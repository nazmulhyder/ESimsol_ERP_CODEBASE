<html>
<head>    
   <link href="@Url.Content("~/Content/CSS/icon.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/easyui.css")" rel="stylesheet" type="text/css" /> 
    <link href="@Url.Content("~/Content/CSS/Pikerstyle.css")" rel="stylesheet" type="text/css" />  

    <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>            
    <script src="@Url.Content("~/Scripts/jquery.ics.customize.js")" type="text/javascript"></script>  
    <script src="@Url.Content("~/Scripts/jquery.easyui.min.js")" type="text/javascript"></script>    

    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script> 
    <script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script> 
</head>
<body>


@model ESimSol.BusinessObjects.OrderRecap

<div style="font-family:Tahoma">
    <table border="0" style="background-color:#CFB53B">
        <tr>
            <td style="width:920px; text-align:center; text-decoration:underline; font-size: 16px; font-weight:bold; color: White"><label id="lblHeaderName">Order Recap Advance Search</label></td>
        </tr>
    </table>
    <table border="0" cellpadding="0" cellspacing="0">
        <tr style="height:445px">
            <td style="width:850px">
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tr style="height:445px">  
                            <td style="width:300px; vertical-align:top;height:300px">
                            <fieldset>
                                <legend style="font-weight:bold; font-size:12px"> Searching Criteria : </legend>
                                <table border="0" cellpadding="0" cellspacing="2">
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Order Recap No:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:350px">
                                           @Html.TextBox("txtOrderRecapNo", "", new { style = "width: 325px", id = "txtOrderRecapNo" }) 
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Style No:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:350px">
                                           @Html.TextBox("txtStyleNo", "", new { style = "width: 325px", id = "txtStyleNo" , placeholder="Type Style No & Press Enter"}) 
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Buyer Name:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           @Html.TextBox("txtBuyerName", "", new { style = "width: 260px;font-size:12px;", id = "txtBuyerName" , placeholder =" Type Buyer & Press Enter" }) <input type="button" style="width:60px;" onclick="BuyerPiker()" value="Pick" />
                                        
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                            Brand:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                            <select id="cboBrand" style="width:300px;"></select>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                            Factory:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                            @Html.TextBox("txtFactory", "", new { style = "width: 260px;font-size:12px;", id = "txtFactory", placeholder = "Type Factory & Press Enter" }) <input type="button" style="width:60px;" onclick="FactoryPiker()"  value="Pick" />
                                        </td>
                                    </tr>
                                     <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Input Date:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px">
                                            <table border="0" cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td style="width:97px;font-size:12px;">@Html.DropDownList("cboOrderIssueDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboOrderIssueDate", style = "width: 97px;font-size:12px;", @class = "_select_changeB" })</td>
                                                    <td style="width:97px;font-size:12px;"><input type="text" id="txtStartIssueDate" value="" style="width: 102px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser"/></td>
                                                    <td style="width:9px;font-size:12px;" id= "enddateIsue">To</td>
                                                    <td style="width:97px;font-size:12px;" id= "enddateIssueEnd"><input type="text" id="txtEndIssueDate" value="" style="width: 102px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>


                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Order Date:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px">
                                            <table border="0" cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td style="width:97px;font-size:12px;">@Html.DropDownList("cboOrderCreateDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboOrderCreateDate", style = "width: 97px;font-size:12px;", @class = "_select_changeA" })</td>
                                                    <td style="width:97px;font-size:12px;"><input type="text" id="txtOpenOrderCreateDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser"/></td>
                                                    <td style="width:9px;font-size:12px;" id= "enddateT">To</td>
                                                    <td style="width:97px;font-size:12px;" id= "enddate"><input type="text" id="txtOrderCreateEndDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                            Shipment Date:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px">
                                            <table bshipment="0" cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td style="width:97px;font-size:12px;">@Html.DropDownList("cboShipmentCreateDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboShipmentCreateDate", style = "width: 97px;font-size:12px;", @class = "_select_changeC" })</td>
                                                    <td style="width:97px;font-size:12px;"><input type="text" id="txtOpenShipmentCreateDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                    <td style="width:9px;font-size:12px;" id="enddateTS">To</td>
                                                    <td style="width:97px;font-size:12px;" id="enddateS"><input type="text" id="txtShipmentCreateEndDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Product Catagory :
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           @Html.TextBox("txtProductCategoryName", "", new { style = "width: 242px", id = "txtProductCategoryName", disabled = "disabled" })<input
                                                    type="button" style="width: 23px; font-size: 12px" onclick="ClenProductCatagory()"
                                                    value="C" /><input type="button" style="width: 60px; font-size: 12px" onclick="ProductCatagoryPicker()"
                                                        value="Pick" />
                                        </td>
                                    </tr>
                                    <tr>
                                            <td style="width: 130px; text-align: left;font-size:12px;">
                                                Session:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width: 325px; text-align: left">
                                                <select id ="cboSession" style =" width:320px;"></select>
                                            </td>
                                        </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                           Merchandiser Name:
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:300px;font-size:12px;">
                                          <select id="cboMerchandiserID"  style="width:325px;font-size:12px;"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="checkbox" name="chkApproved" id="chkApproved"/><label style="width:150px;font-size:12px;" onclick="IsChecked()">Approved</label>
                                            <input type="checkbox" name="chkNotApproved" id="chkNotApproved"/><label style="width:150px;font-size:12px;" onclick="IsChecked()">Not Approved</label>
                                            <input type="checkbox" style="font-weight:bold; color:green; text-align:right;" id="chkIsrunning"><label id="lblRunning" style="font-weight:bold; color:green; font-size:12px;"> Running</label>
                                        </td>
                                    </tr>
                                    <tr style="height:20px; vertical-align:bottom">
                                        <td style=" text-align:left; width:330px;">
                                            <table border ="0" cellpadding ="0" cellspacing="0">
                                                <tr>
                                                    <td style =" text-align:left;"><input type="button" value="Reset"  id="btnReset" style="width:70px; text-align:left;"/></td>
                                                    <td style=" text-align:right; width:260px;"><input type="button" value="Search" id="btnRefresh" style="width:70px; text-align:right;"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </fieldset>
                            </td>                          
                            <td style="width:550px; vertical-align:top">
                                   <div style="margin-left:0px; margin-top:6px; height:548px">
                                        <table id="tblOrderRecap" title="Order Recap List"  class="easyui-datagrid" style="width:550px;height:548px" fitColumns="false" rownumbers="true" pagination="false" singleSelect="true", autoRowHeight="false">
                                            <thead>  
                                                <tr>  
                                                    <th data-options="field:'Selected',checkbox:true"></th> 
                                                    <th field="SLNo" width="80">Recap No</th>
                                                    <th field="OrderRecapNo" width="100">Order No</th>
                                                    <th field="StyleNo" width="90">Style No</th>
                                                    <th field="OrderDateInString" width="80">Order Date</th>  
                                                    <th field="BuyerName" width="170">Buyer Name</th>
                                                </tr>  
                                            </thead> 
                                        </table>​                                          
                                </div>
                            </td>
                            
                        </tr>
                    </table>
            </td>
        </tr>
        <tr style="height:50px">
            <td style="width:850px; text-align:right">
                <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" plain="true" onclick="Close()">Close</a>               
            </td>
        </tr>
    </table>
</div>



</body>
</html>
<script type="text/javascript">
    var _bMultipleItemReturn=false;
    var _sBaseAddress="";
    var obj = window.dialogArguments;
    var _oOrderRecap="";
    var _EmployeeList="";
    var _sBuyerIDs ="";
    var _sFactoryIDs="";
    var _nProductCatagoryID =0;
    var _oBusinessSessions =[];
    var _oBrands = [];
    var _sOrderTypes="";
    var _nMerchandiserIDs = "";
    $(document).ready(function () {
        //debugger;
        //var obj = window.dialogArguments;
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        document.getElementById('lblHeaderName').innerHTML=obj.name;
        _sOrderTypes=obj.OrderType;
        _bMultipleItemReturn=obj.MultipleItemReturn;
        data =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.OrderRecapList));
        _oOrderRecap=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _EmployeeList=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.Employees));
        _oBusinessSessions=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.BusinessSessions));
        _oBrands = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.Brands));
          data={"total":""+data.length+"","rows":data};
          $('#tblOrderRecap').datagrid('loadData',data);
          $('#tblOrderRecap').datagrid({selectOnCheck:false, checkOnSelect:false})
          if(_bMultipleItemReturn==false)
          {
             $('#tblOrderRecap').datagrid('hideColumn','Selected');
             $('#tblOrderRecap').datagrid({ onDblClickRow: function (rowIndex, rowData) { RowDoubleClickEvent(rowIndex, rowData); } });
          }
          
//          $("#txtBuyerName").attr("disabled", "disabled");
          $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
          $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));

          $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
          $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));
          $('#txtOpenShipmentCreateDate').datebox('setValue', icsdateformat(new Date()));
          $('#txtShipmentCreateEndDate').datebox('setValue', icsdateformat(new Date()));

         $('#cboMerchandiserID').empty();
         var listItems= "<option value='"+0+"'>" +"--Select Merchandiser--" + "</option>";
         for (var i = 0; i < _EmployeeList.length; i++)
            {
              listItems+= "<option value='" + _EmployeeList[i].EmployeeID + "'>" + _EmployeeList[i].Name + "</option>";
            }
         $("#cboMerchandiserID").html(listItems);
        var sessionlistItems= "<option value='"+0+"'>" +"--Select Session--" + "</option>";
        if(_oBusinessSessions.length>0)
       {

           for (var i = 0; i <_oBusinessSessions.length; i++) {
                      sessionlistItems += "<option value='" + _oBusinessSessions[i].BusinessSessionID+"'>" + _oBusinessSessions[i].SessionName+"</option>";
           }
       }
        $("#cboSession").html(sessionlistItems);


        var BrandlistItems= "<option value='"+0+"'>" +"--Select Brand--" + "</option>";
        if(_oBrands.length>0)
        {

            for (var i = 0; i <_oBrands.length; i++) {
                BrandlistItems += "<option value='" + _oBrands[i].BrandID+"'>" + _oBrands[i].BrandName+"</option>";
            }
        }
        $("#cboBrand").html(BrandlistItems);

        
    });

     $('._select_changeA').change(function () {
        //debugger;
        var x = $("#cboOrderCreateDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddate").style.display = 'none';
            document.getElementById("enddateT").style.display = 'none';
        }
        else {
            document.getElementById("enddate").style.display = '';
            document.getElementById("enddateT").style.display = '';
        }
       if (x == "None")
        {

            $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));
        }
    });


      $('._select_changeB').change(function () {
        //debugger;
        var x = $("#cboOrderIssueDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddateIssueEnd").style.display = 'none';
            document.getElementById("enddateIsue").style.display = 'none';
        }
        else {
            document.getElementById("enddateIsue").style.display = '';
            document.getElementById("enddateIssueEnd").style.display = '';
        }
       if (x == "None")
        {

            $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));
        }
    });
      $('._select_changeC').change(function () {
          //debugger;
          var x = $("#cboShipmentCreateDate").val();
          if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
              document.getElementById("enddateTS").style.display = 'none';
              document.getElementById("enddateS").style.display = 'none';
          }
          else {
              document.getElementById("enddateS").style.display = '';
              document.getElementById("enddateTS").style.display = '';
          }
          if (x == "None")
          {

              $('#txtOpenShipmentCreateDate').datebox('setValue', icsdateformat(new Date()));
              $('#txtShipmentCreateEndDate').datebox('setValue', icsdateformat(new Date()));
          }
      });


    function ProductCatagoryPicker()
    {
        var oParameter = new Object();
        oParameter.MultipleReturn = false;
        oParameter.ParentCategoryID = 3; //3 means finish goods
        var url = '@Url.Action("ProductCategoryTree", "ProductCategory")';
        var oProductCatagory = window.showModalDialog(url, oParameter, 'dialogHeight:500px;dialogWidth:500px;dialogLeft:400;dialogTop:50;center:yes;resizable:no;status:no;scroll:no');
        //  debugger;
        if (oProductCatagory != null) {
            document.getElementById('txtProductCategoryName').value = oProductCatagory.text;
            _nProductCatagoryID = oProductCatagory.id;
        }
        else
        {
            document.getElementById('txtProductCategoryName').value = "";
            _nProductCatagoryID = 0;
        }


    }

    function ClenProductCatagory(){
        _nProductCatagoryID=0;
        document.getElementById("txtProductCategoryName").value='';
    }





    function BuyerPiker(){
        //debugger;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = true;
        oParameter.ContractorType="2";
        var url = _sBaseAddress+"/Contractor/ContractorSearch";
        _oSelectedContractors = window.showModalDialog(url, oParameter, 'dialogHeight:440px;dialogWidth:455px;dialogLeft:435;dialogTop:200;center:yes;resizable:no;status:no;scroll:no');

        //debugger;
        if(_oSelectedContractors.length>0)
        {

            _sBuyerIDs ="";
            var count =0;
            for(var i =0;i<_oSelectedContractors.length;i++)
            {
                _sBuyerIDs=_sBuyerIDs+_oSelectedContractors[i].ContractorID+",";
                count++;
            }
            _sBuyerIDs =_sBuyerIDs.substring(0,_sBuyerIDs.length-1);
            document.getElementById("txtBuyerName").value=  count +" Buyer's Selected";


        }
        else
        {
            _sBuyerIDs="";
        }
    }

    function FactoryPiker(){
        //debugger;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = true;
        oParameter.ContractorType="3";
        var url = _sBaseAddress+"/Contractor/ContractorSearch";
        _oSelectedContractors = window.showModalDialog(url, oParameter, 'dialogHeight:440px;dialogWidth:455px;dialogLeft:435;dialogTop:200;center:yes;resizable:no;status:no;scroll:no');
        //debugger;
        if(_oSelectedContractors.length>0)
        {
            _sFactoryIDs ="";
            var count =0;
            for(var i =0;i<_oSelectedContractors.length;i++)
            {
                _sFactoryIDs=_sFactoryIDs+_oSelectedContractors[i].ContractorID+",";
                count++;
            }
            _sFactoryIDs =_sFactoryIDs.substring(0,_sFactoryIDs.length-1);
            document.getElementById("txtFactory").value=  count +" Factory's Selected";
        }
        else
        {
            _sFactoryIDs="";
        }
    }




    $('#chkApproved').click(function(){
        if (this.checked) {
            document.getElementById("chkNotApproved").checked = false;
        }
    });
    $('#chkNotApproved').click(function(){
        if (this.checked) {
            document.getElementById("chkApproved").checked = false;
        }
    });

    $('#btnRefresh').click(function () {
        //debugger;
        var cboOrderCreateDate = document.getElementById("cboOrderCreateDate");
        var nOrderCreateDate=cboOrderCreateDate.options[cboOrderCreateDate.selectedIndex].index;

        var cboOrderIssueDate = document.getElementById("cboOrderIssueDate");
        var ncboOrderIssueDate=cboOrderIssueDate.options[cboOrderIssueDate.selectedIndex].index;

        var cboMerchandiserID=document.getElementById("cboMerchandiserID");
        var sStyleNo= document.getElementById("txtStyleNo").value;
        var sOrderRecapNo= document.getElementById("txtOrderRecapNo").value;

        var nMerchandiserID=cboMerchandiserID.options[cboMerchandiserID.selectedIndex].value;
        if(parseInt(nMerchandiserID)>0)
        {
            _nMerchandiserIDs = nMerchandiserID;
        }
        var sSOCDs=$('#txtOpenOrderCreateDate').datebox('getValue');//$("#txtOpenDemandOrderDate").val();
        var sSOCDe=$('#txtOrderCreateEndDate').datebox('getValue');//$("#txtDemandOrderEndDate").val();

        var dIssuStarteDates=$('#txtStartIssueDate').datebox('getValue');
        var dIssueEndDate=$('#txtEndIssueDate').datebox('getValue');

        var cboShipmentCreateDate = document.getElementById("cboShipmentCreateDate");
        var ncboShipmentDate=cboShipmentCreateDate.options[cboShipmentCreateDate.selectedIndex].index;
        var dShipmentStarteDate=$('#txtOpenShipmentCreateDate').datebox('getValue');
        var dShipmentEndDate=$('#txtShipmentCreateEndDate').datebox('getValue');

        /*Business Session */        
        var nSessionID= parseInt($('#cboSession').val());
        var nBrandID = parseInt($('#cboBrand').val());

        var nApproved = 0;
        var nNotApproved = 0;var bIsRunning = false;
        if(document.getElementById("chkApproved").checked == true)
        {
            nApproved = 1;
        }
        else
        {
            nApproved = 0;
        }
        if(document.getElementById("chkNotApproved").checked == true)
        {
            nNotApproved = 1;
        }
        else
        {
            nNotApproved = 0;
        }
        //Running 
        if(document.getElementById("chkIsrunning").checked == true)
        {
            bIsRunning = true;
        }
        if(nOrderCreateDate==0 && ncboShipmentDate == 0 && ncboOrderIssueDate ==0 &&  _nProductCatagoryID == 0 && sStyleNo=="" && sOrderRecapNo=="" && _sBuyerIDs=="" && _sFactoryIDs=="" && _nMerchandiserIDs=="" && nApproved==0 && nNotApproved==0 && nSessionID==0 && nBrandID==0 && bIsRunning==false)
        {
            alert('Please Select a Search Criteria');
            return false;
        }
        
        var sTempString = nOrderCreateDate+'~'+sSOCDs+'~'+sSOCDe+'~'+ncboOrderIssueDate+'~'+dIssuStarteDates+'~'+ dIssueEndDate+'~' +sStyleNo+'~'+_sBuyerIDs+'~'+_nMerchandiserIDs+'~'+sOrderRecapNo+'~'+nApproved+'~'+nNotApproved+'~'+_nProductCatagoryID+'~'+nSessionID+'~'+_sFactoryIDs+'~'+_sOrderTypes+'~'+nBrandID+'~'+ncboShipmentDate+'~'+dShipmentStarteDate+'~'+dShipmentEndDate+'~'+bIsRunning;
        if(obj.name=="Order Recap Advance Search" || obj.name=="Sales Man Sample Advance Search")
        {
            $.ajax({
                type: "GET",
                dataType: "json",
                url: '@Url.Action("Gets", "OrderRecap")',
                data: { Temp: sTempString },
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    ////debugger;
                    oOrderRecap = jQuery.parseJSON(data);
                    if (oOrderRecap != null) {
                        if(oOrderRecap.length>0)
                        {
                            data =oOrderRecap;
                            data={"total":""+data.length+"","rows":data};
                            $('#tblOrderRecap').datagrid('loadData',data);
                            $('#tblOrderRecap').datagrid({selectOnCheck:false, checkOnSelect:false})
                            if(_bMultipleItemReturn==false)
                            {
                                $('#tblOrderRecap').datagrid('hideColumn','Selected');
                                // $('#tblOrderRecap').datagrid({ onDblClickRow: function (rowIndex, rowData) { RowDoubleClickEvent(rowIndex, rowData); } });
                            }
                        }
                        else
                        {
                            alert("Data not found!!");
                            data =oOrderRecap;
                            data={"total":""+data.length+"","rows":data};
                            $('#tblOrderRecap').datagrid('loadData',data);
                        }
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }
    });

    $('#btnReset').click(function () {
        //debugger;
        _sBuyerIDs ="";
        _sFactoryIDs = "";
        _nMerchandiserIDs = "";
        document.getElementById("txtBuyerName").value= '';
        document.getElementById("txtFactory").value= '';
        var txtStyleNo=document.getElementById("txtStyleNo");
        txtStyleNo.style.color="black";
        txtStyleNo.style.fontWeight="normal";
        txtStyleNo.value = "";
        document.getElementById("txtOrderRecapNo").value='';

        document.getElementById("enddate").style.display = '';
        document.getElementById("enddateT").style.display = '';

        document.getElementById("enddateIsue").style.display = '';
        document.getElementById("enddateIssueEnd").style.display = '';

        document.getElementById("chkNotApproved").checked = false;
        document.getElementById("chkApproved").checked = false;
        document.getElementById("chkIsrunning").checked = false;
        document.getElementById('txtProductCategoryName').value = "";
        _nProductCatagoryID =0;
        $('#cboOrderCreateDate').val('None');
        $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));

        $('#cboOrderIssueDate').val('None');
        $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));

        $('#cboShipmentCreateDate').val('None');
        $('#txtOpenShipmentCreateDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtShipmentCreateEndDate').datebox('setValue', icsdateformat(new Date()));
        $('#cboBrand').val(0);

        $('#cboMerchandiserID').empty();
        var listItems= "<option value='"+0+"'>" +"--Select Merchandiser--" + "</option>";
        for (var i = 0; i < _EmployeeList.length; i++)
        {
            listItems+= "<option value='" + _EmployeeList[i].EmployeeID + "'>" + _EmployeeList[i].Name + "</option>";
        }
        $("#cboMerchandiserID").html(listItems);
        data ="";
        data={"total":""+data.length+"","rows":data};
        $('#tblOrderRecap').datagrid('loadData',data);

        var txtFactory=document.getElementById("txtFactory");
        txtFactory.style.color="black";
        txtFactory.style.fontWeight="normal";

        var txtBuyerName=document.getElementById("txtBuyerName");
        txtBuyerName.style.color="black";
        txtBuyerName.style.fontWeight="normal";

    });




    // Search Buyer Start
    $('#txtBuyerName').keypress(function (e) {
        //debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) {
            var txtBuyerName = document.getElementById('txtBuyerName').value;
            if(txtBuyerName!="")
            {
                //debugger;
                var tsv=((new Date()).getTime())/1000;
                var oParameter = new Object();
                oParameter.EnteredText=txtBuyerName;
                var url =_sBaseAddress+ "/Contractor/ViewContractorSearch?sTemp="+txtBuyerName+"&pt=2&ts="+tsv;
                var oContractor = window.showModalDialog(url, oParameter, 'dialogHeight:270px;dialogWidth:383px;dialogLeft:520;dialogTop:310;center:yes;resizable:no;status:no;scroll:no');

                //debugger;
                if(oContractor !=null)
                {
                    if(parseInt(oContractor.ContractorID)>0)
                    {
                        var txttBuyerName=document.getElementById("txtBuyerName");
                        txttBuyerName.value=oContractor.Name;
                        txttBuyerName.style.color="blue";
                        txttBuyerName.style.fontWeight="bold";
                        _sBuyerIDs= _sBuyerIDs+""+ oContractor.ContractorID;
                    }
                }
                else
                {
                    var txttBuyerName=document.getElementById("txtBuyerName");
                    txttBuyerName.style.color="black";
                    txttBuyerName.style.fontWeight="normal";
                    _sBuyerIDs ="";
                    document.getElementById("txtBuyerName").value=  "";
                }

            }
        }
    });

    $('#txtBuyerName').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            //debugger;
            var txtFactoryName=document.getElementById("txtBuyerName");
            txtFactoryName.style.color="black";
            txtFactoryName.style.fontWeight="normal";
            _sBuyerIDs ="";

        }
    });

    // Search By Factory Start
    $('#txtFactory').keypress(function (e) {
        //debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) {
            var txtFactory = document.getElementById('txtFactory').value;
            if(txtFactory!="")
            {
                //debugger;
                var tsv=((new Date()).getTime())/1000;
                var oParameter = new Object();
                oParameter.EnteredText=txtFactory;
                var url =_sBaseAddress+ "/Contractor/ViewContractorSearch?sTemp="+txtFactory+"&pt=3&ts="+tsv;
                var oContractor = window.showModalDialog(url, oParameter, 'dialogHeight:270px;dialogWidth:383px;dialogLeft:520;dialogTop:310;center:yes;resizable:no;status:no;scroll:no');

                //debugger;
                if(oContractor !=null)
                {
                    if(parseInt(oContractor.ContractorID)>0)
                    {
                        var txtFactory=document.getElementById("txtFactory");
                        txtFactory.value=oContractor.Name;
                        txtFactory.style.color="blue";
                        txtFactory.style.fontWeight="bold";
                        _sFactoryIDs= _sFactoryIDs+""+ oContractor.ContractorID;
                    }
                }
                else
                {
                    var txtFactory=document.getElementById("txtFactory");
                    txtFactory.style.color="black";
                    txtFactory.style.fontWeight="normal";
                    _sFactoryIDs ="";
                    document.getElementById("txtFactory").value=  "";
                }

            }
        }
    });

    $('#txtFactory').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            //debugger;
            var txtFactory=document.getElementById("txtFactory");
            txtFactory.style.color="black";
            txtFactory.style.fontWeight="normal";
            _sFactoryIDs ="";
        }
    });

    // Search Style Start
    $('#txtStyleNo').keypress(function (e) {
        //debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) {
            var txtStyleNo = document.getElementById('txtStyleNo').value;
            if(txtStyleNo!="")
            {
                //debugger;
                var tsv=((new Date()).getTime())/1000;
                var oParameter = new Object();
                oParameter.EnteredText=txtStyleNo;
                var url =_sBaseAddress+ "/TechnicalSheet/ViewStyleSearch?sTempStyle="+txtStyleNo+"&ts="+tsv;
                var oTechnicalSheet= window.showModalDialog(url, oParameter, 'dialogHeight:270px;dialogWidth:383px;dialogLeft:520;dialogTop:310;center:yes;resizable:no;status:no;scroll:no');

                debugger;
                if(oTechnicalSheet !=null)
                {
                    if(parseInt(oTechnicalSheet.TechnicalSheetID)>0)
                    {
                        var txtStyleNo=document.getElementById("txtStyleNo");
                        txtStyleNo.value=oTechnicalSheet.StyleNo;
                        txtStyleNo.style.color="blue";
                        txtStyleNo.style.fontWeight="bold";

                    }
                }
                else
                {
                    var txtStyleNo=document.getElementById("txtStyleNo");
                    txtStyleNo.style.color="black";
                    txtStyleNo.style.fontWeight="normal";
                }

            }
        }
    });

    $('#txtStyleNo').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            //debugger;
            var txtStyleNo=document.getElementById("txtStyleNo");
            txtStyleNo.style.color="black";
            txtStyleNo.style.fontWeight="normal";
            txtStyleNo.value = "";

        }
    });
    // Search Style End


    function Close()
    {
        window.close();
    }

    function OkButtonClick()
    {
        //debugger;

        if(_bMultipleItemReturn==true)
        {
            var oOrderRecaps=[];
            var oOrderRecaps = $('#tblOrderRecap').datagrid('getChecked');
            if(oOrderRecaps.length<=0)
            {
                alert("please select atleast one item");
                return;
            }
            window.returnValue= oOrderRecaps;
        }
        else
        {
            var oOrderRecaps=[];
            var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
            oOrderRecaps.push(oOrderRecap);
            if(oOrderRecaps.length<=0)
            {
                alert("please select a product");
                return;
            }
            window.returnValue= oOrderRecap;
        }
        window.close();
    }



    $(document).keydown(function(e) {
        //debugger;
        if(e.which == 27)//escape=27
        {
            //debugger;
            window.close();
        }
    });
</script>