@{
    ViewBag.Title = "Export Bill  List";
}
@model IEnumerable<ESimSol.BusinessObjects.ExportBillReport>

<head>
 <title>ExportBillReport</title>
    @*<script src="@Url.Content("~/Views/ExportBillReport/AdvSearch.js")" type="text/javascript"></script>
 <script src="@Url.Content("~/Views/ExportBillReport/ExportBillReport.js")" type="text/javascript"></script>
 <script src="@Url.Content("~/Views/ExportBillReport/ExportBillReports.js")" type="text/javascript"></script>*@
</head>
<body> 
    <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progressbar" style="width:100%;height:37px;"></div>
        </div>
    </div>

 
 <div class="menuMainCollectionTable">
    
     <table id="tblExportBillReports" title="Export Bill Report List" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar" data-options="rowStyler: function(index,row){
                                        if (row.DgvStyle==1){
                                            return 'color:#ff3300; font-weight:Normal;';
                                        }if (row.ExportBillNoSt=='Total'){
                                            return 'color:#016B18; font-weight:bold;';}}">
         <thead>
             <tr>
                 <th field="ExportLCNo" width="12%" align="left">L/C No</th>
                 <th field="ApplicantName" width="15%" align="left">Party Name</th>
                 <th field="BankName_Advice" width="10%" align="left">Advice Bank</th>
                 <th field="BankName_Nego" width="10%" align="left">Negotiate Bank</th>
                 <th field="ExportBillNoSt" width="15%" align="left">Bill No</th>
                 <th field="PINo" width="12%" align="left">P/I No</th>
                 <th field="AmountSt" width="10%" align="right">Amount</th>
                 <th field="StateSt" width="10%" align="left">Current Status</th>
                 <th field="BankName_Issue" width="10%" align="left">Issue Bank</th>
                 <th field="BBranchName_Issue" width="10%" align="left">Issue Bank Branch</th>
                 <th field="LCOpeningDatest" width="10%" align="left">LC Open. Date</th>
                 <th field="ShipmentDateSt" width="10%" align="left">Last Shipment Date</th>
                 <th field="ExpiryDateSt" width="10%" align="left">Last Expiry Date</th>
                 <th field="MKTPName" width="10%" align="left">Concern Person</th>
                 <th field="DocPrepareDateSt" width="10%" align="left">Doc Prepare Date</th>
                 <th field="StartDateSt" width="10%" align="left">Bill Date</th>
                 <th field="TimeLag1" width="5%" align="left">Delay Days</th>

                 <th field="SendToPartySt" width="10%" align="left">Send To Party</th>
                 <th field="TimeLag2" width="5%" align="left">Delay Days</th>

                 <th field="RecdFromPartySt" width="10%" align="left">Recd From Party</th>
                 <th field="TimeLag3" width="5%" align="left">Delay Days</th>

                 <th field="SendToBankDateSt" width="10%" align="left">Send To Bank</th>
                 <th field="TimeLag4" width="5%" align="left">Delay Days</th>

                 <th field="RecedFromBankDateSt" width="10%" align="left">Recd From Bank</th>
                 <th field="TimeLag5" width="5%" align="left">Delay Days</th>

                 <th field="LDBCDateSt" width="10%" align="left">LDBC Date</th>
                 <th field="LDBCNo" width="10%" align="left">LDBC No</th>
                 <th field="TimeLag6" width="5%" align="left">Delay Days</th>

                 <th field="AcceptanceDateStr" width="10%" align="left">Submit To Party Bank</th>
                 <th field="TimeLag7" width="5%" align="left">Delay Days</th>

                 <th field="MaturityReceivedDateSt" width="10%" align="center">Maturity Red Date</th>
                 <th field="TimeLag8" width="5%" align="left">Delay Days</th>

                 <th field="MaturityDateSt" width="10%" align="left">Maturity Date</th>
                 <th field="TimeLag9" width="5%" align="left">Delay Days</th>

                 <th field="DiscountedDateSt" width="10%" align="left">Discounted Date</th>
                 <th field="TimeLag10" width="5%" align="left">Delay Days</th>

                 <th field="RelizationDateSt" width="10%" align="left">Relization Date</th>
                 <th field="TimeLag11" width="5%" align="left">Delay Days</th>

                 <th field="BankFDDRecDateSt" width="10%" align="left">BankFDD Recd Date</th>
                 <th field="TimeLag12" width="5%" align="left">Delay Days</th>

                 <th field="EncashmentDateSt" width="10%" align="left">Encashment Date</th>
                 <th field="TimeLag13" width="5%" align="left">Delay Days</th>
                 <th field="UPNo" width="10%" align="left">UPNo</th>
             </tr>
         </thead>
     </table>
    <div id="toolbar">
        <table>
            <tr>
                <td>
                    
                    <a id="btnRefresh" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" >Refresh</a>
                    <input type="text" id="txtSearchbyLCNo" placeholder="Type L/C No and Press Enter" style="width:120px" />
                    <input type="text" id="txtSearchbyLDBCNo" placeholder="Type LDBC/IBC No and Press Enter" style="width:120px" />
                    <input type="text" id="txtSearchbyBillNo" placeholder="Type Bill No and Press Enter" style="width:120px" />
                    <input type="text" id="txtSearchbyPINo" placeholder="Type P/I No and Press Enter" style="width:120px" />
                    <a id="btnAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>
                    <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" >Print</a>
                    <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print XL</a>
                    <a id="btnConfiguration" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" >Configuration</a>
                </td>
            </tr>
        </table>
        @*<a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="AddStatus Change()" id="btnPaymentByLibality">Status Change </a>*@
    </div>
 </div>
 <div id="winAdvSearch" class="easyui-window winClass" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <table style="width:100%;">
            <tr>
                <td>
                    <fieldset style="margin-bottom: 0px;">
                        <legend>Searching Criteria</legend>
                        <table>
                            <tr>
                                <td>
                                    <label>Unit:</label>
                                </td>
                                <td>
                                    <select id="cboBUType" style="width: 160px"></select>
                                    <label>L/C Type:</label>
                                    <select id="cboLCType" style="width: 110px"></select>
                                </td>  
                               
                            </tr>
                            <tr>
                                <td>
                                    <label>Currenct State :</label>
                                </td>
                                <td>
                                    <table id="tblCurrenctState" title="" class="easyui-datagrid" style="width:200px;height:150px;" pagination="false" rownumbers="false" fitcolumns="true" singleselect="false">
                                        <thead>
                                            <tr>
                                                <th field="ck" checkbox="true"></th>
                                                <th field="Value" width="100" style="font-size:12px;">Currenct State</th>
                                            </tr>
                                        </thead>
                                    </table>

                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <label>Party Name :</label>
                                </td>
                                <td>
                                    <input id="txtContractorAdvS" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                    <a id="btnPickContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                    <a id="btnClrContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Nego Bank:</label>
                                </td>
                                <td>
                                    <select id="cboBankBranch_Nego" style="width: 390px"></select>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <label>Issue Bank :</label>
                                </td>
                                <td>
                                    <input id="txtBankBranch_Issue" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                    <a id="btnPickBankBranch_Issue" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                    <a id="btnClrBankBranch_Issue" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>

                                </td>
                            </tr>


                            <tr>
                                <td>
                                    <label>Bill Amount :</label>
                                </td>
                                <td>
                                    <select id="cobBillAmount" onchange="DateActions_Amount()" style="width:130px;"></select>
                                    <input type="text" id="txtFromBillAmount" style="width:110px;text-align:right" value="0" />
                                    To
                                    <input type="text" id="txtToBillAmount" style="width:110px;text-align:right" disabled value="0" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">
                                    <fieldset style="width:465px;">
                                        <legend style="font-weight: bold">Criteria : </legend>
                                        <table id="tblDateType">
                                            <tr>
                                                <td style="font-size:12px;text-align:right;">
                                                    <label>Date Type :</label>
                                                </td>
                                                <td>
                                                    <select id="cboDateCriteria" style="width: 352px;">
                                                        <option value="None">--Select One--</option>
                                                        <option value="StartDate">Bill Prepare</option>
                                                        <option value="SendToParty">Send To Party</option>
                                                        <option value="RecdFromParty">Received From Party</option>
                                                        <option value="SendToBank">Send To Bank</option>
                                                        <option value="RecdFromBank">Received From Bank</option>
                                                        <option value="LDBCDate">LDBC/IBC Date</option>
                                                        <option value="AcceptanceDate">Acceptance Date</option>
                                                        <option value="MaturityDate">Maturity Date</option>
                                                        <option value="MaturityReceivedDate">Maturity Received Date</option>
                                                        <option value="RelizationDate">Relization Date</option>
                                                        <option value="BankFDDReceiveDate">Bank FDD Receive Date</option>
                                                        <option value="DiscountedDate">Discounted Date</option>
                                                        <option value="EncashmentDate">Encashment Date</option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="font-size:12px;text-align:right;width:100px;">
                                                    <label>Date :</label>
                                                </td>
                                                <td>
                                                    <select id="cboBillDate" onchange="DateActions_Bill()" style="width:100px;font-size:12px;"></select>
                                                    <input id="txtBillDateStart" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                                    To
                                                    <input id="txtBillDateEnd" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                                </td>
                                            </tr>
                                        </table>
                                    </fieldset>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <fieldset style="width:465px;">
                                        <legend style="font-weight: bold">Datewise State : </legend>
                                        <table>
                                            <tr>
                                                <td style="font-size:12px;text-align:right;width:100px;">
                                                    <label>State on Date :</label>
                                                </td>
                                                <td>
                                                    <select id="cboState" style="width: 352px;"></select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="font-size:12px;text-align:right;">
                                                    <label>Date :</label>
                                                </td>
                                                <td>
                                                    <select id="cboDateOptionAdvSearch" onchange="DateActions_DateOption(); "></select>
                                                    <input id="txtFromDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                                    <input id="txtToDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />

                                                </td>
                                            </tr>
                                        </table>
                                    </fieldset>
                                </td>
                            </tr>

                            <tr>
                                <td height="5px" colspan="4"></td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div class="col-lg-12">
                                        <div class="col-lg-6">
                                            <label>Wait for UP Issue: </label>
                                            <span>
                                                <input type="checkbox" id="ckhYetToEUP" />
                                            </span>
                                        </div>
                                        <div class="col-lg-6">
                                            <label>Export UP Issued: </label>
                                            <span>
                                                <input type="checkbox" id="ckhEUPDone" />
                                            </span>
                                        </div>
                                    </div>
                                </td>
                                </tr>
                        </table>
                    </fieldset>
                </td>
            </tr>
        </table>

        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <label class="lblLoadingMessage" style="float: left;">Loading Please Wait...</label>
            <a id="btnResetAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>
            <a id="btnSearchAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
            <a id="btnCloseAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <div id="winExportBillReportColumn" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div id="divExportBillReportColumn" tabindex=" -1">
            <table border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td>
                        <table id="tblExportBillReportColumn" title="Field List" class="easyui-datagrid" style="width: 255px;
                        height: 580px" fitcolumns="false" rownumbers="true"
                               pagination="false" autorowheight="false">
                            <thead>
                                <tr>
                                    <th data-options="field:'Selected',checkbox:true">
                                    </th>
                                    <th field="Caption" width="195">
                                        Field Name
                                    </th>
                                </tr>

                            </thead>
                        </table>
                    </td>
                </tr>
                <tr style="text-align:right">
                    <td>
                        <table>
                            <thead>
                                <tr>
                                    <td style="text-align:left">
                                        <a id="btnClose_ExportBillReportColumn" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                                    </td>
                                    <td style="text-align:right">
                                        <a id="btnOk_ExportBillReportColumn" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">OK</a>
                                    </td>
                                </tr>
                            </thead>
                        </table>
                    </td>                                    
                </tr>
            </table>

        </div>

    </div>
</body>
                      
<style type="text/css">
        /*#winExportBillReport {
                 width: 400px;
                          }*/
</style>

 <script type="text/javascript">
    var _oExportBillReport=null;
    var _oExportBillReports=[];
    var _oBankBranchs_Nego=[];
    var _oLCBillEventObj=[];
    var _oCompareOperators=[];
    var oExportBillReportColumns = [];
    var _oBusinessUnits=[];
    var _oCurrencys=[];
    var _sBankBranch_IssueIds="";
    var _sContractorIds="";
    var _nBUID=0;
    var _oLCTypes = [];
    $(document).ready(function () {
        _oExportBillReports =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oBankBranchs_Nego=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BankBranchs_Nego));
        _oLCBillEventObj=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.LCBillEventObj));
        _oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
        //  _oBankAccounts= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BankAccounts));
        _oCurrencys= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _oBusinessUnits= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
        _oLCTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.LCTypes));
        $("#cboLCType").icsLoadCombo({List: _oLCTypes, OptionValue: "id", DisplayText: "Value"});
        LoadComboAdv();

        if(sessionStorage.getItem("ExportBillReport")!=null && sessionStorage.getItem("ExportBillReports").length>0)
        {
            _oExportBillReports= jQuery.parseJSON(sessionStorage.getItem('ExportBillReports'));
            var nIndex= sessionStorage.getItem('SelectedRowIndex');
            DynamicRefreshList(_oExportBillReports, 'tblExportBillReports');

            //if(nIndex>-1){
            //    $('#tblExportBillReports').datagrid('selectRow',nIndex);
            //    RowSelect(nIndex, _oExportBillReports[nIndex]);
            //}

        }
        else{
            DynamicRefreshList(_oExportBillReports, 'tblExportBillReports');
        }
        sessionStorage.setItem("ParamsSO", "");
        $(".lblLoadingMessage").hide();
        $("#progressbarParent").hide();
    });

     function LoadComboAdv()
     {
         $("#cboBUType").icsLoadCombo({
             List: _oBusinessUnits,
             OptionValue: "BusinessUnitID",
             DisplayText: "BUTypeSt"
         });
        
         $("#cboBUType").val(_nBUID); // for one company , if multi company please change it
         
         $("#cboBankBranch_Nego").icsLoadCombo({
             List: _oBankBranchs_Nego,
             OptionValue: "BankBranchID",
             DisplayText: "BankBranchName"
         });

         DynamicRefreshList(_oLCBillEventObj, "tblCurrenctState");

         $("#cboState").icsLoadCombo({
             List: _oLCBillEventObj,
             OptionValue: "id",
             DisplayText: "Value"
         });
         $("#cboDateOptionAdvSearch, #cboBillDate, #cobBillAmount").icsLoadCombo({
             List: _oCompareOperators,
             OptionValue: "Value",
             DisplayText: "Text"
             //OptionValue: "id",
             //DisplayText: "Value"
         });
         $("#cboCurrency").icsLoadCombo({
             List: _oCurrencys,
             OptionValue: "CurrencyID",
             DisplayText: "Symbol"
         });

     }
     $(document).keydown(function (e) { if (e.keyCode == 27) { $('#winExportBillReportColumn').icsWindow('close'); } });

     ///Configuration
     $("#btnConfiguration").click(function () {
         $("#winExportBillReportColumn").icsWindow('open', "Export Bill->Configuration");
         GetExportBill_ColConfiguration();
     });

     function GetExportBill_ColConfiguration() {


         var oLists = [];
         var oList = new Object();

         oList.FieldName = "ExportLCNo";
         oList.Caption = "LC No";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "MasterLCNos";
         oList.Caption = "MasterLC No";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "ApplicantName";
         oList.Caption = "Party Name";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "BankName_Advice";
         oList.Caption = "Advice Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "BankName_Nego";
         oList.Caption = "Negotiate Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "ExportBillNoSt";
         oList.Caption = "Bill No";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "AmountSt";
         oList.Caption = "Amount";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "StateSt";
         oList.Caption = "Current Status";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "BankName_Issue";
         oList.Caption = "Issue Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "BBranchName_Issue";
         oList.Caption = "Issue Bank Branch";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "LCOpeningDatest";
         oList.Caption = "LC Open Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "DocPrepareDateSt";
         oList.Caption = "Doc Prepare Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "StartDateSt";
         oList.Caption = "Invoice Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "SendToPartySt";
         oList.Caption = "Send To Party";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "RecdFromPartySt";
         oList.Caption = "Recd From Party";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "SendToBankDateSt";
         oList.Caption = "Send To Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "RecedFromBankDateSt";
         oList.Caption = "Recd From Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "LDBCDateSt";
         oList.Caption = "LDBC Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "LDBCNo";
         oList.Caption = "LDBC No";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "AcceptanceDateSt";
         oList.Caption = "Submit To Party Bank";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "MaturityReceivedDateSt";
         oList.Caption = "Maturity Red Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "MaturityDateSt";
         oList.Caption = "Maturity Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "DiscountedDateSt";
         oList.Caption = "Discounted Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "RelizationDateSt";
         oList.Caption = "Relization Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "BankFDDRecDateSt";
         oList.Caption = "BankFDD Recd Date";
         oLists.push(oList);

         oList = new Object();
         oList.FieldName = "EncashmentDateSt";
         oList.Caption = "Encashment Date";
         oLists.push(oList);

         DynamicRefreshList(oLists, "tblExportBillReportColumn");

     }
     $("#btnClose_ExportBillReportColumn").click(function (e)
     {
         debugger;
         $("#winExportBillReportColumn").icsWindow('close');

     });
     $("#btnOk_ExportBillReportColumn").click(function (e)
     {
         debugger;
         oExportBillReportColumns = $("#tblExportBillReportColumn").icsGetCheckedItem();
     });
     $("#btnRefresh").click(function (e) {
         debugger;
         var sColumns = ["ExportLCNo", "ApplicantName", "BankName_Advice", "BankName_Nego", "ExportBillNoSt", "AmountSt", "StateSt", "BankName_Issue","BBranchName_Issue", "LCOpeningDatest","DocPrepareDateSt", "StartDateSt", "SendToPartySt", "RecdFromPartySt", "SendToBankDateSt", "RecedFromBankDateSt", "LDBCDateSt", "LDBCNo", "AcceptanceDateSt", "MaturityReceivedDateSt", "MaturityDateSt", "DiscountedDateSt", "RelizationDateSt", "BankFDDRecDateSt", "EncashmentDateSt"]
         for (var i = 0; i < sColumns.length; i++) {
             $('#tblExportBillReports').datagrid('showColumn', sColumns[i]);
         }

         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag1');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag2');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag3');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag4');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag5');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag6');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag7');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag8');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag9');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag10');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag11');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag12');
         $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag13');

         DynamicRefreshList(_oExportBillReports, "tblExportBillReports");
     });

     function ColumnHide() {
         debugger
         if (oExportBillReportColumns.length > 0) {
             var sColumns = ["ExportLCNo", "ApplicantName", "BankName_Advice", "BankName_Nego", "ExportBillNoSt", "AmountSt", "StateSt","BankName_Issue","BBranchName_Issue", "LCOpeningDatest","DocPrepareDateSt", "StartDateSt", "SendToPartySt", "RecdFromPartySt", "SendToBankDateSt", "RecedFromBankDateSt", "LDBCDateSt", "LDBCNo", "AcceptanceDateSt", "MaturityReceivedDateSt", "MaturityDateSt", "DiscountedDateSt", "RelizationDateSt", "BankFDDRecDateSt", "EncashmentDateSt"]
             for (var i = 0; i < sColumns.length; i++) {
                 if (!IsExist(sColumns[i])) {
                     $('#tblExportBillReports').datagrid('hideColumn', sColumns[i]);
                 }
             }


             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag1');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag2');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag3');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag4');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag5');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag6');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag7');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag8');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag9');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag10');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag11');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag12');
             $('#tblExportBillReports').datagrid('hideColumn', 'TimeLag13');


         }
     }

     function IsExist(sColumnName) {
         debugger;
         for (var j = 0; j < oExportBillReportColumns.length; j++) {
             if (oExportBillReportColumns[j].FieldName == sColumnName) {
                 return true;
             }
         }
         return false;
     }
     ///end Configuration

     ////Start adv Searching

     function updateProgress() {
         var value =$('#progressbar').progressbar('getValue');
         if (value < 96){
             value += Math.floor(Math.random() * 10);
             $('#progressbar').progressbar('setValue', value);
         }
     }
     function hideShow(miliseconds) {
         $("#progressbarParent").hide();
     }
     //Account Of Picker

     $("#txtContractorAdvS").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             PickContractors_AdvS();
         }
         else if (e.keyCode === 08) {
             $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
             _sContractorIds = '';
         }
     });

     $("#btnClrContractorAdvS").click(function () {
         $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
         $("#txtContractorAdvS").val("");
         _sContractorIds = '';
     });

     $("#btnPickContractorAdvS").click(function () {
         PickContractors_AdvS();
     });
     function PickContractors_AdvS() {
         var oContractor = {
             Params: '2,3' + '~' + $.trim($("#txtContractorAdvS").val()+"~"+_nBUID)
         };
         var obj = {
             BaseAddress: sessionStorage.getItem("BaseAddress"),
             Object: oContractor,
             ControllerName: "Contractor",
             ActionName: "ContractorSearchByNameType",
             IsWinClose: false
         };

         $("#progressbar").progressbar({ value: 0 });
         $("#progressbarParent").show();
         var intervalID = setInterval(updateProgress, 250);

         DynamicRefreshList([], "tblAccountsPickerAdvSearch");
         $.icsDataGets(obj, function (response) {
             clearInterval(intervalID);
             $("#progressbarParent").hide();
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].ContractorID > 0) {
                     var tblColums = []; var oColumn = { field: "ContractorID", title: "Code", width: 50, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "Name", title: "Name", width: 280, align: "left" }; tblColums.push(oColumn);

                     var oPickerParam = {
                         winid: 'winContractorPicker',
                         winclass: 'clsAccountOf',
                         winwidth: 400,
                         winheight: 460,
                         tableid: 'tblAccountOfs',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'Name',
                         windowTittle: 'Contactor List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbutton(oPickerParam);
                 }
                 else {
                     alert(response.objs[0].ErrorMessage);
                 }
             }
             else {
                 alert("Sorry, No Contactor Found.");
             }
         });
     }
     //End Account Of Picker
     $("#txtBankBranch_Issue").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             if($("#txtBankBranch_Issue").val()=="" || $("#txtBankBranch_Issue").val()==null)
             {
                 $("#txtBankBranch_Issue").removeClass("fontColorOfPickItem");
                 _sBankBranch_IssueIds = '';
                 alert("Please, Type name")
                 return;
             }

             var oBankBranch = {
                 BUID: _nBUID,
                 DeptIDs: '5',//EnumOperationalDept : Export_Party=5
                 BankName: $.trim($("#txtBankBranch_Issue").val())
             };
             PickBanks_AdvS(oBankBranch);
         }
         else if (e.keyCode === 08) {
             $("#txtBankBranch_Issue").removeClass("fontColorOfPickItem");
             _sBankBranch_IssueIds = '';
         }
     });

     $("#btnClrBankBranch_Issue").click(function () {
         $("#txtBankBranch_Issue").removeClass("fontColorOfPickItem");
         $("#txtBankBranch_Issue").val("");
         _sBankBranch_IssueIds = '';
     });

     $("#btnPickBankBranch_Issue").click(function () {
         var oBankBranch = {
             BUID: _nBUID,
             DeptIDs: '5',//EnumOperationalDept : Export_Party=5
             BankName: $.trim($("#txtBankBranch_Issue").val())
         };
         PickBanks_AdvS(oBankBranch);
     });
     function PickBanks_AdvS(oBankBranch) {

         var obj = {
             BaseAddress: sessionStorage.getItem("BaseAddress"),
             Object: oBankBranch,
             ControllerName: "BankBranch",
             ActionName: "GetsBankBranchSearchByBankName",
             IsWinClose: false
         };

         $("#progressbar").progressbar({ value: 0 });
         $("#progressbarParent").show();
         var intervalID = setInterval(updateProgress, 250);

         $.icsDataGets(obj, function (response) {
             clearInterval(intervalID);
             $("#progressbarParent").hide();
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].BankBranchID > 0) {
                     var tblColums = []; var oColumn = { field: "BankName", title: "Bank Name", width: 200, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "BranchName", title: "Branch Name", width: 280, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "Address", title: "Address", width: 280, align: "left" }; tblColums.push(oColumn);

                     var oPickerParam = {
                         winid: 'winBankBranch_IssuePicker',
                         winclass: 'clsBankBranch_Issue',
                         winwidth: 500,
                         winheight: 460,
                         tableid: 'tblBankBranch_Issues',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'BranchName',
                         windowTittle: 'Bank List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbutton(oPickerParam);
                 }
                 else {
                     alert(response.objs[0].ErrorMessage);
                 }
             }
             else {
                 alert("Sorry, No Contactor Found.");
             }
         });
     }

     //EndIssue Bank

     function IntializePickerbutton(oPickerobj) {
         $("#" + oPickerobj.winid).find("#btnOk").click(function () {
             SetPickerValueAssign(oPickerobj);
         });
         $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
             if (e.which === 13) {
                 SetPickerValueAssign(oPickerobj);
             }
         });
     }

     function SetPickerValueAssign(oPickerobj) {
         var oreturnObj = null, oreturnObjs = [];
         if (oPickerobj.multiplereturn) {
             oreturnObjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
         } else {
             oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
         }

         if (oPickerobj.winid == 'winContractorPicker')
         {
             if (oreturnObjs != null && oreturnObjs.length> 0)
             {

                 _sContractorIds=''; var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Contractors Selected" : oreturnObjs[0].Name;
                 $('#txtContractorAdvS').val(sMessage);
                 $("#txtContractorAdvS").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sContractorIds=_sContractorIds+oreturnObjs[i].ContractorID+',';
                 }
                 _sContractorIds=_sContractorIds.substring(0,_sContractorIds.length-1);

             }
             else
             {
                 alert("Please select a contractor.");
                 return false;
             }
         }

         else if (oPickerobj.winid == 'winBankBranch_IssuePicker') {
             if (oreturnObjs != null && oreturnObjs.length> 0)
             {
                 var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Bank(s) Selected" : oreturnObjs[0].BankName;
                 $('#txtBankBranch_Issue').val(sMessage);
                 $("#txtBankBranch_Issue").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sBankBranch_IssueIds=_sBankBranch_IssueIds+oreturnObjs[i].BankBranchID+',';
                 }
                 _sBankBranch_IssueIds=_sBankBranch_IssueIds.substring(0,_sBankBranch_IssueIds.length-1);
             }
             else
             {
                 alert("Please select a Bank Branch.");
                 return false;
             }
         }

         $("#" + oPickerobj.winid).icsWindow("close");
         $("#" + oPickerobj.winid).remove();
     }


     //End Buyer Search
     $('#ckhYetToEUP').change(function (e) {
         debugger;
         if ($('#ckhYetToEUP').is(':checked'))
             $('#ckhEUPDone').prop('checked', false);

     });
     $('#ckhEUPDone').change(function (e) {
         if ($('#ckhEUPDone').is(':checked'))
             $('#ckhYetToEUP').prop('checked', false);
     });
     $("#btnResetAdvSearch").click(function () {
         ResetAdvSearchWindow();
         DateActions_Amount();
         DateActions_Bill();
         DateActions_DateOption();

     });

     function MakeStringIDs(StringIDs) {

         var IDs = "";
         for (var i = 0; i < StringIDs.length; i++) {
             IDs = StringIDs[i].id + "," + IDs;
         }
         var length = 0;
         length = parseInt(IDs.length) - 1;
         IDs = IDs.substring(0, parseInt(length));
         return IDs;
     }
     $("#btnSearchAdvSearch").click(function () {
         debugger;

         $(".lblLoadingMessage").show();

         var checkDate = CheckFromAndToDateValidation("cboBillDate", "txtBillDateStart", "txtBillDateEnd");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }
         checkDate = CheckFromAndToDateValidation("cboDateOptionAdvSearch", "txtFromDateAdvSearch", "txtToDateAdvSearch");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }


         var oCurrenctStates = $('#tblCurrenctState').datagrid('getSelections');
         var sCurrenctStates = "";
         if (oCurrenctStates.length > 0) {
             sCurrenctStates = MakeStringIDs(oCurrenctStates);
         }



         var nDateType =  $("#cboDateCriteria").val();
         var nDateSearchCriteria =   parseInt($("#cboBillDate").val());
         var dStartDateCritaria = $('#txtBillDateStart').datebox('getValue');
         var dEndDateCritaria =  $('#txtBillDateEnd').datebox('getValue');

         var nStateDateType =parseInt($("#cboState").val());
         var nDateSearchState= parseInt($("#cboDateOptionAdvSearch").val());
         var dStartDateState= $('#txtFromDateAdvSearch').datebox('getValue');
         var dEndDateState= $('#txtToDateAdvSearch').datebox('getValue');

         var nSearchAmountType =  parseInt($("#cobBillAmount").val());
         var nFromAmount = parseFloat($("#txtFromBillAmount").val());
         var nToAmount =  parseFloat($("#txtToBillAmount").val());
         var nBankBranchID_Nego= parseInt($("#cboBankBranch_Nego").val());

         var sExportLCNo= "";
         var sExportBillNo= "";
         var sExportLDBCNo= "";
         var sExportPINo= "";
         var nExportLCType = parseInt($("#cboLCType").val());
         _nBUID=$("#cboBUType").val();

         var sParams = _sContractorIds + "~" +
                 sCurrenctStates + "~" +
                 nBankBranchID_Nego + "~" +
                 _sBankBranch_IssueIds+"~"+
                 nSearchAmountType + "~" +
                 nFromAmount + "~" +
                 nToAmount + "~" +

                 nDateType+ "~" +
                 nDateSearchCriteria + "~" +
                 dStartDateCritaria + "~" +
                 dEndDateCritaria + "~" +

                 nStateDateType + "~" +
                 nDateSearchState+ "~" +
                 dStartDateState+ "~" +
                 dEndDateState+ "~" +
                 sExportLCNo+ "~" +
                 sExportBillNo+ "~" +
                 sExportLDBCNo+ "~" +
                 sExportPINo+ "~" +
                 _nBUID+"~"+
                $('#ckhYetToEUP').is(':checked') + "~" +
                $('#ckhEUPDone').is(':checked')+"~"+nExportLCType;

         sessionStorage.setItem("ParamsSO", sParams);


         var oExportBillReport = {
             BUID: _nBUID,
             Params : sParams
         }
         GetsBills(oExportBillReport);

     });
     $('#txtSearchbyLDBCNo').keypress(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (code == 13)//Enter key-13
         {

             var nDateType = "";
             var nDateSearchCriteria =  0;
             var dStartDateCritaria = icsdateformat(new Date());
             var dEndDateCritaria =   icsdateformat(new Date());

             var nStateDateType =0;
             var nDateSearchState=  0;
             var dStartDateState=  icsdateformat(new Date());
             var dEndDateState=  icsdateformat(new Date());

             var nSearchAmountType = 0;
             var nFromAmount = 0;
             var nToAmount = 0;
             var nBankBranchID_Nego= 0;
             var sCurrenctStates="";
             if ($.trim($("#txtSearchbyLDBCNo").val()) == "")
             {
                 alert("Please give LDBC No.");
                 return false;
             }

             var sExportLCNo= "";
             var sExportBillNo= "";
             var sExportLDBCNo= $.trim($("#txtSearchbyLDBCNo").val());
             var sExportPINo= "";


             var sParams = _sContractorIds + "~" +
                     sCurrenctStates + "~" +
                     nBankBranchID_Nego + "~" +
                     _sBankBranch_IssueIds+"~"+
                     nSearchAmountType + "~" +
                     nFromAmount + "~" +
                     nToAmount + "~" +

                     nDateType+ "~" +
                     nDateSearchCriteria + "~" +
                     dStartDateCritaria + "~" +
                     dEndDateCritaria + "~" +

                     nStateDateType + "~" +
                     nDateSearchState+ "~" +
                     dStartDateState+ "~" +
                     dEndDateState+ "~" +
                        sExportLCNo+ "~" +
                           sExportBillNo+ "~" +
                              sExportLDBCNo+ "~" +
                                 sExportPINo+ "~" +
                        _nBUID+"~"+
                             false + "~" +
                                false+"~"+0;

             sessionStorage.setItem("ParamsSO", sParams);


             var oExportBillReport = {
                 BUID: _nBUID,
                 Params : sParams
             }
             GetsBills(oExportBillReport);
         }
         else if (code === 8) {
             DynamicRefreshList([], "tblExportBillReports");
         }
     });
     $('#txtSearchbyLCNo').keypress(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (code == 13)//Enter key-13
         {
             debugger;
             var nDateType = "";
             var nDateSearchCriteria =  0;
             var dStartDateCritaria = icsdateformat(new Date());
             var dEndDateCritaria =   icsdateformat(new Date());

             var nStateDateType =0;
             var nDateSearchState=  0;
             var dStartDateState=  icsdateformat(new Date());
             var dEndDateState=  icsdateformat(new Date());

             var nSearchAmountType = 0;
             var nFromAmount = 0;
             var nToAmount = 0;
             var nBankBranchID_Nego= 0;
             var sCurrenctStates="";
             if ($.trim($("#txtSearchbyLCNo").val()) == "")
             {
                 alert("Please give L/C No.");
                 return false;
             }

             var sExportLCNo= $.trim($("#txtSearchbyLCNo").val());
             var sExportBillNo= "";
             var sExportLDBCNo= "";
             var sExportPINo= "";


             var sParams = _sContractorIds + "~" +
                     sCurrenctStates + "~" +
                     nBankBranchID_Nego + "~" +
                     _sBankBranch_IssueIds+"~"+
                     nSearchAmountType + "~" +
                     nFromAmount + "~" +
                     nToAmount + "~" +

                     nDateType+ "~" +
                     nDateSearchCriteria + "~" +
                     dStartDateCritaria + "~" +
                     dEndDateCritaria + "~" +

                     nStateDateType + "~" +
                     nDateSearchState+ "~" +
                     dStartDateState+ "~" +
                     dEndDateState+ "~" +
                        sExportLCNo+ "~" +
                           sExportBillNo+ "~" +
                              sExportLDBCNo+ "~" +
                                 sExportPINo+ "~" +
                               _nBUID+"~"+
                                  false + "~" +
                                false+"~"+0;


             sessionStorage.setItem("ParamsSO", sParams);


             var oExportBillReport = {
                 BUID: _nBUID,
                 Params : sParams
             }
             GetsBills(oExportBillReport);
         }
         else if (code === 8) {
             DynamicRefreshList([], "tblExportBillReports");
         }
     });

     $('#txtSearchbyBillNo').keypress(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (code == 13)//Enter key-13
         {

             var nDateType = "";
             var nDateSearchCriteria =  0;
             var dStartDateCritaria = icsdateformat(new Date());
             var dEndDateCritaria =   icsdateformat(new Date());

             var nStateDateType =0;
             var nDateSearchState=  0;
             var dStartDateState=  icsdateformat(new Date());
             var dEndDateState=  icsdateformat(new Date());

             var nSearchAmountType = 0;
             var nFromAmount = 0;
             var nToAmount = 0;
             var nBankBranchID_Nego= 0;
             var sCurrenctStates="";
             if ($.trim($("#txtSearchbyBillNo").val()) == "")
             {
                 alert("Please give Invoice/Bill No.");
                 return false;
             }

             var sExportLCNo= "";
             var sExportBillNo=$.trim($("#txtSearchbyBillNo").val());
             var sExportLDBCNo= "";
             var sExportPINo= "";


             var sParams = _sContractorIds + "~" +
                     sCurrenctStates + "~" +
                     nBankBranchID_Nego + "~" +
                     _sBankBranch_IssueIds+"~"+
                     nSearchAmountType + "~" +
                     nFromAmount + "~" +
                     nToAmount + "~" +

                     nDateType+ "~" +
                     nDateSearchCriteria + "~" +
                     dStartDateCritaria + "~" +
                     dEndDateCritaria + "~" +

                     nStateDateType + "~" +
                     nDateSearchState+ "~" +
                     dStartDateState+ "~" +
                     dEndDateState+ "~" +
                        sExportLCNo+ "~" +
                           sExportBillNo+ "~" +
                              sExportLDBCNo+ "~" +
                                 sExportPINo+ "~" +
                        _nBUID+"~"+
                                false + "~" +
                                false+"~"+0;


             sessionStorage.setItem("ParamsSO", sParams);


             var oExportBillReport = {
                 BUID: _nBUID,
                 Params : sParams
             }
             GetsBills(oExportBillReport);
         }
         else if (code === 8) {
             DynamicRefreshList([], "tblExportBillReports");
         }
     });
     $('#txtSearchbyPINo').keypress(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (code == 13)//Enter key-13
         {

             var nDateType = "";
             var nDateSearchCriteria =  0;
             var dStartDateCritaria = icsdateformat(new Date());
             var dEndDateCritaria =   icsdateformat(new Date());

             var nStateDateType =0;
             var nDateSearchState=  0;
             var dStartDateState=  icsdateformat(new Date());
             var dEndDateState=  icsdateformat(new Date());

             var nSearchAmountType = 0;
             var nFromAmount = 0;
             var nToAmount = 0;
             var nBankBranchID_Nego= 0;
             var sCurrenctStates="";
             if ($.trim($("#txtSearchbyPINo").val()) == "")
             {
                 alert("Please give P/I No.");
                 return false;
             }

             var sExportLCNo= "";
             var sExportBillNo= "";
             var sExportLDBCNo="";
             var sExportPINo= $.trim($("#txtSearchbyPINo").val());


             var sParams = _sContractorIds + "~" +
                     sCurrenctStates + "~" +
                     nBankBranchID_Nego + "~" +
                     _sBankBranch_IssueIds+"~"+
                     nSearchAmountType + "~" +
                     nFromAmount + "~" +
                     nToAmount + "~" +

                     nDateType+ "~" +
                     nDateSearchCriteria + "~" +
                     dStartDateCritaria + "~" +
                     dEndDateCritaria + "~" +

                     nStateDateType + "~" +
                     nDateSearchState+ "~" +
                     dStartDateState+ "~" +
                     dEndDateState+ "~" +
                        sExportLCNo+ "~" +
                           sExportBillNo+ "~" +
                              sExportLDBCNo+ "~" +
                                 sExportPINo+ "~" +
                           _nBUID+"~"+
                                false + "~" +
                                false+"~"+0;

             sessionStorage.setItem("ParamsSO", sParams);


             var oExportBillReport = {
                 BUID: _nBUID,
                 Params : sParams
             }
             GetsBills(oExportBillReport);
         }
         else if (code === 8) {
             DynamicRefreshList([], "tblExportBillReports");
         }
     });



     function GetsBills(oExportBillReport)
     {
         $.ajax({
             type: "POST",
             dataType: "json",
             url: sessionStorage.getItem("BaseAddress") + "/ExportBillReport/AdvanceSearch",
             traditional: true,
             data: JSON.stringify(oExportBillReport),
             contentType: "application/json; charset=utf-8",
             success: function (data) {
                 var oExportBillReports = data;
                 debugger;
                 if (oExportBillReports != null)
                 {
                     if (oExportBillReports.length > 0)
                     {
                         DynamicRefreshList(oExportBillReports, "tblExportBillReports");
                         RefreshSummary();
                         $("#winAdvSearch").icsWindow("close");
                         ColumnHide();
                     }
                     else
                     {
                         alert("Sorry, No data found.");
                         DynamicRefreshList([], "tblExportBillReports");
                     }

                 } else {
                     alert("Sorry, No data found.");
                     DynamicRefreshList([], "tblExportBillReports");
                 }
                 $(".lblLoadingMessage").hide();
             }
         });
     }

     function CheckFromAndToDateValidation(OperationComboId, FromDateId, ToDateId) {
         $("#" + OperationComboId).parent().parent().parent().find("select").removeClass("errorFieldBorder");
         var nCboVal = $("#" + OperationComboId).val();
         if (parseInt(nCboVal) == 5 || parseInt(nCboVal) == 6) {
             var fromDate = $("#" + FromDateId).datebox("getValue");
             var toDate = $("#" + ToDateId).datebox("getValue");
             if (new Date(fromDate) > new Date(toDate)) {
                 $("#" + ToDateId).focus();
                 $("#" + OperationComboId).addClass("errorFieldBorder");
                 $(".lblLoadingMessage").hide();
                 return false;
             } else {
                 $("#" + OperationComboId).removeClass("errorFieldBorder");
                 return true;
             }
         } else {
             return true;
         }
     }

     function ResetAdvSearchWindow() {
         _sContractorIds = '';
         _sBankBranch_IssueIds = "";
         $("#winAdvSearch input").not("input[type='button']").val("");
         $("#winAdvSearch input").removeClass("fontColorOfPickItem");
         $("#winAdvSearch select").val(0);
         DateActions_Amount();
         DateActions_Bill();
         DateActions_DateOption();
         $("#txtBillDateStart,#txtBillDateEnd,#txtFromDateAdvSearch,#txtToDateAdvSearch").datebox({ disabled: true });
         $("#txtBillDateStart,#txtBillDateEnd,#txtFromDateAdvSearch,#txtToDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
         $("#cboBUType").val(_nBUID);
     }

     function DateActions_Amount() {
         var nDateOptionValTwo = $("#cobBillAmount").val();
         if (parseInt(nDateOptionValTwo) == 0) {
             $("#txtFromBillAmount").prop('disabled', true);
             $("#txtToBillAmount").prop('disabled', true);
             $("#txtFromBillAmount").val(0);
             $("#txtToBillAmount").val(0);
         }
         else if (parseInt(nDateOptionValTwo) >= 1 && parseInt(nDateOptionValTwo) <= 4) {
             $("#txtFromBillAmount").prop('disabled', false);
             $("#txtToBillAmount").prop('disabled', true);

         }
         else if (parseInt(nDateOptionValTwo) == 5 || parseInt(nDateOptionValTwo) == 6) {
             $("#txtFromBillAmount").prop('disabled', false);
             $("#txtToBillAmount").prop('disabled', false);
             $("#txtToBillAmount").val(0);

         }
     }
     function DateActions_Bill() {
         DynamicDateActions("cboBillDate", "txtBillDateStart", "txtBillDateEnd");
     }
     function DateActions_DateOption() {
         DynamicDateActions("cboDateOptionAdvSearch", "txtFromDateAdvSearch", "txtToDateAdvSearch");
     }

     $("#btnCloseAdvSearch").click(function () {
         $("#winAdvSearch").icsWindow("close");
     });
     $("#btnAdvSearch").click(function () {
         debugger;
         $(".lblLoadingMessage").hide();
         $("#progressbarParent").hide();
         $("#winAdvSearch").icsWindow("open", "Export Bill Advance Search");
         DynamicResetAdvSearchWindow("winAdvSearch");
         DynamicDateActions("cboBillDate", "txtBillDateStart", "txtBillDateEnd");
         DynamicDateActions("cboDateOptionAdvSearch", "txtFromDateAdvSearch", "txtToDateAdvSearch");
         ResetAdvSearchWindow();
     });
     /// end Adv Searching


     $("#btnPrint").click(function ()
     {
         debugger;
         var sParams=sessionStorage.getItem("ParamsSO");
         debugger;
         var sFieldName = "";
         var sCaption = "";
         for (var i = 0; i < oExportBillReportColumns.length; i++)
         {
             sFieldName += oExportBillReportColumns[i].FieldName + ",";
             sCaption += oExportBillReportColumns[i].Caption + ",";
         }
         sFieldName = sFieldName.substring(0, sFieldName.length - 1);
         sCaption = sCaption.substring(0, sCaption.length - 1);
         var sExportBillFieldST = sFieldName + "~" + sCaption;
         window.open(sessionStorage.getItem("BaseAddress") + '/ExportBillReport/Print_ExportBillReport?BUID='+_nBUID+'&sParam=' + sParams + '&sExportBillFieldST=' + sExportBillFieldST, "_blank")
     });

     $("#btnPrintXL").click(function () {
         var sParams=sessionStorage.getItem("ParamsSO");
         window.open(sessionStorage.getItem("BaseAddress") + '/ExportBillReport/Print_ExportBillReportXL?BUID='+_nBUID+'&sParam=' + sParams, "_blank")
     });

     function RefreshSummary()
     {
         var oRows = $('#tblExportBillReports').datagrid('getRows');
         if(oRows.length>0)
         {
             var nAmount=0;
             for(var i=0;i<oRows.length;i++)
             {
                 nAmount = parseFloat(nAmount)+parseFloat(oRows[i].Amount);
             }
             nAmount = parseFloat(nAmount).toFixed(2);
             debugger
             var oRow =
             {
                 ExportBillNoSt : 'Total',
                 AmountSt:"$"+nAmount
             }
             $('#tblExportBillReports').datagrid('appendRow',oRow);
         }
     }

</script>
    
