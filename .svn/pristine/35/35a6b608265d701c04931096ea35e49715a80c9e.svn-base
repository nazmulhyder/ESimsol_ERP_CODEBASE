@{
    ViewBag.Title = "Refresh_Product_Reconciliation_Import";
}

<html>


<body>
    @model ESimSol.BusinessObjects.ProductReconciliationReport

    <div style="font-family:Tahoma">
        <div style="padding-left:0px; padding-right: 0px;">
            <div id="tabReconTabs" class="easyui-tabs" style="width:100%; height:100%">
            
                <div title="Stock In Hand" id="divStockInHand" style="width:100%;height:520px">
                    <table id="tblPRRStockInHand" style="width:100%;height:100%" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }
                                    }
                    ">
                        <thead>
                            <tr>
                                <th field="LCNo" width="12%" align="left">L/C No</th>
                                <th field="InvoiceNo" width="10%" align="left">Invoice No</th>
                                <th field="ContractorName" width="15%" align="left">Supplier Name</th>
                                <th field="WUName" width="20%" align="left">Store Name</th>
                                <th field="LotNo" width="10%" align="left">Lot No</th>
                                <th field="Qty" width="10%" align="right" formatter="formatPrice">Qty</th>
                                <th field="Rate" width="10%" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="10%" align="right" formatter="formatPrice">Value</th>
                            </tr>
                        </thead>
                    </table>
                        <div id="toolbar" style="height:25px;color:#000000 !important;text-align:left;">
                            <a id="btnBack" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                            <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(8)">Refresh</a>
                            <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                        </div>

</div>
               
                <div title="ProYetTo(Without LC)" id="divProYetToWithOutLC" style="width:100%;height:530px">
                    <table id="tblProYetToWithOutLC" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarProYetToWithOutLC" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>

                                <th field="PINo" width="10%" align="left">PI No</th>
                                <th field="ProductCode" width="6%" align="left">ProductCode</th>
                                <th field="ProductName" width="10%" align="left">Product Name</th>
                                <th field="ContractorName" width="15%" align="left">Buyer Name</th>
                                <th field="BuyerName" width="10%" align="left">Buyering House</th>
                                <th field="InvoiceNo" width="10%" align="left">BPO No</th>
                                <th field="PIQty" width="7%" align="right" formatter="formatPrice">PI Qty</th>
                                <th field="OrderQty" width="7%" align="right" formatter="formatPrice">Order Qty</th>
                                <th field="Qty_Prod" width="7%" align="right" formatter="formatPrice">Production issue</th>
                                <th field="YetToProduction" width="7%" align="right" formatter="formatPrice">Pending Production</th>
                                <th field="Rate" width="7%" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="7%" align="right" formatter="formatPrice">Value</th>
                                <th field="DeliveryQty" width="7%" align="right" formatter="formatPrice">Delivery Qty</th>
                               

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarProYetToWithOutLC" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBack" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(10)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>

                <div title="ProYetTo(With LC)" id="divProYetToWithLC" style="width:100%;height:530px">
                    <table id="tblProYetToWithLC" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarProYetToWithLC" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>
                                <th field="PINo" width="10%" align="left">PI No</th>
                                <th field="ProductCode" width="6%" align="left">ProductCode</th>
                                <th field="ProductName" width="10%" align="left">Product Name</th>
                                <th field="ContractorName" width="15%" align="left">Buyer Name</th>
                                <th field="BuyerName" width="10%" align="left">Buyering House</th>
                                <th field="InvoiceNo" width="10%" align="left">BPO No</th>
                                <th field="PIQty" width="7%" align="right" formatter="formatPrice">PI Qty</th>
                                <th field="OrderQty" width="7%" align="right" formatter="formatPrice">Order Qty</th>
                                <th field="Qty_Prod" width="7%" align="right" formatter="formatPrice">Production issue</th>
                                <th field="YetToProduction" width="7%" align="right" formatter="formatPrice">Pending Production</th>
                                <th field="LCNo" width="200px" align="left">L/C No</th>
                                <th field="Rate" width="7%" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="7%" align="right" formatter="formatPrice">Value</th>
                                <th field="DeliveryQty" width="7%" align="right" formatter="formatPrice">Delivery Qty</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarProYetToWithLC" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackCnf" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(11)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>
                <div title="Pending Order(L/C Recd)" id="divLCRecedDOnotRecd" style="width:100%;height:530px">
                    <table id="tblLCRecedDOnotRecd" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarLCRecedDOnotRecd" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>

                                <th field="PINo" width="15%" align="left">PI No</th>
                                <th field="ProductCode" width="10%" align="left">ProductCode</th>
                                <th field="ProductName" width="15%" align="left">Product Name</th>
                                @*<th field="BuyerName" width="200px" align="left">Factory Name</th>*@
                                <th field="ContractorName" width="15%" align="left">Buyer Name</th>
                                <th field="PIQty" width="10%" align="right" formatter="formatPrice">PI Qty</th>
                                <th field="OrderQty" width="10%" align="right" formatter="formatPrice">Order Qty</th>
                                <th field="Qty" width="10%" align="right" formatter="formatPrice">Balance</th>
                                <th field="Rate" width="10%" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="10%" align="right" formatter="formatPrice">PI Value</th>
                                <th field="LCNo" width="10%" align="left">LC No</th>

                                @*<th field="ProductionFinishedQty" width="120px" align="right" formatter="formatPrice">Pro Finished</th>
                        <th field="DeliveryQty" width="120px" align="right" formatter="formatPrice">Delivery Qty</th>
                        <th field="YetToDelivery" width="120px" align="right" formatter="formatPrice">Yet To Delivery</th>
                        <th field="YetToProduction" width="120px" align="right" formatter="formatPrice">Yet To Production</th>
                        <th field="ReadyStockInhand" width="120px" align="right" formatter="formatPrice">Stock In Hand</th>
                        <th field="DyeingOrderQty" width="120px" align="right" formatter="formatPrice">Balance</th>*@


                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarLCRecedDOnotRecd" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackCnf" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(13)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>

                <div title="Pending Order(PI Issue)" id="divPIIssueLCnDONotRecd" style="width:100%;height:530px">
                    <table id="tblPIIssueLCnDONotRecd" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarPIIssueLCnDONotRecd" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>

                                <th field="PINo" width="12%" align="left">PI No </th>
                                <th field="ProductCode" width="10%" align="left">ProductCode</th>
                                <th field="ProductName" width="12%" align="left">Product Name</th>
                                @*<th field="BuyerName" width="200px" align="left">Factory Name</th>*@
                                <th field="ContractorName" width="15%" align="left">Buyer Name</th>
                                <th field="PIQty" width="10%" align="right" formatter="formatPrice">PI Qty</th>
                                <th field="OrderQty" width="10%" align="right" formatter="formatPrice">Pro Order Qty</th>
                                <th field="Qty" width="10%" align="right" formatter="formatPrice">Balance</th>
                                @*<th field="ProductionFinishedQty" width="10%" align="right" formatter="formatPrice">Pro Finished</th>*@
                                <th field="DeliveryQty" width="10%" align="right" formatter="formatPrice">Delivery Qty</th>
                                @*<th field="YetToDelivery" width="10%" align="right" formatter="formatPrice">Yet To Delivery</th>
                        <th field="YetToProduction" width="10%" align="right" formatter="formatPrice">Yet To Production</th>
                        <th field="ReadyStockInhand" width="10%" align="right" formatter="formatPrice">Stock In Hand</th>*@
                                <th field="Rate" width="10%" align="right" formatter="formatPrice">Rate</th>
                                @*<th field="Value" width="10%" align="right" formatter="formatPrice">PI Value</th>*@

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarPIIssueLCnDONotRecd" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackCnf" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(14)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>

                @*<div title="ProYetToSample" id="divProYetToSample" style="width:100%;height:530px">
                    <table id="tblProYetToSample" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarProYetToSample" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>

                                <th field="PINo" width="180px" align="left">Sample No</th>
                                <th field="LCNo" width="180px" align="left">Invoice No</th>
                                <th field="ProductCode" width="120px" align="left">ProductCode</th>
                                <th field="ProductName" width="200px" align="left">Product Name</th>
                                <th field="BuyerName" width="200px" align="left">Factory Name</th>
                                <th field="ContractorName" width="200px" align="left">Buyer Name</th>
                                <th field="PIQty" width="120px" align="right" formatter="formatPrice">PI Qty</th>
                                <th field="Rate" width="80px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="120px" align="right" formatter="formatPrice">PI Value</th>
                                <th field="OrderQty" width="120px" align="right" formatter="formatPrice">Order Qty</th>
                                <th field="ProductionFinishedQty" width="120px" align="right" formatter="formatPrice">Pro Finished</th>
                                <th field="DeliveryQty" width="120px" align="right" formatter="formatPrice">Delivery Qty</th>
                                <th field="YetToDelivery" width="120px" align="right" formatter="formatPrice">Yet To Delivery</th>
                                <th field="YetToProduction" width="120px" align="right" formatter="formatPrice">Yet To Production</th>
                                <th field="ReadyStockInhand" width="120px" align="right" formatter="formatPrice">Stock In Hand</th>
                                <th field="DyeingOrderQty" width="120px" align="right" formatter="formatPrice">Balance</th>


                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarProYetToSample" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(12)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblYetToSample"></label></a>
                    </div>

                </div>*@
                <div title="DocInCnF" id="divDocInCnF" style="width:100%;height:530px">
                    <table id="tblDocInCnF" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarDocInCnF">
                        <thead>
                            <tr>

                                <th field="LCNo" width="150px" align="left">LC No</th>
                                <th field="InvoiceNo" width="150px" align="left">Invoice No</th>
                                <th field="ContractorName" width="300px" align="left">Contractor Name</th>
                                <th field="Qty" width="130px" align="right" formatter="formatPrice">Invoice Qty</th>
                                <th field="Rate" width="120px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="130px" align="right" formatter="formatPrice">Value</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarDocInCnF" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackCnf" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(7)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>

                <div title="DocReceived" id="divDocReceived" style="width:100%;height:530px">
                    <table id="tblDocReceived" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarDocReceived">
                        <thead>
                            <tr>

                                <th field="LCNo" width="150px" align="left">LC No</th>
                                <th field="InvoiceNo" width="150px" align="left">Invoice No</th>
                                <th field="ContractorName" width="300px" align="left">Contractor Name</th>
                                <th field="Qty" width="130px" align="right" formatter="formatPrice">Invoice Qty</th>
                                <th field="Rate" width="120px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="130px" align="right" formatter="formatPrice">Value</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarDocReceived" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackDR" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(6)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>

                <div title="ShipmentDone" id="divShipmentDone" style="width:100%;height:530px">
                    <table id="tblShipmentDone" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarShipmentDone">
                        <thead>
                            <tr>
                                <th field="LCNo" width="150px" align="left">LC No</th>
                                <th field="InvoiceNo" width="150px" align="left">Invoice No</th>
                                <th field="ContractorName" width="300px" align="left">Contractor Name</th>
                                <th field="Qty" width="130px" align="right" formatter="formatPrice">Invoice Qty</th>
                                <th field="Rate" width="120px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="130px" align="right" formatter="formatPrice">Value</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarShipmentDone" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackDR" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(5)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>
                </div>
                <div title="InvoiceWithOutShipment" id="divInvWithOutShipment" style="width:100%;height:530px">
                    <table id="tblInvoiceWithOutShipment" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolInvoiceWithOutShipment">
                        <thead>
                            <tr>

                                <th field="LCNo" width="150px" align="left">LC No</th>
                                <th field="InvoiceNo" width="150px" align="left">Invoice No</th>
                                <th field="ContractorName" width="300px" align="left">Contractor Name</th>
                                <th field="Qty" width="130px" align="right" formatter="formatPrice">Invoice Qty</th>
                                <th field="Rate" width="120px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="130px" align="right" formatter="formatPrice">Value</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolInvoiceWithOutShipment" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackDR" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(4)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>
                
                <div title="LC Open(Shipment in Transit)" id="divLCOpen" style="width:100%;height:530px">
                    <table id="tblLCOpen" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolLCOpen">
                        <thead>
                            <tr>

                                <th field="LCNo" width="12%" align="left">LC No</th>
                                <th field="PINo" width="12%" align="left">P/I No</th>
                                <th field="ContractorName" width="15%" align="left">ContractorName</th>
                                <th field="ProductName" width="15%" align="left">Product Name</th>
                                <th field="PIQty" width="10%" align="right" formatter="formatPrice">LC Qty(LBS)</th>
                                <th field="POQty" width="10%" align="right" formatter="formatPrice"> Invoice Qty (LBS)</th>
                                <th field="Qty" width="10%" align="right" formatter="formatPrice">Pending Shipment(Qty)</th>

                            </tr>
                        </thead>
                    </table>
                    <div id="toolLCOpen" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackDR" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(3)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPRRStockInHand">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>
                       
                <div title="P/I Received" id="divPOReceived" style="width:100%;height:530px">
                    <table id="tblPOReceived" class="easyui-datagrid" style="width:100%;height:525px" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarPOReceived" data-options="rowStyler: function(index,row){
                                        if (row.ContractorName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }

                                    }
                    ">

                        <thead>
                            <tr>

                                <th field="PINo" width="180" align="left">PO No</th>
                                <th field="ContractorName" width="200" align="left">ContractorName</th>
                                <th field="Qty" width="130px" align="right" formatter="formatPrice">Qty</th>
                                <th field="Rate" width="120px" align="right" formatter="formatPrice">Rate</th>
                                <th field="Value" width="130px" align="right" formatter="formatPrice">Value</th>
                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarPOReceived" style="height:25px;color:#000000 !important;text-align:left;">
                        <a id="btnBackDR" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" onclick="Back()" plain="false">Back</a>
                        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true" onclick="Refresh(1)">Refresh</a>
                        <a style="color:#000000 !important;font-weight:bold;font-size:12px;"><label id="lblPOReceived">Product Name:</label><span class="lblProductName"></span></a>
                    </div>

                </div>
                                      
           
            </div>

        </div>
    </div>
</body>
</html>
<script type="text/javascript">
    var _sBaseAddress = "";
    
    var _oProductReconciliation=[];
    var _oProductReconciliations=[];
    var _dStartDate=new Date();
    var _dEndDate=new Date();
    var _nBUID=0;
    var _sBackLink="";
    var _nDateType=0;
    $(document).ready(function () {
    debugger;
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oProductReconciliation=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        $(".lblProductName").html(" "+_oProductReconciliation.ProductName);
       _sBackLink=sessionStorage.getItem("BackLink");
       
    });

    function Refresh(nReportType )
    {  
      
        var oPR =sessionStorage.getItem("oPR");
        oPR =  jQuery.parseJSON(oPR);

        var oPRR= {
            BUID:_nBUID,
            ProductID: _oProductReconciliation.ProductID,
            StartDate:oPR.StartDate,
            EndDate:oPR.EndDate,
            ReportType:nReportType 
        }

        $.ajax({
            type: "POST",
            dataType: "json",            
            url : _sBaseAddress+  "/ProductReconciliationReport/GetsPRDetail",
            traditional: true,
            data:  JSON.stringify(oPRR),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
           
                var oPRRs = data;
                if (oPRRs.length>0)
                {                    
                    if(nReportType==8)
                    {
                        RefreshList_StockInHand(oPRRs);
                    }
                    else if(nReportType==7)
                    {
                        RefreshList_DocInCnF(oPRRs);
                    }
                    else if(nReportType==6)
                    {
                        RefreshList_DocReceived(oPRRs);
                    }
                    else if(nReportType==5)
                    {
                        RefreshList_ShipmentDone(oPRRs);
                    }
                    else if(nReportType==4)
                    {
                        RefreshList_InvoiceWithoutShimment(oPRRs);
                    }
                    else if(nReportType==3)
                    {
                        RefreshList_LCOpen(oPRRs);
                    }
                    //else if(nReportType==2)
                    //{
                    //    RefreshList_ReqForLC(oProductReconciliationReports);
                    //}
                    else if(nReportType==1)
                    {
                        RefreshList_POReceived(oPRRs);
                    }

                    else if(nReportType==10)
                    {
                        RefreshList_ProYetToWithOutLC(oPRRs);
                    }
                    else if(nReportType==11)
                    {
                        RefreshList_ProYetToWithLC(oPRRs);
                    }

                    else if(nReportType==12)
                    {
                        RefreshList_ProYetToSample(oPRRs);
                    }
                    else if(nReportType==13)
                    {
                        RefreshList_LCRecedDOnotRecd(oPRRs);
                    }
                    else if(nReportType==14)
                    {
                        RefreshList_PIIssueLCnDONotRecd(oPRRs);
                    }
                   
                }
                else 
                {
                    alert("Data not found");
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    }    
    /// --8
    function RefreshList_StockInHand(oProductReconciliationReports)
    {    
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblPRRStockInHand').datagrid('loadData', data);
        RefreshSummary_StockInHand();
                  
    }
    function RefreshSummary_StockInHand()
    {
        var oRows = $('#tblPRRStockInHand').datagrid('getRows');
        if(oRows.length>0)
        {
            var nStockInHand = 0;
            for(var i=0;i<oRows.length;i++)
            {
                nStockInHand = parseFloat(nStockInHand)+parseFloat(oRows[i].Qty);
            }
            var oRow =
            {
                ContractorName : 'Total',
                Qty:parseFloat(nStockInHand).toFixed(2)
            }
            $('#tblPRRStockInHand').datagrid('appendRow',oRow); 
        } 

    }
    /////-7
    function RefreshList_DocInCnF(oProductReconciliationReports)
    {    
        //var oProductReconciliation=
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblDocInCnF').datagrid('loadData', data);
        document.getElementById('lblDocInCnF').innerHTML=_oProductReconciliation.ColumnName;
                  
    }
    /////-6
    function RefreshList_DocReceived(oProductReconciliationReports)
    {    
        //var oProductReconciliation=
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblDocReceived').datagrid('loadData', data);
      //  document.getElementById('lblDocInCnF').innerHTML=_oProductReconciliation.ColumnName;
                  
    }
    ////--5
    function RefreshList_ShipmentDone(oProductReconciliationReports)
    {    
        //var oProductReconciliation=
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblShipmentDone').datagrid('loadData', data);
        document.getElementById('lblShipmentDone').innerHTML=_oProductReconciliation.ColumnName;
                  
    }
    ///------------4
    function RefreshList_InvoiceWithoutShimment(oProductReconciliationReports)
    {    
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblInvoiceWithOutShipment').datagrid('loadData', data);
    }

    ////-3
    function RefreshList_LCOpen(oProductReconciliationReports)
    {    
       
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblLCOpen').datagrid('loadData', data);
    }
    /////-2
    //function RefreshList_ReqForLC(oProductReconciliationReports)
    //{    
       
    //    data = oProductReconciliationReports;
    //    data = { "total": "" + data.length + "", "rows": data };
    //    $('#tblReqForLC').datagrid('loadData', data);
    //}
    ////----1
    function RefreshList_POReceived(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblPOReceived').datagrid('loadData', data);
        //document.getElementById('lblPOReceived').innerHTML=_oProductReconciliation.ColumnName;
    }


    ////Porodction YetTo Without LC---10
    function RefreshList_ProYetToWithOutLC(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblProYetToWithOutLC').datagrid('loadData', data);
        RefreshSummary_ProYetToWithOutLC();
    }
    function RefreshSummary_ProYetToWithOutLC()
    {
        var oRows = $('#tblProYetToWithOutLC').datagrid('getRows');
        if(oRows.length>0)
        {
            var nQty_Prod = 0,nPIQty=0,nOrderQty=0,nQty=0,nDeliveryQty=0,nYetToProduction=0;
            for(var i=0;i<oRows.length;i++)
            {
                nQty = parseFloat(nQty)+parseFloat(oRows[i].Qty);
                nPIQty = parseFloat(nPIQty)+parseFloat(oRows[i].PIQty);
                nOrderQty = parseFloat(nOrderQty)+parseFloat(oRows[i].OrderQty);
                nDeliveryQty = parseFloat(nDeliveryQty)+parseFloat(oRows[i].DeliveryQty);
                nYetToProduction = parseFloat(nYetToProduction)+parseFloat(oRows[i].YetToProduction);
                nQty_Prod = parseFloat(nQty_Prod)+parseFloat(oRows[i].Qty_Prod);
            }
            var oRow =
            {
                ContractorName : 'Total',
                Qty:parseFloat(nQty).toFixed(2),
                PIQty:parseFloat(nPIQty).toFixed(2),
                OrderQty:parseFloat(nOrderQty).toFixed(2),
                DeliveryQty:parseFloat(nDeliveryQty).toFixed(2),
                Qty_Prod:parseFloat(nQty_Prod).toFixed(2),
                YetToProduction:parseFloat(nYetToProduction).toFixed(2)

            }
            $('#tblProYetToWithOutLC').datagrid('appendRow',oRow); 
        } 
    }

    ////Porodction YetTo With LC LC---11
    function RefreshList_ProYetToWithLC(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblProYetToWithLC').datagrid('loadData', data);
        RefreshSummary_ProYetToWithLC();
    }
    function RefreshSummary_ProYetToWithLC()
    {
        var oRows = $('#tblProYetToWithLC').datagrid('getRows');
        if(oRows.length>0)
        {
            var nQty_Prod = 0,nPIQty=0,nOrderQty=0,nQty=0,nDeliveryQty=0,nYetToProduction=0;
            for(var i=0;i<oRows.length;i++)
            {
                nQty = parseFloat(nQty)+parseFloat(oRows[i].Qty);
                nPIQty = parseFloat(nPIQty)+parseFloat(oRows[i].PIQty);
                nOrderQty = parseFloat(nOrderQty)+parseFloat(oRows[i].OrderQty);
                nDeliveryQty = parseFloat(nDeliveryQty)+parseFloat(oRows[i].DeliveryQty);
                nYetToProduction = parseFloat(nYetToProduction)+parseFloat(oRows[i].YetToProduction);
                nQty_Prod = parseFloat(nQty_Prod)+parseFloat(oRows[i].Qty_Prod);
            }
            var oRow =
            {
                ContractorName : 'Total',
                Qty:parseFloat(nQty).toFixed(2),
                PIQty:parseFloat(nPIQty).toFixed(2),
                OrderQty:parseFloat(nOrderQty).toFixed(2),
                DeliveryQty:parseFloat(nDeliveryQty).toFixed(2),
                Qty_Prod:parseFloat(nQty_Prod).toFixed(2),
                YetToProduction:parseFloat(nYetToProduction).toFixed(2)

            }
            $('#tblProYetToWithLC').datagrid('appendRow',oRow); 
        } 
    }
    ////Porodction YetTo With LC LC---12
    function RefreshList_ProYetToSample(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblProYetToSample').datagrid('loadData', data);
       
    }
  

    ////Porodction YetTo With LC LC---13
    function RefreshList_LCRecedDOnotRecd(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblLCRecedDOnotRecd').datagrid('loadData', data);
        RefreshSummary_LCRecedDOnotRecd();
    }
    function RefreshSummary_LCRecedDOnotRecd()
    {
        var oRows = $('#tblLCRecedDOnotRecd').datagrid('getRows');
        if(oRows.length>0)
        {
            var nStockInHand = 0,nPIQty=0,nOrderQty=0,nQty=0,nDeliveryQty=0;
            for(var i=0;i<oRows.length;i++)
            {
                nQty = parseFloat(nQty)+parseFloat(oRows[i].Qty);
                nPIQty = parseFloat(nPIQty)+parseFloat(oRows[i].PIQty);
                nOrderQty = parseFloat(nOrderQty)+parseFloat(oRows[i].OrderQty);
                nDeliveryQty = parseFloat(nDeliveryQty)+parseFloat(oRows[i].DeliveryQty);
                nDeliveryQty = parseFloat(nDeliveryQty)+parseFloat(oRows[i].DeliveryQty);
            }
            var oRow =
            {
                ContractorName : 'Total',
                Qty:parseFloat(nQty).toFixed(2),
                PIQty:parseFloat(nPIQty).toFixed(2),
                OrderQty:parseFloat(nOrderQty).toFixed(2),
                DeliveryQty:parseFloat(nDeliveryQty).toFixed(2),
            }
            $('#tblLCRecedDOnotRecd').datagrid('appendRow',oRow); 
        } 
    }

    ////Porodction YetTo With LC LC---12
    function RefreshList_PIIssueLCnDONotRecd(oProductReconciliationReports)
    {    
        data = oProductReconciliationReports;
        data = { "total": "" + data.length + "", "rows": data };
        $('#tblPIIssueLCnDONotRecd').datagrid('loadData', data);
        RefreshSummary_PIIssueLCnDONotRecd();
    }
    function RefreshSummary_PIIssueLCnDONotRecd()
    {
        var oRows = $('#tblPIIssueLCnDONotRecd').datagrid('getRows');
        if(oRows.length>0)
        {
            var nQty_Prod = 0,nPIQty=0,nOrderQty=0,nQty=0,nDeliveryQty=0,nYetToProduction=0;
            for(var i=0;i<oRows.length;i++)
            {
                nQty = parseFloat(nQty)+parseFloat(oRows[i].Qty);
                nPIQty = parseFloat(nPIQty)+parseFloat(oRows[i].PIQty);
                nOrderQty = parseFloat(nOrderQty)+parseFloat(oRows[i].OrderQty);
                nDeliveryQty = parseFloat(nDeliveryQty)+parseFloat(oRows[i].DeliveryQty);
                nYetToProduction = parseFloat(nYetToProduction)+parseFloat(oRows[i].YetToProduction);
                nQty_Prod = parseFloat(nQty_Prod)+parseFloat(oRows[i].Qty_Prod);
            }
            var oRow =
            {
                ContractorName : 'Total',
                Qty:parseFloat(nQty).toFixed(2),
                PIQty:parseFloat(nPIQty).toFixed(2),
                OrderQty:parseFloat(nOrderQty).toFixed(2),
                DeliveryQty:parseFloat(nDeliveryQty).toFixed(2),
                Qty_Prod:parseFloat(nQty_Prod).toFixed(2),
                YetToProduction:parseFloat(nYetToProduction).toFixed(2)

            }
            $('#tblPIIssueLCnDONotRecd').datagrid('appendRow',oRow); 
        } 
    }

    function Back()
    {
        window.location.href = _sBackLink;
    }



    </script>
