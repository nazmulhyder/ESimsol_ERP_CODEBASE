@model IEnumerable<ESimSol.BusinessObjects.EmployeeSalary>
    @{
        ViewBag.Title = "Employee Salary";
    }
    <div style="margin-left:0px; height:500px" class="menuMainCollectionTable">
        <table id="tblEmployeeSalary" title="Employee Salary  List" class="easyui-datagrid" style="width:100%;height:510px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" selectoncheck="false" checkonselect="false" toolbar="#toolbar">
            <thead>
                <tr>
                    <th data-options="field:'Selected',checkbox:true"></th>
                    <th field="EmployeeCode" width="20%" align="left">Code</th>
                    <th field="EmployeeName" width="20%" align="left">Name</th>
                    <th field="GrossAmount" width="15%" align="right" formatter="formatPrice">Gross Salary</th>
                    <th field="DeriveNetAmount" width="15%" align="right" formatter="formatPrice">Net Salary</th>
                    <th field="SalaryDateInString" width="15%" align="left">Process Date</th>
                    <th field="SalaryForInString" width="25%" align="left">Salary For</th>
                </tr>
            </thead>
        </table>

        <div>
            <input id="chkRange_Colection" type="checkbox" />Range
            <label id="lblRange1_Colection">
                <input id="txtFrom_Colection" type="text" style="width:40px" />&nbsp; To &nbsp;
            </label>
            <label id="lblRange2_Colection">
                <input id="txtTo_Colection" type="text" style="width:40px" />
            </label>
            &nbsp; &nbsp;
            <label id="lblcount_Colection"></label>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="Next_Collection()">Next</a>
        </div>

        <div id="toolbar" style="height:auto;">
            <input id="txtBusinessUnit_Collection" type="text" style="width:14%;" placeholder="Pick Business Unit" />
            <a id="btnBusinessUnitPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetBusinessUnitPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtLocation_Colection" style="width:110px;" placeholder="Pick Location" type="text" />
            <a id="btnLocationPicker_Colection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetLocationPicker_Colection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtDepartment_Collection" style="width:100px;" type="text" placeholder="Pick Department" />
            <a id="btnDepartmentPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetDepartmentPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtDesignation_Collection" type="text" style="width:100px;" placeholder="Pick Designation" />
            <a id="btnDesignationPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetDesignationPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtSalaryScheme" type="text" style="width:150px" placeholder="Type salary scheme name & enter" />
            <a id="btnSalaryScheme" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnCSalaryScheme" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>


            &nbsp; Group:
            <input id="txtEmployeeGroup" style="width:130px;" type="text" placeholder="Enter Group" />            
            <a id="btnEmployeeGroupPicker" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnEmployeeGroupPickerReset" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            &nbsp; Block:
            <input id="txtEmployeeBlock" style="width:130px;" type="text" placeholder="Enter Block" />
            <a id="btnEmployeeBlockPicker" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick" />
            <a id="btnEmployeeBlockPickerReset" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtEmployee_Collection" style="width:110px;" type="text" placeholder="Type Code & Enter" />
            <a id="btnEmployee" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnCEmployee" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <select id="cboPaymentType" style="width:100px">
                <option value="0">--Payment Type--</option>
                <option value="1">Bank</option>
                <option value="2">Cash</option>
            </select>

            <label id="lblIsMultipleMonth" for="chkIsMultipleMonth">Multiple:</label>
            <input id="chkIsMultipleMonth" type="checkbox" onclick="MunlipleMonthCheckFunction()" />
            <div id="singleMonthDiv">
                <select id="cboSalaryMonth_Collection" class="selection-search" style="width: 9%;"></select>
                <select id="cboYear" style="width:70px;"></select>
            </div>
            <div id="multiMonthDiv">
                <input id="dtMultiStartDate" type="text" style="width: 100px;display:none" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" />
                to
                <input id="dtMultiEndDate" type="text" style="width: 100px;display:none" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" />
            </div>

            <br />
            <input id="chkNewJoin" type="checkbox" />  <label id="lblNewJoin" for="chkNewJoin">New Join</label>
            <input id="chkGroupByDept" type="checkbox" /> <label id="lblGroupByDept" for="chkGroupByDept">Group By Dept</label>
            <input id="chkGroupBySerial" type="checkbox" /> <label id="lblGroupBySerial" for="chkGroupBySerial">By Serial</label>
            <input id="chkRound" type="checkbox" /> <label id="lblRound" for="chkRound">Round</label>
            <input id="chkBank" type="checkbox" /> <label id="lblBank" for="chkBank">Bank</label>
            <input id="chkCash" type="checkbox" /><label id="lblNewJoin" for="chkCash">Cash</label>
            <br />


            <a id="btnSalaryProcess" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-ok">Process</a>

            S. Range :
            <input id="txtStartSalaryRange" type="text" style="width:8%" class="number" /> To
            <input id="txtEndeSalaryRange" type="text" style="width:8%" class="number" />
            <a id="btnSearchByDepartmentAndDateRange" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-search" onclick="SearchByDepartmentAndDateRangeWithPasignation()"></a>

            <input id="txtPrintCount" style="width:40px;" class="easyui-numberspinner" value="4" style="width:40px;" data-options="min:2,max:8,editable:false,increment:2">
            <select id="CboPrintItems" style="width:15%;"></select>
            <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" onclick="Print()"></a>
            <a id="btnExcelSalarySheet" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelOTStatement" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySummery" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySheetF1_4" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelBankSheet" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelPaySlip_Comp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelOTSheetF2" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySheet_F6_Bangla" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true"></a>
            <a id="btnSalarySheet_F6_BanglaExcel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelPaySlip_CompF6" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySheet_F5" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySummery_F5" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true" onclick="ExcelExportSalarySummary_F5()" ></a>
            <a id="btnExcelSalarySheet_F6" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySummery_F2" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelSalarySummery_F3" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnExcelBUWiseSalary" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true"></a>
            <a id="btnRemoveFromGrid" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove List</a>
            <br />            
        </div>

        <div id="winGroupPicker" class="easyui-window winstyle" title="Employee Group Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <table id="tblEmpGroup" class="easyui-datagrid" style="width:100%;height:305px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" selectoncheck="false" checkonselect="false">
                    <thead>
                        <tr>
                            <th data-options="field:'Selected',checkbox:true"></th>
                            <th field="Name" width="50%" align="left">Name</th>
                        </tr>
                    </thead>
                </table>

                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:left">
                                <input type="checkbox" id="chkIsMatchExact" /> Match Exact
                            </td>

                            <td style="width:50px">
                                <a id="btnGroupPickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnGroupPickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div id="winLocationPicker" class="easyui-window winstyle" title="Location Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="locationtree" data-options="checkbox:true" singleselect="false"></ul>
                </div>

                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnLocationPickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnLocationPickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div id="winEmployeePicker" class="easyui-window winstyle" title="Employee Picker" style="width:960px;" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="width: 100%; font-family: Tahoma;">
                <div style="width: 47%; float: left;">
                    <table class="tbl-AdvSearch">
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Employee Name :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEmployeeName" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Code :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEmpCodeForSearch" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Present Address :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtPresentAddress" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Permanent Address :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtPermanentAddress" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Authentication No :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEnrollNo" class="txtReset" type="text" style="width:190px;" />
                                <input id="chkNotassignedyet" type="checkbox" class="chkReset" /> Not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Attendance Scheme :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtAttendanceScheme" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnAttScheme" class="pick-btn" type="button" value="P" />
                                <input id="btnResetAttScheme" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                BU :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboBU" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Location :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtLocation" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnLocationPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetLocationPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Dept./Section :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtDepartment" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnDepartmentPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetDepartmentPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Designation :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtDesignation" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnDesignationPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetDesignationPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Employee Type :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeType" style="width:130px; float:left;" class="selection-search cboReset"></select>
                                &nbsp; Group:
                                <input id="txtEmployeeGroupAdv" style="width:90px;" type="text" />
                                <input id="btnEmployeeGroupPickerAdv" class="pick-btn" type="button" value="P" style="width:20px;" />
                                <input id="btnEmployeeGroupResetAdv" class="pick-btn" type="button" value="R" style="width:20px;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Category:
                            </td>
                            <td class="td-AdvSearch-Level">
                                <div>
                                    <select id="cboCategory" style="width:130px; float:left;"></select>
                                    &nbsp; Gender :
                                    <select id="cboGender" style="width:80px; margin-right:10px;" class="cboReset">
                                        <option value="0">None</option>
                                        <option value="1">Male</option>
                                        <option value="2">Female</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Current Shift :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboShift_EmpSearch" style="width:130px; float:left;" class="selection-search cboReset"></select>

                                &nbsp; Block:
                                <input id="txtEmployeeBlockAdv" style="width:90px;" type="text" />
                                <input id="btnEmployeeBlockPickerAdv" class="pick-btn" type="button" value="P" style="width:20px;" />
                                <input id="btnEmployeeBlockResetAdv" class="pick-btn" type="button" value="R" style="width:20px;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Card Status :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeCardStatus" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Working Status :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeWorkigStatus" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Date Of Birth :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboDateType" style="width: 75px" class="cboReset">
                                    <option value='0'>None</option>
                                    <option value='1'>Equal</option>
                                    <option value='2'>Between</option>
                                </select>
                                <span></span>
                                <select id="cboDayFrom" style="width: 50px" class="cboReset"></select>
                                <select id="cboMonthFrom" style="width: 53px" class="cboReset"></select>
                                <span id="regionDateTo">
                                    <span>To</span>
                                    <select id="cboDayTo" style="width: 50px" class="cboReset"> </select>
                                    <select id="cboMonthTo" style="width: 53px" class="cboReset"> </select>
                                </span>

                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Joining Date :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkJoiningDate" class="chkReset" />
                                <input id="dtDateFrom" type="text" style="width: 132px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />&nbsp; To &nbsp;
                                <input id="dtDateTo" type="text" style="width: 132px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkActive" class="chkReset" /> Active
                                <input type="checkbox" id="chkInActive" class="chkReset" />InActive
                                <input type="checkbox" id="chkUser" class="chkReset" /> User
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkOfficialNotAssign" class="chkReset" /> official Information is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkOfficialAssign" class="chkReset" /> official Information assigned employee
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkCardNotAssigned" class="chkReset" /> Card is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkSalarystructureNotAssigned" class="chkReset" /> Salary structure is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="button" value="Reset" id="btnEmployeePickerReset" style="width: 70px" onclick="EmployeePickerReset()" />
                                <input type="button" value="Search" id="btnEmpPickerSearch" style="width: 70px" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div style="width: 52%; float: right;">
                    <table id="tblEmployeesForPicker" title="Employee List" class="easyui-datagrid" style="width: 480px; height: 480px;" fitcolumns="true" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                        <thead>
                            <tr>
                                <th data-options="field:'Selected',checkbox:true"></th>
                                <th field="Code" width="200"> Code</th>
                                <th field="Name" width="150">Employee Name</th>
                                <th field="DepartmentName" width="100">Department</th>
                                <th field="DesignationName" width="100">Designation</th>
                            </tr>
                        </thead>
                    </table>
                    <table style="width: 485px; font-size: 12px; font-weight: bold;">
                        <tr>
                            <td style="text-align: left">
                                <input id="chkRange" type="checkbox" />Range
                                <label id="lblRange1">
                                    <input id="txtFrom" type="text" style="width:40px" />&nbsp; To &nbsp;
                                </label>
                                <label id="lblRange2">
                                    <input id="txtTo" type="text" style="width:40px" />
                                </label>
                                <label id="lblcount"></label>
                            </td>
                            <td style="text-align: right">
                                <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="Next()">Next</a>
                                <a id="btnEmployeePickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                                <a id="btnEmployeePickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left"></td>
                            <td style="text-align: right"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <div id="winDepartmentPicker_Collection" class="easyui-window winstyle" title="Department Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="departmenttree_Collection" data-options="checkbox:true" singleselect="false"></ul>
                </div>
                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnDepartmentPickerOk_Collection" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnDepartmentPickerClose_Collection" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div id="winDepartmentPicker" class="easyui-window winstyle" title="Department Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="departmenttree" data-options="checkbox:false" singleselect="true"></ul>
                </div>

                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnDepartmentPickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnDepartmentPickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

    </div>

    <div id="winPrintBanKSheet" class="easyui-window winstyle" title="Select Column" style="width:700px;" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="font-family:Tahoma">
            <div style="float:left">
                <fieldset style="width:250px">
                    <legend style="font-weight: bold">Select Column</legend>
                    @* table1 start*@
                    <table id="tblPrintColumns" class="easyui-datagrid" style="width: 230px; height: 310px; font-size: 11px;font-weight: normal;" fitcolumns="false" rownumbers="false" pagination="false" singleselect="false" autorowheight="true">
                        <thead>
                            <tr>
                                <th data-options="field:'Selected',checkbox:true"></th>
                                <th field="ColumnName" width="180" align="left">
                                    Column Name
                                </th>
                            </tr>
                        </thead>
                    </table>
                </fieldset>
            </div>
            <div style="float:right">
                <fieldset style="width:420px; float:right; height:320px">
                    <legend style="font-weight: bold">Letter Information</legend>
                    <table border="0" cellpadding="2" width="400" style="margin-top:40px">
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold">Date :</label></td>
                            <td width="65%">
                                <input id="dLetterInformationDate" type="text" style="width:120px;" class="easyui-datebox"
                                       data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold">Account No :</label></td>
                            <td width="65%">
                                <input type="text" id="txtBankAccountNo" style="width:75%" />
                                <button id="btnBankAccountCancel">C</button>
                                <button id="btnBancAccountPick">P</button>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold">Bank Name :</label></td>
                            <td width="65%">
                                <input type="text" id="txtBankName" style="width:100%" disabled="disabled"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold">Branch Name :</label></td>
                            <td width="65%">
                                <input type="text" id="txtBankBranchName" style="width:100%" disabled="disabled" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold" hidden="hidden">Address :</label></td>
                            <td width="65%">
                                <input type="text" id="txtBankBranchAddress" style="width:100%" disabled="disabled" hidden="hidden"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight:bold">Paper Type :</label></td>
                            <td width="65%">
                                <select style="width:100%" id="cboPaperType">
                                    <option value="PrintWithBlankPaper">Print With Blank Paper</option>
                                    <option value="PrintWithPad">Print With Pad</option>
                                </select>                                
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right"><label style="font-weight: bold">Header(Inch):</label></td>
                            <td width="65%">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:30%">
                                            <input type="text" id="txtHeaderHeightInch" style="width:100%"/>
                                        </td>
                                        <td style="width:40%; text-align:right"><label style="font-weight:bold">Footer(Inch) :</label></td>
                                        <td style="width:30%">
                                            <input type="text" id="txtFooterHeightInch" style="width:100%" />
                                        </td>
                                    </tr>
                                </table>
                                
                            </td>
                        </tr>
                        <tr>
                            <td width="30%"></td>
                            <td width="65%">
                                <label style="font-weight:bold"> <input type="checkbox" id="chkSearchByBank" /> Search By Bank </label>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <div style="float:left">
                <fieldset style="width:680px">
                    <legend style="font-weight: bold">Action</legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold;">
                        <tr>
                            <td style="width: 630px; text-align: right;">
                                <a id="btnPrintSelectedCols" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="printSelectedColumns()">Ok</a> 
                                <a id="btnCancel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Cancel</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
         </div>
    </div>

    <style type="text/css">
        .lblStar {
            color: #ff0000;
            font-weight: bold;
        }

        .tbl-AdvSearch {
            width: 100%;
            font-size: 11px;
            font-weight: bold;
            text-align: left;
            margin-left: 3px;
        }

        .td-AdvSearch-Level {
            text-align: right;
        }

        .td-AdvSearch-Input {
            text-align: left;
        }

        .txtfield-search {
            width: 312px;
            text-align: left;
            font-size: 11px;
        }

        .txtfield-picker {
            width: 265px;
            text-align: left;
            font-size: 11px;
        }

        .selection-search {
            width: 310px;
            text-align: left;
            font-size: 11px;
        }

        .pick-btn {
            width: 20px;
            text-align: center;
            font-size: 11px;
        }
    </style>
    <script type="text/javascript">
        var _oEmployeeSalarys=null;
        var _sBaseAddress="";
        var _oEmployees=[];
        var _nLastEmployeeSalaryID = 0;
        var _oEmployeeSalarys = [];
        var _oEmployee = null;
        var _sSalarySchemeIDs = "";
        var _oMonths=[];
        var _nTempBankAccountID = 0;
        var _sAttendanceSchemeID ="";
        var _sBusinessUnitIds = "";
        var _sLocationID = "";
        var _sDepartmentIds = "";
        var _sDepartmentNames = "";
        var _sDesignationIds = "";
        var _sDesignationNames = "";
        var _sEmployeeIDs="";

        var _nLastEmployeeID = 0;
        var _bNext = false;
        var _nLoadRecords = 0;
        var _nRowLength = 0;

        var _oEmployeeTypes=[];
        var _oShifts=[];
        var _oEmployeeCSs=[];
        var _oEmployeeWSs=[];
        var _oBusinessUnits=[];
        var _oAURolesMapping=[];
        var _oMonths=[];
        var _sGroupNames="";
        var _sGroupIDs="";
        var _sBlockNames="";
        var _sBlockIDs="";

        var _sBlockNamesAdv="";
        var _sBlockIDsAdv="";
        var _sGroupNamesAdv="";
        var _sGroupIDsAdv="";

        var _IsXL = false;

        $(document).ready(function ()
        {
            _oEmployeeSalarys =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            _oMonths= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.Months));
            _oAURolesMapping =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
            _oEmployeeTypes= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeTypes));
            _oShifts= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.Shifts));
            _oEmployeeCSs= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeCSs));
            _oEmployeeWSs= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeWSs));
            _oBusinessUnits=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
            var oEmployeeCategorys=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeCategorys));
            //$('#dtDateFrom').datebox('setValue', icsdateformat(new Date()));
            //$('#dtDateTo').datebox('setValue', icsdateformat(new Date()));
            document.getElementById("singleMonthDiv").style = "display:initial";
            document.getElementById("multiMonthDiv").style = "display:none";
            $('#btnExcelSalarySheet,#btnExcelOTStatement,#btnExcelSalarySummery,#btnExcelSalarySheetF1_4,#btnExcelBankSheet,#btnExcelPaySlip_Comp,#btnExcelSalarySheet_F5,#btnExcelSalarySummery_F5,#btnExcelSalarySummery_F2, #btnExcelSalarySummery_F3,#btnExcelPaySlip_CompF6, #btnExcelBUWiseSalary, #btnExcelOTSheetF2, #btnExcelSalarySheet_F6_Bangla, #btnSalarySheet_F6_BanglaExcel').hide();

            $('#chkSearchByBank').val("PrintWithBlankPaper");
            $('#txtHeaderHeightInch').icsCurrencyBox(null, null, 2);
            $('#txtFooterHeightInch').icsCurrencyBox(null, null, 2);
            
            $('#txtFrom_Colection').numberbox({min:0, precision:0 });
            $('#txtTo_Colection').numberbox({min:0, precision:0 });
            $('#txtFrom_Colection').numberbox('setValue',1);
            $('#txtTo_Colection').numberbox('setValue',50);
            document.getElementById("lblRange1_Colection").style.display = 'none';

            $('#txtEmployeeName').data("EmployeeIDs","");
            //RefreshList(_oEmployeeSalarys);
            DynamicRefreshList(_oEmployeeSalarys, "tblEmployeeSalary");
            $("#cboSalaryMonth_Collection").icsLoadCombo({
                List:_oMonths,
                OptionValue: "Value",
                DisplayText: "Text",
                InitialValue:"Month"
            });
            InitializeAdvSearch();
            //LoadBlock();
            //LoadBU();
            $('#dtMultiStartDate').datebox('setValue',icsdateformat(new Date()));
            $('#dtMultiEndDate').datebox('setValue',icsdateformat(new Date()));
            LoadYear();
            LoadCateGory(oEmployeeCategorys);
            PrintTypeObject();    
        });

        function MunlipleMonthCheckFunction()
        {
            debugger;
            if(document.getElementById("chkIsMultipleMonth").checked == true)
            {
                document.getElementById("singleMonthDiv").style = "display:none";
                document.getElementById("multiMonthDiv").style = "display:initial";
            }
            else
            {
                document.getElementById("singleMonthDiv").style = "display:initial";
                document.getElementById("multiMonthDiv").style = "display:none";
            }
        }
        function LoadCateGory(oEmployeeCategorys)
        {
            $("#cboCategory").icsLoadCombo({
                List: oEmployeeCategorys,
                OptionValue: "Value",
                DisplayText: "Text"
            });
        }

        function LoadYear()
        {
            var oDate=new Date();
            oDate.setFullYear(2014);
            var sYear="";
            sYear +="<option value='0'>"+'Year'+"</option>";
            for(var i=0; i<=15; i++)
            {
                sYear += "<option value='" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"'>" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"</option>";
            }
            $('#cboYear').html(sYear);
            var oDate=new Date();
            $("#cboSalaryMonth_Collection").val(oDate.getMonth()+1);
            $("#cboYear").val(oDate.getFullYear());

        }





        $('#btnSalaryProcess').click(function(e){
            debugger;
            var oEmployeeSalary = $('#tblEmployeeSalary').datagrid('getChecked');
            if (oEmployeeSalary.length<=0) { alert("please select one item");return; }

            var SelectedIndex=$('#tblEmployeeSalary').datagrid('getRowIndex',oEmployeeSalary[0])

            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/EmployeeSalary/ProcessSalary",
                data: JSON.stringify(oEmployeeSalary[0]),
                contentType: "application/json; charset=utf-8",
                success: function(data)
                {
                    var oEmpSalary = jQuery.parseJSON(data);
                    debugger;
                    if(oEmpSalary.ErrorMessage == "" || oEmpSalary.ErrorMessage ==null) {
                        alert("Processed Successfully");
                        $('#tblEmployeeSalary').datagrid('updateRow',{ index: SelectedIndex,row: oEmpSalary});
                        //$('#tblEmployeeSalary').datagrid('updateRow'selectRow
                    }
                    else {
                        alert(oEmpSalary.ErrorMessage);
                    }
                },
                error: function(xhr, status, error)
                {
                    alert(error);
                }
            });
        });

        //function LoadBU()
        //{
        //    $('#cboBU_Collection').combobox({
        //        data:_oBusinessUnits,
        //        valueField:'BusinessUnitID',
        //        textField:'Name',
        //        multiple:true
        //    });
        //    $('#cboBU_Collection').combobox('setValue',  _oBusinessUnits.length>0?_oBusinessUnits[0].BusinessUnitID:0);
        //}

        function GetsEmployeeID(oEmployeeSalarys){

            var Ids="";
            if(oEmployeeSalarys.length>0 && oEmployeeSalarys[0].EmployeeID>0)
            {
                for(var i=0;i<oEmployeeSalarys.length;i++)
                {
                    Ids+=oEmployeeSalarys[i].EmployeeID+',';
                }
                Ids=Ids.substring(0, Ids.length-1);
            }
            return Ids;
        }

        /*---------------- emp Search Start click----------------*/

        function InitializeAdvSearch(){
            $('#dtDateFrom').datebox('setValue', icsdateformat(new Date()));
            $('#dtDateTo').datebox('setValue', icsdateformat(new Date()));

            $("#cboEmployeeType").icsLoadCombo({
                List: _oEmployeeTypes,
                OptionValue: "EmployeeTypeID",
                DisplayText: "Name"
            });
            $("#cboShift_EmpSearch").icsLoadCombo({
                List: _oShifts,
                OptionValue: "ShiftID",
                DisplayText: "ShiftWithDuration"
            });
            $("#cboEmployeeCardStatus").icsLoadCombo({
                List: _oEmployeeCSs,
                OptionValue: "Value",
                DisplayText: "Text"
            });
            $("#cboEmployeeWorkigStatus").icsLoadCombo({
                List: _oEmployeeWSs,
                OptionValue: "Value",
                DisplayText: "Text"
            });
            $("#cboBU").icsLoadCombo({
                List: _oBusinessUnits,
                OptionValue: "BusinessUnitID",
                DisplayText: "Name"
            });
            $('#txtFrom,#txtTo').numberbox({min:0, precision:0 });
            $('#txtFrom').numberbox('setValue',1);
            $('#txtTo').numberbox('setValue',50);
            $("#lblRange1").hide();

            var oMonths=[{MonthID:0,Name:'Jan'},{MonthID:1,Name:'Feb'},{MonthID:2,Name:'Mar'},{MonthID:3,Name:'Apr'},
                        {MonthID:4,Name:'May'},{MonthID:5,Name:'Jun'},{MonthID:6,Name:'Jul'},{MonthID:7,Name:'Aug'},
                        {MonthID:8,Name:'Sep'},{MonthID:9,Name:'Oct'},{MonthID:10,Name:'Nov'},{MonthID:11,Name:'Dec'},];

            $("#cboMonthFrom,#cboMonthTo").icsLoadCombo({
                List: oMonths,
                OptionValue: "MonthID",
                DisplayText: "Name",
                InitialValue:''
            });

            LoadDaysInMonth();
        }

        function LoadDaysInMonth(){
            $("#cboMonthFrom,#cboMonthTo").val((new Date()).getMonth());
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt((new Date()).getMonth())+1,0)).getDate();

            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayFrom,#cboDayTo").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        }

        $("#cboDateType").change(function(e){
            if($("#cboDateType").val()==1){
                $("#regionDateTo").hide();
            }
            else{
                $("#regionDateTo").show();
            }
        });

        $("#cboMonthFrom").change(function(e){
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt($("#cboMonthFrom").val())+1,0)).getDate();
            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayFrom").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        });

        $("#cboMonthTo").change(function(e){
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt($("#cboMonthTo").val())+1,0)).getDate();
            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayTo").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        });

        function EmployeePickerReset(){
            _nLastEmployeeID = 0;
            _sEmployeeIDs = "";
            _bNext = false;
            _nLoadRecords = 0;
            _nRowLength = 0;
            _sAttendanceSchemeID="";
            _sLocationID = "";
            _sDepartmentIds = "";
            _sDesignationIds = "";
            $(".txtReset").val("");
            $(".cboReset").val(0);
            $(".chkReset").prop("checked",false);

            $("#cboMonthFrom,#cboMonthTo").val((new Date()).getMonth());
            LoadDaysInMonth();

            DynamicRefreshList([], "tblEmployeesForPicker");
            $("#lblcount").html("");
            $('#txtFrom,#txtTo').numberbox({min:0, precision:0 });
            $('#txtFrom').numberbox('setValue',1);
            $('#txtTo').numberbox('setValue',50);
            $("#lblRange1").hide();
            $('#txtEmployeeGroupAdv').val("");
            $('#txtEmployeeBlockAdv').val("");
            _sBlockIDsAdv = "";
            _sGroupIDsAdv = "";
        }

        $("#btnEmployee").click(function () {
            EmployeePickerReset();
            $("#winEmployeePicker").icsWindow("open", " Employee Picker");
        });

        $('#chkRange').click(function()
        {
            if(document.getElementById("chkRange").checked == true)
            {
                $("#lblRange1").show();
            }
            else
            {
                $("#lblRange1").hide();
            }
        });

        $('#btnEmpPickerSearch').click(function () {
            _bNext = false;
            AdvSearch();
        });

        function Next() {
            var oEmployees = [];
            oEmployees = $('#tblEmployeesForPicker').datagrid('getRows');
            if (oEmployees.length <= 0) { alert('Please Select Criteria and click on "Search" to find information.!!'); return; }
            _nRowLength = oEmployees.length;
            _bNext = true;
            AdvSearch();
        }

        function AdvSearch(){
            if (!_bNext) {
                _nRowLength = 0;
                _nLastEmployeeID = 0;
            }
            _nLoadRecords = document.getElementById("txtTo").value;
            if ($("#chkRange").is(':checked')) {
                if($('#txtFrom').numberbox('getValue').length=='' || $('#txtTo').numberbox('getValue').length==''){alert("Please enter valid range.")}
                var nRangeFrom = parseInt($('#txtFrom').numberbox('getValue'));
                var nRangeTo = parseInt( $('#txtTo').numberbox('getValue'));
                if (nRangeFrom > nRangeTo) { alert("Invalid Range !");return; }
                _nRowLength = nRangeFrom - 1;
                _nLoadRecords = nRangeTo - nRangeFrom + 1;
            }
            debugger
            var sName = $.trim($("#txtEmployeeName").val());
            var sCode = $.trim($("#txtEmpCodeForSearch").val());
            var sEnrollNo = $.trim($("#txtEnrollNo").val());
            var bIsnotEnroll = $("#chkNotassignedyet").is(':checked');
            var nEmployeeTypeID=$("#cboEmployeeType").val();
            var nShiftID=$("#cboShift_EmpSearch").val();
            var nCardStatus=$("#cboEmployeeCardStatus").val();
            var nWorkingStatus=$("#cboEmployeeWorkigStatus").val();
            var nDateType=$("#cboDateType").val();
            var sDOBFrom= parseInt($("#cboMonthFrom").val())+1+'-'+$("#cboDayFrom").val();
            var sDOBTo= parseInt($("#cboMonthTo").val())+1+'-'+$("#cboDayTo").val();
            var sGender= $("#cboGender option:selected").text();

            var bIsActive = ($("#chkActive").is(':checked'))? 1 : 0;
            var bIsInactive = ($("#chkInActive").is(':checked'))? 1 : 0;
            var bIsUser = ($("#chkUser").is(':checked'))? 1 : 0;

            var bIsUnOfficial = ($("#chkOfficialNotAssign").is(':checked'))?1:0;
            var bIsOfficial = ($("#chkOfficialAssign").is(':checked'))? 1 : 0;

            var bIsCardNotAsigned = ($("#chkCardNotAssigned").is(':checked'))? 1 : 0;
            var bIsSalarystructureNotAsigned = ($("#chkSalarystructureNotAssigned").is(':checked'))? 1 : 0;

            var bIsJoiningDate = $("#chkJoiningDate").is(':checked');
            var dtDateFrom = $('#dtDateFrom').datebox('getValue');
            var dtDateTo = $('#dtDateTo').datebox('getValue');

            if(bIsJoiningDate)
            {
                if(new Date(dtDateFrom)>new Date(dtDateTo))
                {
                    alert("Invalid Joining Date Range!");
                    return;
                }
            }

            var nBusinessUnitID = $("#cboBU").val();
            var nCategory=$('#cboCategory').val();
            var sPresentAddress=$('#txtPresentAddress').val();
            var sPermanentAddress=$('#txtPermanentAddress').val();

            if(sName=='' && sCode=="" && sEnrollNo=="" && _sAttendanceSchemeID=="" && _sLocationID=="" && _sDepartmentIds=="" && _sDesignationIds=="" &&
               nEmployeeTypeID==0 && sGender=="None" && nShiftID==0 && bIsActive==0 && bIsUnOfficial==0 && bIsInactive==0 && _sEmployeeIDs=="" && bIsUser==0 &&
               bIsOfficial==0 && nCardStatus==0 && bIsCardNotAsigned==0 && nWorkingStatus==0 && bIsSalarystructureNotAsigned==0 && nDateType==0
               && !bIsnotEnroll && nCategory<=0 && nBusinessUnitID<=0 && sPresentAddress=="" && sPermanentAddress=="" && _sBlockIDsAdv==""&& _sGroupIDsAdv=="")
            {
                alert("Please enter your selection criteria."); return false;
            }

            var sParam = sName + '~' + sCode + '~' + _sAttendanceSchemeID + '~' + _sLocationID + '~' + _sDepartmentIds + '~' +_sDesignationIds + '~' +
                         sGender + '~' + nEmployeeTypeID + '~' + nShiftID + '~' + bIsActive + '~' + bIsUnOfficial + '~' + bIsInactive + '~' + _sEmployeeIDs + '~' +
                         bIsUser + '~' + bIsOfficial + '~' + nCardStatus + '~' + bIsCardNotAsigned + "~" + nWorkingStatus + "~" + bIsSalarystructureNotAsigned + "~" +
                         sDOBFrom + "~" + sDOBTo + "~" + nDateType + "~" + _nRowLength + "~" + _nLoadRecords+"~"+ bIsJoiningDate + "~" + dtDateFrom + "~" + dtDateTo
                        +"~"+sEnrollNo+"~"+bIsnotEnroll+"~"+nCategory+"~"+nBusinessUnitID+"~"+sPresentAddress+"~"+sPermanentAddress+"~"+_sBlockIDsAdv+"~"+_sGroupIDsAdv;

            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/Employee/EmployeeSearch",
                traditional: true,
                data: JSON.stringify({ sParam: sParam }),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oEmps = jQuery.parseJSON(data);
                    if (oEmps != null) {
                        if (oEmps.length > 0) {
                            if(!_bNext){
                                DynamicRefreshList(oEmps,'tblEmployeesForPicker');
                            }
                            else{
                                var bAppend=false;
                                var oTEmps=$('#tblEmployeesForPicker').datagrid('getRows');
                                if(oTEmps.length>0){
                                    for (var i = 0; i < oEmps.length; i++) {
                                        var IsAppend=true;
                                        for (var j = 0; j < oTEmps.length; j++) {

                                            if(oEmps[i].EmployeeID==oTEmps[j].EmployeeID){
                                                IsAppend=false;
                                                break;
                                            }
                                        }
                                        if(IsAppend){
                                            bAppend=true;
                                            $('#tblEmployeesForPicker').datagrid('appendRow', oEmps[i]);
                                        }
                                    }
                                }
                                else{
                                    for (var j = 0; j < oEmps.length; j++) {
                                        bAppend=true;
                                        $('#tblEmployeesForPicker').datagrid('appendRow', oEmps[j]);
                                    }
                                }
                                if(!bAppend){
                                    alert("No more data found!");
                                }
                            }

                        }
                        else {
                            alert("No more data found!");
                        }
                        var oEmployees = $('#tblEmployeesForPicker').datagrid('getRows');
                        document.getElementById("lblcount").innerHTML = " | Count =" + oEmployees.length;
                        _bNext = false;
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }

        $("#btnEmployeePickerOk").click(function () {
            var oEmployees = $('#tblEmployeesForPicker').datagrid('getChecked');
            if (oEmployees.length<=0) { alert("please select atleast one item");return; }
            var sEmpIDs="";
            var sEmpNames="";
            for(var i=0;i<oEmployees.length;i++)
            {
                sEmpIDs=sEmpIDs+oEmployees[i].EmployeeID+",";
                sEmpNames=sEmpNames+oEmployees[i].Name+",";
            }
            _sEmployeeIDs= sEmpIDs.substring(0,sEmpIDs.length-1);
            sEmpNames= sEmpNames.substring(0,sEmpNames.length-1);
            $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
            $("#txtEmployee_Collection").val(sEmpNames);
            $("#winEmployeePicker").icsWindow('close');
            SearchByDepartmentAndDateRangeWithPasignation();
        });

        $("#btnEmployeePickerClose").click(function () {
            $("#winEmployeePicker").icsWindow('close');
        });

        /*-------------Attendance Schema Picker----------------*/
        $("#btnAttScheme").click(function(e){
            var oAttendanceScheme={AttendanceSchemeID:0};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oAttendanceScheme,
                ControllerName: "AttendanceScheme",
                ActionName: "GetsAttendanceSchemeCurrentSession",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].AttendanceSchemeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "EmployeeType", title: "EmployeeType", width: 100, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "DayOff", title: "DayOff", width: 115, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winAttendanceScheme',
                            winclass:'clsAttendanceScheme',
                            winwidth: 420,
                            winheight: 460,
                            tableid: 'tblAttendanceSchemePicker',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: false,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Attendance Scheme List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeAttendancePickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        });

        function IntializeAttendancePickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oAttendanceScheme = $('#'+oPickerobj.tableid).datagrid('getSelected');
                if (oPickerobj.winid == 'winAttendanceScheme')
                {
                    if(oAttendanceScheme!=null && oAttendanceScheme.AttendanceSchemeID>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();
                        $('#txtAttendanceScheme').val(oAttendanceScheme.Name);
                        _sAttendanceSchemeID=oAttendanceScheme.AttendanceSchemeID;
                    }
                    else{
                        alert("Please select a schema.");
                    }
                }
            });
        }

        $("#btnResetAttScheme").click(function(e){
            $('#txtAttendanceScheme').val("");
            _sAttendanceSchemeID="";
        });

        /*-------------Location Picker----------------*/
        var btnLocation="";
        $("#btnLocationPicker,#btnLocationPicker_Colection").click(function(e){
            debugger;
            btnLocation = $(this).attr("id");
            var sBusinessUnitIDs ="";
            var nBusinessUnitID=0;
            if(btnLocation=="btnLocationPicker")
            {
                nBusinessUnitID = $("#cboBU").val();
                sBusinessUnitIDs = String(nBusinessUnitID);
            }
            else{sBusinessUnitIDs=_sBusinessUnitIds;}
            $("#winLocationPicker").icsWindow('open');
            var oLocation={LocationID:0,BusinessUnitIDs:sBusinessUnitIDs};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oLocation,
                ControllerName: "Location",
                ActionName: "GetsLocationMenuTree",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.TLocation.id > 0) {
                        $('#locationtree').tree({ data: [response.obj.TLocation] });
                    }
                }
            });
        });

        $("#btnLocationPickerOk").click(function(e){
            if(btnLocation=="btnLocationPicker")
            {
                var oLocation = $('#locationtree').tree('getSelected');
                if(oLocation!=null && oLocation.id>0){
                    $("#winLocationPicker").icsWindow('close');
                    _sLocationID=oLocation.id;
                    $('#txtLocation').val(oLocation.text);
                }
                else{
                    alert("Please select a location.");
                }
            }
            else
            {
                var oLocations = $('#locationtree').tree('getChecked');
                if(oLocations!=null && oLocations.length>0)
                {
                    var LocationName="";
                    for(var i=0; i<oLocations.length; i++)
                    {
                        if(oLocations[i].id !=1)
                        {
                            LocationName+=oLocations[i].text+",";
                            _sLocationID+=oLocations[i].id+",";
                        }
                    }

                    LocationName=LocationName.substring(0,LocationName.length-1);
                    _sLocationID=_sLocationID.substring(0,_sLocationID.length-1);
                    $("#winLocationPicker").icsWindow('close');
                    $('#txtLocation_Colection').val(LocationName);
                }
                else
                {
                    alert("Please select a location.");
                }
            }
        });

        $('#txtLocation_Colection').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                //$("#winLocationPicker").icsWindow('open');
                //var oLocation={LocationID:0};
                btnLocation = $(this).attr("id");
                var sBusinessUnitIDs ="";
                var nBusinessUnitID=0;
                if(btnLocation=="btnLocationPicker")
                {
                    nBusinessUnitID = $("#cboBU").val();
                    sBusinessUnitIDs = String(nBusinessUnitID);
                }
                else{sBusinessUnitIDs=_sBusinessUnitIds;}
                $("#winLocationPicker").icsWindow('open');
                var oLocation={LocationID:0,BusinessUnitIDs:sBusinessUnitIDs};

                var obj = {
                    BaseAddress: _sBaseAddress,
                    Object: oLocation,
                    ControllerName: "Location",
                    ActionName: "GetsLocationMenuTree",
                    IsWinClose: false
                };
                $.icsDataGet(obj, function (response) {

                    if (response.status && response.obj!=null) {
                        if (response.obj.TLocation.id > 0) {
                            $('#locationtree').tree({ data: [response.obj.TLocation] });
                        }
                    }
                });
            }
        });

        $("#btnLocationPickerClose").click(function(e){
            $("#winLocationPicker").icsWindow('close');
        });

        $("#btnResetLocationPicker,#btnResetLocationPicker_Colection").click(function(e){
            $('#txtLocation').val("");
            $('#txtLocation_Colection').val("");
            _sLocationID="";
        });

        $("#btnLocationPickerClose").click(function(e){
            $("#winLocationPicker").icsWindow('close');
        });

        /*-------------Department Picker----------------*/

        $("#btnDepartmentPicker").click(function(e){
            $("#winDepartmentPicker").icsWindow('open');
            var oDepartment={DepartmentID:0,BusinessUnitIDs:_sBusinessUnitIds,LocationIDs:_sLocationID};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDepartment,
                ControllerName: "Department",
                ActionName: "GetsDepartments",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.id > 0) {
                        $('#departmenttree').tree({ data: [response.obj] });
                    }
                }
            });
        });

        $("#btnDepartmentPickerOk").click(function(e){
            var oDepartment = $('#departmenttree').tree('getSelected');
            if(oDepartment!=null && oDepartment.id>0){
                $("#winDepartmentPicker").icsWindow('close');
                $('#txtDepartment').val(oDepartment.text);
                _sDepartmentIds= oDepartment.id;
            }
            else{
                alert("Please select a department.");
            }
        });

        $("#btnDepartmentPickerClose").click(function(e){
            $("#winDepartmentPicker").icsWindow('close');
        });

        $("#btnDepartmentPickerClose_Collection").click(function(e){
            $("#winDepartmentPicker_Collection").icsWindow('close');
        });

        $("#btnResetDepartmentPicker,#btnResetDepartmentPicker_Collection").click(function(e){
            $('#txtDepartment,#txtDepartment_Collection').val("");
            _sDepartmentIds="";
            _sDepartmentNames="";
        });

        /*-------------Designation Picker----------------*/
        var btnDesignation="";
        $("#btnDesignationPicker,#btnDesignationPicker_Collection").click(function(e){
            btnDesignation = $(this).attr("id");
            DesignationPicker();
        });

        $("#txtDesignation_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                btnDesignation ="btnDesignationPicker_Collection";
                DesignationPicker();
            }
        });

        function DesignationPicker()
        {
            var oDesignation={
                DesignationID:0,
                Params: _sBusinessUnitIds+'~'+_sLocationID+'~'+ _sDepartmentIds
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDesignation,
                ControllerName: "Designation",
                ActionName: "Gets",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].DesignationID > 0) {
                        var tblColums = [];
                        var oColumn = { field: "Code", title: "Code", width: 50, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 170, align: "left" };tblColums.push(oColumn);

                        var bmultiplereturn=false;
                        if(btnDesignation=="btnDesignationPicker_Collection"){bmultiplereturn=true;}

                        var oPickerParam = {
                            winid: 'winDesignation',
                            winclass:'clsDesignation',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblDesignation',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: bmultiplereturn,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Designation List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeDesignationPickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeDesignationPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oDesignations=[];

                if(btnDesignation=="btnDesignationPicker_Collection")
                {
                    oDesignations = $('#'+oPickerobj.tableid).datagrid('getChecked');
                }
                else
                {
                    var oDesignation = $('#'+oPickerobj.tableid).datagrid('getSelected');
                    oDesignations.push(oDesignation);
                }

                if (oPickerobj.winid == 'winDesignation')
                {
                    if(oDesignations!=null && oDesignations.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oDesignations.length; i++)
                        {
                            _sDesignationNames+=oDesignations[i].Name+",";
                            _sDesignationIds+=oDesignations[i].DesignationID+",";
                        }

                        _sDesignationNames=_sDesignationNames.substring(0,_sDesignationNames.length-1);
                        _sDesignationIds=_sDesignationIds.substring(0,_sDesignationIds.length-1);
                        if(btnDesignation=="btnDesignationPicker_Collection")
                        {
                            $("#txtDesignation_Collection").val(_sDesignationNames);
                        }
                        else
                        {
                            $("#txtDesignation").val(_sDesignationNames);
                        }
                    }
                    else{
                        alert("Please select a designation.");
                    }
                }
            });
        }

        $("#btnResetDesignationPicker,#btnResetDesignationPicker_Collection").click(function(e){
            $('#txtDesignation').val("");
            $('#txtDesignation_Collection').val("");
            _sDesignationIds="";
            _sDesignationNames = "";
        });
        
        /*---------------- emp Search Start keyprees----------------*/
        $('#txtEmployee_Collection').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var sCodeName = $.trim($("#txtEmployee_Collection").val());
                if(sCodeName==''){alert("Please enter name or code to search.");$("#txtEmployee_Collection").focus(); return;}
                SearchEmployeeByText(sCodeName);
            }
        });

        function SearchEmployeeByText(sEmpNameCode){
            var oEmployee = { Params: sEmpNameCode +'~'+ 0};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oEmployee,
                ControllerName: "Employee",
                ActionName: "GetsByEmpCode",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeID > 0) {

                        var tblColums = [];var oColumn = { field: "Code", title: "Code", width: 70, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 120, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "DepartmentName", title: "Department", width: 100, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "DesignationName", title: "Designation", width: 100, align: "left" };tblColums.push(oColumn);
                        var oPickerParam = {
                            winid: 'winEmployeePickerTextSearch',
                            winclass:'clsEmployeePickerTextSearch',
                            winwidth: 455,
                            winheight: 460,
                            tableid: 'tblEmployeePickerTextSearch',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: false,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee list'
                        };

                        $.icsPicker(oPickerParam);
                        IntializeEmployeePickerTextSearch(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeEmployeePickerTextSearch(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
                if(oreturnObj == null || oreturnObj.EmployeeID<=0){  alert("please select an employee."); return false;}

                $("#"+oPickerobj.winid).icsWindow("close");
                $("#" + oPickerobj.winid).remove();
                if (oPickerobj.winid == 'winEmployeePickerTextSearch')
                {
                    if (oreturnObj != null && oreturnObj.EmployeeID > 0)
                    {
                        _sEmployeeIDs=oreturnObj.EmployeeID;
                        $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
                        $("#txtEmployee_Collection").val(oreturnObj.Name);
                        $("#winEmployeePicker").icsWindow('close');
                        SearchByDepartmentAndDateRangeWithPasignation();
                    }
                }
            });

            $(document).find('.' +oPickerobj.winclass).keydown(function (e) {
                if (e.which == 13)//enter=13
                {
                    var oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
                    if(oreturnObj == null || oreturnObj.EmployeeID<=0){  alert("please select an employee."); return false;}

                    $("#"+oPickerobj.winid).icsWindow("close");
                    $("#" + oPickerobj.winid).remove();

                    if (oPickerobj.winclass == 'clsEmployeePickerTextSearch')
                    {
                        if (oreturnObj != null && oreturnObj.EmployeeID > 0)
                        {
                            _sEmployeeIDs=oreturnObj.EmployeeID;
                            $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
                            $("#txtEmployee_Collection").val(oreturnObj.Name);
                            $("#winEmployeePicker").icsWindow('close');
                            SearchByDepartmentAndDateRangeWithPasignation();
                        }
                    }
                }
            });
        }

        $('#btnCEmployee').click(function (e)
        {
            document.getElementById("txtEmployee_Collection").value = "" ;
            $('#txtEmployeeName').data("EmployeeIDs","");
            _sEmployeeIDs = "";
        });

        /*---------------- emp Search Start keyprees----------------*/

        /*-------------Department Picker start Collection----------------*/
        $("#btnDepartmentPicker_Collection").click(function(e){
            DepartmentPicker();
        });

        $("#txtDepartment_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                DepartmentPicker();
            }
        });

        function DepartmentPicker()
        {
            $("#winDepartmentPicker_Collection").icsWindow('open');
            var oDepartment={DepartmentID:0,BusinessUnitIDs:_sBusinessUnitIds,LocationIDs:_sLocationID};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDepartment,
                ControllerName: "Department",
                ActionName: "GetsDepartments",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.id > 0) {
                        $('#departmenttree_Collection').tree({ data: [response.obj] });
                    }
                }
            });
        }

        $("#btnDepartmentPickerOk_Collection").click(function(e){
            _sDepartmentNames="";
            _sDepartmentIds="";
            var oDepartments = $('#departmenttree_Collection').tree('getChecked');
            if(oDepartments!=null && oDepartments.length>0){
                $("#winDepartmentPicker_Collection").icsWindow('close');
                for(var i=0; i<oDepartments.length; i++)
                {
                    _sDepartmentNames+=oDepartments[i].text+",";
                    _sDepartmentIds+=oDepartments[i].id+",";
                }

                _sDepartmentNames=_sDepartmentNames.substring(0,_sDepartmentNames.length-1);
                _sDepartmentIds=_sDepartmentIds.substring(0,_sDepartmentIds.length-1);
                $("#txtDepartment_Collection").val(_sDepartmentNames);
            }
            else{
                alert("Please select a department.");
            }
        });

        function SearchByDepartmentAndDateRangeWithPasignation()//department and date wise search
        {
            if(!_bNext)
            {
                _nRowLength = 0;
                _nLastEmployeeSalaryID = 0;
            }
            //var dtDateFrom= $('#dtDateFrom').datebox('getValue');
            //var dtDateTo= $('#dtDateTo').datebox('getValue');
            var nMonthID=$("#cboSalaryMonth_Collection").val();
            var nYear= $('#cboYear option:selected').text();

            if(parseFloat(nMonthID)<=0 || parseFloat(nYear)<=0)
            {
                alert("Please select Month & Year ");
                return;
            }

            _nLoadRecords = document.getElementById("txtTo").value;
            if(document.getElementById("chkRange").checked == true)
            {
                var RangeFrom = 0;
                var RangeTo = 0;
                RangeFrom = parseFloat(document.getElementById("txtFrom").value);
                RangeTo = parseFloat(document.getElementById("txtTo").value);

                if(RangeFrom > RangeTo)
                {
                    alert("Invalid Range !");
                    return;
                }
                _nRowLength = 0;
                _nLoadRecords = 0;

                _nRowLength = RangeFrom-1;
                _nLoadRecords = RangeTo - RangeFrom +1;
            }

            var nPayType= $('#cboPaymentType').val();
            var tsv = ((new Date()).getTime()) / 1000;
            var bNewJoin =  document.getElementById("chkNewJoin").checked;

            var bGroupByDept =  document.getElementById("chkGroupByDept").checked;
            var bGroupBySerial =  document.getElementById("chkGroupBySerial").checked;
            var bRound =  document.getElementById("chkRound").checked;
            //var nBlock=$('#cboBlock').val();
            var sEmployeeIDs=$('#txtEmployeeName').data("EmployeeIDs");

            var nStartSalaryRange=$('#txtStartSalaryRange').val();
            var nEndSalaryRange=$('#txtEndeSalaryRange').val();
            if(nStartSalaryRange==""){nStartSalaryRange=0;}
            if(nEndSalaryRange==""){nEndSalaryRange=0;}
            nStartSalaryRange= parseFloat(nStartSalaryRange);
            nEndSalaryRange= parseFloat(nEndSalaryRange);
            if(nStartSalaryRange>0 || nEndSalaryRange>0)
            {
                if(nStartSalaryRange>nEndSalaryRange)
                {
                    alert("Invalid Salary Range!");
                    return;
                }
                if(nStartSalaryRange>0 && nEndSalaryRange<=0)
                {
                    alert("Please enter End Salary Range!");
                    return;
                }
                if(nStartSalaryRange<=0 && nEndSalaryRange>0)
                {
                    alert("Please enter Start Salary Range!");
                    return;
                }
            }

            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/EmployeeSalary/SearchSalaryByDepartmentAndDateRange",
                data: JSON.stringify({sBU:_sBusinessUnitIds,sLocationID:_sLocationID, sDepartmentIds: _sDepartmentIds,sDesignationIDs:_sDesignationIds,sSalarySchemeIDs:_sSalarySchemeIDs,sEmployeeIDs:sEmployeeIDs,nPayType:nPayType,nMonthID:nMonthID,nYear:nYear,bNewJoin:bNewJoin,nStartSalaryRange:nStartSalaryRange,nEndSalaryRange:nEndSalaryRange,nLoadRecords : _nLoadRecords, nRowLength : _nRowLength, sGroupIDs:_sGroupIDs, sBlockIDs:_sBlockIDs, ts: tsv}),
                contentType: "application/json; charset=utf-8",
                success: function(data)
                {
                    var oEmployeeSalarys =[];
                    oEmployeeSalarys = jQuery.parseJSON(data);
                    if(oEmployeeSalarys.length>0 && oEmployeeSalarys[0].ErrorMessage=="")
                    {
                        //if(!_bNext)
                        //{
                        //    _oEmployeeSalarys=[];
                        //    //RefreshList(_oEmployeeSalarys);
                        //    DynamicRefreshList(_oEmployeeSalarys, "tblEmployeeSalary");
                        //}

                        for (var j = 0; j < oEmployeeSalarys.length; j++)
                        {
                            $('#tblEmployeeSalary').datagrid('appendRow',oEmployeeSalarys[j]);
                        }
                    }
                    else
                    {
                        if(_bNext == false)
                        {
                            alert("Data not found !!");
                            _oEmployeeSalarys=[];
                            //RefreshList(_oEmployeeSalarys);
                            DynamicRefreshList(_oEmployeeSalarys, "tblEmployeeSalary");
                        }
                        else
                        {
                            alert("No more data found !");
                        }
                    }
                    var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid('getRows');
                    document.getElementById("lblcount_Colection").innerHTML = " | Count ="+ oEmployeeSalarys.length;
                    _bNext = false;
                },
                error: function(xhr, status, error)
                {
                    alert(error);
                }
            });
        }

        function Next_Collection()
        {
            var oEmployeeSalarys =[];
            oEmployeeSalarys=$('#tblEmployeeSalary').datagrid('getRows');
            _nRowLength = oEmployeeSalarys.length;
            _bNext = true;

            if (oEmployeeSalarys.length<=0)
            {
                alert('Please Select Criteria and click on "Search" to find information.!!');
                return;
            }
            var oEmployeeSalary = oEmployeeSalarys[oEmployeeSalarys.length-1];

            if (_nLastEmployeeSalaryID==oEmployeeSalary.EmployeeSalaryID)
            {
                alert('No more data found by this date range');
                return;
            }
            _nLastEmployeeSalaryID=oEmployeeSalary.EmployeeSalaryID;
            SearchByDepartmentAndDateRangeWithPasignation();
        }

        function PrintPaySlipV1()
        {
            debugger;
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var oParameter = new Object();
                var url = _sBaseAddress+ "/EmployeeSalary/View_PrintMultiplePaySlip"+S
                var oEmployees = window.showModalDialog(url, oParameter, 'dialogHeight:1050px;dialogWidth:1350px;dialogLeft:20;dialogRight:0;center:yes;resizable:yes;status:no;scroll:no');
            }
        }

        $('#btnNPPaySlipV1').click(function (e)
        {

            var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getChecked');
            if(oEmployeeSalarys.length <= 0 )
            {
                alert("Please Select At Least One Item !");
                return;
            }
            var sEmployeeSalaryIDs = "";
            if(oEmployeeSalarys.length>0)
            {
                for(var i =0; i<oEmployeeSalarys.length;i++)
                {
                    sEmployeeSalaryIDs += oEmployeeSalarys[i].EmployeeSalaryID +",";
                }
                sEmployeeSalaryIDs = sEmployeeSalaryIDs.substring(0,sEmployeeSalaryIDs.length-1);
            }

            var dtDateFrom= $('#dtDateFrom').datebox('getValue');
            var dtDateTo= $('#dtDateTo').datebox('getValue');
            var sDate=dtDateFrom+","+dtDateTo;
            var tsv = ((new Date()).getTime()) / 1000;

            var oParameter = new Object();
            //oParameter.DateStart = dtStartDate;
            //oParameter.DateEnd = dtEndDate;

            var url = _sBaseAddress + "/EmployeeSalary/View_PrintNPMultiplePaySlip?EmployeeSalaryIDs="+sEmployeeSalaryIDs+"&sDate="+sDate+"&ts="+tsv;
            var oEmployees = window.showModalDialog(url, oParameter, 'dialogHeight:1050px;dialogWidth:1350px;dialogLeft:20;dialogRight:0;center:yes;resizable:yes;status:no;scroll:no');

        });

        $('#btnPaySlipV2').click(function (e)
        {
            var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getChecked');
            if(oEmployeeSalarys.length <= 0 )
            {
                alert("Please Select At Least One Item !");
                return;
            }
            var sEmployeeSalaryIDs = "";
            if(oEmployeeSalarys.length>0)
            {
                for(var i =0; i<oEmployeeSalarys.length;i++)
                {
                    sEmployeeSalaryIDs += oEmployeeSalarys[i].EmployeeSalaryID +",";
                }
                sEmployeeSalaryIDs = sEmployeeSalaryIDs.substring(0,sEmployeeSalaryIDs.length-1);
            }

            var dtDateFrom= $('#dtDateFrom').datebox('getValue');
            var dtDateTo= $('#dtDateTo').datebox('getValue');
            var sDate=dtDateFrom+","+dtDateTo;
            var tsv = ((new Date()).getTime()) / 1000;

            var oParameter = new Object();
            //oParameter.DateStart = dtStartDate;
            //oParameter.DateEnd = dtEndDate;

            var url = _sBaseAddress + "/EmployeeSalary/View_PrintMultiplePaySlipV2?EmployeeSalaryIDs="+sEmployeeSalaryIDs+"&sDate="+sDate+"&ts="+tsv;
            var oEmployees = window.showModalDialog(url, oParameter, 'dialogHeight:1050px;dialogWidth:1350px;dialogLeft:20;dialogRight:0;center:yes;resizable:yes;status:no;scroll:no');

        });

        $('#btnSalarySheetV1').click(function (e)
        {
            var sEmpID= $('#txtEmployeeName').data("EmployeeIDs");

            var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid("getChecked");
            if(oEmployeeSalarys.length>0){
                sEmpID=GetsEmployeeID(oEmployeeSalarys);
            }

            var dtStartDate= $('#dtDateFrom').datebox('getValue');
            var dtEndDate= $('#dtDateTo').datebox('getValue');

            var sDate=dtStartDate+","+dtEndDate;
            var tsv = ((new Date()).getTime()) / 1000;
            window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheet?sEmpIDs="+sEmpID+"&sDate="+sDate+"&nLocationID="+_nLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIDs +"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&ts="+tsv, "_blank");

        });

        $('#btnSSXLV1').click(function (e)
        {
            var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getRows');
            if(oEmployeeSalarys==null )
            {
                alert("Please Select At Least One Item !");
                return;
            }

            var sEmpID="";
            for(var i=0; i<oEmployeeSalarys.length; i++)
            {
                sEmpID+=oEmployeeSalarys[i].EmployeeID+",";
            }
            sEmpID=sEmpID.substring(0,sEmpID.length-1);

            var dtStartDate= $('#dtDateFrom').datebox('getValue');
            var dtEndDate= $('#dtDateTo').datebox('getValue');

            var sDate=dtStartDate+","+dtEndDate;
            var tsv = ((new Date()).getTime()) / 1000;
            window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheetXL?sEmpIDs="+sEmpID+"&sDate="+sDate+"&ts="+tsv, "_blank");

        });

        $('#btnSalarySheetV2').click(function (e)
        {
            var sEmpID= $('#txtEmployeeName').data("EmployeeIDs");
            var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid("getChecked");
            if(oEmployeeSalarys.length>0){
                sEmpID=GetsEmployeeID(oEmployeeSalarys);
            }

            var dtStartDate= $('#dtDateFrom').datebox('getValue');
            var dtEndDate= $('#dtDateTo').datebox('getValue');

            var sDate=dtStartDate+","+dtEndDate;
            var tsv = ((new Date()).getTime()) / 1000;
            window.open(_sBaseAddress+ "/EmployeeSalary/PrintDSalarySheet?sEmpIDs="+sEmpID+"&sDate="+sDate+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIDs +"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&ts="+tsv, "_blank");

        });

        $('#btnNPSalarySheetV1').click(function (e)
        {
            var sEmpID= $('#txtEmployeeName').data("EmployeeIDs");
            var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid("getChecked");
            if(oEmployeeSalarys.length>0){
                sEmpID=GetsEmployeeID(oEmployeeSalarys);
            }

            var dtStartDate= $('#dtDateFrom').datebox('getValue');
            var dtEndDate= $('#dtDateTo').datebox('getValue');

            var sDate=dtStartDate+","+dtEndDate;
            var tsv = ((new Date()).getTime()) / 1000;
            window.open(_sBaseAddress+ "/EmployeeSalary/PrintNPSalarySheetV1?sEmpIDs="+sEmpID+"&sDate="+sDate+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIDs+"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&ts="+tsv, "_blank");

        });

        $('#btnNPSalarySheetV2').click(function (e)
        {
            var sEmpID= $('#txtEmployeeName').data("EmployeeIDs");
            var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid("getChecked");
            if(oEmployeeSalarys.length>0){
                sEmpID=GetsEmployeeID(oEmployeeSalarys);
            }

            var dtStartDate= $('#dtDateFrom').datebox('getValue');
            var dtEndDate= $('#dtDateTo').datebox('getValue');

            var sDate=dtStartDate+","+dtEndDate;
            var tsv = ((new Date()).getTime()) / 1000;
            window.open(_sBaseAddress+ "/EmployeeSalary/PrintNPSalarySheetV2?sEmpIDs="+sEmpID+"&sDate="+sDate+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIDs+"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&ts="+tsv, "_blank");

        });

        function ReturnConnectionStringForController()
        {
            var sString="";
            //var sBUnit=$('#cboBU_Collection').combobox('getValues');
            //var nBlock=$("#cboBlock").val();
            var sEmpID= $('#txtEmployeeName').data("EmployeeIDs");
            var nPayType=$("#cboPaymentType").val();
            var nMonthID=$("#cboSalaryMonth_Collection").val();
            var nYear= $('#cboYear option:selected').text();
            if(parseFloat(nMonthID)<=0 || parseFloat(nYear)<=0)
            {
                alert("Please select Month & Year ");
                return;
            }
            debugger;
            var bNewJoin =  document.getElementById("chkNewJoin").checked;
            var IsMatchExact = document.getElementById("chkIsMatchExact").checked;

            debugger;
            var bGroupByDept =  document.getElementById("chkGroupByDept").checked;
            var bGroupBySerial =  document.getElementById("chkGroupBySerial").checked;
           
            debugger;
            //var isChecked = $('#chkGroupBySerial').attr('checked') ? true:false;

            var bRound =  document.getElementById("chkRound").checked;

            var oEmployeeSalarys=$('#tblEmployeeSalary').datagrid("getChecked");
            if(oEmployeeSalarys.length>0){
                sEmpID=GetsEmployeeID(oEmployeeSalarys);
            }

            var nStartSalaryRange=$('#txtStartSalaryRange').val();
            var nEndSalaryRange=$('#txtEndeSalaryRange').val();
            if(nStartSalaryRange==""){nStartSalaryRange=0;}
            if(nEndSalaryRange==""){nEndSalaryRange=0;}
            nStartSalaryRange= parseFloat(nStartSalaryRange);
            nEndSalaryRange= parseFloat(nEndSalaryRange);
            if(nStartSalaryRange>0 || nEndSalaryRange>0)
            {
                if(nStartSalaryRange>nEndSalaryRange)
                {
                    alert("Invalid Salary Range!");
                    return;
                }
                if(nStartSalaryRange>0 && nEndSalaryRange<=0)
                {
                    alert("Please enter End Salary Range!");
                    return;
                }
                if(nStartSalaryRange<=0 && nEndSalaryRange>0)
                {
                    alert("Please enter Start Salary Range!");
                    return;
                }
            }
            debugger;
            var nReportFormat = $('#CboPrintItems').val();
            var tsv = ((new Date()).getTime()) / 1000;

            if(nReportFormat==3 || nReportFormat==4 || nReportFormat==5 ||nReportFormat==6||nReportFormat==13||nReportFormat==14 ||nReportFormat==15 || nReportFormat==17 || nReportFormat == 30 || nReportFormat == 11|| nReportFormat == 35|| nReportFormat == 20|| nReportFormat == 60)
            {

                sString="?IsCompliance="+ ((nReportFormat==5 ||nReportFormat==6 ||nReportFormat==14 ||nReportFormat==17 ||nReportFormat==35)?true:false)+"&sBU="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds +"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&sEmpIDs="+sEmpID+"&nPayType="+nPayType+"&nMonthID="+nMonthID+"&nYear="+nYear+"&bNewJoin="+bNewJoin+"&bWithPrecision=false"+"&nStartSalaryRange="+nStartSalaryRange+"&nEndSalaryRange="+nEndSalaryRange+"&bGroupByDept="+bGroupByDept+"&bGroupBySerial="+bGroupBySerial+"&sGroupIDs="+_sGroupIDs+"&sBlockIDs="+_sBlockIDs+"&bRound=" + bRound + "&IsMatchExact=" + IsMatchExact +"&ts="+tsv, "_blank";
            }
            else
            {
                var oSelectedCols = $('#tblPrintColumns').datagrid('getChecked');
                var sSelectedColNames = "";
                if(oSelectedCols.length>0)
                {
                    for(var i =0; i<oSelectedCols.length;i++)
                    {
                        sSelectedColNames += oSelectedCols[i].ColumnName +",";
                    }
                    sSelectedColNames = sSelectedColNames.substring(0,sSelectedColNames.length-1);
                }

                sString="?sBU="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds +"&sSalarySchemeIDs="+_sSalarySchemeIDs+"&sEmpIDs="+sEmpID+"&nPayType="+nPayType+"&nMonthID="+nMonthID+"&nYear="+nYear+"&bNewJoin="+bNewJoin+"&bWithPrecision=false"+"&nStartSalaryRange="+nStartSalaryRange+"&nEndSalaryRange="+nEndSalaryRange+"&bGroupByDept="+bGroupByDept+"&bGroupBySerial="+bGroupBySerial+"&sGroupIDs="+_sGroupIDs+"&sBlockIDs="+_sBlockIDs+"&bRound=" + bRound + "&IsMatchExact=" + IsMatchExact +"&ts="+tsv+"&SelectedColNames="+sSelectedColNames, "_blank";
            }
            var sBankAccountPartString = "&dDateTime=" + $('#dLetterInformationDate').datebox('getValue') + "&BankAccID=" + _nTempBankAccountID;
            return sString + sBankAccountPartString;
        }

        function SalarySheet_Corporate(IsXL)
        {
            debugger;
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sAction="";
                if(IsXL){sAction="PrintSalarySheet_Corporate_XL"}else{sAction="PrintSalarySheet_Corporate"}
                S=sAction+S;
                window.open(_sBaseAddress+ "/EmployeeSalary/"+S);
            }
        }

        function SalarySheet_DetailFormat()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheet_DetailFormat"+S);
            }
        }

        function PaySlip_DetailFormat()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var oParameter = new Object();
                var url = _sBaseAddress+ "/EmployeeSalary/PrintMultiplePaySlip_DetailFormat"+S
                window.open(url, "_blank");
            }
        }
        function PaySlip_DetailFormatMultiMonth()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var oParameter = new Object();
                var MultipleMonthParam = dtDateFrom = $('#dtMultiStartDate').datebox('getValue') + "~" + $('#dtMultiEndDate').datebox('getValue');
                var url = _sBaseAddress+ "/EmployeeSalary/PrintMultiplePaySlip_DetailFormatMultiMonth"+S + "&sMultipleMonthParam=" + MultipleMonthParam;
                window.open(url, "_blank");
            }
        }

        function PrintPaySlip()
        {
            debugger;

            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlip"+S);
            }
        }

        //Pay Slip F4

        function PrintPaySlipDoubleTable()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                //----------New Add For Bank And Cash

                S = S + "&IsBank=" + document.getElementById("chkBank").checked + "&IsCash=" + document.getElementById("chkCash").checked;

                //-----------------END---------------
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlipDoubleTable"+S);
            }
        }

        //Pay Slip F5

        function PrintPaySlipDoubleTable_Comp()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlipDoubleTable_Comp"+S);
            }
        }
        
        //Pay Slip F4_1
        function PrintPaySlipDoubleTable_1()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlipDoubleTable_1"+S);
            }
        }
        //Pay Slip F4_1_B
        function PrintPaySlipDoubleTable_1_B()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlipDoubleTable_1_B"+S);
            }
        }

        //Pay Slip F5_1

        function PrintPaySlipDoubleTable_Comp_1()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                var sPrintCount = $('#txtPrintCount').numberspinner('getValue');
                if(sPrintCount===null || sPrintCount.length<=0)
                {
                    alert("Please select Print Count!");
                    return;
                }
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ViewEmployeePaySlipDoubleTable_Comp_1"+S);
            }
        }


        $('#btnExcelPaySlip_Comp').click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoPaySlip_Comp"+S);
            }
        });
        $('#btnExcelPaySlip_CompF6').click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                S=S+"&PC="+parseInt($('#txtPrintCount').numberspinner('getValue'));
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoPaySlip_CompF6"+S);
            }
        });

        $('#btnRemoveFromGrid').click(function (e)
        {
            var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getChecked');
            if(oEmployeeSalarys.length<=0)
            {
                alert("Please select at least onr item!");
                return;
            }

            for(var i=0; i<oEmployeeSalarys.length;i++)
            {
                var SelectedRowIndex = $('#tblEmployeeSalary').datagrid('getRowIndex', oEmployeeSalarys[i]);
                $('#tblEmployeeSalary').datagrid('deleteRow', SelectedRowIndex);
            }

        });

        function printSelectedColumns()
        {
            debugger;
            var sActionAndSearchingCriteria = ReturnConnectionStringForController();
            if(sActionAndSearchingCriteria == "" || sActionAndSearchingCriteria == null)
            {
                $('#winPrintCV').icsWindow('close');
                return;
            }
            else
            {
                var sAction="";
                $('#btnCancel').click();                                
                if(_IsXL)
                {
                    sAction="PrintBankSheet_XL"                    
                }
                else
                {
                    sAction="PrintBankSheet"                    
                }
                sActionAndSearchingCriteria = sAction + sActionAndSearchingCriteria+"&bSearchByBank="+$('#chkSearchByBank').is(":checked")+"&sPrintHeader="+$('#cboPaperType').val()+"&HeaderHeightInch="+parseFloat(icsRemoveComma($('#txtHeaderHeightInch').val(),2))+"&FooterHeightInch="+parseFloat(icsRemoveComma($('#txtFooterHeightInch').val(),2));
                window.open(_sBaseAddress+ "/EmployeeSalary/"+sActionAndSearchingCriteria);
            }
            DynamicRefreshList([], "tblPrintColumns");
        };

        function BankSheet(IsXL)
        {
            debugger;
            _IsXL = IsXL;

            //var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getChecked');
            //if(oEmployeeSalarys.length <= 0 )
            //{
            //    alert("Please Select At Least One Item !");
            //    return;
            //}
            var sEmployeeSalaryIDs = "";
            //if(oEmployeeSalarys.length>0)
            //{
            //    for(var i =0; i<oEmployeeSalarys.length;i++)
            //    {
            //        sEmployeeSalaryIDs += oEmployeeSalarys[i].EmployeeSalaryID +",";
            //    }
            //    sEmployeeSalaryIDs = sEmployeeSalaryIDs.substring(0,sEmployeeSalaryIDs.length-1);
            //}

            SelectingColumns();
            $('#dLetterInformationDate').datebox('setValue',icsdateformat(new Date()));
            $('#winPrintBanKSheet').icsWindow('open');
            
        }

        $('#btnExcelBankSheet').click(function(e){
            BankSheet(true);//XL
        });

        function SelectingColumns()
        {
            debugger;
            var oList = new Object();
            var oLists = [];
            oList.ColumnName = "EmployeeCode";
            oList.ID = 1;
            oLists.push(oList);

            var oList = new Object();
            oList.ColumnName = "EmployeeName";
            oList.ID = 2;
            oLists.push(oList);

            var oList = new Object();
            oList.ColumnName = "DepartmentName";
            oList.ID = 3;
            oLists.push(oList);

            var oList = new Object();
            oList.ColumnName = "DesignationName";
            oList.ID = 4;
            oLists.push(oList);

            var oList = new Object();
            oList.ColumnName = "JoiningDate";
            oList.ID = 5;
            oLists.push(oList);

            var oList = new Object();
            oList.ColumnName = "AccountNo";
            oList.ID = 6;
            oLists.push(oList);
            
            var oList = new Object();
            oList.ColumnName = "Amount";
            oList.ID = 7;
            oLists.push(oList);
            
            var oList = new Object();
            oList.ColumnName = "ContactNo";
            oList.ID = 8;
            oLists.push(oList);

            DynamicRefreshList(oLists, "tblPrintColumns");
        }

        $('#btnCancel').click(function (e)
        {
            _nTempBankAccountID = 0;
            $('#txtBankAccountNo').val("");
            $('#txtBankName').val("");
            $('#txtBankBranchName').val("");
            $('#txtBankBranchAddress').val("");
            $('#winPrintCV').icsWindow('close');
            DynamicRefreshList([], "tblPrintColumns");
        });

        function CashSheet()
        {
            //var oEmployeeSalarys= $('#tblEmployeeSalary').datagrid('getChecked');
            //if(oEmployeeSalarys.length<=0)
            //{
            //    alert("Please select at least one item from the list !");
            //    return;
            //}
            //var sESID="";
            //for(var i=0; i<oEmployeeSalarys.length; i++)
            //{
            //    sESID+=oEmployeeSalarys[i].EmployeeSalaryID+",";
            //}
            //sESID=sESID.substring(0,sESID.length-1);
            //var tsv=((new Date()).getTime())/1000;
            //window.open(_sBaseAddress+ "/EmployeeSalary/PrintCashSheet?sESID="+sESID+"&ts="+tsv, "_blank");

            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintCashSheet"+S);
            }
        }

        function PrintTypeObject()
        {
            debugger;
            var oObj= new Object();
            var oItems=[];
            if(PermissionChecker('Pay_Slip_Bang','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=1;
                oObj.Item="Pay Slip(Bang)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_Slip_Eng','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=2;
                oObj.Item="Pay Slip(Eng)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_Slip_F2','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=11;
                oObj.Item="Pay Slip(F2)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_Slip_F3','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=14;
                oObj.Item="Pay Slip(F3)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_Slip_F4','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=20;
                oObj.Item="Pay Slip(F4)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_slip_F5','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=21;
                oObj.Item="Pay Slip(F5)";
                oItems.push(oObj);
            }
            
            if(PermissionChecker('Pay_Slip_F4_1','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=79;
                oObj.Item="Pay Slip(F4_1)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_Slip_F4_1_B','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=90;
                oObj.Item="Pay Slip(F4_1_B)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Pay_slip_F5_1','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=80;
                oObj.Item="Pay Slip(F5_1)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Pay_slip_F6','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=35;
                oObj.Item="Pay Slip(F6)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F1','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=3;
                oObj.Item="Salary Sheet(F1)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F2','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=4;
                oObj.Item="Salary Sheet(F2)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F3','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=5;
                oObj.Item="Salary Sheet(F3)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F4','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=6;
                oObj.Item="Salary Sheet(F4)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F5','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=15;
                oObj.Item="Salary Sheet(F5)";
                oItems.push(oObj);
            }

            if(PermissionChecker('Salary_Sheet_F6','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=17;
                oObj.Item="Salary Sheet(F6)";
                oItems.push(oObj);
            }

            if(sessionStorage.getItem('BaseAddress') != '/akcl' && sessionStorage.getItem('BaseAddress') != '/a007')
            {
                oObj= new Object();
                oObj.id=60;
                oObj.Item="Salary_Sheet_F6(Bangla)";
                oItems.push(oObj);
            }
           
            if(PermissionChecker('Bank_Sheet','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=7;
                oObj.Item="Bank Sheet";
                oItems.push(oObj);
            }
            if(PermissionChecker('Cash_Sheet','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=8;
                oObj.Item="Cash Sheet";
                oItems.push(oObj);
            }
            if(PermissionChecker('OT_Sheet_F1','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=10;
                oObj.Item="OT Sheet(F1)";
                oItems.push(oObj);
            }
            if(PermissionChecker('OT_Sheet_F2','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=13;
                oObj.Item="OT Sheet(F2)";
                oItems.push(oObj);
            }
            if(PermissionChecker('OT_Sheet_F3','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=50;
                oObj.Item="OT Sheet F3";
                oItems.push(oObj);
            }
            if(PermissionChecker('OT_Summary_F1','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=51;
                oObj.Item="OT Summary_F1";
                oItems.push(oObj);
            }
            if(PermissionChecker('OT_Summary_F2','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=52;
                oObj.Item="OT Summary_F2";
                oItems.push(oObj);
            }
            if(PermissionChecker('Salary_Summary_XL','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=12;
                oObj.Item="Salary Summary(XL)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Salary_Summary_F2','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=16;
                oObj.Item="Salary Summary(F2)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Salary_Summery_F3','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=30;
                oObj.Item="Salary Summary(F3)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Salary_Summery_F5','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=31;
                oObj.Item="Salary Summary(F5)";
                oItems.push(oObj);
            }
            if(PermissionChecker('Salary_Certificate','EmployeeSalary',_oAURolesMapping))
            {
                oObj= new Object();
                oObj.id=9;
                oObj.Item="Salary Certificate";
                oItems.push(oObj);
            }
            
            if(sessionStorage.getItem('BaseAddress') != '/akcl' && sessionStorage.getItem('BaseAddress') != '/a007')
            {
                oObj= new Object();
                oObj.id=40;
                oObj.Item="Salary_Summary_BUWise";
                oItems.push(oObj);

                oObj= new Object();
                oObj.id=33;
                oObj.Item="Salary_Summary(F4)";
                oItems.push(oObj);
            }
            
            $("#CboPrintItems").icsLoadCombo({
                List: oItems,
                OptionValue: "id",
                DisplayText: "Item"
            });
        }
        function PermissionChecker(sOperationType, sModuleName, oAURoles) {
            if (JSON.parse(sessionStorage.getItem('IsSuperUser')) === true) //check SuperUser
            {
                return true;
            }
            else {
                for (var i = 0; i < oAURoles.length; i++) {
                    if (oAURoles[i].OperationTypeST === sOperationType && oAURoles[i].ModuleNameST === sModuleName) {
                        return true;
                    }
                }
                return false;
            }
        }

        function Print()
        {
            debugger;
            var nPrintItemNo= $('#CboPrintItems').val();
            if(nPrintItemNo==0)
            {
                alert("Please select at least one print item !");
                return;
            }
            if(nPrintItemNo==1)
            {
                PrintPaySlipV1();
            }
            else if(nPrintItemNo==2)
            {
                if(document.getElementById("chkIsMultipleMonth").checked==true)
                {
                    PaySlip_DetailFormatMultiMonth();
                }
                else
                {
                    PaySlip_DetailFormat();
                }
            }
            else if(nPrintItemNo==3 || nPrintItemNo==6)
            {
                SalarySheet_Corporate(false);
            }
            else if(nPrintItemNo==4 || nPrintItemNo==5)
            {
                SalarySheet_DetailFormat();
            }
            else if(nPrintItemNo==7)
            {
                BankSheet(false);
            }
            else if(nPrintItemNo==8)
            {
                CashSheet();
            }
            else if(nPrintItemNo==9)
            {
                PrintSalaryCertificate();
            }
            else if(nPrintItemNo==10)
            {
                PrintExcelOTStatement();
            }
            else if(nPrintItemNo==50)
            {
                PrintExcelOTStatementComp();
            }
            else if(nPrintItemNo==11)
            {

                PrintPaySlip();
            }
            else if(nPrintItemNo==20)
            {
                PrintPaySlipDoubleTable();
            }
            else if(nPrintItemNo==21)
            {
                PrintPaySlipDoubleTable_Comp();
            }
            else if(nPrintItemNo==79)
            {
                PrintPaySlipDoubleTable_1();
            }
            else if(nPrintItemNo==90)
            {
                PrintPaySlipDoubleTable_1_B();
            }
            else if(nPrintItemNo==80)
            {
                PrintPaySlipDoubleTable_Comp_1();
            }
            else if(nPrintItemNo==13)
            {
                PrintOTStatement();
            }
            else if(nPrintItemNo==15)
            {
                PrintSalarySheet_F5();
            }
            else if(nPrintItemNo==51)
            {
                PrintOTSummary();
            }
            else if(nPrintItemNo==52)
            {
                PrintOTSummaryF2();
            }
            else if(nPrintItemNo==16)
            {
                PrintSalarySummary_F2();
            }
            else if(nPrintItemNo==30)
            {
                PrintSalarySummary_F3();
            }
            else if(nPrintItemNo==31)
            {
                PrintSalarySummary_F5();
            }
            else if(nPrintItemNo==33)
            {
                PrintSalarySummary_F4();
            }
            else if(nPrintItemNo==17)
            {
                PrintSalarySheet_F6();
            }
            else if(nPrintItemNo==40)
            {
                PrintSalarySummary_BUWise();
            }
            else if(nPrintItemNo==60)
            {
                PrintSalarySheetF6Bangla();
            }
        }

        function PrintSalarySheetF6Bangla()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheet_DetailFormat_F6_Bangla"+S);
            }
        }

        function PrintSalarySummary_BUWise()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySummary_BUWise"+S);
            }
        }
        function PrintSalarySummary_F2()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySummary_F2"+S);
            }
        }
       
        function ExcelExportSalarySummary_F5()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoExcelSalarySummary_F5"+S);
            }
        }

        function PrintSalarySummary_F5()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySummary_F5"+S);
            }
        }
        function PrintOTSummary()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintOTSummary"+S);
            }
        }
        function PrintOTSummaryF2()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintOTSummaryF2"+S);
            }
        }

        function PrintSalarySummary_F3()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySummary_F3"+S);
            }
        }



        $('#btnExcelSalarySummery_F2').click(function(e){
            var S=ReturnConnectionStringForController();

            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                if($('#CboPrintItems').val()==16)
                {
                    window.open(_sBaseAddress+ "/EmployeeSalary/ExcelSalarySummery_F2"+S+"&PrintFormat=2");
                }
                if($('#CboPrintItems').val()==33)
                {
                    window.open(_sBaseAddress+ "/EmployeeSalary/ExcelSalarySummery_F2"+S+"&PrintFormat=4");
                }
            }
        });

        $('#btnExcelSalarySummery_F3').click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExcelSalarySummery_F3"+S);
            }
        });

        $('#btnExcelSalarySheetF1_4').click(function(e){
            SalarySheet_Corporate(true);//XL
        });

        function PrintSalaryCertificate()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalaryCertificate"+S);
            }
        }

        function PrintExcelOTStatement()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintOTExceptCompliance"+S);
            }
        }
        function PrintExcelOTStatementComp()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintOTSheetCompliance"+S);
            }
        }

        function PrintOTStatement()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintOTCompliance"+S);
            }
        }

        $('#CboPrintItems').change(function(e){
            if($('#CboPrintItems').val()==4 || $('#CboPrintItems').val()==5){
                $('#btnExcelSalarySheet').show();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnPrint').show();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==31){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').show();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnPrint').show();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==10){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelOTStatement').show();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==35){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').show();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==11){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').show();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').show();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==12){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').show();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').show();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==3 || $('#CboPrintItems').val()==6){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').show();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').show();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==7){

                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').show();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==13){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnPrint').show();
                $('#btnExcelOTSheetF2').show();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==14){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').hide();
                $('#btnExcelPaySlip_Comp').show();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==15){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').show();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==16){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').show();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==33){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').show();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==17){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').show();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==30){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').show();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==40){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelBUWiseSalary').show();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnExcelSalarySheet_F6_Bangla').hide();
                $('#btnSalarySheet_F6_BanglaExcel').hide();
            }
            else if($('#CboPrintItems').val()==60){
                $('#btnExcelSalarySheet').hide();
                $('#btnExcelOTStatement').hide();
                $('#btnExcelSalarySheetF1_4').hide();
                $('#btnExcelSalarySummery').hide();
                $('#btnExcelBankSheet').hide();
                $('#btnPrint').show();
                $('#btnExcelBUWiseSalary').hide();
                $('#btnExcelPaySlip_Comp').hide();
                $('#btnExcelPaySlip_CompF6').hide();
                $('#btnExcelSalarySheet_F5').hide();
                $('#btnExcelSalarySummery_F5').hide();
                $('#btnExcelSalarySheet_F6').hide();
                $('#btnExcelSalarySummery_F2').hide();
                $('#btnExcelSalarySummery_F3').hide();
                $('#btnExcelOTSheetF2').hide();
                $('#btnSalarySheet_F6_BanglaExcel').show();
                //$('#btnExcelSalarySheet_F6_Bangla').show();

            }
            else{
                $('#btnExcelSalarySheet, #btnExcelOTStatement,#btnExcelSalarySummery,btnExcelSalarySheetF1_4,#btnExcelBankSheet,#btnExcelPaySlip_Comp,#btnExcelSalarySheet_F5,#btnExcelSalarySummery_F5,#btnExcelSalarySummery_F2,#btnExcelSalarySheet_F6,#btnExcelBUWiseSalary, #btnExcelOTSheetF2, #btnSalarySheet_F6_BanglaExcel').hide();
                $('#btnPrint').show();
            }
        });


        $("#btnSalarySheet_F6_BanglaExcel").click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExcelSalarySheet_DetailFormat_F6_Bangla"+S);
            }
        });


        $('#btnExcelOTSheetF2').click(function(e){

            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExcelOTSheetF2"+S);
            }
        });
        $('#btnExcelBUWiseSalary').click(function(e){

            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/BUWiseSalaryExcel"+S);
            }
        });
        $('#btnExcelSalarySheet').click(function(e){

            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoExcelSalarySheet"+S);
            }
        });

        $('#btnExcelOTStatement').click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoExcelOTExceptCompliance"+S);
            }
        });

        $('#btnExcelSalarySummery').click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/SalarySummeryXL"+S);
            }
        });

        /*----------- Salary Scheme Start-----------------------*/
        $('#txtSalaryScheme').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            var sSSName = document.getElementById("txtSalaryScheme").value;
            if (code == 13)//Enter key-13
            {
                PickerSalaryScheme(sSSName);
            }
        });
        $('#btnSalaryScheme').click(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            var sSSName ="";
            PickerSalaryScheme(sSSName);
        });
        function PickerSalaryScheme(sSSName)
        {
            var oSalaryScheme = { Name: sSSName};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oSalaryScheme,
                ControllerName: "SalaryScheme",
                ActionName: "GetsBySalarySchemeName",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].SalarySchemeID > 0) {

                        var tblColums = [];var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "NatureOfEmployeeInString", title: "Nature Of Employee", width: 140, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "PaymentCycleInString", title: "Payment Cycle", width: 140, align: "left" };tblColums.push(oColumn);
                        var oPickerParam = {
                            winid: 'winSalarySchemePicker',
                            winclass:'clsSalarySchemePicker',
                            winwidth: 520,
                            winheight: 460,
                            tableid: 'tblSalarySchemes',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Salary Scheme List'
                        };

                        $.icsPicker(oPickerParam);
                        IntializeSalarySchemePickerbutton(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }
        function IntializeSalarySchemePickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oreturnObjs = $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winSalarySchemePicker')
                {
                    if (oreturnObjs != null && oreturnObjs.length > 0)//oreturnObj.SalarySchemeID
                    {
                        var sSalarySchemeNames = "";
                        _sSalarySchemeIDs = "";
                        for(var i=0; i<oreturnObjs.length; i++)
                        {
                            sSalarySchemeNames+=oreturnObjs[i].Name+",";
                            _sSalarySchemeIDs+=oreturnObjs[i].SalarySchemeID+",";
                        }

                        sSalarySchemeNames=sSalarySchemeNames.substring(0,sSalarySchemeNames.length-1);
                        _sSalarySchemeIDs=_sSalarySchemeIDs.substring(0,_sSalarySchemeIDs.length-1);
                        $("#txtSalaryScheme").val(sSalarySchemeNames);
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();
                    }
                    else
                    {
                        alert("please check at least one item!");
                    }
                }
            });

            $(document).find('.' +oPickerobj.winclass).keydown(function (e) {
                if (e.which == 13)//enter=13
                {
                    var oreturnObjs = $('#'+oPickerobj.tableid).datagrid('getChecked');
                    if (oPickerobj.winclass == 'clsSalarySchemePicker')
                    {
                        if (oreturnObjs != null && oreturnObjs.length > 0)
                        {
                            var sSalarySchemeNames = "";
                            _sSalarySchemeIDs = "";
                            for(var i=0; i<oreturnObjs.length; i++)
                            {
                                sSalarySchemeNames+=oreturnObjs[i].Name+",";
                                _sSalarySchemeIDs+=oreturnObjs[i].SalarySchemeID+",";
                            }

                            sSalarySchemeNames=sSalarySchemeNames.substring(0,sSalarySchemeNames.length-1);
                            _sSalarySchemeIDs=_sSalarySchemeIDs.substring(0,_sSalarySchemeIDs.length-1);
                            $("#txtSalaryScheme").val(sSalarySchemeNames);
                            $("#"+oPickerobj.winid).icsWindow("close");
                            $("#" + oPickerobj.winid).remove();
                        }
                        else
                        {
                            alert("please check at least one item!");
                        }
                    }
                }
            });
        }
        $('#btnCSalaryScheme').click(function (e)
        {
            $("#txtSalaryScheme").val("");
            _sSalarySchemeIDs = "";
        });
        /*----------- Salary Scheme End-----------------------*/

        /*-------------Start Business Unit Picker----------------*/
        $("#btnBusinessUnitPicker_Collection").click(function(e){
            BusinessUnitPicker();
        });

        $("#txtBusinessUnit_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                BusinessUnitPicker();
            }
        });

        function BusinessUnitPicker()
        {
            var oBusinessUnit={
                BusinessUnitID:0
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oBusinessUnit,
                ControllerName: "BusinessUnit",
                ActionName: "GetsBusinessUnitWithPermission",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].BusinessUnitID > 0) {
                        var tblColums = [];
                        var oColumn = { field: "Code", title: "Code", width: 50, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 170, align: "left" };tblColums.push(oColumn);

                        var bmultiplereturn=true;

                        var oPickerParam = {
                            winid: 'winBusinessUnit',
                            winclass:'clsBusinessUnit',
                            winwidth: 320,
                            winheight: 400,
                            tableid: 'tblBusinessUnit',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: bmultiplereturn,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Business Unit List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeBusinessUnitPickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeBusinessUnitPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oBusinessUnits=[];
                oBusinessUnits = $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winBusinessUnit')
                {
                    if(oBusinessUnits!=null && oBusinessUnits.length>0)
                    {
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();
                        var sBusinessUnitName = "";
                        for(var i=0; i<oBusinessUnits.length; i++)
                        {
                            sBusinessUnitName+=oBusinessUnits[i].Name+",";
                            _sBusinessUnitIds+=oBusinessUnits[i].BusinessUnitID+",";
                        }

                        sBusinessUnitName=sBusinessUnitName.substring(0,sBusinessUnitName.length-1);
                        _sBusinessUnitIds=_sBusinessUnitIds.substring(0,_sBusinessUnitIds.length-1);
                        $("#txtBusinessUnit_Collection").val(sBusinessUnitName);
                    }
                    else
                    {
                        alert("Please select a Business Unit.");
                    }
                }
            });
        }

        $("#btnResetBusinessUnitPicker_Collection").click(function(e){
            $('#txtBusinessUnit_Collection').val("");
            _sBusinessUnitIds="";
        });
        /*-------------End Business Unit Picker----------------*/

        //function LoadBlock()
        //{
        //    var oBlockMachineMapping={
        //        ProductionProcessInt:0,
        //        DepartmentID:0,
        //        BlockName:""
        //    }
        //    var obj =
        //    {
        //        BaseAddress: _sBaseAddress,
        //        Object: oBlockMachineMapping,
        //        ControllerName: "BlockMachineMapping",
        //        ActionName: "BlockMachineMapping_Search",
        //        IsWinClose: false
        //    };
        //    $.icsDataGets(obj, function (response) {
        //        if (response.status && response.objs != null) {
        //            if (response.objs.length>0 && response.objs[0].BMMID > 0) {
        //                $("#cboBlock").icsLoadCombo({
        //                    List: response.objs,
        //                    OptionValue: "BMMID",
        //                    DisplayText: "BlockName",
        //                    InitialValue:"--Select Block--"
        //                });
        //            }
        //            else
        //            {
        //                $("#cboBlock").empty();
        //                $("#cboBlock").icsLoadCombo({
        //                    List: [],
        //                    OptionValue: "BMMID",
        //                    DisplayText: "BlockName",
        //                    InitialValue:"--Select Block--"
        //                });
        //            }
        //        }
        //    });
        //}

        function PrintSalarySheet_F5()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheet_DetailFormat_F5"+S);
            }
        }

        function PrintSalarySheet_F6()
        {
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/PrintSalarySheet_DetailFormat_F6"+S);
            }
        }

        $("#btnExcelSalarySheet_F5").click(function(e){
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoExcelSalarySheet_F5"+S);
            }
        });

        $("#btnExcelSalarySheet_F6").click(function(e){
            debugger;
            var S=ReturnConnectionStringForController();
            if(S=="" || S == null)
            {
                return;
            }
            else
            {
                window.open(_sBaseAddress+ "/EmployeeSalary/ExportIntoExcelSalarySheet_F6"+S);
            }
        });

        ///*------------- Start Block Picker----------------*/

        //$("#btnBlock,#btnBlock_Collection").click(function(e){
        //    BlockPicker($(this).attr("id"));
        //});

        //function BlockPicker(btnBlock)
        //{
        //    var oBlockMachineMapping={
        //        ProductionProcessInt:0,
        //        DepartmentID:0,
        //        BlockName:""
        //    }
        //    var obj = {
        //        BaseAddress: _sBaseAddress,
        //        Object: oBlockMachineMapping,
        //        ControllerName: "BlockMachineMapping",
        //        ActionName: "BlockMachineMapping_Search",
        //        IsWinClose: false
        //    };
        //    $.icsDataGets(obj, function (response) {

        //        if (response.status && response.objs.length > 0) {
        //            if (response.objs[0].BMMID > 0) {
        //                var tblColums = [];
        //                var oColumn = { field: "BlockName", title: "Block Name", width: 230, align: "left" };tblColums.push(oColumn);
        //                var bmultiplereturn=true;
        //                if(btnBlock=="btnBlock"){bmultiplereturn=false;}
        //                var oPickerParam = {
        //                    winid: 'winBlock',
        //                    winclass:'clsBlock',
        //                    winwidth: 320,
        //                    winheight: 460,
        //                    tableid: 'tblShift',
        //                    tablecolumns: tblColums,
        //                    datalist: response.objs,
        //                    multiplereturn: bmultiplereturn,
        //                    searchingbyfieldName:'BlockName',
        //                    windowTittle: 'Block List'
        //                };
        //                $.icsPicker(oPickerParam);
        //                IntializeBlockPickerbutton(oPickerParam,btnBlock);//multiplereturn, winclassName
        //            }
        //            else { alert(response.objs[0].ErrorMessage); }
        //        }
        //    });
        //}

        //function IntializeBlockPickerbutton(oPickerobj,btnBlock)
        //{
        //    $("#" + oPickerobj.winid).find("#btnOk").click(function () {
        //        var oBlocks=[];
        //        if(btnBlock=="btnBlock"){
        //            var oBlock= $('#'+oPickerobj.tableid).datagrid('getSelected');
        //            oBlocks.push(oBlock);
        //        }
        //        else
        //        {
        //            oBlocks= $('#'+oPickerobj.tableid).datagrid('getChecked');
        //        }
        //        if (oPickerobj.winid == 'winBlock')
        //        {
        //            if(oBlocks!=null && oBlocks.length>0){
        //                $("#"+oPickerobj.winid).icsWindow("close");
        //                $("#" + oPickerobj.winid).remove();

        //                for(var i=0; i<oBlocks.length; i++)
        //                {
        //                    _sBlockNames += oBlocks[i].BlockName+",";
        //                    _sBMMIDs += oBlocks[i].BMMID+",";

        //                }
        //                _sBlockNames=_sBlockNames.substring(0,_sBlockNames.length-1);
        //                _sBMMIDs=_sBMMIDs.substring(0,_sBMMIDs.length-1);
        //                if(btnBlock=="btnBlock"){$("#txtBlock").val(_sBlockNames);}else{$("#txtBlock_Collection").val(_sBlockNames);}
        //            }
        //            else
        //            {
        //                alert("Please select a Block.");
        //            }
        //        }
        //    });
        //}

        //$("#btnResetBlock,#btnResetBlock_Collection").click(function(e){
        //    $('#txtBlock').val("");
        //    $('#txtBlock_Collection').val("");
        //    _sBlockNames="";
        //    _sBMMIDs = "";
        //});

        //$("#txtBlock,#txtBlock_Collection").keypress(function(e){
        //    if (e.which == 13)
        //    {
        //        BlockPicker();
        //    }
        //});
        //    /*------------- End Block Picker----------------*/




        /*------------EmployeeGroup--------------*/

        $('#txtEmployeeGroup').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByGroup = $("#txtEmployeeGroup").val();
                var sTempName = "";
                SearchEmployeeGroup(txtSearchByGroup);
                $("#txtEmployeeGroup").val('');
            }
        });


        $("#btnEmployeeGroupPicker").click(function(e){

            $("#winGroupPicker").icsWindow("open");
            SearchEmployeeGroup("");
        });
        function SearchEmployeeGroup(name) {
            $("#txtEmployeeGroup").val("");
            _sGroupNames = "";
            _sGroupIDs = "";
            var oGroup={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oGroup,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeGroupAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        DynamicRefreshList(response.objs, "tblEmpGroup");
                        //var tblColums = [];
                        //var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        //var oPickerParam = {
                        //    winid: 'winGroup',
                        //    winclass:'clsGroup',
                        //    winwidth: 320,
                        //    winheight: 460,
                        //    tableid: 'tblGroup',
                        //    tablecolumns: tblColums,
                        //    datalist: response.objs,
                        //    multiplereturn: true,
                        //    searchingbyfieldName:'Name',
                        //    windowTittle: 'Employee Group List'
                        //};
                        //$.icsPicker(oPickerParam);
                        //IntializeGroupPickerbutton(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }


        $("#btnGroupPickerOk").click(function(e){

            var oGroups=[];
            oGroups= $('#tblEmpGroup').datagrid('getChecked');
            if(oGroups!=null && oGroups.length>0){

                $("#winGroupPicker").icsWindow("close");

                for(var i=0; i<oGroups.length; i++)
                {
                    _sGroupNames += oGroups[i].Name+",";
                    _sGroupIDs += oGroups[i].EmployeeTypeID+",";

                }
                _sGroupNames=_sGroupNames.substring(0,_sGroupNames.length-1);
                _sGroupIDs=_sGroupIDs.substring(0,_sGroupIDs.length-1);
                $("#txtEmployeeGroup").val(_sGroupNames);
            }
            else
            {
                alert("Please select a Employee Group.");
            }
        });

        $("#btnGroupPickerClose").click(function(e){

            $("#winGroupPicker").icsWindow("close");
            $('#txtEmployeeGroup').val("");
            _sGroupIDs = "";
        });

        //function IntializeGroupPickerbutton(oPickerobj)
        //{
        //    $("#" + oPickerobj.winid).find("#btnOk").click(function () {

        //        var oGroups=[];
        //        oGroups= $('#'+oPickerobj.tableid).datagrid('getChecked');
        //        if (oPickerobj.winid == 'winGroup')
        //        {
        //            if(oGroups!=null && oGroups.length>0){
        //                $("#"+oPickerobj.winid).icsWindow("close");
        //                $("#" + oPickerobj.winid).remove();

        //                for(var i=0; i<oGroups.length; i++)
        //                {
        //                    _sGroupNames += oGroups[i].Name+",";
        //                    _sGroupIDs += oGroups[i].EmployeeTypeID+",";

        //                }
        //                _sGroupNames=_sGroupNames.substring(0,_sGroupNames.length-1);
        //                _sGroupIDs=_sGroupIDs.substring(0,_sGroupIDs.length-1);
        //                $("#txtEmployeeGroup").val(_sGroupNames);
        //            }
        //            else
        //            {
        //                alert("Please select a Employee Group.");
        //            }
        //        }
        //    });
        //}

        $("#btnEmployeeGroupPickerReset").click(function(e){

            $('#txtEmployeeGroup').val("");
            _sGroupIDs = "";
        });


        /*------------EmployeeBlock--------------*/

        $('#txtEmployeeBlock').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByBlock = $("#txtEmployeeBlock").val();
                var sTempName = "";
                SearchEmployeeBlock(txtSearchByBlock);
                $("#txtEmployeeBlock").val('');
            }
        });

        $("#btnEmployeeBlockPicker").click(function(e){
            SearchEmployeeBlock("");
        });
        function SearchEmployeeBlock(name) {
            $("#txtEmployeeBlock").val("");
            _sBlockNames = "";
            _sBlockIDs = "";
            var oBlock={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oBlock,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeBlockAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winBlock',
                            winclass:'clsBlock',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblBlock',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee Block List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeBlockPickerbutton(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeBlockPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oGroups=[];
                oBlocks= $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winBlock')
                {
                    if(oBlocks!=null && oBlocks.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();
                        debugger;
                        for(var i=0; i<oBlocks.length; i++)
                        {
                            _sBlockNames += oBlocks[i].Name+",";
                            _sBlockIDs += oBlocks[i].EmployeeTypeID+",";

                        }
                        _sBlockNames=_sBlockNames.substring(0,_sBlockNames.length-1);
                        _sBlockIDs=_sBlockIDs.substring(0,_sBlockIDs.length-1);
                        $("#txtEmployeeBlock").val(_sBlockNames);
                    }
                    else
                    {
                        alert("Please select a Employee Block.");
                    }
                }
            });
        }


        $("#btnEmployeeBlockPickerReset").click(function(e){
            _sBlockNames = "";
            $('#txtEmployeeBlock').val("");
            _sBlockIDs = "";
        });




        /*------------EmployeeGroupAdv--------------*/

        $("#btnEmployeeGroupResetAdv").click(function(e){
            $("#txtEmployeeGroupAdv").val("");
            _sGroupNamesAdv = "";
            _sGroupIDsAdv = "";
        });

        $('#txtEmployeeGroupAdv').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByGroup = $("#txtEmployeeGroupAdv").val();
                var sTempName = "";
                SearchEmployeeGroupAdv(txtSearchByGroup);
                $("#txtEmployeeGroupAdv").val('');
            }
        });


        $("#btnEmployeeGroupPickerAdv").click(function(e){
            SearchEmployeeGroupAdv("");
        });
        function SearchEmployeeGroupAdv(name) {
            $("#txtEmployeeGroupAdv").val("");
            _sGroupNamesAdv = "";
            _sGroupIDsAdv = "";
            var oGroup={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oGroup,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeGroupAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winGroup',
                            winclass:'clsGroup',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblGroup',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee Group List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeGroupPickerbuttonAdv(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeGroupPickerbuttonAdv(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oGroups=[];
                oGroups= $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winGroup')
                {
                    if(oGroups!=null && oGroups.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oGroups.length; i++)
                        {
                            _sGroupNamesAdv += oGroups[i].Name+",";
                            _sGroupIDsAdv += oGroups[i].EmployeeTypeID+",";

                        }
                        _sGroupNamesAdv=_sGroupNamesAdv.substring(0,_sGroupNamesAdv.length-1);
                        _sGroupIDsAdv=_sGroupIDsAdv.substring(0,_sGroupIDsAdv.length-1);
                        $("#txtEmployeeGroupAdv").val(_sGroupNamesAdv);
                    }
                    else
                    {
                        alert("Please select a Employee Group.");
                    }
                }
            });
        }


        /*------------EmployeeBlockAdv--------------*/

        $('#txtEmployeeBlockAdv').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByBlock = $("#txtEmployeeBlockAdv").val();
                var sTempName = "";
                SearchEmployeeBlockAdv(txtSearchByBlock);
                $("#txtEmployeeBlockAdv").val('');
            }
        });

        $("#btnEmployeeBlockPickerAdv").click(function(e){
            SearchEmployeeBlockAdv("");
        });
        function SearchEmployeeBlockAdv(name) {
            $("#txtEmployeeBlockAdv").val("");
            _sBlockNamesAdv = "";
            _sBlockIDsAdv = "";
            var oBlock={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oBlock,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeBlockAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winBlock',
                            winclass:'clsBlock',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblBlock',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee Block List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeBlockPickerbuttonAdv(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeBlockPickerbuttonAdv(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oGroups=[];
                oBlocks= $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winBlock')
                {
                    if(oBlocks!=null && oBlocks.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oBlocks.length; i++)
                        {
                            _sBlockNamesAdv += oBlocks[i].Name+",";
                            _sBlockIDsAdv += oBlocks[i].EmployeeTypeID+",";

                        }
                        _sBlockNamesAdv=_sBlockNamesAdv.substring(0,_sBlockNamesAdv.length-1);
                        _sBlockIDsAdv=_sBlockIDsAdv.substring(0,_sBlockIDsAdv.length-1);
                        $("#txtEmployeeBlockAdv").val(_sBlockNamesAdv);
                    }
                    else
                    {
                        alert("Please select a Employee Block.");
                    }
                }
            });
        }


        $("#btnEmployeeBlockResetAdv").click(function(e){
            debugger;
            _sBlockNamesAdv = "";
            $('#txtEmployeeBlockAdv').val("");
            _sBlockIDsAdv = "";
        });

        //----------------------------Bank Account------------------------------------
        $('#txtBankAccountNo').keypress(function (e)
        {
            debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            var sSSName = document.getElementById("txtBankAccountNo").value;
            if (code == 13)//Enter key-13
            {
                PickerBankAccount(sSSName);
            }
        });
        $('#btnBancAccountPick').click(function (e)
        {
            debugger;
            var sSSName ="";
            PickerBankAccount(sSSName);
        });
        function PickerBankAccount(sSSName)
        {
            debugger;
            var oBankAccount = {
                AccountNo : sSSName
            };
            debugger;
            var obj = {
                BaseAddress:_sBaseAddress,
                Object: (oBankAccount) ,
                ControllerName: "BankAccount", //Product
                ActionName: "Gets",//SearchByProductBUWise
                IsWinClose: false
            };
            var tblColums = []; 
            var oColumn = { field: "AccountNo", title: "Account No", width: 250, align: "left" }; tblColums.push(oColumn);
            oColumn = { field: "AccountName", title: "Account Name", width: 150, align: "left" }; tblColums.push(oColumn);
            oColumn = { field: "BankName", title: "Bank Name", width: 150, align: "left" }; tblColums.push(oColumn);
            oColumn = { field: "BranchName", title: "Branch Name", width: 150, align: "left" }; tblColums.push(oColumn);
            DynamicPiker('Bank',obj,tblColums,false,'AccountNo','BankAccountID',720); //pickerName(unique),obj,table,multiReturn,SearchingField, pkID
        }
        function DynamicPiker(pickerName,obj,pTblColums,pMultiReturn,pSearchField,pID,nWidth)
        {
            debugger;
            $.icsDataGets(obj, function (response) {
                debugger;
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0][pID] > 0) {
                        debugger;
                        var tblColums = pTblColums;
                        var oPickerParam = {
                            winid: 'win'+pickerName,
                            winclass: 'cls'+pickerName,
                            winwidth: nWidth,
                            winheight: 460,
                            tableid: 'tbl'+pickerName+'s',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: false,
                            searchingbyfieldName: pSearchField,
                            windowTittle: pickerName+' List',
                            colsable:true
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbuttonBankAccount(oPickerParam);
                    }
                    else {
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else{
                    alert("Data Not Found.");
                    return;
                }
            });
        }
        function IntializePickerbuttonBankAccount(oPickerobj) {
            debugger;
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                debugger;
                //for Single Select
                SetPickerValueAssignBankAccount(oPickerobj);
            });
            $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
                if (e.which == 13)//enter=13
                {
                    SetPickerValueAssignBankAccount(oPickerobj);
                }
            });
        }
        function SetPickerValueAssignBankAccount(oPickerobj)
        {
            debugger;
            var oResult;
            if (oPickerobj.multiplereturn)
            {
                oResult = $('#'+oPickerobj.tableid).datagrid('getChecked');
            }
            else
            {
                oResult = $('#'+oPickerobj.tableid).datagrid('getSelected');
            }

            if (oPickerobj.winid == 'winBank')
            {
                SetAccount(oResult);
            }
            $("#" + oPickerobj.winid).icsWindow("close");
            $("#" + oPickerobj.winid).remove();
        }
        function SetAccount(oSelectedStyle) {
            debugger;
            _nTempBankAccountID = oSelectedStyle.BankAccountID;
            $('#txtBankAccountNo').val(oSelectedStyle.AccountNo);
            $('#txtBankName').val(oSelectedStyle.BankName);
            $('#txtBankBranchName').val(oSelectedStyle.BranchName);
            $('#txtBankBranchAddress').val("");
        }
        $('#btnBankAccountCancel').click(function (e)
        {
            _nTempBankAccountID = 0;
            $('#txtBankAccountNo').val("");
            $('#txtBankName').val("");
            $('#txtBankBranchName').val("");
            $('#txtBankBranchAddress').val("");
        });
        $('#btnCSalaryScheme').click(function (e)
        {
            $("#txtSalaryScheme").val("");
            _sSalarySchemeIDs = "";
        });


    </script>
