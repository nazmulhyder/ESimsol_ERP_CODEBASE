@model IEnumerable<ESimSol.BusinessObjects.OrderRecap>
@{
    ViewBag.Title = "Order Recap List";
}
<body>
    <div id="winApprovalRequest" class="easyui-window" title="Request For Approval" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="font-family:Tahoma">
            <fieldset style="margin-top:3px">
                <table border="0" style="font-size:12px">
                    <tr>
                        <td style="width:150px; text-align:right">Request To:</td>
                        <td style="width:250px; text-align:left"><select id="cboApprovalRequestTo" style="width:225px;font-size:12px;" /></td>
                    </tr>
                    <tr>
                        <td style="width:150px; text-align:right">Note :</td>
                        <td style="width:250px; text-align:left">
                            <input type="text" id="txtApprovalRequestNote" style="width:220px" />
                        </td>
                    </tr>
                </table>
            </fieldset>

            <fieldset style="margin-bottom:3px">
                <legend style="font-weight:bold"> Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; width:400px">
                    <tr>
                        <td style="width:300px; text-align:right"></td>
                        <td style="width:50px">
                            <a id="btnApprovalRequestConfirm" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Confirm</a>
                        </td>
                        <td style="width:50px">
                            <a id="btnApprovalRequestClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>
    <div id="winReviseRequest" class="easyui-window" title="Request For Revise" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="font-family:Tahoma">
            <fieldset style="margin-top:3px">
                <table border="0" style="font-size:12px">
                    <tr>
                        <td style="width:150px; text-align:right">Request To:</td>
                        <td style="width:250px; text-align:left"><select id="cboReviseRequestTo" style="width:225px;font-size:12px;" /></td>
                    </tr>
                    <tr>
                        <td style="width:150px; text-align:right">Note :</td>
                        <td style="width:250px; text-align:left">
                            <input type="text" id="txtReviseRequestNote" style="width:220px" />
                        </td>
                    </tr>
                </table>
            </fieldset>

            <fieldset style="margin-bottom:3px">
                <legend style="font-weight:bold"> Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; width:400px">
                    <tr>
                        <td style="width:300px; text-align:right"></td>
                        <td style="width:50px">
                            <a id="btnReviseRequestConfirm" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Confirm</a>
                        </td>
                        <td style="width:50px">
                            <a id="btnReviseRequestClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>

    <div id="winOrderRecapComment" class="easyui-window" title="Sample Order History for Order No : SAM-125545/2016, Buyer : “Mr. Kamal Hossain”, Article Number : 45212/12" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="height: 250px; width:100%">
            <table id="tblOrderRecapComment" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false" toolbar="#toolbarOrderRecapComment">
                <thead>
                    <tr>
                        <th field="CommentsBy" width="60">Comments By</th>
                        <th field="CommentsText" width="400">Comments</th>
                    </tr>
                </thead>
            </table>
            <div id="toolbarOrderRecapComment">                
                <input type="text" id="txtOrderRecapWriteComments" placeholder="Write Comments" style="width:550px" />
                <a id="btnAddOrderRecapComment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
                <a id="btnEditOrderRecapComment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                <a id="btnRemoveOrderRecapComment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove</a>
                <a id="btnPrintListOrderRecapComment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print List</a>
            </div>


        </div>

        <fieldset style="font-family:Tahoma">
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px;width:100%; font-weight:bold;font-size:12">
                <tr>
                    <td style="width:250px; text-align:right"></td>
                    <td style="width:60px;font-size:13;text-align:right"><a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true" onclick="CloseComment()">Close</a></td>
                </tr>
            </table>
        </fieldset>
    </div>

    <div id="winOrderRecapAdvanceSearch" class="easyui-window winClass" title="Advance Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
    <div style="width:760px; float: left;">
        <table border="0" cellpadding="0" cellspacing="0">
            <tr style="height:445px">
                <td style="width:850px">
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tr style="height:445px">
                            <td style="width:300px; vertical-align:top;height:300px">
                                <fieldset>
                                    <legend style="font-weight:bold; font-size:12px"> Searching Criteria : </legend>
                                    <table border="0" cellpadding="0" cellspacing="2">
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Order Recap No:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:350px">
                                                @Html.TextBox("txtOrderRecapNo", "", new { style = "width: 325px", id = "txtOrderRecapNo" })
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Style No:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:350px">
                                                @Html.TextBox("txtStyle", "", new { style = "width: 325px", id = "txtStyle", placeholder = "Type Style No & Press Enter" })
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Buyer Name:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                @Html.TextBox("txtBuyer", "", new { style = "width: 260px;font-size:12px;", id = "txtBuyer", placeholder = " Type Buyer & Press Enter" }) <input type="button" id="btnBuyerPicker" style="width:60px;" onclick="BuyerPiker()" value="Pick" />

                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Brand:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                <select id="cboBrand" style="width:300px;"></select>

                                            </td>
                                        </tr>

                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Factory:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                @Html.TextBox("txtFactory", "", new { style = "width: 260px;font-size:12px;", id = "txtFactory", placeholder = "Type Factory & Press Enter" }) <input type="button" style="width:60px;" onclick="FactoryPiker()" value="Pick" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Input Date:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px">
                                                <table border="0" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td style="width:97px;font-size:12px;">@Html.DropDownList("cboOrderIssueDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboOrderIssueDate", style = "width: 97px;font-size:12px;", @class = "_select_changeB" })</td>
                                                        <td style="width:97px;font-size:12px;"><input type="text" id="txtStartIssueDate" value="" style="width: 102px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                        <td style="width:9px;font-size:12px;" id="enddateIsue">To</td>
                                                        <td style="width:97px;font-size:12px;" id="enddateIssueEnd"><input type="text" id="txtEndIssueDate" value="" style="width: 102px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>


                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Order Date:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px">
                                                <table border="0" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td style="width:97px;font-size:12px;">@Html.DropDownList("cboOrderCreateDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboOrderCreateDate", style = "width: 97px;font-size:12px;", @class = "_select_changeA" })</td>
                                                        <td style="width:97px;font-size:12px;"><input type="text" id="txtOpenOrderCreateDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                        <td style="width:9px;font-size:12px;" id="enddateT">To</td>
                                                        <td style="width:97px;font-size:12px;" id="enddate"><input type="text" id="txtOrderCreateEndDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Shipment Date:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px">
                                                <table bshipment="0" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td style="width:97px;font-size:12px;">@Html.DropDownList("cboShipmentCreateDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboShipmentCreateDate", style = "width: 97px;font-size:12px;", @class = "_select_changeC" })</td>
                                                        <td style="width:97px;font-size:12px;"><input type="text" id="txtOpenShipmentCreateDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                        <td style="width:9px;font-size:12px;" id="enddateTS">To</td>
                                                        <td style="width:97px;font-size:12px;" id="enddateS"><input type="text" id="txtShipmentCreateEndDate" value="" style="width: 108px;font-size:12px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Product Catagory :
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                @Html.TextBox("txtProductCategoryName", "", new { style = "width: 242px", id = "txtProductCategoryName", disabled = "disabled" })<input type="button" style="width: 23px; font-size: 12px" onclick="ClenProductCatagory()"
                                                                                                                                                                                        value="C" /><input type="button" style="width: 60px; font-size: 12px" onclick="ProductCatagoryPicker()"
                                                                                                                                                                                                           value="Pick" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width: 130px; text-align: left;font-size:12px;">
                                                Session:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width: 325px; text-align: left">
                                                <select id="cboSession" style=" width:320px;"></select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                Merchandiser:
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width:300px;font-size:12px;">
                                                @Html.TextBox("txtMerchandiser", "", new { style = "width: 260px;font-size:12px;", id = "txtMerchandiser", placeholder = "Type Merchandiser & Press Enter" }) <input type="button" style="width:60px;" onclick="MerchandiserPiker()" value="Pick" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <input type="checkbox" name="chkApproved" id="chkApproved" /><label style="width:130px;font-size:12px;" onclick="IsChecked()">Approved</label>
                                                <input type="checkbox" name="chkNotApproved" id="chkNotApproved" /><label style="width:140px;font-size:12px;" onclick="IsChecked()">Not Approved</label>
                                                <input type="checkbox" style="font-weight:bold; color:green; text-align:right;" id="chkIsrunning"><label id="lblRunning" style="font-weight:bold; color:green; font-size:12px;"> Running</label>
                                            </td>
                                        </tr>
                                        <tr style="height:20px; vertical-align:bottom">
                                            <td style=" text-align:left; width:330px;">
                                                <table border="0" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td style=" text-align:left;"><input type="button" value="Reset" id="btnReset" style="width:70px; text-align:left;" /></td>
                                                        <td style=" text-align:right; width:260px;"><input type="button" value="Search" id="btnRefresh" style="width:70px; text-align:right;" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </fieldset>
                            </td>
                            <td style="width:400px; vertical-align:top">
                                <div style="margin-left:0px; margin-top:6px; height:535px">
                                    <table id="tblOrderRecapsList" title="Order Recap List" class="easyui-datagrid" style="width:400px;height:540px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" , autorowheight="false">
                                        <thead>
                                            <tr>
                                                <th data-options="field:'Selected',checkbox:true"></th>
                                                <th field="SLNo" width="80">Recap No</th>
                                                <th field="OrderRecapNo" width="80">Order No</th>
                                                <th field="StyleNo" width="80">Style No</th>
                                                <th field="OrderDateInString" width="70">Order Date</th>
                                                <th field="BuyerName" width="100">Buyer Name</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </td>

                        </tr>
                    </table>
                </td>
            </tr>
            <tr style="height:50px">
                <td style="width:850px; text-align:right">
                    <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true" onclick="Close()">Close</a>
                </td>
            </tr>
        </table>
    </div>
</div>

<div class="menuMainCollectionTable" id="divOrderRecap">
    <table id="tblOrderRecap" title="Order Recap List" class="easyui-datagrid" fit="true"  rownumbers="true" pagination="true" singleselect="true" autorowheight="false" toolbar="#toolbar" data-options="resizable:true">
        <thead data-options="frozen:true">
            <tr>
                <th field="SLNo" width="60" align="left"> Recap No</th>
                <th field="SessionName" width="80" align="left">Session</th>
                <th field="OrderRecapNo" width="80" align="left">Order No</th>
                <th field="StyleNo" width="100" align="left" resizable="true">Style No</th>
                <th field="PAMNo" width="70" align="left" resizable="true">PAM No</th>
            </tr>
        </thead>
        <thead>
            <tr>                         
                <th field="OrderRecapStatusInString" width="100" align="left">Status</th>
                <th field="BuyerName" width="120" align="left">Buyer Name</th>
                <th field="BrandName" width="100" align="left">Brand Name</th>
                <th field="OrderDateForViewInString" width="80" align="right">Order Date</th>
                <th field="ShipmentDateInString" width="80" align="right">Shipment Date</th>
                <th field="ProductionPlanDateInString" width="80" align="center">Plan Date</th>
                <th field="TAPIssueDateInString" width="80" align="center">TAP Issue Date</th>
                <th field="MerchandiserName" width="100" align="left">Merchandiser</th>
                <th field="ApproveByName" width="100" align="left">Approved</th>
                <th field="TotalQuantity" width="100" formatter="formatPrice" align="right">Quantity</th>
                <th field="Amount" width="100" align="right" formatter="formatPrice">Amount</th>
                <th field="IsActiveInString" width="80" align="center">Is-Active</th>
                <th field="IsShippedOutSt" width="80" align="center">Shipped Out</th>
                <th field="IsORExistInPlanSt" width="80" align="center">Plan Exist</th>
                <th field="NumberOfPackingPolicyCountInString" width="80" formatter="formatAttachment" align="center">Attachment</th>
            </tr>
        </thead>
    </table>

    <div id="toolbar">
        <input type="text" id="txtStyleNo" placeholder="Type Style No & Press Enter" style="width: 150px;" />
        <input type="text" id="txtRecapNo" placeholder="Type recap no & Press Enter" style="width: 150px; " />
        <a id="btnSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true" onclick="Search()">Search</a>
        <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true" onclick="Add()">Add</a>
        <a id="btnEdit" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="Edit()">Edit</a>
        <a id="btnUpdateInfo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Update Info</a>
        <a id="btnView" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true" onclick="View()">View</a>
        <a id="btnCreateShipmentSchedule" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true" onclick="CreateShipmentSchedule()">Create Schedule</a>
        <a id="btnCopy" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-copy" plain="true" onclick="Copy()">Copy</a>
        <a id="btnDelete" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true" onclick="Delete()">Delete</a>
        <a id="btnReqForApprove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-redo" plain="true">Req For App</a>
        <a id="btnUndoReq" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true" onclick="UndoRequest()">Undo Req</a>
        <a id="btnWaitforApproval" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-waitforapproval" plain="true" onclick="WaitForApproval()"> Wait For App</a>
        <a id="btnApprove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-approved" plain="true" onclick="Approve()">Approve</a>
        <a id="btnUndoApprove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true" onclick="UndoApprove()">Undo App</a>
        <a id="btnReqForRevise" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-redo" plain="true" >Req For Revise</a>
        <a id="btnAcceptRevise" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-approved" plain="true" onclick="AcceptRevise()">Accept Revise</a>
        <a id="btnReviseHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-redo" plain="true" onclick="ReviseHistory()">Revise History</a>
        <a id="btnPackingPolicy" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-attachment" plain="true" onclick="PackingPolicy(false,0,'')">Attachment</a>
        <a id="btnWaitforRevise" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true" onclick="WaitForRevise()"> Wait For Revise</a>
        <a id="btnProductionPlan" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true" onclick="ProductionPlan()">Production Plan</a>
        <a id="btnIsActive" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Active/InActive</a>
        <a id="btnPrintPreview" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" onclick="PrintPreview()">Order Sheet</a>
        <a id="btnPrintListToExcel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" onclick="PrintExcel()">Export to Excel</a>
        <a id="btnPrintList" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" onclick="PrintList()">Print List</a>
        <a id="btnORSPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true"><label id="lblORSPrint">ORS Print</label></a>
        <a id="btnFollowUp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Follow Up</a>
        <a id="btnBarCodePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" onclick="BarCodePrint()">Bar Code</a>
        <a id="btnOrderRecapComment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Comments</a>
        <a id="btnBillOfMaterial" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Material</a>
        <a id="btnShippedUnShipped" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Shipped/Un-Shipped</a>
        <a id="btnPreviewCutOff" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview Cut Off</a>
        
    </div>
</div>
</body>
<script type="text/javascript">
    var _sBaseAddress="";
    var _oAuthorizationRolesMapping = [];
    $(document).ready(function () {
        var nOrderType = parseInt(@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(TempData["OT"])));
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oOrderRecaps =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oAuthorizationRolesMapping =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
        var oBusinessSessions=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessSessions));
        var oBrands = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Brands));
        var nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        $('#divOrderRecap').data('OrderRecaps',oOrderRecaps);
        $('#divOrderRecap').data('BusinessSessions',oBusinessSessions);
        $('#divOrderRecap').data('Brands',oBrands);
        $('#divOrderRecap').data('BuyerIDs',"");
        $('#divOrderRecap').data('FactoryIDs',"");
        $('#divOrderRecap').data('MerchandiserIDs',"");
        $('#divOrderRecap').data('ProductCatagoryID',0);
        sessionStorage.setItem("BUID",nBUID);
        sessionStorage.setItem("OrderType",nOrderType);
        var oTempOrderRecaps =sessionStorage.getItem("OrderRecaps");
        if(oTempOrderRecaps!=null)
        {
            oTempOrderRecaps = jQuery.parseJSON(oTempOrderRecaps);
        }
        else
        {
            oTempOrderRecaps=oOrderRecaps;
        }
        RefreshList(oTempOrderRecaps);
        RefreshControlLayout();
        //$('#tblOrderRecapComment').datagrid({onSelect: function(index,row){ RowSelect(index,row);}});
    });

    //Attachment Count start
    function formatAttachment(value)
    {
        debugger
        var values;
        var nOrderRecapID=0;
        var nAttachmentCount=0;
        var sRecapNo = '';
        if(value!=undefined)
        {
            values=value.split("~");
            nOrderRecapID=values[0];
            nAttachmentCount=values[1];
            sRecapNo = values[2];
        }
        var s = '<a  href="javascript:void(0)"  onclick = "PackingPolicy(true,'+nOrderRecapID+','+sRecapNo+')"">'+nAttachmentCount+'</a>';
        return s;
    }
    //Attachmet count End

    //Advance Search Start
    //Search Property
    $("#btnSearch").click(function () {

        $("#winOrderRecapAdvanceSearch").icsWindow('open', "Advance Search");
        $("#winOrderRecapAdvanceSearch input").not("input[type='button']").val("");
        $("#winOrderRecapAdvanceSearch select").val(0);
        SetTodayDate();

        $("#cboSession").icsLoadCombo({ List: $('#divOrderRecap').data('BusinessSessions'), OptionValue: "BusinessSessionID", DisplayText: "SessionName" });
        $("#cboBrand").icsLoadCombo({ List: $('#divOrderRecap').data('Brands'), OptionValue: "BrandID", DisplayText: "BrandName" });
    });
    function SetTodayDate()
    {
        $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));

        $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));

        $('#txtOpenShipmentCreateDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtShipmentCreateEndDate').datebox('setValue', icsdateformat(new Date()));
    }
    $('._select_changeA').change(function () {
        //
        var x = $("#cboOrderCreateDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddate").style.display = 'none';
            document.getElementById("enddateT").style.display = 'none';
        }
        else {
            document.getElementById("enddate").style.display = '';
            document.getElementById("enddateT").style.display = '';
        }
        if (x == "None")
        {

            $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));
        }
    });

    $('._select_changeB').change(function () {
        //
        var x = $("#cboOrderIssueDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddateIssueEnd").style.display = 'none';
            document.getElementById("enddateIsue").style.display = 'none';
        }
        else {
            document.getElementById("enddateIsue").style.display = '';
            document.getElementById("enddateIssueEnd").style.display = '';
        }
        if (x == "None")
        {

            $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));
        }
    });
    $('._select_changeC').change(function () {
        //
        var x = $("#cboShipmentCreateDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddateTS").style.display = 'none';
            document.getElementById("enddateS").style.display = 'none';
        }
        else {
            document.getElementById("enddateS").style.display = '';
            document.getElementById("enddateTS").style.display = '';
        }
        if (x == "None")
        {

            $('#txtOpenShipmentCreateDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtShipmentCreateEndDate').datebox('setValue', icsdateformat(new Date()));
        }
    });

    //Pick Buyer
    $("#txtBuyer").keydown(function (e) {

        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            if($.trim($('#txtBuyer').val())==null || $.trim($('#txtBuyer').val())=="")
            {
                alert("Type Buyer and Press Enter.");
                return;
            }
            GetBuyers();
        }else if (code == 8) //backspace=8
        {
            //
            var txtBuyer = document.getElementById("txtBuyer");
            txtBuyer.style.color = "black";
            txtBuyer.style.fontWeight = "normal";
            _nBuyerIDs = "";

        }
    });
    $("#btnBuyerPicker").click(function () {
        GetBuyers();
    });
    function GetBuyers()
    {
        var oContractor = { Params: 2 + '~' + $.trim($('#txtBuyer').val())+'~'+sessionStorage.getItem("BUID")};
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oContractor,
            ControllerName: "Contractor",
            ActionName: "ContractorSearchByNameType",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {

            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ContractorID > 0) {

                    var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 150, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ContractorTypeInString", title: "Type", width: 150, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winBuyers',
                        winclass: 'clsBuyer',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblBuyers',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Buyer List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }
        });
    }

    //Factory
    // Search By Factory Start
    $("#txtFactory").keydown(function (e) {

        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            var oContractor = { Params: 3 + '~' + $('#txtFactory').val() };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oContractor,
                ControllerName: "Contractor",
                ActionName: "ContractorSearchByNameType",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].ContractorID > 0) {

                        var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 150, align: "left" }; tblColums.push(oColumn);
                        oColumn = { field: "ContractorTypeInString", title: "Type", width: 150, align: "left" }; tblColums.push(oColumn);
                        var oPickerParam = {
                            winid: 'winFactorys',
                            winclass: 'clsFactory',
                            winwidth: 600,
                            winheight: 460,
                            tableid: 'tblFactorys',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName: 'Name',
                            windowTittle: 'Factory List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }
    });
    function FactoryPiker(){
        //
        var oContractor = { Params: 3+'~' };
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oContractor,
            ControllerName: "Contractor",
            ActionName: "ContractorSearchByNameType",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {

            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ContractorID > 0) {

                    var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 150, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ContractorTypeInString", title: "Type", width: 150, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winFactorys',
                        winclass: 'clsFactory',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblFactorys',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Factory List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }
        });
    }
    $('#txtFactory').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            var txtFactory=document.getElementById("txtFactory");
            txtFactory.style.color="black";
            txtFactory.style.fontWeight="normal";
            $('#divOrderRecap').data('FactoryIDs',"");
        }
    });

    // Search By Merchandiser Start
    $("#txtMerchandiser").keydown(function (e) {

        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            var oEmployee = { Name: $('#txtMerchandiser').val(),EmployeeTypeID:23};//EnumEmployeeType:23-Merchandiser
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oEmployee,
                ControllerName: "Employee",
                ActionName: "EmployeeSearchByName",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeID > 0) {

                        var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 300, align: "left" }; tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winMerchandisers',
                            winclass: 'clsMerchandiser',
                            winwidth: 600,
                            winheight: 460,
                            tableid: 'tblMerchandisers',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName: 'Name',
                            windowTittle: 'Merchandiser List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }else
                {
                    alert("Data Not Found.");
                }
            });
        }
    });
    function MerchandiserPiker(){
        //
        var oEmployee = {EmployeeTypeID:23};//EnumEmployeeType:23-Merchandiser
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oEmployee,
            ControllerName: "Employee",
            ActionName: "EmployeeSearchByName",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {

            if (response.status && response.objs.length > 0) {
                if (response.objs[0].EmployeeID > 0) {

                    var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 150, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winMerchandisers',
                        winclass: 'clsMerchandiser',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblMerchandisers',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Merchandiser List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }else
            {
                alert("Data Not Found.");
            }
        });
    }
    $('#txtMerchandiser').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            //
            var txtMerchandiser=document.getElementById("txtMerchandiser");
            txtMerchandiser.style.color="black";
            txtMerchandiser.style.fontWeight="normal";
            $('#divOrderRecap').data('MerchandiserIDs',"");
        }
    });
    //Merchandiser Search End


    //Product Category
    $("#btnPickProductCategory").click(function () {
        var oProductCategory = { ParentCategoryID:3 };
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oProductCategory,
            ControllerName: "ProductCategory",
            ActionName: "GetProductCategoryByParentID",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {

            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ProductCategoryID > 0) {
                    var tblColums = []; var oColumn = { field: "ProductCategoryName", title: "Product Categor yName", width: 250, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winProductCategory',
                        winclass: 'clsProductCategory',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblProductCategory',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'ProductCategoryName',
                        windowTittle: 'Product Category List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }
        });

    });

    $('#chkApproved').click(function(){
        if (this.checked) {
            document.getElementById("chkNotApproved").checked = false;
        }
    });
    $('#chkNotApproved').click(function(){
        if (this.checked) {
            document.getElementById("chkApproved").checked = false;
        }
    });

    $('#btnRefresh').click(function () {

        var cboOrderCreateDate = document.getElementById("cboOrderCreateDate");
        var nOrderCreateDate=cboOrderCreateDate.options[cboOrderCreateDate.selectedIndex].index;

        var cboOrderIssueDate = document.getElementById("cboOrderIssueDate");
        var ncboOrderIssueDate=cboOrderIssueDate.options[cboOrderIssueDate.selectedIndex].index;

        var cboShipmentCreateDate = document.getElementById("cboShipmentCreateDate");
        var ncboShipmentDate=cboShipmentCreateDate.options[cboShipmentCreateDate.selectedIndex].index;

        var sStyleNo= $("#txtStyle").val();
        var sOrderRecapNo= $("#txtOrderRecapNo").val();

        var sSOCDs=$('#txtOpenOrderCreateDate').datebox('getValue');
        var sSOCDe=$('#txtOrderCreateEndDate').datebox('getValue');

        var dIssuStarteDates=$('#txtStartIssueDate').datebox('getValue');
        var dIssueEndDate=$('#txtEndIssueDate').datebox('getValue');

        var dShipmentStarteDate=$('#txtOpenShipmentCreateDate').datebox('getValue');
        var dShipmentEndDate=$('#txtShipmentCreateEndDate').datebox('getValue');

        /*Business Session */
        var nSessionID= parseInt($('#cboSession').val());
        var nBrandID =  $('#cboBrand').val();

        var nApproved = 0;
        var nNotApproved = 0;var bIsRunning = false;
        if(document.getElementById("chkApproved").checked == true)
        {
            nApproved = 1;
        }
        else
        {
            nApproved = 0;
        }
        if(document.getElementById("chkNotApproved").checked == true)
        {
            nNotApproved = 1;
        }
        else
        {
            nNotApproved = 0;
        }
        //Running
        if(document.getElementById("chkIsrunning").checked == true)
        {
            bIsRunning = true;
        }
        if(nOrderCreateDate==0 &&  ncboOrderIssueDate ==0 && ncboShipmentDate ==0 && parseInt($('#divOrderRecap').data('ProductCatagoryID'))== 0 && sStyleNo=="" && sOrderRecapNo=="" && $('#divOrderRecap').data('BuyerIDs')=="" && $('#divOrderRecap').data('FactoryIDs')=="" && $('#divOrderRecap').data('MerchandiserIDs')=="" && nApproved==0 && nNotApproved==0 && nSessionID==0 && nBrandID==0 && bIsRunning==false)
        {
            alert('Please Select a Search Criteria');
            return false;
        }

        var sTempString = nOrderCreateDate+'~'+sSOCDs+'~'+sSOCDe+'~'+ncboOrderIssueDate+'~'+dIssuStarteDates+'~'+ dIssueEndDate+'~' +sStyleNo+'~'+$('#divOrderRecap').data('BuyerIDs')+'~'+$('#divOrderRecap').data('MerchandiserIDs')+'~'+sOrderRecapNo+'~'+nApproved+'~'+nNotApproved+'~'+$('#divOrderRecap').data('ProductCatagoryID')+'~'+nSessionID+'~'+$('#divOrderRecap').data('FactoryIDs')+'~'+sessionStorage.getItem("OrderType")+'~'+nBrandID+'~'+ncboShipmentDate+'~'+dShipmentStarteDate+'~'+dShipmentEndDate+'~'+bIsRunning+'~'+sessionStorage.getItem("BUID");
            $.ajax({
                type: "GET",
                dataType: "json",
                url: '@Url.Action("Gets", "OrderRecap")',
            data: { Temp: sTempString },
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                ////
                oOrderRecap = jQuery.parseJSON(data);
                if (oOrderRecap != null) {
                    if(oOrderRecap.length>0)
                    {
                        data =oOrderRecap;
                        data={"total":""+data.length+"","rows":data};
                        $('#tblOrderRecapsList').datagrid('loadData',data);
                        $('#tblOrderRecapsList').datagrid({selectOnCheck:false, checkOnSelect:false})

                    }
                    else
                    {
                        alert("Data not found!!");
                        data =oOrderRecap;
                        data={"total":""+data.length+"","rows":data};
                        $('#tblOrderRecapsList').datagrid('loadData',data);
                    }
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });

    });

    $('#btnReset').click(function () {



        var txtStyle=document.getElementById("txtStyle");
        txtStyle.style.color="black";
        txtStyle.style.fontWeight="normal";
        txtStyle.value = "";
        $("#txtOrderRecapNo").val('');

        document.getElementById("enddate").style.display = '';
        document.getElementById("enddateT").style.display = '';

        document.getElementById("enddateIsue").style.display = '';
        document.getElementById("enddateIssueEnd").style.display = '';

        document.getElementById("chkNotApproved").checked = false;
        document.getElementById("chkApproved").checked = false;
        document.getElementById("chkIsrunning").checked = false;
        document.getElementById('txtProductCategoryName').value = "";
        $('#divOrderRecap').data('ProductCatagoryID',0);
        $('#cboOrderCreateDate').val('None');
        $('#txtOpenOrderCreateDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtOrderCreateEndDate').datebox('setValue', icsdateformat(new Date()));

        $('#cboOrderIssueDate').val('None');
        $('#txtStartIssueDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtEndIssueDate').datebox('setValue', icsdateformat(new Date()));
        $('#cboBrand').val(0);

        data ="";
        data={"total":""+data.length+"","rows":data};
        $('#tblOrderRecapsList').datagrid('loadData',data);

        var txtFactory=document.getElementById("txtFactory");
        txtFactory.style.color="black";
        txtFactory.style.fontWeight="normal";
        $("#txtFactory").val('');
        $('#divOrderRecap').data('FactoryIDs',"");

        var txtBuyer=document.getElementById("txtBuyer");
        txtBuyer.style.color="black";
        txtBuyer.style.fontWeight="normal";
        $("#txtBuyer").val('');
        $('#divOrderRecap').data('BuyerIDs',"");

        var txtMerchandiser=document.getElementById("txtMerchandiser");
        txtMerchandiser.style.color="black";
        txtMerchandiser.style.fontWeight="normal";
        $("#txtMerchandiser").val('');
        $('#divOrderRecap').data('MerchandiserIDs',"");

    });

    function IntializePickerbutton(oPickerobj) {

        $("#" + oPickerobj.winid).find("#btnOk").click(function () {

            //for Single Select
            PickerEvents(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which == 13)//enter=13
            {
                PickerEvents(oPickerobj);
            }
        });
    }
    function PickerEvents(oPickerobj) {
        var oreturnobj = null, oreturnobjs = [];
        if (oPickerobj.multiplereturn)
        {
            oreturnobjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
        } else
        {
            oreturnobj = $('#' + oPickerobj.tableid).datagrid('getSelected');
        }

        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();
        if (oPickerobj.winclass == 'clsBuyer')
        {
            var sBuyerIDs = "";
            if (oPickerobj.multiplereturn)
            {
                var ncount = 0;
                for (var i = 0; i <oreturnobjs.length; i++) {
                    var nBuyerID = oreturnobjs[i].ContractorID;
                    sBuyerIDs = sBuyerIDs + nBuyerID + ',';
                    ncount++;
                }
                if (ncount > 1)
                {
                    $('#txtBuyer').val("Select " + ncount + " Buyer's");
                } else
                {
                    $('#txtBuyer').val(oreturnobjs[0].Name);
                }
                sBuyerIDs = sBuyerIDs.substring(0, sBuyerIDs.length - 1);
            } else
            {
                $('#txtBuyer').val(oreturnobj.Name);
                sBuyerIDs = "" + oreturnobj.ContractorID + "";
                $('#txtBuyer').focus();
            }
            var txtBuyerName = document.getElementById("txtBuyer");
            txtBuyerName.style.color = "blue";
            txtBuyerName.style.fontWeight = "bold";
            $('#divOrderRecap').data('BuyerIDs',sBuyerIDs);
        } else if (oPickerobj.winclass == 'clsProductCategory')
        {
            $('#txtProductCategoryName').val(oreturnobj.ProductCategoryName);
            $('#divOrderRecap').data('ProductCatagoryID',oreturnobj.ProductCategoryID);
            $('#txtProductCategoryName').focus();
            var txtProductCategoryName = document.getElementById("txtProductCategoryName");
            txtProductCategoryName.style.color = "blue";
            txtProductCategoryName.style.fontWeight = "bold";
        }if (oPickerobj.winclass == 'clsFactory')
        {
            var sFactoryIDs = "";
            if (oPickerobj.multiplereturn)
            {
                var ncount = 0;
                for (var i = 0; i <oreturnobjs.length; i++) {
                    var nFactoryID = oreturnobjs[i].ContractorID;
                    sFactoryIDs = sFactoryIDs + nFactoryID + ',';
                    ncount++;
                }
                if (ncount > 1)
                {
                    $('#txtFactory').val("Select " + ncount + " Factory's");
                } else
                {
                    $('#txtFactory').val(oreturnobjs[0].Name);
                }
                sFactoryIDs = sFactoryIDs.substring(0, sFactoryIDs.length - 1);

            } else
            {
                $('#txtFactory').val(oreturnobj.Name);
                sFactoryIDs = "" + oreturnobj.ContractorID + "";
                $('#txtFactory').focus();
            }
            var txtFactory = document.getElementById("txtFactory");
            txtFactory.style.color = "blue";
            txtFactory.style.fontWeight = "bold";
            $('#divOrderRecap').data('FactoryIDs',sFactoryIDs);
        }else if (oPickerobj.winclass == 'clsStyle')
        {
            $('#txtStyle').val(oreturnobj.StyleNo);
            $('#txtStyle').focus();
            var txtStyle = document.getElementById("txtStyle");
            txtStyle.style.color = "blue";
            txtStyle.style.fontWeight = "bold";
        }else if (oPickerobj.winclass == 'clsMerchandiser')
        {
            var nMerchandiserIDs = "";
            if (oPickerobj.multiplereturn)
            {
                var ncount = 0;
                for (var i = 0; i <oreturnobjs.length; i++) {
                    var nEmployeeID = oreturnobjs[i].EmployeeID;
                    nMerchandiserIDs = nMerchandiserIDs + nEmployeeID + ',';
                    ncount++;
                }
                if (ncount > 1)
                {
                    $('#txtMerchandiser').val("Select " + ncount + " Merchandiser's");
                } else
                {
                    $('#txtMerchandiser').val(oreturnobjs[0].Name);
                }
                nMerchandiserIDs = nMerchandiserIDs.substring(0, nMerchandiserIDs.length - 1);

            } else
            {
                $('#txtMerchandiser').val(oreturnobj.Name);
                nMerchandiserIDs = "" + oreturnobj.ContractorID + "";
                $('#txtMerchandiser').focus();
            }
            var txtMerchandiser = document.getElementById("txtMerchandiser");
            txtMerchandiser.style.color = "blue";
            txtMerchandiser.style.fontWeight = "bold";
            $('#divOrderRecap').data('MerchandiserIDs',nMerchandiserIDs);
        }else if (oPickerobj.winclass == 'clsStyle')
        {
            $('#txtStyle').val(oreturnobj.StyleNo);
            $('#txtStyle').focus();
            var txtStyle = document.getElementById("txtStyle");
            txtStyle.style.color = "blue";
            txtStyle.style.fontWeight = "bold";
        }
    }


    // Search Style Start
    $('#txtStyle').keydown(function (e) {
        //
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            var oTechnicalSheet = { Note: $('#txtStyle').val()};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oTechnicalSheet,
                ControllerName: "TechnicalSheet",
                ActionName: "ViewStyleSearch",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].TechnicalSheetID > 0) {

                        var tblColums = []; var oColumn = { field: "StyleNo", title: "Style No", width: 150, align: "left" }; tblColums.push(oColumn);
                        oColumn = { field: "BuyerName", title: "Buyer", width: 150, align: "left" }; tblColums.push(oColumn);
                        var oPickerParam = {
                            winid: 'winStyles',
                            winclass: 'clsStyle',
                            winwidth: 600,
                            winheight: 460,
                            tableid: 'tblStyles',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: false,
                            searchingbyfieldName: 'StyleNo',
                            windowTittle: 'Style List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }
    });

    $('#txtStyle').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            //
            var txtStyle=document.getElementById("txtStyle");
            txtStyle.style.color="black";
            txtStyle.style.fontWeight="normal";
            txtStyle.value = "";
        }
    });
    // Search Style End


    function Close()
    {
        $("#winOrderRecapAdvanceSearch").icsWindow('close');
    }

    function OkButtonClick() {

        var oOrderRecaps=[];
        var oOrderRecaps = $('#tblOrderRecapsList').datagrid('getChecked');
        if(oOrderRecaps.length<=0)
        {
            alert("please select at least one item");
            return;
        }
        RefreshList(oOrderRecaps);
        $("#winOrderRecapAdvanceSearch").icsWindow('close');
    }
    //Adv Search end

    //Style wise Start
    $('#txtStyleNo').keypress(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) {
            var txtStyleNo = document.getElementById('txtStyleNo').value;
            if(txtStyleNo!="")
            {
                $("#txtRecapNo").val('');
                var tsv=((new Date()).getTime())/1000;
                $.ajax
            ({
                type: "GET",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/SearchStyleAndRecap",
                data: {sTempData:txtStyleNo,bIsStyle:true,BUID:sessionStorage.getItem("BUID"),ts:tsv},
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oOrderRecaps = jQuery.parseJSON(data);
                    if (oOrderRecaps.length>0)
                    {
                        $('#divOrderRecap').data('OrderRecaps',oOrderRecaps);
                        var  data=oOrderRecaps;
                        data={"total":""+data.length+"","rows":data};
                        $('#tblOrderRecap').datagrid('loadData',data);
                    }
                    else
                    {
                        alert("Data Not found");
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }
            });            

            }
        }

    });

    $('#txtStyleNo').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            var txtStyleNo=document.getElementById("txtStyleNo");
            txtStyleNo.style.color="Normal";
            txtStyleNo.style.fontWeight="Black";

        }
    });
    //style Wise End


    //Recap wise Start
    $('#txtRecapNo').keypress(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) {
            var txtRecapNo = document.getElementById('txtRecapNo').value;
            if(txtRecapNo!="")
            {
                document.getElementById("txtStyleNo").value='';
                //
                var tsv=((new Date()).getTime())/1000;
                $.ajax
            ({
                type: "GET",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/SearchStyleAndRecap",
                data: {sTempData:txtRecapNo,bIsStyle:false,BUID:sessionStorage.getItem("BUID"), ts:tsv},
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oOrderRecaps = jQuery.parseJSON(data);
                    $('#divOrderRecap').data('OrderRecaps',oOrderRecaps);
                    if (oOrderRecaps.length>0)
                    {
                        var  data=oOrderRecaps;
                        data={"total":""+data.length+"","rows":data};
                        $('#tblOrderRecap').datagrid('loadData',data);
                    }
                    else
                    {
                        alert("Data Not found");
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }
            });             //

            }
        }

    });

    $('#txtRecapNo').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            var txtRecapNo=document.getElementById("txtRecapNo");
            txtRecapNo.style.color="Normal";
            txtRecapNo.style.fontWeight="Black";

        }
    });
    //style Wise End


    $('#btnORSPrint').click(function (e) {

        var oOrderRecaps = $('#tblOrderRecap').datagrid('getRows');
        if(oOrderRecaps==null ||  oOrderRecaps.length<=0)
        {
            alert ("No data found to print!!! Please use Search option!!!");
            return false;
        }

        var ids =""; var nBuyerID=parseInt(oOrderRecaps[0].BuyerID);
        for(var i =0;i<oOrderRecaps.length;i++)
        {
            ids =ids+oOrderRecaps[i].OrderRecapID+",";
        }
        ids= ids.substring(0, ids.length - 1);
        var sReportHeader= "";
        window.open(_sBaseAddress+'/OrderRecap/PrintRecapSummary?OT='+sessionStorage.getItem("OrderType")+'&RecapIDs='+ids+'&ReportHeader='+sReportHeader+'&nSortBy=0', "_blank");
    });

    $('#btnIsActive').click(function (e) {

        //
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(oOrderRecap.IsActive==true)
        {
            if (!confirm("Confirm to In-Active?")) return ;
            oOrderRecap.IsActive=false;
        }
        else
        {
            if (!confirm("Confirm to Active?")) return ;
            oOrderRecap.IsActive=true;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        $.ajax ({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/ActiveInActive",
            data:  JSON.stringify(oOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                //
                oOrderRecap = jQuery.parseJSON(data);
                if (oOrderRecap.ErrorMessage==null || oOrderRecap.ErrorMessage=="") {
                    alert("Data Update successfully");
                    $('#tblOrderRecap').datagrid('updateRow',{index: SelectedRowIndex,	row: oOrderRecap});
                }
                else {
                    alert(oOrderRecap.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });
    });

    $('#btnShippedUnShipped').click(function (e) {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(oOrderRecap.IsShippedOut==true)
        {
            if (!confirm("Confirm to Un-Shipped?")) return ;
            oOrderRecap.IsShippedOut=false;
        }
        else
        {
            if (!confirm("Confirm to Shipped?")) return ;
            oOrderRecap.IsShippedOut=true;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        $.ajax ({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/ShippedUnShipped",
            data:  JSON.stringify(oOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                //
                oOrderRecap = jQuery.parseJSON(data);
                if (oOrderRecap.ErrorMessage==null || oOrderRecap.ErrorMessage=="") {
                    alert("Data Update successfully");
                    $('#tblOrderRecap').datagrid('updateRow',{index: SelectedRowIndex,	row: oOrderRecap});
                }
                else {
                    alert(oOrderRecap.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });
    });

    $('#btnUpdateInfo').click(function (e) 
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || parseInt(oOrderRecap.OrderRecapID)<=0)
        {
            alert('Sorry, there is No Order Recap!');
            return false;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", "Update Order Recap Information");
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecapUpdateInfo?id="+oOrderRecap.OrderRecapID;



    });

    //btnFollowUp
    $('#btnFollowUp').click(function (e) {
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        if(oOrderRecaps==null || oOrderRecaps.length<=0)
        {
            alert('Sorry, there is No Order Recap!');
            return false;
        }
        var sRecapIDs ="";
        for(var i=0;i<oOrderRecaps.length;i++)
        {
            sRecapIDs+=oOrderRecaps[i].OrderRecapID+",";
        }
        sRecapIDs = sRecapIDs.substring(0,sRecapIDs.length-1);
        window.open(_sBaseAddress+'/OrderRecap/PrintFollowUpSheet?RecapIDs='+sRecapIDs, "_blank");
    });

    function ReviseHistory()
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(oOrderRecap.OrderRecapStatus!=2)
        {
            alert("Please select only Approved Item");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", "Order Recap Revise History");
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/OrderRecapReviseHistory?id="+oOrderRecap.OrderRecapID;
    }

    function PrintPreview()
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        window.open(_sBaseAddress + '/OrderRecap/OrderRecapPrintPreview?id='+oOrderRecap.OrderRecapID, "_blank");
    }

    function BarCodePrint()
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        window.open(_sBaseAddress + '/OrderRecap/BarCodePrint?id='+oOrderRecap.OrderRecapID, "_blank");
    }

    function PrintList()
    {
        //
        var oOrderRecaps = $('#tblOrderRecap').datagrid('getRows');
        if(oOrderRecaps==null ||  oOrderRecaps.length<=0)
        {
            alert ("No data found to print!!! Please use Search option!!!");
            return false;
        }

        var ids ="";
        if(oOrderRecaps.length>0)
        {

            for(var i =0;i<oOrderRecaps.length;i++)
            {
                ids =ids+oOrderRecaps[i].OrderRecapID+",";
            }
            ids= ids.substring(0, ids.length - 1);
        }
        else{
            return;
        }

        var oOrderRecap = {
            Param:ids,
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+  "/OrderRecap/SetSessionValue",
            traditional: true,
            data:  JSON.stringify(oOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var tsv=((new Date()).getTime())/1000;
                window.open(_sBaseAddress + '/OrderRecap/OrderRecapPrintList?&ts='+tsv, "_blank");
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });



        
    }
    function PrintExcel()
    {
        var oOrderRecaps = $('#tblOrderRecap').datagrid('getRows');
        if(oOrderRecaps==null ||  oOrderRecaps.length<=0)
        {
            alert ("No data found to print!!! Please use Search option!!!");
            return false;
        }
        var ids ="";
        if(oOrderRecaps.length>0)
        {
            for(var i =0;i<oOrderRecaps.length;i++)
            {
                ids =ids+oOrderRecaps[i].OrderRecapID+",";
            }
            ids= ids.substring(0, ids.length - 1);
        }
        else{
            return;
        }

        var oOrderRecap = {
            Param:ids,
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+  "/OrderRecap/SetSessionValue",
            traditional: true,
            data:  JSON.stringify(oOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var tsv=((new Date()).getTime())/1000;
                window.open(_sBaseAddress + '/OrderRecap/ExportToExcel?&ts='+tsv, "_blank");
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });


    }
    function Refresh()
    {
        RefreshList($('#divOrderRecap').data('OrderRecaps'));
    }

    function RefreshList(oTempOrderRecaps)
    {
        //data=oTempOrderRecaps;
        data={"total":""+oTempOrderRecaps.length+"","rows":oTempOrderRecaps};
        $('#tblOrderRecap').datagrid('loadData',data);
        if(sessionStorage.getItem("SelectedRowIndex")!=null || sessionStorage.getItem("SelectedRowIndex") !="")
        {
            var nIndex= parseInt(sessionStorage.getItem("SelectedRowIndex"));
            $('#tblOrderRecap').datagrid('selectRow',nIndex);
        }
    }

    function WaitForApproval()
    {
        $.ajax
        ({
            type: "GET",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/WaitingSearch",
            data: { nStatusExtra:1,OrderType:sessionStorage.getItem("OrderType"), BUID:sessionStorage.getItem("BUID")},
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oOrderRecaps = jQuery.parseJSON(data);
                $('#divOrderRecap').data('OrderRecaps',oOrderRecaps);
                if (oOrderRecaps.length>0)
                {
                    var  data=oOrderRecaps;
                    data={"total":""+data.length+"","rows":data};
                    $('#tblOrderRecap').datagrid('loadData',data);

                }
                else
                {
                    alert("Data Not found");
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });
    }

    function Clearfield()
    {
        $("#txtSearchbyCode")[0].value='';
    }

    function Add()
    {
        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader= "Add Order Recap";
        }
        else
        {
            RecapHeader = "Add Sales Man Sample";
        }
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", -1);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecap?id=0&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&TSID=0&ts="+tsv;
    }

    function Edit()
    {
        //
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }

        if(oOrderRecap.OrderRecapStatus!=0)
        {
            alert("Please select Only Initialized Item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);

        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader= "Edit Order Recap";
        }
        else
        {
            RecapHeader = "Edit Sales Man Sample";
        }
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecap?id="+oOrderRecap.OrderRecapID+"&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&TSID=0&ts="+tsv;

    }

    function Delete()
    {
        ////

        var oOrderRecaptbl= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecaptbl==null || oOrderRecaptbl.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return false;
        }
        if(oOrderRecaptbl.ApproveBy!=0)
        {
            alert("Already Approved.Can't Delete.");
            return;
        }
        if (!confirm("Confirm to Delete?")) return ;

        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecaptbl);

        if (parseInt(oOrderRecaptbl.OrderRecapID) > 0)
        {

            $.ajax
            ({
                type: "GET",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/Delete",
                data: { id: oOrderRecaptbl.OrderRecapID},
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    ////
                    feedbackmessage = jQuery.parseJSON(data);
                    if (feedbackmessage == "Data delete successfully")
                    {
                        alert("Delete sucessfully");
                        $('#tblOrderRecap').datagrid('deleteRow',SelectedRowIndex);

                    }
                    else
                    {
                        alert(feedbackmessage);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }

            });
        }
    }

    function View()
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);

        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader= "View Order Recap";
        }
        else
        {
            RecapHeader = "View Sales Man Sample";
        }
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecap?id="+oOrderRecap.OrderRecapID+"&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&TSID=0&ts="+tsv;
    }

    $('#btnBillOfMaterial').click(function(){
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("BackLink", window.location.href);
        window.location.href = _sBaseAddress+ "/RecapBillOfMaterial/ViewRecapBillOfMaterial?orid="+oOrderRecap.OrderRecapID+"&ms=''&ts="+tsv;
    });



    function CreateShipmentSchedule()
    {
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("OrderRecap", JSON.stringify(oOrderRecap));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("ORBackLink", window.location.href);
        window.location.href =_sBaseAddress+ "/ShipmentSchedule/ViewShipmentSchedules?id="+oOrderRecap.OrderRecapID;
    }

    function Copy()
    {
        //
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);

        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader= "Copy Order Recap";
        }
        else
        {
            RecapHeader = "Copy Sales Man Sample";
        }
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", -1);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecap?id="+oOrderRecap.OrderRecapID+"&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&TSID=0&ts="+tsv;
    }

    function Approve()
    {
        //
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(parseInt(oOrderRecap.OrderRecapStatus)!=1 )
        {
            alert("Please select Only Request for Approval Item From List");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);

        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader= "Approved Order Recap";
        }
        else
        {
            RecapHeader = "Approved Sales Man Sample";
        }
        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecap?id="+oOrderRecap.OrderRecapID+"&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&TSID=0&ts="+tsv;
    }

    function AcceptRevise()
    {
        var oOrderRecaptbl= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecaptbl==null || parseInt(oOrderRecaptbl.OrderRecapID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }

        if(oOrderRecaptbl.OrderRecapStatus!=3)
        {
            alert("Please select Only Request for Revise Item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecaptbl);
        var RecapHeader = '';
        if(sessionStorage.getItem("OrderType")==1)
        {
            RecapHeader = "Revise Order Recap";
        }
        else
        {
            RecapHeader = "Revise Sales Man Sample";
        }

        var tsv=((new Date()).getTime())/1000;
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("OT", sessionStorage.getItem("OrderType"));
        var oBackLink = window.location.href;
        sessionStorage.setItem("BackLink", oBackLink);
        window.location.href =_sBaseAddress+ "/OrderRecap/ViewOrderRecapRevise?id="+oOrderRecaptbl.OrderRecapID+"&OT="+parseInt(sessionStorage.getItem("OrderType"))+"&ts="+tsv;

    }

    function PackingPolicy(bIsFromUrl, nOrderRecapID, sRecapNo)
    {
        debugger;
        var oOrderRecap = {OrderRecapID:0,OrderRecapNo:''};
        if(bIsFromUrl)
        {
            oOrderRecap.OrderRecapID = nOrderRecapID;
            oOrderRecap.OrderRecapNo = sRecapNo;
        }else
        {
            oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
            if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
            {
                alert("Please select a item from list!");
                return;
            }
        }
        if(parseInt(oOrderRecap.OrderRecapID)<=0)
        {
            alert("Please Save Order Recap first.");
            return;
        }
        
        //EnumAttchRefType : 1 Production Order;2 Delivery Order;3 Delivery Challan ..... 15:Order Recap Packing Policy        
        window.open(_sBaseAddress + '/AttachDocument/Attachment?id='+oOrderRecap.OrderRecapID+'&RefType=15&OperationInfo= Attachment of Order Recap No : '+oOrderRecap.OrderRecapNo, '_blank');
    }

    function WaitForRevise()
    {
        var tsv=((new Date()).getTime())/1000;
        $.ajax
            ({
                type: "GET",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/WaitForRevise",
                data: {BUID:sessionStorage.getItem("BUID"),ts:tsv},
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oOrderRecaps = jQuery.parseJSON(data);
                    $('#divOrderRecap').data('OrderRecaps',oOrderRecaps);
                    if (oOrderRecaps[0].ErrorMessage == "" || oOrderRecaps[0].ErrorMessage == null)
                    {
                        RefreshList(oOrderRecaps);
                    }
                    else
                    {
                        RefreshList([]);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }

            });
    }

    function ProductionPlan()
    {
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(parseInt(oOrderRecap.IsActive)==0 )
        {
            alert("Please select Only Active Recap From List");
            return;
        }
        if(parseInt(oOrderRecap.OrderRecapStatus)!=2 )
        {
            alert("Please select Only Approval Item From List");
            return;
        }
        if(parseInt(oOrderRecap.IsORExistInPlan)==true)
        {
            alert("Sorry, Plan Already Exist for this Plan");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        var oOrderRecaps= $('#tblOrderRecap').datagrid('getRows');
        sessionStorage.setItem("OrderRecaps", JSON.stringify(oOrderRecaps));
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        //sessionStorage.setItem("RecapHeader", RecapHeader);
        sessionStorage.setItem("BackLink", window.location.href);
        window.location.href =_sBaseAddress+ "/ProductionExecutionPlan/ViewProductionExecutionPlan?id=0&OrderRecapID="+oOrderRecap.OrderRecapID;

    }

    $('#btnReqForApprove').click(function(e){
        debugger;
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || parseInt(oOrderRecap.OrderRecapID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        else if  (oOrderRecap.OrderRecapStatus==0)
        {
            var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex', oOrderRecap);
            var oEmployee = { DesignationName : '2,23' };
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+"/User/GetsRequestedUsers",
                traditional: true,
                data:  JSON.stringify(oEmployee),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oUsers = jQuery.parseJSON(data);
                    if(oUsers===null){ oUsers=[]; }
                    $("#cboApprovalRequestTo").icsLoadCombo({ List: oUsers, OptionValue: "UserID", DisplayText: "UserName" });
                    if(sessionStorage.getItem("OrderType")==1)
                    {
                        $("#winApprovalRequest").icsWindow('open', "Order Recap Request For Approval");
                    }
                    else
                    {
                        $("#winApprovalRequest").icsWindow('open', "Sales Man Sample Request For Approval");
                    }
                    $("#winApprovalRequest input").not("input[type='button']").val("");
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }
        else
        {
            alert("Please select only Initialized item from list");
            return;
        }
    });

    $('#btnApprovalRequestClose').click(function(e){
        $("#winApprovalRequest").icsWindow('close');
    });

    $('#btnApprovalRequestConfirm').click(function(e){
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || parseInt(oOrderRecap.OrderRecapID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(parseInt($('#cboApprovalRequestTo').val())==0)
        {
            alert('Please Select Approval User');
            $('#cboApprovalRequestTo').focus();
            return false;
        }
        var oApprovalRequest= {
            ApprovalRequestID :0,
            OperationObjectID : parseInt(oOrderRecap.OrderRecapID),
            RequestTo : parseInt($('#cboApprovalRequestTo').val()),
            Note :$.trim($("#txtApprovalRequestNote").val())

        };

        var oTempOrderRecap = {
            OrderRecapID : parseInt(oOrderRecap.OrderRecapID),
            ActionTypeExtra : "RequestForApproval",
            ActionTypeInInt:1,
            ApprovalRequest : oApprovalRequest
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex', oOrderRecap);
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/ChangeStatus",
            traditional: true,
            data:  JSON.stringify(oTempOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oOrderRecap = jQuery.parseJSON(data);
                if(oOrderRecap!=null)
                {
                    if(oOrderRecap.ErrorMessage=="" || oOrderRecap.ErrorMessage == null)
                    {
                        if(sessionStorage.getItem("OrderType")==1)
                        {
                            alert("Order Recap Approval Request  Successfully.");
                        }
                        else
                        {
                            alert("Sales Man Sample Approval Request  Successfully.");
                        }
                        $('#tblOrderRecap').datagrid('updateRow',{index: SelectedRowIndex,	row: oOrderRecap});
                        $("#winApprovalRequest").icsWindow('close');
                    }
                    else
                    {
                        alert(oOrderRecap.ErrorMessage);
                    }
                }
                else
                {
                    alert("Invalid Operation!");
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });

    });

    function UndoRequest()
    {

        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        else if(oOrderRecap.OrderRecapStatus==1)
        {
            if (!confirm("Confirm to Undo Request?")) return ;
            oOrderRecap.ActionTypeInInt=2; // For Order Recap Undo Request
            StatusChange(oOrderRecap,"Undo Request");

        }
        else
        {
            alert("Please select only Request For Approval  item from list");
            return;
        }
    }

    function UndoApprove()
    {
        //
        // alert(HttpContext.Current.Session[SessionInfo.currentUserID]);
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }

        else if(oOrderRecap.OrderRecapStatus==2)
        {
            if (!confirm("Confirm to Undo Approved?")) return ;
            oOrderRecap.ActionTypeInInt=4; // For Order Recap undo Approve
            StatusChange(oOrderRecap,"UndoApprove");
        }
        else
        {
            alert("Please select only Approved from list");
            return;
        }
    }  
    $('#btnReqForRevise').click(function(e){
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        else if(oOrderRecap.OrderRecapStatus!=2)
        {
            alert("Only Approved Item can Request for Revise.");
            return;
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex', oOrderRecap);
        var oEmployee = { DesignationName : '23' };
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/User/GetsRequestedUsers",
            traditional: true,
            data:  JSON.stringify(oEmployee),
            contentType: "application/json; charset=utf-8",
            success: function (data) {                    
                var oUsers = jQuery.parseJSON(data);          
                if(oUsers===null){ oUsers=[]; }                    
                $("#cboReviseRequestTo").icsLoadCombo({ List: oUsers, OptionValue: "UserID", DisplayText: "UserName" });
                if(sessionStorage.getItem("OrderType")==1)
                {
                    $("#winReviseRequest").icsWindow('open', "Order Recap Request For Revise");
                }
                else
                {
                    $("#winReviseRequest").icsWindow('open', "Sales Man Sample Request For Revise");
                }
                
                $("#winReviseRequest input").not("input[type='button']").val("");
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    });
    $('#btnReviseRequestClose').click(function(e){
        $("#winReviseRequest").icsWindow('close');
    });
    $('#btnReviseRequestConfirm').click(function(e){
        var oOrderRecap = $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || parseInt(oOrderRecap.OrderRecapID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        if(parseInt($('#cboReviseRequestTo').val())==0)
        {
            alert('Please Select User');
            $('#cboReviseRequestTo').focus();
            return false;
        }
        var oReviseRequest= { 
            ReviseRequestID :0,
            OperationObjectID : parseInt(oOrderRecap.OrderRecapID),
            RequestTo : parseInt($('#cboReviseRequestTo').val()),
            Note :$.trim($("#txtReviseRequestNote").val())
          
        };

        var oTempOrderRecap = {
            OrderRecapID : parseInt(oOrderRecap.OrderRecapID),
            ActionTypeInInt : 5,// EnumActionType:  None = 0,  RequestForApproval = 1,UndoRequest = 2,Approve = 3,UndoApprove = 4, Request_For_Revise = 5,RequestForProductionPermission = 6,UndoRequestForProductionPermission = 7,ProductionApproved = 8,InProduction = 9,ProductionFinished = 10,Cancel = 11
            ReviseRequest : oReviseRequest
        }
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex', oOrderRecap);        
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/ChangeStatus",
            traditional: true,
            data:  JSON.stringify(oTempOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {                    
                var oOrderRecap = jQuery.parseJSON(data);          
                if(oOrderRecap!=null)
                {
                    if(oOrderRecap.ErrorMessage=="" || oOrderRecap.ErrorMessage == null)
                    {
                        if(sessionStorage.getItem("OrderType")==1)
                        {
                            alert("Order Recap Revise Request  Successfully.");
                        }
                        else
                        {
                            alert("Sales Man Sample Revise Request  Successfully.");
                        }
                        $('#tblOrderRecap').datagrid('updateRow',{index: SelectedRowIndex,	row: oOrderRecap});
                        $("#winApprovalRequest").icsWindow('close');
                    }
                    else
                    {
                        alert(oOrderRecap.ErrorMessage);
                    }
                }
                else
                {
                    alert("Invalid Operation!");
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });

    });
    function StatusChange(oOrderRecap,sParamIdentifier)
    {
        var SelectedRowIndex=$('#tblOrderRecap').datagrid('getRowIndex',oOrderRecap);
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/OrderRecap/ChangeStatus",
            traditional: true,
            data:  JSON.stringify(oOrderRecap),
            contentType: "application/json; charset=utf-8",
            success: function (data) {

                var _oOrderRecap= jQuery.parseJSON(data);
                if (_oOrderRecap.ErrorMessage=="" || _oOrderRecap.ErrorMessage== null)
                {
                    if(sParamIdentifier=="Undo Request")
                    {
                        alert("Successfully Undo the Request !!");
                    }

                    else  if(sParamIdentifier=="UndoApprove")
                    {
                        alert("Successfully Undo Approved.");
                    }
                    else  if(sParamIdentifier=="RequestForRevise")
                    {
                        alert("Successfully Request to Revised.");
                    }

                    $('#tblOrderRecap').datagrid('updateRow',{index: SelectedRowIndex,	row: _oOrderRecap});
                }
                else
                {
                    alert(_oOrderRecap.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });


    }

    //Sample Order Comments start
    $("#btnOrderRecapComment").click(function () {

        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if(oOrderRecap==null || oOrderRecap.OrderRecapID<=0)
        {
            alert("Please select a Item !");
            return false;
        }
        else
        {

            $.ajax
              ({
                  type: "GET",
                  dataType: "json",
                  url : _sBaseAddress+  "/OrderRecap/GetsComment",
                  data: { id: oOrderRecap.OrderRecapID},
                  contentType: "application/json; charset=utf-8",
                  success: function (data) {
                      var oOrderRecapComments = jQuery.parseJSON(data);
                      if (oOrderRecapComments.length>0)
                      {
                          RefreshCommentsList(oOrderRecapComments);
                      }else
                      {
                          RefreshCommentsList([]);
                      }
                      $("#winOrderRecapComment").icsWindow('open', "Recap Wise Comments for Order No : "+oOrderRecap.OrderRecapNo+", Buyer : “"+oOrderRecap.BuyerName+"”, Style Number : "+oOrderRecap.StyleNo);

                  },
                  error: function (xhr, status, error)
                  {
                      alert(error);
                  }
              });


        }


    });
    function CloseComment()
    {
        $('#winOrderRecapComment').icsWindow('close');
    }

    $("#btnAddOrderRecapComment").click(function(){

        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        if($("#txtOrderRecapWriteComments").val()=="" || $("#txtOrderRecapWriteComments").val()==null)
        {
            alert("Please Type something Comments");
            $("#txtOrderRecapWriteComments").focus();
            return;
        }
        var oOrderRecapComment= {
            OrderRecapID:oOrderRecap.OrderRecapID,
            CommentsText: $("#txtOrderRecapWriteComments").val()
        };
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+  "/OrderRecap/SaveOrderRecapComment",
            traditional: true,
            data:  JSON.stringify(oOrderRecapComment),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oOrderRecapComment = jQuery.parseJSON(data);
                if (oOrderRecapComment.OrderRecapCommentID>0) {
                    alert("Data Saved sucessfully");
                    debugger
                    $('#tblOrderRecapComment').datagrid('appendRow',oOrderRecapComment);
                    $("#txtOrderRecapWriteComments").val(" ");
                    $("#txtOrderRecapWriteComments").focus();
                }
                else {
                    alert(oOrderRecapComment.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });


    });

    $("#btnRemoveOrderRecapComment").click(function()
    {
        var oOrderRecapComment= $('#tblOrderRecapComment').datagrid('getSelected');
        if(oOrderRecapComment==null || oOrderRecapComment.OrderRecapCommentID<=0)
        {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        if (!confirm("Confirm to Delete?")) return ;
        var SelectedRowIndex=$('#tblOrderRecapComment').datagrid('getRowIndex',oOrderRecapComment);
        if (oOrderRecapComment.OrderRecapCommentID > 0)
        {
            debugger
            $.ajax
            ({

                type: "GET",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/RemoveComment",
                data: { id: oOrderRecapComment.OrderRecapCommentID},
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var feedbackmessage = jQuery.parseJSON(data);
                    if (feedbackmessage == "Data delete successfully")
                    {
                        alert("Delete sucessfully");
                        $('#tblOrderRecapComment').datagrid('deleteRow',SelectedRowIndex);
                        $("#txtOrderRecapWriteComments").val(" ");
                        $('#txtOrderRecapWriteComments').focus();
                    }
                    else
                    {
                        alert(feedbackmessage);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }
            });
        }
    });
    function RefreshCommentsList(oOrderRecapComments)
    {

        var data=oOrderRecapComments;
        data={"total":""+data.length+"","rows":data};
        $('#tblOrderRecapComment').datagrid('loadData',data);
        $('#tblOrderRecapComment').datagrid({onSelect: function(index,row){ RowSelect(index,row);}});
    }

    function RowSelect(index,oOrderRecapComment)
    {
        $("#txtOrderRecapWriteComments").val(oOrderRecapComment.CommentsText);
    }

    $('#btnPrintListOrderRecapComment').click(function(){
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        var nid= oOrderRecap.OrderRecapID;
        window.open(_sBaseAddress+'/OrderRecap/PrintOrderRecapComments?id='+nid, "_blank");
    });
    
    $('#btnPreviewCutOff').click(function(e){
        //if(!ValidateSearch(0)) return;
        //var oOrderRecap = RefreshObject();
        var oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
        var nOrderRecapID=oOrderRecap.OrderRecapID;

        if(nOrderRecapID==undefined || nOrderRecapID<=0)
        {
            alert("Please Select An Order Recap!!");
            return;
        }
       
        var tsv=((new Date()).getTime())/1000;
        window.open(_sBaseAddress+'/ShipmentSchedule/PintOrderRecapRegisters?nORID='+nOrderRecapID+'&tsv='+tsv,"_blank");
    });

    function SOEditRefreshObject()
    {
        var oOrderRecapComment= {
            OrderRecapCommentID:_oOrderRecapComment.OrderRecapCommentID,
            OrderRecapID:_oOrderRecapComment.OrderRecapID,
            CommentsText: $("#txtOrderRecapWriteComments").val()
        };
        return oOrderRecapComment;
    }

    $("#btnEditOrderRecapComment").click(function(){
        _oOrderRecapComment= $('#tblOrderRecapComment').datagrid('getSelected');
        var SelectedRowIndex=$('#tblOrderRecapComment').datagrid('getRowIndex',_oOrderRecapComment);

        if(_oOrderRecapComment==null || _oOrderRecapComment.OrderRecapCommentID<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        else
        {

            //_oOrderRecap= $('#tblOrderRecap').datagrid('getSelected');
            var oOrderRecapComment=SOEditRefreshObject();
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/OrderRecap/SOEditComment",
                traditional: true,
                data:  JSON.stringify(oOrderRecapComment),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oOrderRecapComment = jQuery.parseJSON(data);
                    if (oOrderRecapComment.OrderRecapCommentID>0) {
                        alert("Data Update sucessfully");
                        debugger
                        $('#tblOrderRecapComment').datagrid('updateRow',{index: SelectedRowIndex,row: oOrderRecapComment});
                        $("#txtOrderRecapWriteComments").val(" ");
                    }
                    else {
                        alert(oOrderRecapComment.ErrorMessage);
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });


        } // end else

    });
    //Samplre order Comments end

    function RefreshControlLayout()
    {

        $('#btnSearch,#btnAdd,#btnEdit,#btnUpdateInfo,#btnView,#btnDelete,#btnReqForApprove,#btnUndoReq,#btnWaitforApproval,#btnWaitforRevise,#btnApprove,#btnUndoApprove,#btnPackingPolicy,#btnIsActive,#btnPrintPreview,#btnPrintList,#btnPrintListToExcel,#btnORSPrint,#btnFollowUp,#btnBarCodePrint').hide();
        if(PermissionChecker('AdvSearch','OrderRecap',_oAuthorizationRolesMapping)){$("#btnSearch").show();}
        if(PermissionChecker('Add','OrderRecap',_oAuthorizationRolesMapping)){$("#btnAdd,#btnReqForApprove,#btnWaitforRevise,#btnPackingPolicy").show();}
        if(PermissionChecker('Edit','OrderRecap',_oAuthorizationRolesMapping)){$("#btnEdit").show();}
        if(PermissionChecker('UpdateInfo','OrderRecap',_oAuthorizationRolesMapping)){$("#btnUpdateInfo").show();}
        if(PermissionChecker('View','OrderRecap',_oAuthorizationRolesMapping)){$("#btnView").show();}
        if(PermissionChecker('Delete','OrderRecap',_oAuthorizationRolesMapping)){$("#btnDelete").show();}
        if(PermissionChecker('UndoRequest','OrderRecap',_oAuthorizationRolesMapping)){$("#btnUndoReq").show();}
        if(PermissionChecker('WaitforApproval','OrderRecap',_oAuthorizationRolesMapping)){$("#btnWaitforApproval").show();}
        if(PermissionChecker('Approved','OrderRecap',_oAuthorizationRolesMapping)){$("#btnApprove,#btnUndoApprove").show();}
        if(PermissionChecker('ActiveInActive','OrderRecap',_oAuthorizationRolesMapping)){$("#btnIsActive").show();}
        if(PermissionChecker('Preview','OrderRecap',_oAuthorizationRolesMapping)){$("#btnPrintPreview,#btnBarCodePrint").show();}
        if(PermissionChecker('PrintList','OrderRecap',_oAuthorizationRolesMapping)){$("#btnPrintList").show();}
        if(PermissionChecker('XLPrint','OrderRecap',_oAuthorizationRolesMapping)){$("#btnPrintListToExcel").show();}
        if(PermissionChecker('ORSPrint','OrderRecap',_oAuthorizationRolesMapping)){$("#btnORSPrint").show();}
        if(PermissionChecker('FollowUp','OrderRecap',_oAuthorizationRolesMapping)){$("#btnFollowUp").show();}
        if(PermissionChecker('RateView','OrderRecap',_oAuthorizationRolesMapping)){$('#tblOrderRecap').datagrid('hideColumn','Amount');}
        if(sessionStorage.getItem("OrderType")==2)
        {
            document.getElementById("lblORSPrint").innerHTML="SMSS Print";
            $('#tblOrderRecap').datagrid({
                title: 'Sales Man Sample List'
            });
        }
    }

   

</script>
