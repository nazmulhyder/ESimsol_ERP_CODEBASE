 <html>
<head>  
 <link href="@Url.Content("~/Content/CSS/icon.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/easyui.css")" rel="stylesheet" type="text/css" /> 
    <link href="@Url.Content("~/Content/CSS/Pikerstyle.css")" rel="stylesheet" type="text/css" />  

    <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>            
    <script src="@Url.Content("~/Scripts/jquery.ics.customize.js")" type="text/javascript"></script>  
    <script src="@Url.Content("~/Scripts/jquery.easyui.min.js")" type="text/javascript"></script>    

    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script> 
    <script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script> 
    
</head>
<body>

@model ESimSol.BusinessObjects.CommercialInvoiceDoc
<div style="font-family:Tahoma">           
<table border="0" cellspacing="2" cellpadding="2">
    <tr>
        <td style="background-color:#CFB53B; text-align:center; width:495px; color:White">
            <label id="lblHeaderName" style="font-size:15px; font-weight:bold; text-decoration:Underline"> Commercial Document Attachment</label>
        </td>
    </tr>
</table>
@using (Html.BeginForm("UploadDocument", "CommercialInvoice", FormMethod.Post, new { enctype = "multipart/form-data" }))
{  
    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
        <tr>
            @Html.HiddenFor(model => model.CommercialInvoiceID)  
            <td style="width:100px; text-align:right">Doc Type : </td>
            <td style="width:370px"> 
                @Html.DropDownListFor(model => model.DocTypeInInt, Model.DocumentTypes.Select(x => new SelectListItem() { Text = x.Value, Value = x.id.ToString() }), new { id = "cboDocumentType", style = "width: 380px" })
            </td>
        </tr> 
        <tr>
            <td style="width:100px; text-align:right">Note : </td>
            <td style="width:390px">@Html.TextBoxFor(model => model.Note, new { style = "width: 380px;", id = "txtNote" }) </td>
        </tr>
        <tr>
            <td style="width:100px; text-align:right">Select File : </td>
            <td style="width:270px"><input type="file" name="file" onchange="readURL(this);"/></td>
        </tr> 
        <tr>
             <td style="width:100px; text-align:right"> </td>
             <td style="width:270px">
                <input id="btnSubmit" type="submit" value="Upload" style="width:75px; font-weight:bold" />                
             </td>
        </tr>     
        <tr>
             <td style="width:100px; text-align:right"> </td>
             <td style="width:270px">               
                <div style="color: red;font-weight:900; margin-top:10px">@TempData["message"]</div>
             </td>
        </tr>        
    </table>
}
    <fieldset>
    <legend style="font-weight:bold;font-size:11px;"> Attachment List : </legend>
     <div id="ImagContaiiner" style="width:470px; height:20px;">
        <table border="1" cellpadding="1" cellspacing="1">
             <tr>
                <td style="text-align:center;font-size:12px;width: 70px;min-width:70px;max-width:70px;font-weight:bold;">SL No</td>
                <td style=" text-align:center;font-size:12px;width: 120px;min-width:120px;max-width:120px;font-weight:bold;">Doc Type</td>
                <td style=" text-align:center;font-size:12px;width: 140px;min-width:140px;max-width:140px;font-weight:bold;">File Name</td>
                <td style=" text-align:center;font-size:12px;width: 110px;min-width:110px;max-width:110px;font-weight:bold;">Action</td>
             </tr>
        </table>
    </div>
    <div style="width:470px; height:140px;overflow:auto">
        <table border="1" cellpadding="1" cellspacing="1" > 
         @{
             int nSLNo = 0;
          }     
        @foreach (ESimSol.BusinessObjects.CommercialInvoiceDoc oItem in Model.CommercialInvoiceDocList)
        {
            nSLNo++;
            <tr>
                <td style="text-align: center; font-size:12px;width: 70px;min-width:70px;max-width:70px;">
                     @nSLNo.ToString()
                </td>
                <td  style="text-align: left; font-size:12px;width: 120px;min-width:120px;max-width:120px;overflow:hidden;">
                     @oItem.DocTypeInString
                </td>
                <td  style="text-align: left; font-size:12px;width: 140px;min-width:140px;max-width:140px;overflow:hidden;">
                     @oItem.DocName
                </td>
                <td style=" text-align:center;font-size:12px;width: 110px;min-width:110px;max-width:110px;">
                    @Html.ActionLink("Download", "DownloadPackingPolicy", new { id = oItem.CommercialInvoiceDocID })/@Html.ActionLink("Delete", "DeleteDocument", new { id = oItem.CommercialInvoiceDocID })
                </td>
             </tr>
                              
        }
        </table>
    </div>
    </fieldset>
    <fieldset>
        <legend style="font-weight:bold"> Action : </legend>
        <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
            <tr>
                <td style="width:500px; text-align:right">             
                </td>

                <td style="width:50px">                   
                </td>
                <td style="width:50px">
                   <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" plain="true" onclick="Close()">Close</a>
                </td>
            </tr>       
        </table>
    </fieldset>
</div>
</body>
</html>

<script type="text/javascript">  
 var _sBaseAddress="";
 var _oAttachmentList=[]
 $(document).ready(function () {
    //debugger;     
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oAttachmentList=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.CommercialInvoiceDocList));
 }); 
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#imgSample')
                .attr('src', e.target.result)
                .width(250)
                .height(250);
        };

        reader.readAsDataURL(input.files[0]);
    }
}
function formatAction()
{
    var e = "'"+'<a href="#" onclick="Download(this)">Download</a>'+ "/" +'<a href="#" onclick="Delete(this)">Delete</a>'+"'";
    return e;
}
$('#btnSubmit').click(function (e) {
    var cboDocumentType= document.getElementById("cboDocumentType").value;
    if(parseInt(cboLCNo.options[cboLCNo.selectedIndex].value) <=0)
    {        
        alert("Please Select Document Type!");
        $('#cboDocumentType').focus();
        return false;
    }
});


function Download(target)
{
    $('#tt').datagrid('beginEdit', getRowIndex(target));
}

function Delete(target){
$.messager.confirm('Confirm','Are you sure?',function(r){
    if (r){
        $('#tt').datagrid('deleteRow', getRowIndex(target));
    }
    });
}



function Close()
{    
    window.close();
}

$(document).keydown(function(e) {    
    //debugger;
    if(e.which == 27)//escape=27
    {
        //debugger;        
        window.close();
    }
});
</script>