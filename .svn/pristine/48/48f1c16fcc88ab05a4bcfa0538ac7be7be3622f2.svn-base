<html>
@{
    ViewBag.title = "RSShift";
}
<body>
    @model ESimSol.BusinessObjects.RSShift
    <div class="menuMainCollectionTable panel-group" ng-app="CCategoryapp" ng-controller="CCategoryController" id="divCC" style="height:530px">
        <div class=" panel-primary" >
        <div style="height:490px;" class="panel-body regionRSShift">
            <fieldset style=" height:100%; text-align:center;">
                <legend style="font-weight:bold;">Basic Info : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold; text-align:center; width:90%; margin:150px 90px 0 40px">
                    <tr>
                        <td style="width:15%; text-align:right">
                            Shift Name :
                        </td>
                        <td style="width:85%" colspan="3">
                            <input type="text" ng-model="RSShift.Name" class="form-control" style="width:100%" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">
                           Start Time:
                        </td>
                        <td style="width:35%;">
                            <input type="time" ng-model="RSShift.StartDateTimeSt" class="form-control" placeholder="HH:mm" style="width:100%" />
                        </td>
                        <td style="width:15%; text-align:right">
                            End Time:
                        </td>
                        <td style="width:35%;">
                            <input type="time" ng-model="RSShift.EndDateTimeSt" class="form-control" placeholder="HH:mm" style="width:100%" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">
                            Module Type:
                        </td>
                        <td style="width:35%;">
                            <select id="cboModuleType" ng-model="RSShift.ModuleTypeInt" ng-options="obj.id as obj.Value for obj in Modules" ng-disabled="disabled" class="form-control">
                                <option value="">--Select Module--</option>
                            </select>
                        </td>
                        <td style="width:15%; text-align:right">
                            Note :
                        </td>
                        <td style="width:35%;" colspan="3">
                            <input type="text" ng-model="RSShift.Note" class="form-control" style="width:100%" />
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
        <fieldset>
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold; width:100%;">
                <tr>
                    <td style="width:100%;text-align:right">
                        <button type="button" id="btnSave" class="btn btn-default btn-sm btn-success" aria-label="right Align" ng-click="Save()"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"> Save</span></button>
                        <button type="button" id="btnClose" class="btn btn-default btn-sm btn-danger" aria-label="right Align" ng-click="Close()"><span class="glyphicon glyphicon-remove" aria-hidden="true"> Close</span></button>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>
            
        </div>
</body>
</html>
<style type="text/css">
    .regionRSShift .form-horizontal .control-label {
        padding-top: 1px;
    }

    .regionRSShift .form-control {
        height: 26px;
        padding: 0px 6px;
        font-size: 12px;
        width:100%;
    }
</style>


<script type="text/javascript">
    //debugger;
    var oRSShift =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
    var oModules = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Modules));

    var CCategoryApp = angular.module('CCategoryapp', ['ngAnimate', 'ui.bootstrap', 'ui.grid', 'ui.grid.selection', 'ui.grid.edit','ui.grid.resizeColumns','ui.grid.cellNav','ms.service']);
    CCategoryApp.controller('CCategoryController', function ($scope, $http, $uibModal, $log, uiGridConstants, msModal,icsMethod, userSession,msGridControl) {
        $scope.RSShift = oRSShift;
        debugger;
        $scope.Modules=oModules;
        $scope.RSShift.StartDateTimeSt=new Date(oRSShift.StartDateTimeSt);
        $scope.RSShift.EndDateTimeSt=new Date(oRSShift.EndDateTimeSt);
        $scope.Save=function()
        {
            $scope.RSShift.StartDateTime=new Date($scope.RSShift.StartDateTimeSt);
            $scope.RSShift.EndDateTime=new Date($scope.RSShift.EndDateTimeSt);
            if(!$scope.ValidateInput()) return;
            var oRSShift=$scope.RSShift;
            $http.post(sessionStorage.getItem('BaseAddress')+'/RSShift/Save',oRSShift).then(
                    function (response)
                    {
                        var oRSShift= jQuery.parseJSON(response.data);
                        if (oRSShift.ErrorMessage=="" || oRSShift.ErrorMessage==null)
                        {
                            alert("Data Saved Successfully!!");
                            userSession.setData('RSShifts',oRSShift);
                            userSession.previousPage();
                        }
                        else
                        {
                            alert(oRSShift.ErrorMessage);
                        }

                    },
                        function (response) { alert(jQuery.parseJSON(response.data).Message);$scope.MeasurementUnits=[];}
                );
        }
        $scope.ValidateInput = function()
        {
            debugger;
            if(($scope.RSShift.Name==null || $scope.RSShift.Name==""))
            {
                alert("Please enter shift Name!");
                return false;
            }
               
            if($scope.RSShift.StartDateTime==null)
            {
                alert("Please enter Start Time!");
                return false;
            }
            if($scope.RSShift.EndDateTime==null)
            {
                alert("Please enter End Time!");
                return false;
            }
            if(new Date($scope.RSShift.StartDateTime)===new Date($scope.RSShift.EndDateTime))
            {
                alert("Start Time And End Time Can Not Be Equal!");
                return false;
            }
            return true;
        }
        if(sessionStorage.getItem("RSShiftHeader")=="View Vehicle RSShift")
        {
            $("#divCC :input").prop('disabled', true);
            $('#btnClose').prop('disabled', false);
        }
        $scope.Close = function()
        {
            window.location.href = sessionStorage.getItem("BackLink");
        }
        $scope.keydown = function(e)
        {
            if(e.which == 27)//escape=27
            {
                //debugger;
                window.location.href = sessionStorage.getItem("BackLink");
            }
        }
    });

</script>