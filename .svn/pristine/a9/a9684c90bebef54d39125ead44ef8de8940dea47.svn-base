<html>
    <head>  
        <title>Training & Development</title>
        <link href="@Url.Content("~/Content/CSS/icon.css")" rel="stylesheet" type="text/css" />
        <link href="@Url.Content("~/Content/CSS/easyui.css")" rel="stylesheet" type="text/css" />
        <link href="@Url.Content("~/Content/CSS/Pikerstyle.css")" rel="stylesheet" type="text/css" />
        <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery.ics.customize.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery.easyui.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script>
    
    </head>
    <body>
    @model ESimSol.BusinessObjects.TrainingDevelopment
        <div style="font-family:Tahoma">           
            <table border="0" cellspacing="2" cellpadding="2">
                <tr>
                    <td style="background-color:#cfb53b; text-align:center; width:800px; color:White">
                        <label id="lblHeaderName" style="font-size:15px; font-weight:bold; text-decoration:Underline"> Add Leave Application</label>
                    </td>
                </tr>
            </table>
            <fieldset>
                <legend style="font-weight:bold"> Training & Development : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight: bold">
                    <tr>
                        <td style="width:140px; text-align:right">
                            Employee :
                        </td>
                        <td colspan="3">
                            <input placeholder="Type Employee Code or Name & Enter" id="txtEmployee" type="text" style="width:430px;" />
                            <input id="btnClearEmployee" type="button" value="C"/>
                            <input id="btnPickEmployee" type="button" value="P"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                            Official Info :
                        </td>
                        <td colspan="3">
                        <input id="txtOfficialInfo" type="text" style="Width:500px;" disabled ="disabled"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                            Last Training Info :
                        </td>
                        <td colspan="3">
                            <input id="txtLastTrainingInfo" type="text" style="Width:500px;" disabled ="disabled"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                            Course Name :
                        </td>
                       <td colspan="3">
                            <input id="txtCourseName" type="text" style="Width:500px;" placeholder="Type Course & Enter"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                            Specification :
                        </td>
                        <td colspan="3">
                            <input id="txtSpecification" type="text" style="Width:500px;" placeholder="Press Enter or type pecification"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                           Institute :
                        </td>
                        <td colspan="3">
                        <input id="txtInstitute" type="text" style="Width:500px;" placeholder="Press Enter or type Institute"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                           Vendor :
                        </td>
                        <td colspan="3">
                            <input id="txtVendor" type="text" style="Width:500px;" placeholder="Press Enter or type vendor"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                           Country :
                        </td>
                        <td >
                            <input id="txtCountry" type="text" style="Width:220px;" placeholder="Press Enter or type country"/>
                        </td>
                         <td style="width:30px; text-align:right">
                           State :
                        </td>
                        <td  >
                            <input id="txtState" type="text" style="Width:210px;" placeholder="Press Enter or type state/district"/>
                        </td>
                    </tr>
                     <tr>
                        <td style="width:140px; text-align:right">
                           Address :
                        </td>
                        <td colspan="3">
                            <input id="txtAddress" type="text" style="Width:500px;" placeholder="Press Enter or type address"/>
                        </td>
                    </tr>
                     <tr>
                        <td style="width:140px; text-align:right">
                           Duration :
                        </td>
                        <td colspan="3">
                        <input id="txtDuration" type="text" style="Width:500px;" placeholder="Press Enter or type duration"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                           Trainging Schedule :
                        </td>                       
                            
                        <td >
                            <input id="dtStartDate" type="text" style="width: 95px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            To <input id="dtEndDate" type="text" style="width: 100px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />

                        </td>
                         <td style="width:30px; text-align:center">
                           <input id="btnEffect" type="button" value="Effect"/>
                        </td>
                        <td >
                            <input id="dtActualStartDate" type="text" style="width: 95px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            To <input id="dtActualEndDate" type="text" style="width: 95px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />

                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px; text-align:right">
                           Note :
                        </td>
                        <td colspan="3">
                            <input id="txtNote" type="text" style="width:500px;" />

                        </td>
                    </tr>
                    <tr id="trApprovalNote">
                        <td style="width:140px; text-align:right">
                           Approval Note :
                        </td>
                        <td colspan="3">
                            <input id="txtApprovalNote" type="text" style="width:500px;" />

                        </td>
                    </tr>
                    <tr id="trResult">
                        <td style="width:140px; text-align:right">
                           Result :
                        </td>
                        <td colspan="3">
                            <input id="txtResult" type="text" style="width:500px;" />

                        </td>
                    </tr>
                    <tr id="trResultNote">
                        <td style="width:140px; text-align:right">
                           Result Note :
                        </td>
                        <td colspan="3">
                            <input id="txtResultNote" type="text" style="width:500px;" />

                        </td>
                    </tr>
                    <tr id="trPassingDate">
                        <td style="width:140px; text-align:right">
                           Passing Date :
                        </td>
                        <td colspan="3">
                            <input id="dtPassingDate" type="text" style="width: 100px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            <input id="chkComplete" type="checkbox" /> Complete
                        </td>
                    </tr>
                     <tr id="trInActiveNote">
                        <td style="width:140px; text-align:right">
                          InActive Note :
                        </td>
                        <td colspan="3">
                            <input id="txtInActiveNote" type="text" style="width:500px;" />

                        </td>
                    </tr>
                 
                </table>
            </fieldset>
            <br />
            <fieldset>
                <legend style="font-weight:bold"> Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                    <tr>
                        <td style="width:500px; text-align:left">
                            
                        </td>
                        <td style="width:50px">
                            <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" plain="true" onclick="Save()">Save</a>
                            <a id="btnApprove" href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" plain="true" >Approve</a>
                            <a id="btnFinalize" href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" plain="true" >Finalize</a>
                            <a id="btnInActive" href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" plain="true" >Inactive</a>

                        </td>
                        <td style="width:50px">
                            <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" plain="true" onclick="Close()">Close</a>
                        </td>
                    </tr>       
                </table>
            </fieldset>
        </div>
    </body>
</html>

<script type="text/javascript">
var _oTrainingDevelopment = null;
var _sBaseAddress = "";
var _bIsPaid=true;
var _oEmployee = null;
var _nEmployeeID = 0;

$(document).ready(function() 
{
    debugger
    _sBaseAddress = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
    _oTrainingDevelopment = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
    var obj = window.dialogArguments;
    document.getElementById('lblHeaderName').innerHTML = obj.Name;
    $('#dtStartDate').datebox('setValue',icsdateformat( new Date()));
    $('#dtEndDate').datebox('setValue', icsdateformat(new Date()));
    $('#dtActualStartDate').datebox('setValue', icsdateformat(new Date()));
    $('#dtActualEndDate').datebox('setValue', icsdateformat(new Date()));
    $('#dtPassingDate').datebox('setValue', icsdateformat(new Date()));
  
    if(obj.Name == "New Training & Development")
    {   
        document.getElementById("btnSave").style.display = '';
        document.getElementById("trApprovalNote").style.display = 'none';
        document.getElementById("btnApprove").style.display = 'none';
        document.getElementById("btnFinalize").style.display = 'none';
        document.getElementById("btnInActive").style.display = 'none';
        document.getElementById("trResult").style.display = 'none';
        document.getElementById("trResultNote").style.display = 'none';
        document.getElementById("trPassingDate").style.display = 'none';
        document.getElementById("trInActiveNote").style.display = 'none';
    }
    
    if(obj.Name == "Edit Training & Development")
    {
        RefreshControl();
        document.getElementById("trApprovalNote").style.display = 'none';
        document.getElementById("btnApprove").style.display = 'none';
        document.getElementById("btnFinalize").style.display = 'none';
        document.getElementById("btnInActive").style.display = 'none';
        document.getElementById("trResult").style.display = 'none';
        document.getElementById("trResultNote").style.display = 'none';
        document.getElementById("trPassingDate").style.display = 'none';
        document.getElementById("trInActiveNote").style.display = 'none';
    }
    if(obj.Name == "Preview Training & Development")
    {
        RefreshControl();
        RefreshControlForPreview();
        document.getElementById("btnApprove").style.display = 'none';
        document.getElementById("btnFinalize").style.display = 'none';
        document.getElementById("btnInActive").style.display = 'none';
        document.getElementById("trResult").style.display = '';
        document.getElementById("trResultNote").style.display = '';
        document.getElementById("trPassingDate").style.display = '';
        document.getElementById("trInActiveNote").style.display = 'none';

    }
    if(obj.Name == "Approve Training & Development")
    {
        RefreshControl();
        RefreshControlForPreview();
        document.getElementById("btnApprove").style.display = '';
        document.getElementById("btnFinalize").style.display = 'none';
        document.getElementById("btnInActive").style.display = 'none';
        document.getElementById("trResult").style.display = 'none';
        document.getElementById("trResultNote").style.display = 'none';
        document.getElementById("trPassingDate").style.display = 'none';
        document.getElementById("trInActiveNote").style.display = 'none';
        document.getElementById("txtApprovalNote").disabled = false;
        
    }
    if(obj.Name == "Finalize Training & Development")
    {
        RefreshControl();
        RefreshControlForPreview();
        document.getElementById("btnApprove").style.display = 'none';
        document.getElementById("btnFinalize").style.display = '';
        document.getElementById("btnInActive").style.display = 'none';
        document.getElementById("trResult").style.display = '';
        document.getElementById("trResultNote").style.display = '';
        document.getElementById("trPassingDate").style.display = '';
        document.getElementById("trInActiveNote").style.display = 'none';
        document.getElementById("chkComplete").disabled = false;
        if(_oTrainingDevelopment.IsCompleted == false)
        {
            document.getElementById("txtResult").disabled = false;
            document.getElementById("txtResultNote").disabled = false;
            //$('#dtPassingDate').datebox({disabled :false});   
        }
        
    }
    if(obj.Name == "Inactive Training & Development")
    {
        RefreshControl();
        RefreshControlForPreview();
        document.getElementById("btnApprove").style.display = 'none';
        document.getElementById("btnFinalize").style.display = 'none';
        document.getElementById("btnInActive").style.display = '';
        document.getElementById("trResult").style.display = '';
        document.getElementById("trResultNote").style.display = '';
        document.getElementById("trPassingDate").style.display = '';
        document.getElementById("trInActiveNote").style.display = '';
        
    }
    
});

//function  icsdateformat(date)
//{
//    var mthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
//    var y = date.getFullYear();
//    var m = date.getMonth();
//    var d = date.getDate();
//    if(d<10)
//    {
//        d = "0" + d;
//    }
   
//    var result= d +' '+ mthNames[m]+' '+ y;
//    return result;
//}

function RefreshControlForPreview()
{
    
    document.getElementById('btnPickEmployee').disabled = true;
    document.getElementById('btnClearEmployee').disabled = true; 
    document.getElementById('txtEmployee').disabled = true;
    document.getElementById("txtCourseName").disabled = true;
    document.getElementById("txtSpecification").disabled = true 
    document.getElementById("txtInstitute").disabled = true
    document.getElementById("txtVendor").disabled = true;
    document.getElementById("txtCountry").disabled = true;
    document.getElementById("txtState").disabled = true;
    document.getElementById("txtAddress").disabled = true;
    document.getElementById("txtDuration").disabled  = true;

    //$('#dtStartDate').datebox({disabled :true});
    //$('#dtEndDate').datebox({disabled :true});
    //$('#dtActualStartDate').datebox({disabled :true});
    //$('#dtActualEndDate').datebox({disabled :true});
    document.getElementById("btnEffect").disabled = true;
    document.getElementById("txtNote").disabled = true;
    document.getElementById("btnSave").style.display = 'none';
    document.getElementById("trApprovalNote").style.display = '';

    document.getElementById("txtApprovalNote").value = _oTrainingDevelopment.ApprovalNote;
    document.getElementById("txtResult").value = _oTrainingDevelopment.Result;
    document.getElementById("txtResultNote").value = _oTrainingDevelopment.ResultNote;
    $('#dtPassingDate').datebox('setValue',_oTrainingDevelopment.PassingDateInString);
    document.getElementById("chkComplete").checked = _oTrainingDevelopment.IsCompleted;

    document.getElementById("txtApprovalNote").disabled = true;
    document.getElementById("txtResult").disabled = true;
    document.getElementById("txtResultNote").disabled = true;
    //$('#dtPassingDate').datebox({disabled :true});
    document.getElementById("chkComplete").disabled = true;
    
}

function RefreshControl()
{
    _nEmployeeID = _oTrainingDevelopment.EmployeeID;
    document.getElementById('txtEmployee').value = _oTrainingDevelopment.EmployeeName;
    document.getElementById('txtOfficialInfo').value = _oTrainingDevelopment.DesignationName+","+_oTrainingDevelopment.DepartmentName+","+_oTrainingDevelopment.LocationName+". ["+_oTrainingDevelopment.EmployeeTypeName+","+_oTrainingDevelopment.WorkingStatusInString+"]";
    $("#txtLastTrainingInfo")[0].value=_oTrainingDevelopment.CourseName+"-"+ "("+_oTrainingDevelopment.StartDateInString+" to "+_oTrainingDevelopment.EndDateInString+")-"+_oTrainingDevelopment.TrainingStatusInString+"-"+_oTrainingDevelopment.Result;  
    document.getElementById("txtCourseName").value = _oTrainingDevelopment.CourseName;
    document.getElementById("txtSpecification").value = _oTrainingDevelopment.Specification;
    document.getElementById("txtInstitute").value = _oTrainingDevelopment.Institute;
    document.getElementById("txtVendor").value = _oTrainingDevelopment.Vendor;
    document.getElementById("txtCountry").value = _oTrainingDevelopment.Country;
    document.getElementById("txtState").value = _oTrainingDevelopment.State;
    document.getElementById("txtAddress").value = _oTrainingDevelopment.Address;
    document.getElementById("txtDuration").value  = _oTrainingDevelopment.Duration;
    $('#dtStartDate').datebox('setValue',_oTrainingDevelopment.StartDateInString);
    $('#dtEndDate').datebox('setValue',_oTrainingDevelopment.EndDateInString);
    $('#dtActualStartDate').datebox('setValue',_oTrainingDevelopment.EffectFromDateInString);
    $('#dtActualEndDate').datebox('setValue',_oTrainingDevelopment.EffectToDateInString);
    document.getElementById("txtNote").value = _oTrainingDevelopment.Note;
    
}


function ValidateInput() 
{
    if(_nEmployeeID == 0)
    {
        alert("Please Enter Employee !");
        document.getElementById("txtEmployee").style.borderColor = 'red';
        document.getElementById("txtEmployee").focus();
        return false;
    }
        
    if(document.getElementById("txtCourseName").value =="")
    {
        alert("Please Enter Course Name !");
        document.getElementById("txtCourseName").style.borderColor = 'red';
        document.getElementById("txtCourseName").focus();
        return false;
    }
    
    if(document.getElementById("txtSpecification").value =="")
    {
        alert("Please Enter Specification !");
        document.getElementById("txtSpecification").style.borderColor = 'red';
        document.getElementById("txtSpecification").focus();
        return false;
    }
    
    if(document.getElementById("txtInstitute").value =="")
    {
        alert("Please Enter Institute!");
        document.getElementById("txtInstitute").style.borderColor = 'red';
        $('#txtInstitute').focus();
        return false;
    }
    
    if(document.getElementById("txtVendor").value =="")
    {
        alert("Please Enter Vendor!");
        document.getElementById("txtVendor").style.borderColor = 'red';
        $('#txtVendor').focus();
        return false;
    }
    
    if(document.getElementById("txtCountry").value =="")
    {
        alert("Please Enter Country!");
        document.getElementById("txtCountry").style.borderColor = 'red';
        $('#txtCountry').focus();
        return false;
    }
    
    if(document.getElementById("txtState").value =="")
    {
        alert("Please Enter State!");
        document.getElementById("txtState").style.borderColor = 'red';
        $('#txtState').focus();
        return false;
    }
    
    if(document.getElementById("txtAddress").value =="")
    {
        alert("Please Enter Address!");
        document.getElementById("txtAddress").style.borderColor = 'red';
        $('#txtAddress').focus();
        return false;
    }
    
    if(document.getElementById("txtDuration").value =="")
    {
        alert("Please Enter Duration!");
        document.getElementById("txtDuration").style.borderColor = 'red';
        $('#txtDuration').focus();
        return false;
    }
    
    var dStartDate = $('#dtStartDate').datebox('getValue');
    var dEndDate = $('#dtEndDate').datebox('getValue');
    var dActualstartDate = $('#dtActualStartDate').datebox('getValue');
    var dActualEndDate = $('#dtActualEndDate').datebox('getValue');
    
    if(dStartDate>dEndDate)
    {

        alert("Start date should not greater than end date!");
        document.getElementById("dtStartDate").style.borderColor = 'red';
        $('#dtStartDate').focus();
        return false;
    }
    if(dStartDate>dActualstartDate)
    {
        alert("Start date should not greater than actual start date!");
        document.getElementById("dtStartDate").style.borderColor = 'red';
        $('#dtStartDate').focus();
        return false;
    }
    
    if(dStartDate>dActualEndDate)
    {
        alert("Start date should not greater than actual end date!");
        document.getElementById("dtStartDate").style.borderColor = 'red';
        $('#dtStartDate').focus();
        return false;
    }
    
   
    if(dEndDate>dActualEndDate)
    {
        alert("End date should not greater than actual end date!");
        document.getElementById("dtStartDate").style.borderColor = 'red';
        $('#dtStartDate').focus();
        return false;
    }    
    
    return true;
}


function RefreshObject() 
{
    
    var oTrainingDevelopment = {
        TDID : _oTrainingDevelopment.TDID,
        EmployeeID: _nEmployeeID,
        CourseName: document.getElementById("txtCourseName").value,
        Specification: document.getElementById("txtSpecification").value, 
        Institute: document.getElementById("txtInstitute").value,
        Vendor: document.getElementById("txtVendor").value,
        Country : document.getElementById("txtCountry").value,
        State : document.getElementById("txtState").value,
        Address : document.getElementById("txtAddress").value,
        Duration : document.getElementById("txtDuration").value,
        StartDate: $('#dtStartDate').datebox('getValue'),
        EndDate: $('#dtEndDate').datebox('getValue'),
        EffectFromDate: $('#dtActualStartDate').datebox('getValue'),
        EffectToDate: $('#dtActualEndDate').datebox('getValue'),
        Note : document.getElementById("txtNote").value

    };

    return oTrainingDevelopment;
}

function Save() 
{
    if (!ValidateInput()) return;
     
    var oTrainingDevelopment = RefreshObject();
    
    $.ajax({
    type: "POST",
    dataType: "json",
    url: _sBaseAddress + "/TrainingDevelopment/TrainingDevelopment_IU",
    traditional: true,
    data: JSON.stringify(oTrainingDevelopment),
    contentType: "application/json; charset=utf-8",

    success: function(data) {
        
        var oTrainingDevelopment = jQuery.parseJSON(data);
        if (oTrainingDevelopment.TDID > 0) {
            alert("Data Saved sucessfully");
            window.returnValue = oTrainingDevelopment;
            window.close();
        } else {
            alert(oTrainingDevelopment.ErrorMessage);
        }
    },
    error: function(xhr, status, error) {
        alert(error);
    }
    });
    
}

$('#txtEmployee').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sEmpCode=document.getElementById("txtEmployee").value;
        
    if (code == 13)//Enter key-13
    {
        if(sEmpCode=="")
        {
            alert("Please Enter Code !");
            return;
        }
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/Employee/EmployeePikerByCode?sCode="+sEmpCode+"&nDepartmentID=0&nts="+nts;
        var nLeft=(window.screen.width/2)-(515/2);
        var nHeight=(window.screen.height/2)-(415/2);
        _oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:415px;dialogWidth:515px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:405px;dialogWidth:510px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
            
        if(_oEmployee!=null)
        {

            if(_oEmployee.DesignationName=="" || _oEmployee.DepartmentName=="" || _oEmployee.LocationName=="")
            {
                alert("This Employee Has No Official Information !");
                return;
            }

            if(_oEmployee.IsActive == false)
            {
                alert("InActive Employee. Work can not be assigned for this employee!");
                return;
            }

            if(_oEmployee.WorkingStatus != 1)
            {
                alert("This employee is not in work place!");
                return;
            }

            $("#txtOfficialInfo")[0].value = _oEmployee.DesignationName+"," + _oEmployee.DepartmentName +","+_oEmployee.LocationName+"["+_oEmployee.WorkingStatusInString+"]";
            $("#txtEmployee")[0].value=_oEmployee.Name;
            _nEmployeeID=_oEmployee.EmployeeID;
            GetLastTrainingInfo();
            $('#txtCourseName').focus();
        }
    }
});

$('#btnPickEmployee').click(function (e)
{

    var oParameter = new Object();
    oParameter.Name = "Employee Advance Search";
    oParameter.MultipleItemReturn=false;
    var url = _sBaseAddress + "/Employee/EmployeeHRMPiker";
    var nLeft=(window.screen.width/2)-(1000/2);
    var nHeight=(window.screen.height/2)-(530/2);
    _oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:530px;dialogWidth:1000px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
    //_oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:510px;dialogWidth:945px;dialogLeft:200;dialogRight:50;dialogTop:100;center:yes;resizable:yes;status:no;scroll:no');
    if(_oEmployee!=null)
    {
        if(_oEmployee.DesignationName=="" || _oEmployee.DepartmentName=="" || _oEmployee.LocationName=="")
        {
            alert("This Employee Has No Official Information !");
            return;
        }
        
        if(_oEmployee.IsActive == false)
        {
            alert("InActive Employee. Work can not be assigned for this employee!");
            return;
        }
        if(_oEmployee.WorkingStatus != 1)
        {
            alert("This employee is not in work place!");
            return;
        }

        $("#txtOfficialInfo")[0].value = _oEmployee.DesignationName+"," + _oEmployee.DepartmentName +","+_oEmployee.LocationName+"["+_oEmployee.WorkingStatusInString+"]";
        $("#txtEmployee")[0].value=_oEmployee.Name;
        
        _nEmployeeID = _oEmployee.EmployeeID;
        GetLastTrainingInfo();
    }
});

$('#txtCourseName').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCourseName = document.getElementById('txtCourseName').value;
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerByCourseName?sCourseName="+sCourseName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtCourseName")[0].value=_oTrainingDevelopment.CourseName;
            $('#txtSpecification').focus();
        }   
    }
});

$('#txtSpecification').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCourseName = document.getElementById("txtCourseName").value;
    if(sCourseName == "")
    {
        alert("Please Enter Course Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForSpecification?sCourseName="+sCourseName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');

        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtSpecification")[0].value=_oTrainingDevelopment.Specification;
            $('#txtInstitute').focus();
        }   
    }
});

$('#txtInstitute').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCourseName = document.getElementById("txtCourseName").value;
    if(sCourseName == "")
    {
        alert("Please Enter Course Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForInstitute?sCourseName="+sCourseName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtInstitute")[0].value=_oTrainingDevelopment.Institute;
            $('#txtVendor').focus();
        }   
    }
});

$('#txtVendor').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCourseName = document.getElementById("txtCourseName").value;
    if(sCourseName == "")
    {
        alert("Please Enter Course Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForVendor?sCourseName="+sCourseName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtVendor")[0].value=_oTrainingDevelopment.Vendor;
            $('#txtCountry').focus();
        }   
    }
});

$('#txtCountry').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForCountry?nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtCountry")[0].value=_oTrainingDevelopment.Country;
            $('#txtState').focus();
        }   
    }
});

$('#txtState').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCountryName = document.getElementById("txtCountry").value;
    if(sCountryName == "")
    {
        alert("Please Enter Country Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForState?sCountryName="+sCountryName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtState")[0].value=_oTrainingDevelopment.State;
            $('#txtAddress').focus();
        }   
    }
});

$('#txtAddress').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sInstituteName = document.getElementById("txtInstitute").value;
    if(sInstituteName == "")
    {
        alert("Please Enter Institute Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForAddress?sInstituteName="+sInstituteName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtAddress")[0].value=_oTrainingDevelopment.Address;
            $('#txtDuration').focus();
        }   
    }
});

$('#txtDuration').keypress(function (e) 
{
    var code = (e.keyCode ? e.keyCode : e.which);
    var sCourseName = document.getElementById("txtCourseName").value;
    if(sCourseName == "")
    {
        alert("Please Enter Course Name !!");
        return;
    }
        
    if (code == 13)//Enter key-13
    {
       
        var nts=(new Date()).getTime()/1000;
        var oParameter = new Object();
        oParameter.MultipleItemReturn = false;
        var url = _sBaseAddress + "/TrainingDevelopment/TrainingDevelopmentPikerForDuration?sCourseName="+sCourseName+"&nts="+nts;
        var nLeft=(window.screen.width/2)-(260/2);
        var nHeight=(window.screen.height/2)-(350/2);
        _oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
        //_oTrainingDevelopment = window.showModalDialog(url, oParameter, 'dialogHeight:350px;dialogWidth:260px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
        if(_oTrainingDevelopment !=null)
        {
            $("#txtDuration")[0].value=_oTrainingDevelopment.Duration;
        }   
    }
});

$('#btnClearEmployee').click(function (e)
{
    $("#txtEmployee")[0].value="";
    $("#txtOfficialInfo")[0].value="";
    $("#txtLastTrainingInfo")[0].value="";
    _nEmployeeID = 0;

});

$('#btnEffect').click(function (e)
{
    var dStartDate =  $('#dtStartDate').datebox('getValue'); 
    var dEndDate =  $('#dtEndDate').datebox('getValue');
    $('#dtActualStartDate').datebox('setValue',dStartDate);
    $('#dtActualEndDate').datebox('setValue',dEndDate); 

});

function GetLastTrainingInfo()
{

    $.ajax({
    type: "POST",
    dataType: "json",
    url: _sBaseAddress + "/TrainingDevelopment/GetLastTrainingInfo",
    traditional: true,
    data: JSON.stringify({nEmployeeID :_nEmployeeID}),
    contentType: "application/json; charset=utf-8",

    success: function(data) {
        
        var oTrainingDevelopment = jQuery.parseJSON(data);
        if (oTrainingDevelopment.TDID > 0) 
        {
            $("#txtLastTrainingInfo")[0].value=oTrainingDevelopment.CourseName+"-"+ "("+oTrainingDevelopment.StartDateInString+" to "+oTrainingDevelopment.EndDateInString+")-"+oTrainingDevelopment.TrainingStatusInString+"-"+oTrainingDevelopment.Result;  
        }
        else
        {
           $("#txtLastTrainingInfo")[0].value= "Nill" ;
        }
    },
    error: function(xhr, status, error) 
    {
        alert(error);
    }
    }); 

}

$('#btnApprove').click(function (e)
{
    var sApprovalNote = document.getElementById('txtApprovalNote').value;
   
    $.ajax({
    type: "POST",
    dataType: "json",
    url: _sBaseAddress + "/TrainingDevelopment/TrainingDevelopment_Approve",
    traditional: true,
    data: JSON.stringify({sApprovalNote :sApprovalNote,nTDID: _oTrainingDevelopment.TDID}),
    contentType: "application/json; charset=utf-8",

    success: function(data) {
             
             oTrainingDevelopment = jQuery.parseJSON(data);
             if (oTrainingDevelopment.TDID > 0)
             {
                alert("Approved sucessfully !");
                window.returnValue = oTrainingDevelopment;
                window.close();  
             } 
             else
             {
                 alert(oTrainingDevelopment.ErrorMessage);
             }
         }
         
     });

});

$('#btnFinalize').click(function (e)
{
    
    var sResult = document.getElementById('txtResult').value;
    var sResultNote = document.getElementById('txtResultNote').value;
    var dPassingDate =  $('#dtPassingDate').datebox('getValue');
    var IsComplete = 0;
    if(document.getElementById("chkComplete").checked)
    {
        IsComplete = 1;
        if(sResult == "")
        {
            alert("Please enter Result !");
            return;
        }
    }
   
    $.ajax({
    type: "POST",
    dataType: "json",
    url: _sBaseAddress + "/TrainingDevelopment/TrainingDevelopment_Finalize",
    traditional: true,
    data: JSON.stringify({sResult :sResult,sResultNote : sResultNote,dPassingDate : dPassingDate,IsComplete :IsComplete,nTDID: _oTrainingDevelopment.TDID}),
    contentType: "application/json; charset=utf-8",

    success: function(data) {
             
             oTrainingDevelopment = jQuery.parseJSON(data);
             if (oTrainingDevelopment.TDID > 0)
             {
                alert("Finalize sucessfully !");
                window.returnValue = oTrainingDevelopment;
                window.close();  
             } 
             else
             {
                 alert(oTrainingDevelopment.ErrorMessage);
             }
         }
         
     });

});

$('#btnInActive').click(function (e)
{
    var sInActiveNote = document.getElementById('txtInActiveNote').value;
   
    $.ajax({
    type: "POST",
    dataType: "json",
    url: _sBaseAddress + "/TrainingDevelopment/TrainingDevelopment_InActive",
    traditional: true,
    data: JSON.stringify({sInActiveNote :sInActiveNote,nTDID: _oTrainingDevelopment.TDID}),
    contentType: "application/json; charset=utf-8",

    success: function(data) {
             
             oTrainingDevelopment = jQuery.parseJSON(data);
             if (oTrainingDevelopment.TDID > 0)
             {
                alert("InActivated sucessfully !");
                window.returnValue = oTrainingDevelopment;
                window.close();  
             } 
             else
             {
                 alert(oTrainingDevelopment.ErrorMessage);
             }
         }
         
     });

});

function Close() 
{
    window.close();
}
$(document).keydown(function (e)
{
    var keyCode = e.keyCode || e.which;
    if (keyCode == 27)
    {
        window.close();
    }
});
</script>