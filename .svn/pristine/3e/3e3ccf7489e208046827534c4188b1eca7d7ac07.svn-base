<html>
<head>
    <title></title>
</head>
<body>
    @model ESimSol.BusinessObjects.PFScheme
        <div class="menuMainCollectionTable">
            <fieldset>
                <legend>PF Scheme</legend>
                <table border="0" style="width:100%;">
                    <tr>
                        <td colspan="2" style="text-align:right; padding-right:1%;">
                            <label>Recognize: </label>
                            <span>
                                <input id="chkRecognize" type="checkbox" />
                            </span>
                           
                        </td>
                    </tr>
                    <tr>
                        <td class="td-left"><label>Scheme Name: </label></td>
                        <td class="td-right">
                            <input id="txtSchemeName" type="text" class="cls-txt" placeholder="Scheme name" />
                        </td>
                    </tr>
                    <tr>
                        <td class="td-left"><label>Description: </label></td>
                        <td class="td-right">
                            <input id="txtDescription" type="text" class="cls-txt" placeholder="Description of the scheme" />
                        </td>
                    </tr>
                    <tr>
                        <td class="td-left"><label>Salary Head: </label></td>
                        <td class="td-right">
                            <select id="cboSalaryHead" class="cls-cbo"></select>
                        </td>
                    </tr>
                </table>
            </fieldset>
            <table border="0">
                <tr>
                    <td>
                        <fieldset>
                            <legend>Employee's Contribution</legend>
                            <div style="float:left; width:100%; padding-bottom:5px;">
                                <div style="float:left; width:20%; text-align:right;">
                                    <label>Salary Range:</label>
                                </div>
                                <div style="float:left; width:78%; text-align:left;margin-left:3px;">
                                    <input type="text" id="txtMinAmount" style="width:40%" />
                                    <span> to </span>
                                    <input type="text" id="txtMaxAmount" style="width:49%" />
                                </div>
                            </div>
                            <div style="float:left; width:100%; padding-bottom:5px;">
                                <div style="float:left; width:20%; text-align:right;">
                                    <label>Contribution:</label>
                                </div>
                                <div style="float:left; width:78%; text-align:left;margin-left:3px;">
                                    <div class="region-value">
                                        <div style="width:41.5%; height:19px; float:left; margin-top:2px; border:1px solid Grey">
                                            <label id="lblCurrency" style="float:left;"></label>
                                            <input id="txtFixedValue" style="width:83%; border:0; float:left;" />
                                        </div>
                                        <span style="padding-left:3px;">Or</span>
                                        <input id="txtPercentage" style="width:40px;"/>
                                        <span> % of </span>
                                        <select id="cboCalculationOn"></select>
                                    </div>
                                </div>
                            </div>

                            <table id="tblPFMemberContribution" class="easyui-datagrid" style="width:475px;height:250px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarPFMC">
                                <thead>
                                    <tr>
                                        <th field="ContributionRange" width="20%" align="left">Range</th>
                                        <th field="EmployeeContribution" width="50%" align="left">Contribution</th>
                                        <th field="ActivityStatus" width="15%" align="left">Status</th>
                                    </tr>
                                </thead>
                            </table>
                            <div id="toolbarPFMC">
                                <a id="btnAddPFMC" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true"></a>
                                <a id="btnDeletePFMC" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true"></a>
                                <a id="btnActivityPFMC" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true"></a>
                            </div>
                        </fieldset>

                    </td>
                    <td>

                        <fieldset>
                            <legend>PF Benefits</legend>
                            <div style="float:left; width:100%; padding-bottom:5px;">
                                <div style="float:left; width:18%; text-align:right;">
                                    <label>Maturity After:</label>
                                </div>
                                <div style="float:left; width:80%; text-align:left;margin-left:3px;">
                                    <select id="cboMaturityYear" style="width:16%; text-align:right;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                    </select>

                                    <span> Years of </span>
                                    <select id="cboMaturityYrCalculateAfter" style="width:60%;"></select>
                                </div>
                            </div>
                            <div style="float:left; width:100%; padding-bottom:10px;">
                                <div style="float:left; width:18%; text-align:right;">
                                    Benefits:
                                </div>
                                <div style="float:left; width:80%; text-align:left;margin-left:3px;">
                                    <input id="txtContributionPercentage" style="width:14.6%;" />
                                    <label> % of employeer contribution</label>
                                    <input type="checkbox" id="chkProfitShare" />
                                    <label> with profit share.</label>
                                </div>
                            </div>

                            <table id="tblPFSchemeBenefit" class="easyui-datagrid" style="width:475px;height:250px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarPFB">
                                <thead>
                                    <tr>
                                        <th field="Maturity" width="20%" align="left">Maturity</th>
                                        <th field="Benefit" width="50%" align="left">Benefit</th>
                                        <th field="ActivityStatus" width="15%" align="left">Status</th>
                                    </tr>
                                </thead>
                            </table>
                            <div id="toolbarPFB">
                                <a id="btnAddPFB" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true"></a>
                                <a id="btnDeletePFB" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true"></a>
                                <a id="btnActivityPFB" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true"></a>
                            </div>
                        </fieldset>

                    </td>
                </tr>
            </table>

            <fieldset>
                <legend>Action</legend>
                <div style="width:100%; text-align:right;">
                    <a id="btnReset" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>
                    <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                    <a id="btnCancel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Cancel</a>
                </div>
            </fieldset>
</div>
</body>
</html>
<style type="text/css">

    .td-left {
        width: 9%;
        text-align: right;
    }

    .td-right {
        width: 90%;
        text-align: left;
    }

    .td-right .cls-cbo {
        width: 98.5%;
    }

    .td-right .cls-txt {
        width: 98%;
    }

    .td-right .cls-cbo {
        width: 99%;
    }

</style>
<script type="text/javascript">
    var _sBaseAddress="";
    var _oSalaryHeads=[];
    var _oCalculationOns=[];
    var _oRecruitmentEvents=[];
    var _oPFS=null;
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oPFScheme =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        var sCurrencySymbol =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.CurrencySymbol));
        _oSalaryHeads =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.SalaryHeads));
        _oCalculationOns =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.CalculationOns));
        _oRecruitmentEvents =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.RecruitmentEvents));
        $('#txtFixedValue,#txtPercentage,#txtContributionPercentage,#txtMinAmount,#txtMaxAmount').icsCurrencyBox();
        $('#lblCurrency').text(sCurrencySymbol);
        $("#cboSalaryHead").icsLoadCombo({
            List: _oSalaryHeads,
            OptionValue: "SalaryHeadID",
            DisplayText: "Name"
        });
        $("#cboCalculationOn").icsLoadCombo({
            List: _oCalculationOns,
            OptionValue: "Value",
            DisplayText: "Text"
        });
        $("#cboMaturityYrCalculateAfter").icsLoadCombo({
            List: _oRecruitmentEvents,
            OptionValue: "Value",
            DisplayText: "Text"
        });
        Initialization(oPFScheme,((sessionStorage.length>0)?sessionStorage.getItem('Operation'):'New'));
    });

    $(document).keydown(function (e) { if (e.keyCode == 27) { $('#div').icsWindow('close'); } });
  
    $('#txtFixedValue').keyup(function(e){

        if($('#txtFixedValue').val()>0){
            $('#txtPercentage').val("");
            $('#cboCalculationOn').val(0);
            $('#cboCalculationOn').prop('disabled',true);

        }
        else{
            $('#cboCalculationOn').val(0);
            $('#cboCalculationOn').prop('disabled',false);
        }
    });

    $('#txtPercentage').keyup(function(e){

        if($('#txtPercentage').val()>0){
            $('#txtFixedValue').val("");
            // $('#txtFixedValue').prop('disabled',true);
            $('#cboCalculationOn').val(0);
            $('#cboCalculationOn').prop('disabled',false);
        }
        //else{
        //    $('#txtFixedValue').prop('disabled',false);
        //}
    });


    function Initialization(oPFScheme,sOperation){
        ResetControl();
        RefreshControl(oPFScheme);
        if(sOperation=="View"){
            $('input,select').prop('disabled',true);
            $('#toolbarPFMC,#toolbarPFB').hide();
            $('#btnSave').hide();
        }
    }

    function ResetControl(){
        _oPFS=null;
        $('input').val('');
        $('select').val(0);
        $('input,select').prop('disabled',false);
        DynamicRefreshList([],'tblPFMemberContribution');
        $('#toolbarPFMC,#toolbarPFB').show();
        DynamicRefreshList([],'tblPFSchemeBenefit');
        $('#btnSave').show();
    }

    function RefreshControl(oPFScheme){
        _oPFS=oPFScheme;
        $('#chkRecognize').prop('checked',oPFScheme.IsRecognize);
        $('#txtSchemeName').val(oPFScheme.Name);
        $('#txtDescription').val(oPFScheme.Description);
        $('#cboSalaryHead').val(oPFScheme.RecommandedSalaryHeadID);
        $('#cboCalculationOn').val(oPFScheme.CalculationOnInInt);

        if(oPFScheme.IsPercent){
            $('#txtFixedValue').val("");
            $('#txtPercentage').val(oPFScheme.Value);
           // $('#txtFixedValue').prop('disabled',true);
        }
        else{
            $('#txtFixedValue').val(oPFScheme.Value);
            $('#txtPercentage').val("");
            $('#cboCalculationOn').prop('disabled',true);
        }
        DynamicRefreshList(oPFScheme.PFMCs,'tblPFMemberContribution');
        DynamicRefreshList(oPFScheme.PFBs,'tblPFSchemeBenefit');

    }

    function RefreshObjectPF(){
        var oPFS = {
            PFSchemeID:(_oPFS!=null)? _oPFS.PFSchemeID: 0,
            Name: $.trim($('#txtSchemeName').val()),
            IsRecognize : $('#chkRecognize').is(':checked'),
            RecommandedSalaryHeadID:$('#cboSalaryHead').val(),
            Description : $.trim($('#txtDescription').val()),
            IsActive : (_oPFS!=null)? _oPFS.IsActive: false
        };
        return oPFS;
    }

    function RefreshObjectPFMC(){
        var IsPercent=(icsRemoveComma($('#txtPercentage').val())>icsRemoveComma($('#txtFixedValue').val()))?true:false;
        var oPFS = {
            PFMCID:0,
            PFSchemeID:(_oPFS!=null)? _oPFS.PFSchemeID: 0,
            MinAmount: icsRemoveComma($('#txtMinAmount').val()),
            MaxAmount : icsRemoveComma($('#txtMaxAmount').val()),
            IsPercent:IsPercent,
            Value:(IsPercent)?icsRemoveComma($('#txtPercentage').val()):icsRemoveComma($('#txtFixedValue').val()),
            CalculationOn : $('#cboCalculationOn option:selected').text(),
            IsActive : true,
            PFS:(_oPFS==null || _oPFS.PFSchemeID<=0) ? RefreshObjectPF(): null,
        };
        return oPFS;
    }

    function RefreshObjectPFB(){
        var oPFB = {
            PFSBID : 0,
            PFSchemeID : (_oPFS!=null) ? _oPFS.PFSchemeID: 0,
            MaturityYear : $('#cboMaturityYear').val(),
            MaturityYrCalculateAfter : $('#cboMaturityYrCalculateAfter option:selected').text(),
            ContributionPercentage : icsRemoveComma($('#txtContributionPercentage').val()),
            IsProfitShare: $('#chkProfitShare').is(':checked'),
            IsActive: true,
            PFS:(_oPFS==null || _oPFS.PFSchemeID<=0) ? RefreshObjectPF(): null,
        };


        return oPFB;
    }


    function Validation(){

        if ($.trim($("#txtSchemeName").val()) == "") {
            alert("Please scheme name.");
            $("#txtSchemeName").addClass("errorFieldBorder");
            $("#txtSchemeName").focus();
            return false;
        } else {
            $("#txtSchemeName").removeClass("errorFieldBorder");
        }

        if ($("#cboSalaryHead").val() <=0) {
            alert("Please select a salary head.");
            $("#cboSalaryHead").addClass("errorFieldBorder");
            $("#cboSalaryHead").focus();
            return false;
        } else {
            $("#cboSalaryHead").removeClass("errorFieldBorder");
        }
        return true;
    }

    function ValidationPFMC(){

        if($('#txtMinAmount').val().toString().length<=0)
        {
            alert("Please enter minimum amount.");
            $("#txtMinAmount").addClass("errorFieldBorder");
            $("#txtMinAmount").focus();
            return false;
        }
        else {
            $("#txtMinAmount").removeClass("errorFieldBorder");
        }
        
        if($('#txtMaxAmount').val().toString().length<=0)
        {
            alert("Please enter maximum amount.");
            $("#txtMaxAmount").addClass("errorFieldBorder");
            $("#txtMaxAmount").focus();
            return false;
        }
        else {
            $("#txtMaxAmount").removeClass("errorFieldBorder");
        }

        if(parseFloat(icsRemoveComma($('#txtMinAmount').val()))>parseFloat(icsRemoveComma($('#txtMaxAmount').val())))
        {
            alert("Maximum amount must be greater than minimum amount.");
            $("#txtMinAmount").addClass("errorFieldBorder");
            $("#txtMinAmount").focus();
            return false;
        }
        else {
            $("#txtMinAmount").removeClass("errorFieldBorder");
        }

        if($('#txtFixedValue').val().toString().length<=0 && $('#txtPercentage').val().toString().length<=0)
        {
            alert("Please enter employee contribution.");
            $("#txtFixedValue").addClass("errorFieldBorder");
            $("#txtFixedValue").focus();
            return false;

        }
        else if($('#txtFixedValue').val().toString().length<=0 && icsRemoveComma($('#txtPercentage').val())>0 && $("#cboCalculationOn").val()<=0)
        {
            alert("Please select percentage of calculation.");
            $("#cboCalculationOn").addClass("errorFieldBorder");
            $("#cboCalculationOn").focus();
            return false;

        }
        else {
            $("#cboCalculationOn").removeClass("errorFieldBorder");
        }

        if ($('#txtFixedValue').val().toString().length<=0 && ($('#txtPercentage').val().toString().length>0 || icsRemoveComma($('#txtPercentage').val())<=0) && $("#cboCalculationOn").val() <=0) {
            alert("Please select percentage of calculation.");
            $("#cboCalculationOn").addClass("errorFieldBorder");
            $("#cboCalculationOn").focus();
            return false;
        } else {
            $("#cboCalculationOn").removeClass("errorFieldBorder");
        }
        return true;
    }

    function ValidationPFB(){

        if ($("#cboMaturityYrCalculateAfter").val() <=0) {
            alert("Select maturity years after.");
            $("#cboMaturityYrCalculateAfter").addClass("errorFieldBorder");
            $("#cboMaturityYrCalculateAfter").focus();
            return false;
        } else {
            $("#cboMaturityYrCalculateAfter").removeClass("errorFieldBorder");
        }

        if ($('#txtContributionPercentage').val().toString().length<=0 || icsRemoveComma($('#txtContributionPercentage').val())<=0) {
            alert("Enter employeer contribution percentage.");
            $("#txtContributionPercentage").addClass("errorFieldBorder");
            $("#txtContributionPercentage").focus();
            return false;
        } else {
            $("#txtContributionPercentage").removeClass("errorFieldBorder");
        }

        return true;
    }



    

    /*---- PF Employee Contribution  ----*/

    function SaveWithEmployeeContribution(IsClose){
        debugger;
        if(!Validation()) return false;
        if(!ValidationPFMC()) return false;
        var oPFMC = RefreshObjectPFMC();
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oPFMC,
            ObjectId: oPFMC.PFMCID,
            ControllerName: "PFScheme",
            ActionName: "SavePFMC",
            TableId: "tblPFMemberContribution",
            IsWinClose: false,
            Message:(oPFMC.PFMCID>0)?"Update Successfully." : "Save Successfully."
        };
        $.icsSave(obj, function (response) {
            if (response.status && response.obj != null) {
                if (response.obj.PFS!=null && response.obj.PFS.PFSchemeID>0) {
                    $('#tblPFScheme').datagrid('appendRow',response.obj.PFS);
                    response.obj.PFS.PFMCs = $('#tblPFMemberContribution').datagrid('getRows');
                    response.obj.PFS.PFBs = $('#tblPFSchemeBenefit').datagrid('getRows');
                    RefreshControl(response.obj.PFS);
                    if(IsClose ){
                        ResetControl();
                    }
                }
                if(response.obj.PFMCID>0){
                    $('#txtMinAmount,#txtMaxAmount,#txtFixedValue,#txtPercentage').val('');
                    $('#cboCalculationOn').val(0);
                    $('#txtMinAmount').focus();
                }
            }
        });
    }

    $('#txtMinAmount').keydown(function(e){
        debugger;
        if(e.keyCode==27){
            $('#txtMinAmount').val('');
            $('#cboMaturityYear').focus();
        }
    });

    $('#btnAddPFMC').click(function(e){
        SaveWithEmployeeContribution(false);
    });

    $('#btnDeletePFMC').click(function(e){

        
        var oPFMC = $('#tblPFMemberContribution').datagrid('getSelected');

        if (oPFMC == null || oPFMC.PFMCID <= 0) {
            alert("Please select an item from list");
            return false;
        }
        if (!confirm("Confirm to Delete?")) return;
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oPFMC,
            ControllerName: "PFScheme",
            ActionName: "DeletePFMC",
            TableId: "tblPFMemberContribution",
            IsWinClose: false
        };
        $.icsDelete(obj);
    });

    $("#btnActivityPFMC").click(function (e) {

        debugger;
        var oPFMC = $('#tblPFMemberContribution').datagrid('getSelected');

        if (oPFMC == null || oPFMC.PFMCID <= 0) {
            alert("Please select an item from contribution list");
            return false;
        }

        if (!confirm((oPFMC.IsActive) ?"Confirm to inactive?":"Confirm to active?")) return;
        var nIndex=$('#tblPFMemberContribution').datagrid('getRowIndex',oPFMC);
        oPFMC.PFS=null;
        var obj =
            {
                BaseAddress: _sBaseAddress,
                Object: oPFMC,
                ObjectId: oPFMC.PFMCID,
                ControllerName: "PFScheme",
                ActionName: "ActivityChangePFMC",
                TableId: "tblPFMemberContribution",
                IsWinClose: false,
                Message: ""
            };
        $.icsSave(obj, function (response) {
            if (response.status && response.obj != null) {
                RowSelect(nIndex,response.obj);
            }
        });

    });


    /*---- PF Benefits ----*/
 
    function SaveWithPFBenefits(IsClose){
        debugger;
        if(!Validation()) return false;
        if(!ValidationPFB()) return false;
        var oPFBenefit = RefreshObjectPFB();
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oPFBenefit,
            ObjectId: oPFBenefit.PFSBID,
            ControllerName: "PFScheme",
            ActionName: "SavePFB",
            TableId: "tblPFSchemeBenefit",
            IsWinClose: false,
            Message:(oPFBenefit.PFSBID>0)?"Update Successfully." : "Save Successfully."
        };
        $.icsSave(obj, function (response) {
            if (response.status && response.obj != null) {
                if (response.obj.PFS!=null && response.obj.PFS.PFSchemeID>0) {
                    $('#tblPFScheme').datagrid('appendRow',response.obj.PFS);
                    response.obj.PFS.PFMCs = $('#tblPFMemberContribution').datagrid('getRows');
                    response.obj.PFS.PFBs = $('#tblPFSchemeBenefit').datagrid('getRows');
                    RefreshControl(response.obj.PFS);
                    if(IsClose ){
                        ResetControl();
                    }
                }
                if(response.obj.PFSBID>0){
                    $('#cboMaturityYear').val(1);
                    $('#cboMaturityYrCalculateAfter').val(0);
                    $('#txtContributionPercentage').val(0);
                    $('#chkProfitShare').prop('checked',false);
                    $('#cboMaturityYear').focus();
                }
            }
        });
    }
  
    $('#cboMaturityYear').keydown(function(e){

        if(e.keyCode==27){
            $('#cboMaturityYear').val(0);
            $('#btnSave').focus();
        }
    });
   
    $('#btnAddPFB').click(function(e){
        if(_oPFS==null || _oPFS.PFSchemeID<=0 || ($('#tblPFMemberContribution').datagrid('getRows')).length<=0){
            alert("Please add employee's contribution first.");
            return false;
        }
        SaveWithPFBenefits(false);
    });

    $('#btnDeletePFB').click(function(e){

        var oPFB = $('#tblPFSchemeBenefit').datagrid('getSelected');

        if (oPFB == null || oPFB.PFSBID <= 0) {
            alert("Please select an item from list");
            return false;
        }
        if (!confirm("Confirm to Delete?")) return;
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oPFB,
            ControllerName: "PFScheme",
            ActionName: "DeletePFB",
            TableId: "tblPFSchemeBenefit",
            IsWinClose: false
        };
        $.icsDelete(obj);
    });

    $("#btnActivityPFB").click(function (e) {

        debugger;
        var oPFB = $('#tblPFSchemeBenefit').datagrid('getSelected');

        if (oPFB == null || oPFB.PFSBID <= 0) {
            alert("Please select an item from benefits list");
            return false;
        }

        if (!confirm((oPFB.IsActive) ?"Confirm to inactive?":"Confirm to active?")) return;
        var nIndex=$('#tblPFSchemeBenefit').datagrid('getRowIndex',oPFB);
        oPFB.PFS=null;
        var obj =
            {
                BaseAddress: _sBaseAddress,
                Object: oPFB,
                ObjectId: oPFB.PFSBID,
                ControllerName: "PFScheme",
                ActionName: "ActivityChangePFB",
                TableId: "tblPFSchemeBenefit",
                IsWinClose: false,
                Message: ""
            };
        $.icsSave(obj, function (response) {
            if (response.status && response.obj != null) {
                RowSelect(nIndex,response.obj);
            }
        });

    });





    $('#btnSave').click(function(e){

        debugger;
        if(_oPFS==null || _oPFS.PFSchemeID<=0 || ($('#tblPFMemberContribution').datagrid('getRows')).length<=0){
            alert("Please add employee's contribution first.");
            return false;
        }
        else{
            if (!Validation()) return false;
            var oPFScheme = RefreshObjectPF();
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oPFScheme,
                ObjectId: oPFScheme.PFSchemeID,
                ControllerName: "PFScheme",
                ActionName: "SavePF",
                TableId: "",
                IsWinClose: false,
                Message: (oPFScheme.PFSchemeID>0)?"Update Successfully." : "Save Successfully."
            };
            $.icsSave(obj, function (response) {
                debugger;
                if (response.status && response.obj != null) {
                    if (response.obj!=null && response.obj.PFSchemeID>0) {
                        window.location.href = sessionStorage.getItem("BackLink");
                        ResetControl();
                    }
                }
            });
        }
    });

    $('#btnCancel').click(function(e){
        ResetControl();
        window.location.href = sessionStorage.getItem("BackLink");
    });

    $('#btnReset').click(function(e){

        sessionStorage.setItem('Operation','New');
        ResetControl();
    });
    



</script>