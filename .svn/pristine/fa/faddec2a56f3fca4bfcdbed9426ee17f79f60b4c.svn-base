<html>
<head>
    <title>Export Bill Send to Party </title>
</head>
<body>

    @model ESimSol.BusinessObjects.ExportBill
  
    <div class="menuMainCollectionTable">
        <div style="width:100%;height:88%">
            <fieldset>
             <legend style="font-weight:bold">L/C & Invoice info </legend>
                <table border="0"  cellspacing="2" cellpadding="2" style=" width:100%;font-size:12px; font-weight:bold">
                    <tr>
                        <td style="width:20%; text-align:right">
                            Invoice No :
                        </td>
                        <td style="width:30%;font-size:12px; font-weight:bold">
                            <input id="txtExportBillNo" style="width: 100%;font-size:12px; font-weight:bold" font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right"></td>
                        <td style="width:25%"></td>
                        <td style="width:10%; text-align:right">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            L/C No :
                        </td>
                        <td style="width:25%">
                            <input id="txtLCNo" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right">
                            <label id="lblAmendmentNo">Amendment No :</label>  
                        </td>
                        <td style="width:25%">
                            <input id="txtAmendmentNoAndDate" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            File No :
                        </td>
                        <td style="width:25%">
                            <input id="txtFileNo" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right"></td>
                        <td style="width:25%"></td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Party Name :
                        </td>
                        <td colspan="3" style="width:70%">
                            <input id="txtApplicantName" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Advice Bank :
                        </td>
                        <td colspan="3" style="width:70%">
                            <input id="txtBankNameAdvice" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Issue Bank :
                        </td>
                        <td colspan="3" style="width:70%">
                            <input id="txtBankNameIssue" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Negotiation Bank :
                        </td>
                        <td colspan="3" style="width:70%">
                            <input id="txtBankNameNego" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:12%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Bill Date :
                        </td>
                        <td style="width:30%">
                            <input id="txtExportBillDate" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right">
                            L/C Date :
                        </td>
                        <td style="width:25%">
                            <input id="txtLCDate" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Bill Value :
                        </td>
                        <td style="width:30%">
                            <input id="txtIAmountSt" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right">
                            L/C Value :
                        </td>
                        <td style="width:25%">
                            <input id="txtIAmountLC" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                  
                    <tr>
                        <td style="width:20%; text-align:right">
                            Send To Bank :
                        </td>
                        <td style="width:30%">
                            <input id="txtSendToBankDateSt" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>

                        <td style="width:15%; text-align:right">
                            Received From Bank :
                        </td>
                        <td style="width:25%">
                            <input id="txtRecedFromBankDateSt" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>

                        <td style="width:20%; text-align:right">
                            LDBC/IBC No :
                        </td>
                        <td style="width:30%">
                            <input id="txtLDBCNo" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:15%; text-align:right">
                            LDBC/IBC No Date :
                        </td>
                        <td style="width:25%">
                            <input id="txtLDBCDate" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align:right">
                            Current Status :
                        </td>
                        <td colspan="3" style="width:70%">
                            <input id="txtState" style="width: 100%;font-size:12px; font-weight:bold" class="type-diabaled" disabled />
                        </td>
                        <td style="width:10%; text-align:right"></td>
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <legend style="font-weight:bold">Send To Party info </legend>
                <table style="width:100%;font-size:12px; font-weight:normal" border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">

                 

                </table>
            </fieldset>
            
        </div>
         


        <fieldset>
            <legend>Action</legend>
            <div style="width:100%;height:10%">
                <table border="0" cellpadding="2" cellspacing="2" style="width:100%;">
                <tr>
                    <td style="width: 20%; text-align: right"></td>

                    <td style="width: 65px; font-size:13px">
                    </td>
                    <td style="width: 15%;text-align: right;  font-size:13px">
                        <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>
                   
                </tr>
                </table>
            </div>

        </fieldset>
    </div>

</body>
</html>

<style type="text/css">
    .td-styler input {
        padding-left: 5px;
    }

    .td-styler select {
        padding-left: 5px;
    }

    .td-col-3 select {
        width: 95%;
    }
</style>

<script type="text/javascript">

    var _sBaseAddress = "";
    var _oExportBill=null;
    var _nSelectedRowIndex=0;
    var _sBackLink="";
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oExportBill =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        debugger;
     
        ResetControll();
        RefreshControl(_oExportBill);
        _sBackLink=sessionStorage.getItem("BackLink");

    });

   

    function ResetControll(){
      
        $('#txtSendToParty').datebox('setValue', icsdateformat(new Date()));
        $('.reset-text').val("");
        
    }
    function RefreshControl(oExportBill){
        debugger;
        _oExportBill=oExportBill;
        $("#txtExportBillNo").val( _oExportBill.ExportBillNo);
        $("#txtAmendmentNoAndDate").val( _oExportBill.AmendmentNo);
        if(_oExportBill.AmendmentNo=="" || _oExportBill.AmendmentNo == null)
        {
            $("#txtAmendmentNoAndDate").hide();
            $("#lblAmendmentNo").hide();
        }
        $("#txtLCNo").val(_oExportBill.ExportLCNo);
        $("#txtFileNo").val( _oExportBill.FileNo);
        $("#txtApplicantName").val(_oExportBill.ApplicantName);
        $("#txtExportBillDate").val(_oExportBill.StartDateSt);
        $("#txtLCDate").val(_oExportBill.LCOpeningDatest);
        $("#txtBankNameAdvice").val(_oExportBill.BankName_Advice + '[' + _oExportBill.BBranchName_Advice + ']');
        $("#txtBankNameNego").val( _oExportBill.BankName_Nego + '[' + _oExportBill.BBranchName_Nego + ']');
        $("#txtBankNameIssue").val(_oExportBill.BankName_Issue + '[' + _oExportBill.BBranchName_Issue + ']');
        $("#txtIAmountSt").val( _oExportBill.AmountSt);
        $("#txtIAmountLC").val(_oExportBill.Amount_LCSt);
        $("#txtState").val(_oExportBill.StateSt);
        //$("#txtSendToPartySt").val(_oExportBill.SendToPartySt);
        $("#txtSendToBankDateSt").val( _oExportBill.SendToBankDateSt);
        //$("#txtRecdFromPartyST").val(  _oExportBill.RecdFromPartySt);
        $("#txtRecedFromBankDateSt").val( _oExportBill.RecedFromBankDateSt);
        $("#txtLDBCNo").val(_oExportBill.LDBCNo);
        $("#txtLDBCDate").val(_oExportBill.LDBCDateSt);
    
        //$("#txtNote_MaturityRecd").val(_oExportBill.NoteCarry);

        //if (_oExportBill.AcceptanceDateStr == "" || _oExportBill.AcceptanceDateStr == "--") {
        //    $('#txtAcceptanceDate').datebox('setValue', icsdateformat(new Date()));
        //}
        //else {
        //    $('#txtAcceptanceDate').datebox('setValue', _oExportBill.AcceptanceDateStr);
        //}
        //if (_oExportBill.MaturityReceivedDateSt == "" || _oExportBill.MaturityReceivedDateSt == "--") {
        //    $('#txtMaturityReceivedDate').datebox('setValue', icsdateformat(new Date()));
        //}
        //else {
        //    $('#txtMaturityReceivedDate').datebox('setValue', _oExportBill.MaturityReceivedDateSt);
        //}
        //if (_oExportBill.MaturityDateSt == "" || _oExportBill.MaturityDateSt == "--") {
        //    $('#txtMaturityDate').datebox('setValue', icsdateformat(new Date()));
        //}
        //else {
        //    $('#txtMaturityDate').datebox('setValue', _oExportBill.MaturityDateSt);
        //}

        //$("#cboLCTerm").icsLoadCombo({
        //    List: _oExportBill.LCTermss,
        //    OptionValue: "LCTermID",
        //    DisplayText: "NameDaysInString"
        //});
      
    }
   
    function Validation(){

        var dSendToParty = new Date($('#txtSendToParty').datebox('getValue'));
        var dStartDate = new Date(_oExportBill.StartDate);
   
       
        return true;
    }

  
    function RefreshObject()
    {
        var oExportBill = {
            ExportBillID: (_oExportBill != null) ? _oExportBill.ExportBillID : 0
            //AcceptanceDate: new Date($('#txtAcceptanceDate').datebox('getValue')),
            //MaturityDate: new Date($('#txtMaturityDate').datebox('getValue')),
            //MaturityReceivedDate: new Date($('#txtMaturityReceivedDate').datebox('getValue')),
            //NoteCarry: document.getElementById('txtNote_MaturityRecd').value
        };
        return oExportBill;
    }

    $("#btnSave").click(function (){
     
      //  if(!Validation()) return false;

        debugger;
        var oExportBill=RefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/ExportBill/SaveSAN",
            traditional: true,
            data:  JSON.stringify(oExportBill),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                var ExportBill= jQuery.parseJSON(data);
                if (ExportBill.ErrorMessage=="" || ExportBill.ErrorMessage==null)
                {
                    _oExportBill=ExportBill;
                    alert("Data Save Succesfully!!");
                    var oExportBills =sessionStorage.getItem("ExportBills");
                    var nIndex= parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    debugger;
                    if(oExportBills!=null)
                    {
                        oExportBills = jQuery.parseJSON(oExportBills);
                    }
                    else
                    {
                        oExportBills=[];
                    }
                    if(nIndex!=-1)
                    {
                        oExportBills[nIndex]=_oExportBill;
                    }
                    else
                    {
                        sessionStorage.setItem("SelectedRowIndex", oExportBills.length);
                        oExportBills.push(_oExportBill);
                    }
                    sessionStorage.setItem("ExportBills", JSON.stringify(oExportBills));
                    window.location.href = _sBackLink;
                }
                else
                {
                    alert(ExportBill.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });
    });




    $('#btnClose').click(function(e){
        window.location.href = sessionStorage.getItem("BackLink");
    });



</script>