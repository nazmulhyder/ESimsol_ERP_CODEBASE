@{
    ViewBag.Title = "Fabric Pattern";
}

@model IEnumerable<ESimSol.BusinessObjects.FabricPattern>
    <head>
        <title></title>
        @*<script src="@Url.Content("~/Views/ProductCategory/ProductSearchByNamePicker.js")" type="text/javascript"></script>*@
        <script src="@Url.Content("~/Views/Fabric/FabricPatterns.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/Fabric/FabricPattern.js")" type="text/javascript"></script>
    </head>
    <body>
        <div id="winFabricPattern" class="easyui-window" style="width:970px;" title="Fabric Pattern" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset style="overflow:hidden;">
                <table style="width:960px;">
                    <tr>
                        <td>
                            <table style="width:100%;">
                                <tr>
                                    <td style="text-align:right;">
                                        <label> Fabric ID :</label>
                                    </td>
                                    <td>
                                        <input id="txtFabricId" class="resetfield" type="text" disabled style="width: 84px; height:15px;" />
                                        <input id="txtFabricIdCopy" class="copy" type="text" disabled style="width: 84px;height:15px;" placeholder="Type Fabric ID" />
                                        <a id="btnCopyFabric" href="javascript:void(0)" class="easyui-linkbutton copy" iconcls="icon-pick" plain="true">P</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Buyer :</label>
                                    </td>
                                    <td>
                                        <input id="txtBuyer" class="resetfield" type="text" disabled style="width: 80%;height:15px;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Reed :</label>
                                    </td>
                                    <td>
                                        <input id="txtReed" class="numberfiled" type="text" style="width:14%;" />
                                        <label style="width: 15%;display: inline-block;text-align: right;">Dent :</label>
                                        <input id="txtDent" class="numberfiled" type="text" style="width:14%;" />
                                        <label style="width: 14%;display: inline-block;text-align: right;">Pick :</label>
                                        <input id="txtPick" class="numberfiled" type="text" style="width:14%;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Note :</label>
                                    </td>
                                    <td>
                                        <input id="txtNote" class="resetfield" style="width:80%;height:15px;" type="text" placeholder="Enter note" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Ratio :</label>
                                    </td>
                                    <td>
                                        <input id="txtRatio" class="resetfield" type="text" placeholder="Ratio" style="width: 80%;height:15px;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table style="width:100%;">
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Pattern No :</label>
                                    </td>
                                    <td>
                                        <input id="txtPatternNo" class="resetfield" type="text" placeholder="Auto generated" disabled style="width: 80%;height:15px;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Construction :</label>
                                    </td>
                                    <td>
                                        <input id="txtConstruction" class="resetfield" type="text" disabled style="width: 80%;height:15px;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>GSM :</label>
                                    </td>
                                    <td>
                                        <input id="txtGSM" class="numberfiled" type="text" style="width:18%;" />
                                        <label style="width: 17%;display: inline-block;text-align: right;">Warp :</label>
                                        <input id="txtWarp" class="numberfiled" type="text" style="width:18%;" />
                                        <label style="width: 14%;display: inline-block;text-align: right;">Weft :</label>
                                        <input id="txtWeft" class="numberfiled" type="text" style="width:18%;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>Weave :</label>
                                    </td>
                                    <td>
                                        <select id="cboWeave" style="width:82%;"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <label>R. Size :</label>
                                    </td>
                                    <td>
                                        <input id="txtRepeatSize" class="resetfield" type="text" placeholder="Size" style="width: 80%;height:15px;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </fieldset>
            <table class="tbl">
                <tr>
                    <td style="width:50%;">
                        <fieldset>
                            <legend>Warp Pattern</legend>
                            <table id="tblFabricPatternWarp" class="easyui-datagrid" style="width:100%;height:300px;" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" autorowwidth="false" toolbar="#toolbarFabricPatternWarp" data-options="onLoadSuccess: onLoadSuccess,onClickRow: onClickRowFabricPatternWarp">
                                <thead>
                                    <tr>
                                        <th data-options="field:'Selected',checkbox:true"></th>
                                        <th field="ProductShortName" width=40%>Yarn Count</th>
                                        <th data-options="field:'ColorName',editor:{type:'text'}" width=25% align="left">Color</th>
                                        <th data-options="field:'EndsCount',align:'right',editor:{type:'numberbox',options:{precision:0}}" width="10%">Pick</th>
                                        <th data-options="field:'Value',align:'right',editor:{type:'numberbox',options:{precision:0}}" width="10%">Value</th>
                                        <th field="ColorNo" width=12%>ColorNo</th>
                                        <th field="PantonNo" width=12%>PantonNo</th>
                                        <th field="SLNo" width=12%>SLNo</th>
                                    </tr>
                                </thead>
                            </table>
                            <div id="toolbarFabricPatternWarp" class="fptoolbar">
                                <input id="txtSearchByProductNameWarp" class="resetfield" type="text" placeholder="Type product name & press enter" />
                                <input id="txtColorWarp" class="resetfield colorfield" placeholder="Enter color name" type="text" />
                                <input id="txtEndsCountWarp" type="text" class="number" style="width:20px;" />
                                @*<input id="txtEndsCountWarp" class="endsCount" type="text" />*@
                                <a id="btnAddFPWarp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true"></a>
                                <a id="btnRemoveFPWarp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true"></a>
                                <input id="txtFPRepeatWarp" type="text" style="width:40px;" class="number" />
                                <a id="btnRepeatFPWarp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Repeat</a>
                                <a id="btnUndoRepeatFPWarp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true">Undo Repeat</a>
                                <a id="btnRefreshWarp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-Reset" plain="true">Refresh</a>
                                <a href="javascript:void(0)" id="btnUp" class="easyui-linkbutton" iconcls="icon-up" plain="true" onclick="UP(true)">Up</a>
                                <a href="javascript:void(0)" id="btnDown" class="easyui-linkbutton" iconcls="icon-down" plain="true" onclick="Down(true)">Down</a>
                                <a id="btnCopyWarp" style="float:right;" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-forword" plain="true">Copy to weft</a>
                                <a id="btnMakeTwistedWarp" style="float:right;" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Make Twist</a>
                                <a id="btnRemoveTwistedWarp" style="float:right;" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove Twist</a>
                            </div>
                        </fieldset>
                        <table>
                            <tr>
                                <td style="text-align:right;width: 285px;">
                                    Total Ends :
                                </td>
                                <td style="width: 51px;text-align: right;">
                                    <label id="lblTotalEndsWarp"></label>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td style="width:50%;">
                        <fieldset>
                            <legend>Weft Pattern</legend>
                            <table id="tblFabricPatternWeft" class="easyui-datagrid" style="width:100%;height:300px;" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" autorowwidth="false" data-options="onLoadSuccess: onLoadSuccessWeft,onClickRow: onClickRowFabricPatternWeft" toolbar="#toolbarFabricPatternWeft">
                                <thead>
                                    <tr>
                                        <th data-options="field:'Selected',checkbox:true"></th>
                                        <th field="ProductShortName" width=45%>Yarn Count</th>
                                        <th data-options="field:'ColorName',editor:{type:'text'}" width=25% align="left">Color</th>
                                        <th data-options="field:'EndsCount',align:'right',editor:{type:'numberbox',options:{precision:0}}" width="10%">Pick</th>
                                        <th data-options="field:'Value',align:'right',editor:{type:'numberbox',options:{precision:0}}" width="10%">Value</th>
                                        <th field="ColorNo" width=12%>ColorNo</th>
                                        <th field="PantonNo" width=12%>PantonNo</th>
                                        <th field="SLNo" width=12%>SLNo</th>

                                    </tr>
                                </thead>
                            </table>
                            <div id="toolbarFabricPatternWeft" class="fptoolbar">
                                <input id="txtSearchByProductNameWeft" class="resetfield" type="text" placeholder="Type product name & press enter" />
                                <input id="txtColorWeft" class="resetfield colorfield" placeholder="Enter color name" type="text" />
                                <input id="txtEndsCountWeft" type="text" class="number" style="width:20px;" />
                                @*<input id="txtEndsCountWeft" class="endsCount" type="text" />*@
                                <a id="btnAddFPWeft" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true"></a>
                                <a id="btnRemoveFPWeft" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true"></a>
                                <input id="txtFPRepeatWeft" type="text" style="width:40px;" class="number" />
                                <a id="btnRepeatFPWeft" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Repeat</a>
                                <a id="btnUndoRepeatFPWeft" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true">Undo Repeat</a>
                                <a id="btnRefreshWeft" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-Reset" plain="true">Refresh</a>
                                <a href="javascript:void(0)" id="btnUp" class="easyui-linkbutton" iconcls="icon-up" plain="true" onclick="UP(false)">Up</a>
                                <a href="javascript:void(0)" id="btnDown" class="easyui-linkbutton" iconcls="icon-down" plain="true" onclick="Down(false)">Down</a>
                                <a id="btnMakeTwistedWeft" style="float:right;" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Make Twist</a>
                                <a id="btnRemoveTwistedWeft" style="float:right;" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove Twist</a>

                            </div>
                        </fieldset>
                        <table>
                            <tr>
                                <td style="text-align:right;width: 285px;">
                                    Total Ends :
                                </td>
                                <td style="width: 51px;text-align: right;">
                                    <label id="lblTotalEndsWeft"></label>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnSaveSequence" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">SaveSequence</a>
                <a id="btnPrintFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
                <a id="btnSaveFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                <a id="btnCloseFabricPatter" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
     
        <div style="height:100%;">
            <div class="menuMainCollectionTable">
                <table id="tblFabricPatterns" title="Fabric List" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarFabricPattern">
                    <thead>
                        <tr>
                            <th field="PatternNo" width="10%">Pattern No</th>
                            <th field="Reed" width="5%" align="right">Reed</th>
                            <th field="Pick" width="5%" align="right">Pick</th>
                            <th field="Dent" width="5%" align="right" formatter="formatPrice">Dent</th>
                            <th field="GSM" width="5%" align="right" formatter="formatPrice">GSM</th>
                            <th field="Warp" width="5%" align="right">Warp</th>
                            <th field="Weft" width="5%" align="right">Weft</th>
                            <th field="Ratio" width="7%">Ratio</th>
                            <th field="RepeatSize" width="10%">Repeat Size</th>
                            <th field="Status" width="12%">Activity</th>
                            <th field="ApproveByName" width="25%">Approved By</th>
                           
                        </tr>
                    </thead>
                </table>
                <div id="toolbarFabricPattern">
                    <fieldset>
                        <table class="tbl">
                            <tr>
                                <td class="tdFP">
                                    <div class="divLabel">
                                        <label><strong> Fabric ID :</strong></label>
                                    </div>
                                    <div class="divOutput">
                                        <label id="lblFabricId"></label>
                                    </div>
                                </td>
                                <td class="tdFP">
                                    <div class="divLabel">
                                        <label><strong>Construction :</strong> </label>
                                    </div>
                                    <div class="divOutput">
                                        <label id="lblConstruction"></label>
                                    </div>
                                </td>
                                <td class="tdFP">
                                    <div class="divLabel">
                                        <label><strong>Buyer :</strong> </label>
                                    </div>
                                    <div class="divOutput">
                                        <label id="lblBuyer"></label>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                    <div>
                        <a id="btnBackToFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" plain="true"></a>
                        <a id="btnAddFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">New</a>
                        <a id="btnEditFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                        <a id="btnDeleteFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                        <a id="btnViewFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">View</a>
                        <a id="btnApproveFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Approve</a>
                        <a id="btnActivityFabricPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true"> <label>Activity</label> </a>
                        <a id="btnPrintFP" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true"> <label>Print</label> </a>
                        <a id="btnSaveByLabdip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add By Labdip</a>
                        <a id="btnCopyPattern" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-copy" plain="true">Copy</a>
                        <a id="btnSpecification" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Specification</a>
                    </div>
                </div>
            </div>
        </div>
</body>
    <style type="text/css">
        .tdFP{
             width:33.33%
         }
        .divLabel{
         float:left;
         width:29%;
         text-align:right;
         margin-right: 3px;
        }
        .divOutput{
             float:left;
             width:70%;
        }
        .divOutput label{
            width:90%;
            font-size:12px;
        }
        .divInput{
             float:left;
             width:65%;
        }
        .divInput input{
            width:98%;
            font-size:11px;
        }

       .patternMeasure .divCaption{

         float:left;
         width:14%;
         text-align:right;
         margin-top: 3px;
       }
     
       .patternMeasure .divCaptionInput{
         float:left;
         width:86%;
         text-align:left;
       }

       .divCaptionInput table{
           width:100%;
       }
   
       .divCaptionInput .numberfiled{
           width:40px;
        }
    
       .divparent{
        float:left; width:80% ;
       }
     
       .divparent .divChildLeft{
        float:left;width:50%; text-align:left; 
       }
      
       .divparent .divChildRight{
        float:left;width:50%; text-align:right;
       }
       
       .divCaptionInput .divInputNote{
           width:46%;
           float:left;
       }

       .divInputNote input{
           width:98%;
           font-size:11px;
       }

       .divRatioRepeat{
           width:46.5%;
           float:right;
       }

      .divRatioRepeat .divChildLeft{
        float:left; margin-left:4% ;width:46%; text-align:left; 
       }
      
      .divRatioRepeat .divChildRight{
        float:left;width:50%; text-align:left;
       }

      .divRatioRepeat span label{
          width:30%;
      }
     
      .divRatioRepeat span input{
          width:51%;
          font-size:11px;
      }


        #winFabricPattern{
            width:800px;
        }
        .fptoolbar input{
            font-size:11px;
            width:43%;
        }
        .fptoolbar .colorfield{
            font-size:11px;
            width:23%;
        }
        .fptoolbar .endsCount{
            width:20px;
            font-size:12px;
        }
        .fptoolbar select{
            font-size:12px;
            width:27%;
        }

        .txtPickerSearchInputField{
            width:98%;
        }
        
    </style>

    <script type="text/javascript">
    var _sBaseAddress = "";
    var _oFabricPattern = null;
    var _oFabricPatterns = [];
    var _oFPDetail = null;
    var _oFPDetails = [];
    var _oFabric = null;
    var _nmenuid=0;
    var _oFabricWeaves=[];
    var _nBUID=0;
    var _nFSCDetailID=0;
    var _oCellRowSpans=[];
    var _oCellRowSpansWeft=[];
    $(document).ready(function() {
        _sBaseAddress = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oFabricPatterns = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oFabric=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Fabric));
        _nmenuid=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.menuid));
        _nBUID=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _nFSCDetailID=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FSCDetailID));
        _oFabricWeaves=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricWeaves));
        debugger
        InitializeFabricPatterns();
        InitializeFabricPattern();
        //InitializeProductPickerByNameEvents();
    });
    $(document).keydown(function (e) { if (e.keyCode == 27) { $("div").icsWindow('close'); } });

    $("#txtFabricIdCopy").keydown(function(e){
        if(e.keyCode===13)
        {
            CopyFabricFP();
        }
    });

    $("#btnCopyFabric").click(function(){
        CopyFabricFP();
    });

    function CopyFabricFP()
    {
        var oFabric = {
            FabricNo : $.trim($("#txtFabricIdCopy").val())
        };

        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oFabric,
            ControllerName: "Fabric",
            ActionName: "GetsPatternFabrics",
            IsWinClose: false
        };
        $.icsMaxDataGets(obj, function (response) {
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].FabricID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "FabricNo", title: "Fabric ID", width: "98%", align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winFabricFP',
                        winclass: 'clsFabricFP',
                        winwidth: 300,
                        winheight: 460,
                        tableid: 'tblFabricFP',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'FabricNo',
                        windowTittle: 'Fabrics',
                        placeholder : "Search By Fabric No"
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbuttonFP(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }
            }
            else
            {
                alert("Sorry, No list found.");
            }
        });
    }

    function IntializePickerbuttonFP(oPickerobj) {
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            SetPickerValueAssignFP(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which === 13) {
                SetPickerValueAssignFP(oPickerobj);
            }
        });
    }

    function SetPickerValueAssignFP(oPickerobj) {
        var oreturnObj = null, oreturnobjs = [];

        if (oPickerobj.multiplereturn) {
            oreturnObjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
        }

        if (oPickerobj.winid == 'winFabricFP') {
            if (oreturnObj != null && oreturnObj.FabricID > 0)
            {
                CopyPickedFabricPattern(oreturnObj);
            }
            else{
                alert("Please an fabric from list.");
                return false;
            }
        }
        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();
    }

    function CopyPickedFabricPattern(oFabric)
    {
        if(_oFabric.FabricID <= 0)
        {
            alert("Invalid fabric.");
            return false;
        }

        if(oFabric != null && oFabric.FabricID > 0)
        {
            var oFabricPattern={
                CopyFabricID : oFabric.FabricID,
                FabricID : _oFabric.FabricID
            };

            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oFabricPattern,
                ObjectId: oFabricPattern.FPID,
                ControllerName: "Fabric",
                ActionName: "CopyFabricPattern",
                TableId: "",
                IsWinClose: false,
                Message: ""
            };
            $.icsSave(obj, function (response) {
                if (response.status && response.obj != null) {
                    if (response.obj.FPID > 0) {
                        var oFPs = $("#tblFabricPatterns").datagrid("getRows");
                        for(var i=0;i<oFPs.length;i++)
                        {
                            oFPs[i].IsActive = 0;
                            oFPs[i].Status = "Inactive";
                            $("#tblFabricPatterns").datagrid("updateRow", { index: i, row: oFPs[i] });
                        }
                        var nLength = oFPs.length;
                        $("#tblFabricPatterns").datagrid("appendRow", response.obj);
                        $("#tblFabricPatterns").datagrid("selectRow", nLength);
                        GetFabricPattern(response.obj);
                    }
                }
            });
        }
    }

    function UP(IsWarp)
    {
        var sTableID="";
        if(IsWarp==true){ sTableID="tblFabricPatternWarp"} else {sTableID="tblFabricPatternWeft"}
        
        debugger;
        var oFPD = $("#" + sTableID).datagrid("getSelected");
      
        if(oFPD==null)
        {
            alert("Please select Item");
            return;
        }
        var SelectedRowIndex = $("#" + sTableID).datagrid("getRowIndex", oFPD);
      
        if(SelectedRowIndex==0)return;
        var oFPDs=$("#" + sTableID).datagrid('getRows');
        _oFPDetails = [];
        for(var i=0; i<oFPDs.length; i++)
        {
            if(i==(SelectedRowIndex-1))
            {
                _oFPDetails[i]=oFPDs[i+1];
            }
            else if(i==SelectedRowIndex)
            {
                _oFPDetails[i]=oFPDs[i-1];
            }
            else
            {
                _oFPDetails[i]=oFPDs[i];
            }
            _oFPDetails[i].SLNo=i+1;
        }
        DynamicRefreshList(_oFPDetails,sTableID);
        var newSelectedRowIndex=SelectedRowIndex-1;
        $("#" + sTableID).datagrid('selectRow',newSelectedRowIndex);

    }
    function Down(IsWarp)
    {
        debugger;
        var sTableID="";
        if(IsWarp==true){ sTableID="tblFabricPatternWarp"} else {sTableID="tblFabricPatternWeft"}
        
        var oFPD = $("#" + sTableID).datagrid("getSelected");
        if(oFPD==null)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex = $("#" + sTableID).datagrid("getRowIndex", oFPD);
        if(SelectedRowIndex==(_oFPDetails.length-1))return;
        var oFPDs=$("#" + sTableID).datagrid('getRows');
        _oFPDetails = [];
        for(var i=0; i<oFPDs.length; i++)
        {
            if(i==(SelectedRowIndex+1))
            {
                _oFPDetails[i]=oFPDs[i-1];
            }
            else if(i==SelectedRowIndex)
            {
                _oFPDetails[i]=oFPDs[i+1];
            }
            else
            {
                _oFPDetails[i]=oFPDs[i];
            }
            _oFPDetails[i].SLNo=i+1;
        }
        DynamicRefreshList(_oFPDetails, sTableID);
        var newSelectedRowIndex=SelectedRowIndex+1;
        $("#" + sTableID).datagrid('selectRow',newSelectedRowIndex);
    }
   
    $('#btnSpecification').click(function(e){
        //var row = $('#tblFabricSCReports').datagrid('getSelected');
        //if(row==null || row.FabricSalesContractDetailID<=0){
        //    alert("Select an item from list");
        //    return false;
        //}
        //debugger;
        //var nRowIndexBank = $("#tblFabricSCReports").datagrid("getRowIndex", row);
        //sessionStorage.setItem("SelectedRowIndex", nRowIndexBank);
        if (sessionStorage.getItem("BackLink") != ""){
            window.location.href = sessionStorage.getItem("BackLink");
        }
        sessionStorage.setItem("BUID", _nBUID);
        var tsv=((new Date()).getTime())/1000;
        //window.location.href = _sBaseAddress+"/FabricExecutionOrderSpecification/ViewSpecification?nFSCDID="+ row.FabricSalesContractDetailID+"&nts="+nts;
        window.location.href = _sBaseAddress+ "/FabricExecutionOrderSpecification/ViewSpecification?nFSCDID="+_nFSCDetailID+"&nFEOSID=0&nts="+tsv;
        //window.location.href = _sBaseAddress+ "/FabricExecutionOrderSpecification/ViewSpecification?nFSCDID=0&nFEOSID="+oFabricExecutionOrderSpecification.FEOSID+"&nts="+tsv;
    });

</script>
