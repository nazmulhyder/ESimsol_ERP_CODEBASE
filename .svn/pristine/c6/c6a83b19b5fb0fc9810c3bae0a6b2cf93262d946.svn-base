@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Challan Register";
}
@model ESimSol.BusinessObjects.FDCRegister

<div class="menu-main-collection-table" ng-app="FDCRegisterAPP">
    <div ng-controller="FDCRegisterCtrl" class="form-horizontal regionFDCRegister" style="height:500px;">
        <fieldset>
            <legend>Searching Citeria</legend>
        <div class="row col-md-12" style=" padding-top: 40px">
            <div class="col-md-1 text-right"><label class="control-label">Challan No:</label></div>
            <div class="col-md-4 text-left">
                <input ng-model="FDCRegister.ChallanNo" style="width:100%;" />
            </div>
            <div class="col-md-1 text-right"><label class="control-label">Challan Date:</label></div>
            <div class="col-md-5" >
                <div class="col-md-12" style="padding:0px; margin:0px;">
                    <div style="float:left; width:30%;">
                        <select style="width:100%" class="DropDownMinHeight" ng-model="ChallanDate" ng-options="obj.id as obj.Value for obj in CompareOperators"></select>
                    </div>
                    <div class="col-md-5" style="width:35%; padding:0px;margin:0px">
                        <div class="input-group date date-container" style="width:100%; padding:0;margin:0px">
                            <input type="text" ng-model="ChallanStartDate" style="width:93%;text-align:center; padding:0px; margin:0px" readonly="readonly" ng-disabled="disabled">
                            <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-5" style="width:35%;margin:0px;">
                        <div class="input-group date date-container">
                            <input type="text" ng-model="ChallanEndDate" style="width:93%;text-align:center; padding:0px;margin:0px" readonly="readonly" ng-disabled="disabled">
                            <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row rowPadding col-md-12">
            <div class="col-md-1 text-right"><label class="control-label">Do No:</label></div>
            <div class="col-md-4 text-left">
                <input ng-model="FDCRegister.DONo" style="width:100%;" />
            </div>
            <div class="col-md-1 text-right"><label class="control-label">DO Date:</label></div>
            <div class="col-md-5">
                <div class="col-md-12" style="padding:0px; margin:0px;">
                    <div style="float:left; width:30%;">
                        <select style="width:100%" class="DropDownMinHeight" ng-model="DODate" ng-options="obj.id as obj.Value for obj in CompareOperators">
                            <option value="">--Select--</option>
                        </select>
                    </div>
                    <div class="col-md-5" style="width:35%; padding:0px;margin:0px">
                        <div class="input-group date date-container" style="width:100%; padding:0;margin:0px">
                            <input type="text" ng-model="DOStartDate" style="width:93%;text-align:center; padding:0px; margin:0px" readonly="readonly" ng-disabled="disabled">
                            <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-5" style="width:35%;margin:0px">
                        <div class="input-group date date-container">
                            <input type="text" ng-model="DOEndDate" style="width:93%;text-align:center; padding:0px;margin:0px" readonly="readonly" ng-disabled="disabled">
                            <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Do Type:</label></div>
                <div class="col-md-4 text-left">
                    <select style="width:100%;" class="DropDownMinHeight" ng-model="DOType" ng-options="obj.id as obj.Value for obj in DOTypes">
                        <option value="">--Select--</option>
                    </select>
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Party Name:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="PartyName" ng-keydown="SearchKeyDownPartyName($event)" style="width:79%;" />
                    <input type="button" class="cancelButtonRight" ng-click="ClearPartyName()" value="C" />
                    <input type="button" class="okButtonRight" ng-click="PickPartyName()" value="P" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Store Name:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.StoreName" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Buyer Name:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="BuyerName" ng-keydown="SearchKeyDownBuyerName($event)" style="width:79%;" />
                    <input type="button" class="cancelButtonRight" ng-click="ClearBuyerName()" value="C" />
                    <input type="button" class="okButtonRight" ng-click="PickBuyerName()" value="P" />
                </div>
            </div>
        <div class="row col-md-12">
            <div class="col-md-1 text-right"><label class="control-label">Style No:</label></div>
            <div class="col-md-4 text-left">
                <input ng-model="FDCRegister.StyleNo" style="width:100%;" />
            </div>
            <div class="col-md-1 text-right"><label class="control-label">MKT Person:</label></div>
            <div class="col-md-5 text-left">
                <select style="width:100%;" class="DropDownMinHeight" ng-model="FDCRegister.MKTPerson" ng-options="obj.EmployeeID as obj.Name for obj in MKTPersons">
                    <option value="0">--select--</option>
                </select>
            </div>
        </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Driver Name:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.DriverName" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Vehicle No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.VehicleNo" style="width:100%;" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Delivery Poient:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.DeliveryPoient" ng-int="" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Challan Remarks:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.ChallanRemarks" style="width:100%;" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Approve By:</label></div>
                <div class="col-md-4 text-left">
                    <select id="cboApproveBy" class="DropDownMinHeight" style=" width:100%;" ng-model="ApproveBy" ng-options="obj.UserID as obj.UserName for obj in ApproveByList">
                        <option value="">--Select--</option>
                    </select>
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Approve Date:</label></div>
                <div class="col-md-5">
                    <div class="col-md-12" style="padding:0px; margin:0px;">
                        <div style="float:left; width:30%;">
                            <select style="width:100%" class="DropDownMinHeight" ng-model="ApproveDate" ng-options="obj.id as obj.Value for obj in CompareOperators"></select>
                        </div>
                        <div class="col-md-5" style="width:35%; padding:0px;margin:0px">
                            <div class="input-group date date-container" style="width:100%; padding:0;margin:0px">
                                <input type="text" ng-model="ApproveStartDate" style="width:93%;text-align:center;  padding:0px; margin:0px" readonly="readonly" ng-disabled="disabled">
                                <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                            </div>
                        </div>
                        <div class="col-md-5" style="width:35%;margin:0px">
                            <div class="input-group date date-container">
                                <input type="text" ng-model="ApproveEndDate" style="width:93%;text-align:center; padding:0px;margin:0px" readonly="readonly" ng-disabled="disabled">
                                <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                            </div>
                        </div>
                    </div>    
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Disburse By:</label></div>
                <div class="col-md-4 text-left">
                    <select id="cboDisburseBy" class="DropDownMinHeight" style="width:100%;" ng-model="DisburseBy" ng-options="obj.UserID as obj.UserName for obj in DisburseByList"></select>
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Disburse Date:</label></div>
                <div class="col-md-5">
                    <div class="col-md-12" style="padding:0px; margin:0px;">
                        <div style="float:left; width:30%;">
                            <select style="width:100%" ng-model="DisburseDate" ng-options="obj.id as obj.Value for obj in CompareOperators">
                            </select>
                        </div>
                        <div class="col-md-5" style="width:35%; padding:0px;margin:0px">
                            <div class="input-group date date-container" style="width:100%; padding:0;margin:0px">
                                <input type="text" ng-model="DisburseStartDate" style="width:93%;text-align:center; padding:0px; margin:0px" readonly="readonly" ng-disabled="disabled">
                                <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                            </div>
                        </div>
                        <div class="col-md-5" style="width:35%;margin:0px">
                            <div class="input-group date date-container">
                                <input type="text" ng-model="DisburseEndDate" style="width:93%;text-align:center; padding:0px;margin:0px" readonly="readonly" ng-disabled="disabled">
                                <span style="width:5%; padding:0px;margin:0px" class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Product Name:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="ProductName" ng-keydown="SearchKeyDownProductName($event)" style="width:77%;" />
                    <input type="button" class="cancelButton" ng-click="ClearProductName()" value="C" />
                    <input type="button" class="okButton" ng-click="PickProductName()" value="P" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Fabric No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FabricNo" ng-keydown="SearchKeyDownFabricNo($event)" style="width:79%;" />
                    <input type="button" class="cancelButtonRight" ng-click="ClearFabricNo()" value="C" />
                    <input type="button" class="okButtonRight" ng-click="PickFabricNo()" value="P" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">Construction No:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.Construction" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Dispo No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.ExeNo" style="width:100%;" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">LC No:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.LCNo" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">SC No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.SCNoFull" style="width:100%;" />
                </div>
            </div>
            <div class="row col-md-12">
                <div class="col-md-1 text-right"><label class="control-label">PI No:</label></div>
                <div class="col-md-4 text-left">
                    <input ng-model="FDCRegister.PINo" style="width:100%;" />
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Lot No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.LotNo" style="width:100%;" />
                </div>
            </div>
            <div class="row col-md-12" style="margin-bottom:85px">
                <div class="col-md-1 text-right"><label class="control-label">Print layout:</label></div>
                <div class="col-md-4 text-left">
                    <select style="width:100%" class="DropDownMinHeight" id="cboPrintLayout" ng-model="Printlayout">
                        <option value="0">--Select--</option>
                        <option value="1">--Date Wise--</option>
                        <option value="2">--MKT Wise--</option>
                        <option value="3">--Buyer/Party Wise--</option>
                    </select>
                </div>
                <div class="col-md-1 text-right"><label class="control-label">Mkt Ref No:</label></div>
                <div class="col-md-5 text-left">
                    <input ng-model="FDCRegister.MktRef" style="width:100%;" />
                </div>
            </div>
            </fieldset>
                <fieldset>
                    <legend>Action</legend>
                    <div class="row col-md-12 text-right">
                        <label ng-bind="LodingText" style="color:green; font-size:19px; font-weight:bold; margin-left:20px; float:left"></label>
                        <button type="button" class="btn btn-info" aria-label="Left Align" ng-click="Excel()"> <span class="glyphicon glyphicon-download-alt" aria-hidden="true"> Excel</span> </button>
                        <button type="button" class="btn btn-success" aria-label="Left Align" ng-click="Preview()"> <span class="glyphicon glyphicon-print" aria-hidden="true"> Preview</span> </button>
                    </div>
                </fieldset>

</div>
    

</div>

<style type="text/css">
    .panel-header {
        background: #eff5ff ; /*linear-gradient(to bottom,#EFF5FF 0,#E0ECFF 100%);*/
    }

    ::-webkit-input-placeholder {
        font-size: 10px;
    }

    .form-horizontal .control-label {
        /*padding-top: 3px;*/
    }

    .regionFDCRegister .form-control {
        /*height: 26px;*/
        /*padding: 0px 6px;*/
        font-size: 12px;
    }

    .regionFDCRegister .col-md-12 {
        width: 100%;
        /*padding-right: 3px;
        padding-left: 3px;
        margin-bottom: 3px;*/
    }
    .rowPadding{
        padding-top:4px;
    }
    .DropDownMinHeight{
        min-height:22px;
    }

    .regionFDCRegister .col-md-1 {
        width: 10%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }
    
    .regionFDCRegister .col-md-1 {
        width: 15%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .col-md-3 {
        width: 23.3%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }
    .cancelButton {
        width: 10%;
        background-color:red;
        color:white;
        font-weight:bold;
        border:0px solid red;
    }
    .okButton {
        width: 10%;
        background-color:green;
        color:white;
        font-weight:bold;
        border:1px solid green;
    }
    .cancelButtonRight {
        width: 9%;
        background-color:red;
        color:white;
        font-weight:bold;
        border:0px solid red;
    }
    .okButtonRight {
        width: 9%;
        float:right;
        background-color:green;
        color:white;
        font-weight:bold;
        border:1px solid green;
    }

    .regionFDCRegister .col-md-4 {
        width: 30%;
        /*padding-right: 5px;*/
        padding-left: 5px;
    }

    .regionFDCRegister .col-md-5 {
        width: 37%;
        padding-left: 0px;
    }

    .regionFDCRegister .col-md-6 {
        width: 50%;
        padding-right: 0px;
        padding-left: 0px;
    }

    .regionFDCRegister .col-md-9 {
        width: 66.4%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }
    .regionFDCRegister .col-md-2 {
        width: 16%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .col-md-10 {
        width: 83%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .col-md-11 {
        width: 90%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .col-md-7 {
        width: 56.5%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .col-md-8 {
        width: 69%;
        /*padding-right: 5px;
        padding-left: 5px;*/
    }

    .regionFDCRegister .btn-sm {
        /*padding: 3px 10px;*/
    }
    .regionFDCRegister .input-group-addon {
        /*padding: 4px 8px;*/
    }
</style>

<script type="text/javascript">
    _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
    var oFDCRegister =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
    var nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
    var oMktPersons = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MktPersons));
    var oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
    var oDOTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DOTypes));
    var oApproveByList = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ApproveByList));
    var oDisburseByList = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DisburseByList));

    var FDCRegisterModule = angular.module('FDCRegisterAPP', ['ngAnimate', 'ui.bootstrap', 'ui.grid', 'ui.grid.selection', 'ui.grid.edit','ms.service']);
    FDCRegisterModule.controller('FDCRegisterCtrl', function ($scope, $http, $uibModal, $log, uiGridConstants, msModal, userSession) {
        debugger;
        $('.date-container').datepicker({
            format: "dd M yyyy",
            calendarWeeks: true,
            autoclose: true,
            todayHighlight: true
        });
        //---------Load Combo--------------
        $scope.MKTPersons = oMktPersons;
        $scope.CompareOperators = oCompareOperators;
        $scope.ApproveByList = oApproveByList;
        $scope.DisburseByList = oDisburseByList;
        $scope.DOTypes = oDOTypes;
        $scope.FDCRegister = oFDCRegister;
        //------date initialize---------
        $scope.ChallanDate = 0;
        $scope.ChallanStartDate = icsdateformat(new Date());
        $scope.ChallanEndDate = icsdateformat(new Date());
        $scope.DODate = 0;
        $scope.DOStartDate = icsdateformat(new Date());
        $scope.DOEndDate = icsdateformat(new Date());
        $scope.ApproveDate = 0;
        $scope.ApproveStartDate = icsdateformat(new Date());
        $scope.ApproveEndDate = icsdateformat(new Date());
        $scope.DisburseDate = 0;
        $scope.DisburseStartDate = icsdateformat(new Date());
        $scope.DisburseEndDate = icsdateformat(new Date());
        //--------------refresh data-----------
        $scope.FDCRegister.ChallanNo = "";
        $scope.FDCRegister.DONo = "";
        $scope.DOType = 0;
        $scope.FDCRegister.StoreName = "";
        $scope.FDCRegister.StyleNo = "";
        $scope.FDCRegister.DriverName = "";
        //$scope.RefreshData($scope.FDCRegister.DeliveryPoient,"")+ "~"+ 
        //$scope.ApproveBy +"~"+
        //$scope.DisburseBy +"~"+
        //$scope.ProductID +"~"+
        $scope.FDCRegister.Construction = "";
        $scope.FDCRegister.LCNo = "";
        $scope.FDCRegister.PINo  = "";
        //$scope.FDCRegister.MKTPerson +"~"+
        $scope.FDCRegister.ExeNo = "";
        $scope.FDCRegister.SCNoFull  = "";
        $scope.FDCRegister.LotNo = "";
        $scope.FDCRegister.VehicleNo  = "";
        $scope.PartyID="";
        $scope.BuyerID="";
        $scope.FabricID="";
        $scope.ApproveBy="";
        $scope.DisburseBy="";
        $scope.ProductID="";
        //////////////////////////////////////
        $scope.RefreshObject = function()
        {
            debugger;
            if($scope.DOType==0 || $scope.DOType=="" || $scope.DOType=='undefined' || $scope.DOType==null)
            {
                $scope.DOType = 0;
            }
            if($scope.ApproveBy==0 || $scope.ApproveBy=="" || $scope.ApproveBy=='undefined' || $scope.ApproveBy==null)
            {
                $scope.ApproveBy = 0;
            }if($scope.DisburseBy==0 || $scope.DisburseBy=="" || $scope.DisburseBy=='undefined' || $scope.DisburseBy==null)
            {
                $scope.DisburseBy = 0;
            }if($scope.FDCRegister.MKTPerson==0 || $scope.FDCRegister.MKTPerson=="" || $scope.FDCRegister.MKTPerson=='undefined' || $scope.FDCRegister.MKTPerson==null)
            {
                $scope.FDCRegister.MKTPerson = 0;
            }
            var sTemp = $scope.ChallanDate+"~"+$scope.ChallanStartDate+"~"+$scope.ChallanEndDate+"~"+$scope.DODate+"~"+$scope.DOStartDate+"~"+$scope.DOEndDate+"~"+$scope.ApproveDate+"~"+$scope.ApproveStartDate+"~"+$scope.ApproveEndDate+"~"+$scope.DisburseDate+"~"+$scope.DisburseStartDate+"~"+$scope.DisburseEndDate+"~"+$scope.FDCRegister.ChallanNo +"~"+$scope.FDCRegister.DONo +"~"+$scope.DOType+"~"+ $scope.FDCRegister.StoreName+"~"+ $scope.FDCRegister.StyleNo +"~"+$scope.FDCRegister.DriverName +"~"+ $scope.RefreshData($scope.FDCRegister.DeliveryPoient,"")+ "~"+ $scope.ApproveBy +"~"+$scope.DisburseBy +"~"+$scope.ProductID +"~"+$scope.FDCRegister.Construction +"~"+$scope.FDCRegister.LCNo +"~"+$scope.FDCRegister.PINo +"~"+$scope.FDCRegister.MKTPerson +"~"+$scope.FDCRegister.ExeNo +"~"+$scope.FDCRegister.SCNoFull +"~"+$scope.FDCRegister.LotNo+"~"+$scope.PartyID +"~"+$scope.BuyerID +"~"+$scope.FabricID + "~" + $scope.Printlayout + "~" + nBUID + "~" + $scope.FDCRegister.VehicleNo  + "~" + $scope.RefreshData($scope.FDCRegister.ChallanRemarks,"");
            return sTemp;
        }
        
        $scope.RefreshData = function(data,val)
        {
            return (data==undefined || data==null) ? val : data;
        }
        $scope.Preview = function()
        {
            debugger;
            if($scope.Printlayout == 0 || $scope.Printlayout=="" || $scope.Printlayout=='undefined' || $scope.Printlayout==null)
            {
                alert("Please Select any print Type");
                $('#cboPrintLayout').focus();
                return;
            }
            $scope.sParam = $scope.RefreshObject();
            var oFDCRegister = {
                Params:$scope.sParam,
            }
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/FDCRegister/SetSessionSearchCriteria",
                traditional: true,
                data:  JSON.stringify(oFDCRegister),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                        window.open(_sBaseAddress+'/FDCRegister/PrintFDCRegister?sString='+"pdf");
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }
        $scope.Excel = function()
        {
            debugger;
            $scope.sParam = $scope.RefreshObject();
            if($scope.Printlayout == 0 || $scope.Printlayout=="" || $scope.Printlayout=='undefined' || $scope.Printlayout==null)
            {
                alert("Please Select any print Type");
                $('#cboPrintLayout').focus();
                return;
            }
            $scope.sParam = $scope.RefreshObject();
            debugger;
            var oFDCRegister = {
                Params:$scope.sParam,
            }
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/FDCRegister/SetSessionSearchCriteria",
                traditional: true,
                data:  JSON.stringify(oFDCRegister),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    if($scope.Printlayout == 1)
                    {
                        window.open(_sBaseAddress+'/FDCRegister/GetExcelDateWise?sParam='+"DateWiseReport");
                    }
                    if($scope.Printlayout == 2)
                    {
                        window.open(_sBaseAddress+'/FDCRegister/GetExcelMKTPersonWise?sParam='+"MKTPersonWiseREport");
                    }
                    if($scope.Printlayout == 3)
                    {
                        window.open(_sBaseAddress+'/FDCRegister/GetExcelPartyWise?sParam='+"PartyWiseReport");
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }

        //-----------Picker----------------
        //-----------Buyer-----------------
        $scope.PickBuyerName= function ()
        {
            debugger;
            var oContractor = {
                Params: '2' + '~' + $.trim($scope.BuyerName)+'~'+sessionStorage.getItem('BUID')
            };
            $scope.LodingText = "Please Wait....................";
            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(_sBaseAddress+'/Contractor/ContractorSearchByNameType',$.param(oContractor), config).then(
                                function (response)
                                {
                                    $scope.LodingText = "";
                                    debugger;
                                    var results=(response.data);
                                    if(results.length<=0 || (results[0].ErrorMessage!=null && results[0].ErrorMessage!=""))
                                    {
                                        alert(results[0].ErrorMessage); return;
                                    }
                                    console.log(results);
                                    var oColumns = [];
                                    oColumn = { field: 'Name', name: 'Applicant Name',width: '50%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'Address', name: 'Address',width: '30%', enableSorting: false  };oColumns.push(oColumn);

                                    var modalObj={
                                        size:'md',
                                        modalcontroller:'ModalCommonListCtrl',
                                        appcontroller:'SaleInvoiceController',
                                        objs:results,
                                        multiSelect:true,
                                        pickertitle:'Applicant List',
                                        searchingbyfieldName:'Name',
                                        columns:oColumns
                                    }
                                    var modalInstance=msModal.Instance(modalObj);
                                    modalInstance.result.then(function (result)
                                    {
                                        debugger;
                                        if(result.length>0)
                                        {
                                            if(result.length==1)
                                            {
                                                $scope.BuyerID=result[0].ContractorID;
                                                $scope.BuyerName=result[0].Name;
                                            }else
                                            {
                                                $scope.BuyerName=result.length+" Customers are selected";
                                                $scope.BuyerID=result[0].ContractorID;
                                                for(var i=1;i< result.length; i++)
                                                {
                                                    $scope.BuyerID+=","+result[i].ContractorID;
                                                }
                                            }
                                        }
                                    }, function () {
                                        $log.info('Modal dismissed at: ' + new Date());
                                    });
                                },
                                  function (response) { alert((response.data).Message);}
                            );

        };
        $scope.SearchKeyDownBuyerName = function (e){
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                var RefNo = $.trim($scope.BuyerName);
                if(RefNo=="" || RefNo==null)
                {
                    alert("Type Buyer Name and Press Enter");
                    return;
                }
                $scope.PickBuyerName();
            }else if (code == 8) //backspace=8
            {
                $scope.BuyerName="";
                $scope.BuyerID="";
            }
        };
        $scope.ClearBuyerName= function ()
        {
            $scope.BuyerName="";
            $scope.BuyerID="";
        }
        //-----------Party--------------------
        $scope.PickPartyName= function ()
        {
            var oContractor = {
                Params: '2,3' + '~' + $.trim($scope.PartyName)+'~'+sessionStorage.getItem('BUID')
            };
            $scope.LodingText = "Please Wait....................";
            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(_sBaseAddress+'/Contractor/ContractorSearchByNameType',$.param(oContractor), config).then(
                                function (response)
                                {
                                    $scope.LodingText = "";
                                    debugger;
                                    var results=(response.data);
                                    if(results.length<=0 || (results[0].ErrorMessage!=null && results[0].ErrorMessage!=""))
                                    {
                                        alert(results[0].ErrorMessage); return;
                                    }
                                    console.log(results);
                                    var oColumns = [];
                                    oColumn = { field: 'Name', name: 'Applicant Name',width: '50%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'Address', name: 'Address',width: '30%', enableSorting: false  };oColumns.push(oColumn);

                                    var modalObj={
                                        size:'md',
                                        modalcontroller:'ModalCommonListCtrl',
                                        appcontroller:'SaleInvoiceController',
                                        objs:results,
                                        multiSelect:true,
                                        pickertitle:'Applicant List',
                                        searchingbyfieldName:'Name',
                                        columns:oColumns
                                    }
                                    var modalInstance=msModal.Instance(modalObj);
                                    modalInstance.result.then(function (result)
                                    {
                                        debugger;
                                        if(result.length>0)
                                        {
                                            if(result.length==1)
                                            {
                                                $scope.PartyID=result[0].ContractorID;
                                                $scope.PartyName=result[0].Name;
                                            }else
                                            {
                                                $scope.PartyName=result.length+" Customers are selected";
                                                $scope.PartyID=result[0].ContractorID;
                                                for(var i=1;i< result.length; i++)
                                                {
                                                    $scope.PartyID+=","+result[i].ContractorID;
                                                }
                                            }
                                        }
                                    }, function () {
                                        $log.info('Modal dismissed at: ' + new Date());
                                    });
                                },
                                  function (response) { alert((response.data).Message);}
                            );

        };
        $scope.SearchKeyDownPartyName = function (e){
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                var RefNo = $.trim($scope.PartyName);
                if(RefNo=="" || RefNo==null)
                {
                    alert("Type Party Name and Press Enter");
                    return;
                }
                $scope.PickPartyName();
            }else if (code == 8) //backspace=8
            {
                $scope.PartyName="";
                $scope.PartyID="";
            }
        };
        $scope.ClearPartyName= function ()
        {
            $scope.PartyName="";
            $scope.PartyID="";
        }
        //-----------Fabric--------------------
        $scope.PickFabricNo= function ()
        {
            debugger;
            var oFabric = {
                FabricNo : $.trim($scope.FabricNo)
            };
            $scope.LodingText = "Please Wait....................";
            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(_sBaseAddress+'/Fabric/GetsFabricBySearchingCriterias',$.param(oFabric), config).then(
                                function (response)
                                {
                                    $scope.LodingText = "";
                                    debugger;
                                    var results=(response.data);
                                    if(results.length<=0 || (results[0].ErrorMessage!=null && results[0].ErrorMessage!=""))
                                    {
                                        alert(results[0].ErrorMessage); return;
                                    }
                                    console.log(results);
                                    var oColumns = [];
                                    oColumn = { field: 'FabricNo',    name: 'Fabric No',width: '30%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'StyleNo',     name: 'StyleNo',width: '20%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'ColorInfo',   name: 'ColorInfo',width: '20%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'FabricWidth', name: 'FabricWidth',width: '80%', enableSorting: false  };oColumns.push(oColumn);
                                    var modalObj={
                                        size:'md',
                                        modalcontroller:'ModalCommonListCtrl',
                                        appcontroller:'SaleInvoiceController',
                                        objs:results,
                                        multiSelect:true,
                                        pickertitle:'Applicant List',
                                        searchingbyfieldName:'Name',
                                        columns:oColumns
                                    }
                                    var modalInstance=msModal.Instance(modalObj);
                                    modalInstance.result.then(function (result)
                                    {
                                        debugger;
                                        if(result.length>0)
                                        {
                                            if(result.length==1)
                                            {
                                                $scope.FabricID=result[0].FabricID;
                                                $scope.FabricNo=result[0].FabricNo;
                                            }else
                                            {
                                                $scope.FabricNo=result.length+" Fabrics are selected";
                                                $scope.FabricID=result[0].FabricID;
                                                for(var i=1;i< result.length; i++)
                                                {
                                                    $scope.FabricID+=","+result[i].FabricID;
                                                }
                                            }
                                        }
                                    }, function () {
                                        $log.info('Modal dismissed at: ' + new Date());
                                    });
                                },
                                  function (response) { alert((response.data).Message);}
                            );

        };
        $scope.SearchKeyDownFabricNo = function (e){
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                var RefNo = $.trim($scope.FabricNo);
                if(RefNo=="" || RefNo==null)
                {
                    alert("Type Fabric Name and Press Enter");
                    return;
                }
                $scope.PickFabricNo();
            }else if (code == 8) //backspace=8
            {
                $scope.FabricNo="";
                $scope.FabricID="";
            }
        };
        $scope.ClearFabricNo= function ()
        {
            $scope.FabricNo="";
            $scope.FabricID="";
        }
        //-----------Product--------------------
        $scope.PickProductName= function ()
        {
            debugger;
            var oProduct = {
                ProductName : $.trim($scope.ProductName),
                BUID : nBUID
            };
            $scope.LodingText = "Please Wait....................";
            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(_sBaseAddress+'/Product/SearchByProductBUWise',$.param(oProduct), config).then(
                                function (response)
                                {
                                    $scope.LodingText = "";
                                    debugger;
                                    var results=(response.data);
                                    if(results.length<=0 || (results[0].ErrorMessage!=null && results[0].ErrorMessage!=""))
                                    {
                                        alert(results[0].ErrorMessage); return;
                                    }
                                    console.log(results);
                                    var oColumns = [];
                                    oColumn = { field: 'ProductName', name: 'Product No',width: '70%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'ProductCode', name: 'Product Code',width: '20%', enableSorting: false  };oColumns.push(oColumn);
                                    var modalObj={
                                        size:'md',
                                        modalcontroller:'ModalCommonListCtrl',
                                        appcontroller:'SaleInvoiceController',
                                        objs:results,
                                        multiSelect:true,
                                        pickertitle:'Applicant List',
                                        searchingbyfieldName:'Name',
                                        columns:oColumns
                                    }
                                    var modalInstance=msModal.Instance(modalObj);
                                    modalInstance.result.then(function (result)
                                    {
                                        debugger;
                                        if(result.length>0)
                                        {
                                            if(result.length==1)
                                            {
                                                $scope.ProductID=result[0].ProductID;
                                                $scope.ProductName=result[0].ProductName;
                                            }else
                                            {
                                                $scope.ProductName=result.length+" Products are selected";
                                                $scope.ProductID=result[0].ProductID;
                                                for(var i=1;i< result.length; i++)
                                                {
                                                    $scope.ProductID+=","+result[i].ProductID;
                                                }
                                            }
                                        }
                                    }, function () {
                                        $log.info('Modal dismissed at: ' + new Date());
                                    });
                                },
                                  function (response) { alert((response.data).Message);}
                            );

        };
        $scope.SearchKeyDownProductName = function (e){
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                var RefNo = $.trim($scope.ProductName);
                if(RefNo=="" || RefNo==null)
                {
                    alert("Type Fabric Name and Press Enter");
                    return;
                }
                $scope.PickProductName();
            }else if (code == 8) //backspace=8
            {
                $scope.ProductName="";
                $scope.ProductID="";
            }
        };
        $scope.ClearProductName= function ()
        {
            $scope.ProductName="";
            $scope.ProductID="";
        }
        //--------------------------------------
        });
</script>