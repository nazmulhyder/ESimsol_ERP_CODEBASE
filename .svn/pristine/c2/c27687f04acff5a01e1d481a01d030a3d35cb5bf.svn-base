@{
    ViewBag.Title = "Export Document Setup List";
}
@model IEnumerable<ESimSol.BusinessObjects.ExportDocSetup>


   <head>
   <title></title>
   </head>
   <body>
       <div id="winExportDocSetup" style="width:850px;height:100%;" class="easyui-window winstyle" title="Export Doc Setup " data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
           <div id="tabExportDOC"  style="width:100%;height:510px">
               <div title="First" style="width:840px;height:100%;padding:2px">
                   <fieldset>
                       <table class="tbl">
                           <tr>
                               <td class="tdInput">
                                   <input id="txtDocName" type="text" placeholder="Doc Name " disabled="disabled" />
                               </td>
                               <td class="tdInput">
                                   <input type="text" id="txtDocHeader" placeholder="Document Header" disabled="disabled" />
                               </td>

                           </tr>
                         
                       </table>

                   </fieldset>
                   <fieldset>
                  
                           @*<input id="chkIsPrintHeader" type="checkbox" />Print Header*@
                           <input id="chkIsPrintOriginal" type="checkbox" />Print Original
                           <input id="chkIsPrintGrossNetWeight" type="checkbox" />Print Gross/ Net Weight
                           <input id="chkIsPrintFrieghtPrepaid" type="checkbox" />Print Frieght Prepaid
                           <input id="chkIsPrintInvoiceDate" type="checkbox" />Print Invoice Date
                           <input id="chkIsPrintHSCode" type="checkbox" />Print HS Code
                       
                   </fieldset>
                  
                   <fieldset>
                       <table style="width:100%;height:100%;padding:2px">
                           <tr>
                               <td class="tdInput">
                                   <input type="text" id="txtCertification" placeholder="Certification" />
                               </td>
                           </tr>
                           <tr>
                               <td class="tdInput">
                                   <input type="text" id="txtClauseOne" placeholder="Clause One" />
                               </td>
                           </tr>
                           <tr>
                               <td class="tdInput">
                                   <input type="text" id="txtClauseTwo" placeholder="Clause Two" />
                               </td>
                           </tr>
                           <tr>
                               <td class="tdInput">
                                   <input type="text" id="txtClauseThree" placeholder="Clause Three" />
                               </td>
                           </tr>
                           <tr>
                               <td class="tdInput">
                                   <input type="text" id="txtClauseFour" placeholder="Clause Four" />
                               </td>
                           </tr>
                       </table>
                   </fieldset>
                   <fieldset>
                       <table border="0" style="width:100%;height:100%;padding:2px">
                           <tr>
                               <td style="width: 15%; text-align: right">
                                   Carrier By :
                               </td>
                               <td style="width: 20%">
                                   <input type="text" id="txtCarrierName" placeholder="Carrier by Name" style="width:100%" />
                               </td>
                               <td style="width: 15%; text-align: right">
                                   Receipt No :
                               </td>
                               <td style="width: 20%">
                                   <input id="txtTruckReceiptNo" type="text" style="width:100%;" />
                               </td>
                               <td style="width: 15%; text-align: right">
                                   Receipt Date:
                               </td>
                               <td style="width: 15%">
                                   <input type="text" style="width:100%;" id="txtTruckReceiptDate" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                               </td>
                           </tr>
                           <tr>
                               <td style="width: 15%; text-align: right">
                                   Truck No :
                               </td>
                               <td style="width: 20%">
                                   <input id="txtTruckNo" type="text" style="width:200px;" disabled="disabled" />
                               </td>
                               <td style="width: 15%; text-align: right">
                                   Driver Name :
                               </td>
                               <td style="width: 20%">
                                   <input id="txtDriverName" type="text" style="width:200px;" disabled="disabled" />
                               </td>
                               <td style="width: 15%; text-align: right">
                                  
                               </td>
                               <td style="width: 15%">
                                  
                               </td>
                           </tr>
                          
                       </table>
                   </fieldset>
                   <fieldset>
                       <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px;">
                           <tr>
                               <td style="width: 15%; text-align: right">
                                   NOTIFY PARTY
                               </td>
                               <td style="width: 20%">
                                   <select id="cboNotifyBy" style=" width:100%;"></select>
                               </td>
                               <td style="width: 15%; text-align: right">
                                   CPT APPLICANT
                               </td>
                               <td style="width: 20%; text-align: right">
                                   <input id="txtCTPApplicant" type="text" style="width:99%;" placeholder="CPT Applicant" />
                               </td>
                               <td style="width: 15%; text-align: right">
                                   GRP Form No
                               </td>
                               <td style="width:15%;">
                                   <input id="txtGRPNonDate" type="text" style="width:99%;" placeholder="GRP/Export Form No" />
                               </td>
                           </tr>
                           <tr>
                               <td style="width: 15%; text-align: right">
                                   Goods Des. View Type
                               </td>
                               <td style="width: 20%">
                                   <select id="cboGoodsDesViewType" style=" width:100%;"></select>
                               </td>
                               <td style="width: 15%; text-align: right">
                                   To The Order Of
                               </td>
                               <td style="width: 20%; text-align: right">
                                   <input type="text" id="txtToTheOrderOf" style="width:100%"/>
                               </td>
                               <td style="width: 15%; text-align: right">
                                   Order Of BankType 
                               </td>
                               <td style="width:15%;">
                                   <select id="cboOrderOfBankType" style=" width:100%;"></select>
                               </td>
                           </tr>
                       </table>
                   </fieldset>
                   <fieldset>
                    <div>
                        <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                            <tr>
                                <td style="width:60%;vertical-align:top">
                                    <table id="tblPartyInfo"  class="easyui-datagrid" style="width:99%; height:150px;  font-size: 12px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                                        <thead>
                                            <tr>
                                                <th data-options="field:'Selected',checkbox:true"></th>
                                                <th field="PartyInfo" width="50%">PartyInfo</th>
                                                <th field="RefNo" width="30%">RefNo</th>
                                                <th field="RefDate" width="30%">RefDate</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </td>
                                <td style="width:38%;vertical-align:top">
                                    <fieldset>
                                        <table border="0" cellspacing="2" cellpadding="2" style="width:100%; font-size: 11px;">

                                            <tr >
                                                <td style="width: 50%; text-align: right"> <label id="lblBagWeight" style="font-size: 11px ;"></label>:</td>
                                                <td style="width: 20%">
                                                    <input id="txtBagCount" class="number" type="text" style="width:99%;" placeholder="Measurement Carton" />
                                                </td>
                                                <td style="width: 30%"></td>
                                            </tr>
                                            <tr >
                                                <td style="width: 50%; text-align: right"><label id="lblWeightPerBag" style="font-size: 11px;"></label>:</td>
                                                <td style="width: 20%">
                                                    <input id="txtWeightPBag" class="number" type="text" style="width:99%;" placeholder="Per Carton Weight" />
                                                </td>
                                                <td style="width: 40%"></td>
                                            </tr>
                                            <tr style=" height:80px;">
                                                <td style="width: 50%; text-align: right"> </td>
                                                <td style="width: 20%">
                                                </td>
                                                <td style="width: 30%"></td>
                                            </tr>

                                        </table>
                                        </fieldset>
</td>
                            </tr>
                        </table>
                        @*<table id="tblpartyinfo" title="" class="easyui-datagrid" style="width:100%;height:100px;   font-size: 12px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                            <thead>
                                <tr>
                                    <th data-options="field:'Selected',checkbox:true">
                                    </th>
                                    <th field="PartyInfo" width="50%">PartyInfo</th>

                                </tr>
                            </thead>
                        </table>*@
                    </div>
                          
                      
                     
                   </fieldset>
</div>
               
               
           </div>
           <fieldset >
                       <legend>Actions : </legend>
               <table style="width:100%;">
                   <tr>
                       <td style="width:70%;"></td>
                       <td style="width:30%;text-align:right;">
                           <a id="btnSaveDoc" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                           <a id="btnCloseExportDocSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                       </td>
                   </tr>
               </table>
                      
                   </fieldset>
      </div>

       <div style="width:100%;height:100%" class="menuMainCollectionTable">
         
               <div style="width:100%;height:88%">

                   <table id="tblExportDocSetups" title="Export Doc Setup List" style="width:100%;height:120%" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarExportDocSetup">
                       <thead>
                           <tr>
                               <th field="DocName" width="150">Doc Name</th>
                               <th field="DocHeader" width="180">Header</th>
                               <th field="Beneficiary" width="150">Beneficiary</th>
                               <th field="ActivityInSt" width="100">Activity</th>
                               <th field="Sequence" width="50">Sequence</th>

                           </tr>
                       </thead>
                   </table>
                   <div id="toolbarExportDocSetup">

                       @*<a id="btnAddExportDocSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>*@
                       <a id="btnEditDoc" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                       <a id="btnExportDocForwarding" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Bank Forwarding Setup</a>
                       <a id="btnPrintDoc" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print Document</a>
                       @*<a id="btnViewDoc" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">View</a>
                    <a id="btnDeleteExportDocSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                    <a id="btnActivate" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Activate</a>
                    <a id="btnSetSequence" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true" onclick="SetSequence()">Setup Sequence</a>*@
                   </div>

               </div>
         
           <fieldset>
               <legend>Action</legend>
               <div style="width:100%;height:10%">
                   <table border="0" cellpadding="2" cellspacing="2" style="width:100%;">
                       <tr>
                           <td style="width: 20%; text-align: right"></td>

                           <td style="width: 65px; font-size:13px"></td>
                           <td style="width: 15%;text-align: right;  font-size:13px">
                               <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                           </td>

                       </tr>
                   </table>
               </div>

           </fieldset>
       </div>
       <div id="winExportDocForwarding" class="easyui-window winstyle" title="Bill Informations" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
           <table>
               <tr>
                   <td>
                       <fieldset>
                           <table id="tblExportDocForwarding" class="easyui-datagrid" style="width:100%;height:450px;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="false" autorowheight="false" toolbar="#toolbarExportDocForwarding" data-options="onClickRow: onClickRow">
                               <thead>
                               <th data-options=" field:'selected',checkbox:true"></th>
                               <th data-options="field:'Name_Print', width:250,align:'Left',editor:{type:'text'}" height="100px" align="Left">Doc Name</th>
                               <th data-options="field:'Copies_Original', width:100,align:'Left',editor:{type:'text'}" style="width:100px; height:100px" align="Left">Original Copies</th>
                               <th data-options="field:'Copies', width:100,align:'Left',editor:{type:'text'}" style="width:100px; height:100px" align="Left">Copies</th>
                               @*<th field="Name_Doc" width="110" align="left">Doc Name</th>*@
                               </thead>
                           </table>
                           <div id="toolbarExportDocForwarding">
                               <a href="javascript:void(0)" id="btnAddExportDocForwarding" class="easyui-linkbutton" iconcls="icon-add" plain="true">New</a>
                               <a href="javascript:void(0)" id="btnExportDocForwardingReload" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Re-load</a>
                               <a href="javascript:void(0)" id="btnDeleteExportDocForwarding" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                               <a href="javascript:void(0)" id="btnTemplateExportDocForwarding" class="easyui-linkbutton" iconcls="icon-add" plain="true">Template</a>
                           </div>

                       </fieldset>

                       <fieldset id="Action">
                           <legend style="font-weight: bold">Action : </legend>
                           <table border="0" cellspacing="2" cellpadding="2" style=" width: 100%;font-weight: bold; font-size: 12px">
                               <tr>
                                   <td style="width: 320px; text-align: right"></td>
                                   <td style="width: 50px; font-size:13px">
                                       <a id="btnSaveExportDocForwarding" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                                   </td>
                                   <td style="width: 50px; font-size:13px">
                                       <a id="btnCloseExportDocForwarding" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-closed" plain="true">Close</a>
                                   </td>
                               </tr>
                           </table>
                       </fieldset>
                   </td>

               </tr>
           </table>

       </div>
</body>
   <style type="text/css">
    #winExportDocSetup {
    width: 100%;
                       }
   </style>

  <script type="text/javascript">
    var _oExportDocSetup = null;
    var _oExportDocSetups = [];
    var _sBaseAddress = "";
    var _oDocumentTypes=[];
    var _nBUID = 0;
    var _oNotifyBy=[];
    var _oExportPartyInfoBills=[];
    var _oGoodsDesViewType=[];
    var _oOrderOfBankType = [];
    var _oBusinessUnit=null;
    var _oExportBill=null;
    var _oBankForwardingList = [];
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oExportDocSetups =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oDocumentTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.EnumDocumentTypes));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _oNotifyBy = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.NotifyBy));
        _oOrderOfBankType = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.OrderOfBankType));
        _oGoodsDesViewType = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.GoodsDesViewType));
        _oExportPartyInfoBills = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExportPartyInfoBills));
        _oBusinessUnit = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnit));
        _oExportBill = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExportBill));
        DynamicRefreshList(_oExportDocSetups, 'tblExportDocSetups');

        DynamicRefreshList(_oExportPartyInfoBills, 'tblPartyInfo');
        CheckExistingPartyInfo();
        debugger;
        $("#cboNotifyBy").icsLoadCombo({ List: _oNotifyBy,OptionValue: "id",DisplayText: "Value"});
        $("#cboGoodsDesViewType").icsLoadCombo({ List: _oGoodsDesViewType,OptionValue: "id",DisplayText: "Value"});
        $("#cboOrderOfBankType").icsLoadCombo({List: _oOrderOfBankType, OptionValue: "id",DisplayText: "Value"});
        //$("#cboOrderOfBankType").val(_oExportDocSetups.OrderOfBankTypeInInt);
        RefreshLeable();
    });

    $(document).keydown(function (e) { if (e.keyCode == 27) { $('#winExportDocSetup').icsWindow('close'); } });
    function RefreshLeable()
    {
        if(_oBusinessUnit.BusinessUnitID)
        {
            if(_oBusinessUnit.BusinessUnitTypeInInt==5|| _oBusinessUnit.BusinessUnitTypeInInt==6)
            {
                document.getElementById("lblBagWeight").innerHTML = "Per yds Weight in GM";
                document.getElementById("lblWeightPerBag").innerHTML = "Per Roll Length(Y)";
            }
            else{
                document.getElementById("lblBagWeight").innerHTML = "Bag/Packet Weight";
                document.getElementById("lblWeightPerBag").innerHTML = "Weight per Bag/Packet";
            }
        }
    }
    //function SetSequence()
    //{
    //    var oParameter = new Object();
    //    oParameter.Name = "Set Sequence";
    //    var tsv=((new Date()).getTime())/1000;
    //    var url = _sBaseAddress+"/ExportDocSetup/ViewSetupSequence?buid="+_nBUID+"&ts="+tsv;
    //    var oExportDocSetups = window.showModalDialog(url, oParameter, 'dialogHeight:440px;dialogWidth:395px;dialogLeft:400;dialogTop:110;center:yes;resizable:yes;status:no;scroll:yes');
    //    if(oExportDocSetups!=null)
    //    {
    //        if(oExportDocSetups.length>0)
    //        {
    //            RefreshList(oExportDocSetups);
    //        }
    //    }
    //}

    $("#btnAddExportDocSetup").click(function () {
        $("#winExportDocSetup").icsWindow("open", "Add ExportDocSetup");
        $("#winExportDocSetup input").not("input[type='button']").val("");
        _oExportDocSetup = null;
        RefreshExportDocSetupLayout("btnAddExportDocSetup"); //button id as parameter
    });

    $("#btnEditDoc").click(function () {
        debugger;
        var oExportDocSetup = $("#tblExportDocSetups").datagrid("getSelected");
        if (oExportDocSetup == null || oExportDocSetup.ExportDocSetupID <= 0) { alert("Please select an item from list!"); return; }
        $("#winExportDocSetup").icsWindow('open', "Edit ExportDocSetup");
        _oExportDocSetup = oExportDocSetup;
        RefreshExportDocSetupLayout("btnEditDoc");
        RefreshExportDocSetupControl(oExportDocSetup);
    });

    $("#btnViewDoc").click(function () {
        var oExportDocSetup = $("#tblExportDocSetups").datagrid("getSelected");
        if (oExportDocSetup == null || oExportDocSetup.ExportDocSetupID <= 0) { alert("Please select an item from list!"); return; }
        $("#winExportDocSetup").icsWindow('open', "View ExportDocSetup");
        RefreshExportDocSetupLayout("btnViewDoc");
        RefreshExportDocSetupControl(oExportDocSetup);
    });
    function RefreshExportDocSetupLayout(buttonId) {
        if (buttonId === "btnViewDoc") {
            $("#winExportDocSetup input").prop("disabled", true);
            $("#winExportDocSetup select").prop("disabled", true);
            $("#btnSaveDoc").hide();
        }
        else {
            $("#winExportDocSetup input").not("#txtExportDocSetupCode").prop("disabled", false);
            $("#winExportDocSetup select").prop("disabled", false);
            $("#btnSaveDoc").show();
        }
        //$("#txtNumebr").icsNumberField({ precision: 2 });
    }

    function CheckExistingPartyInfo() {
        var oExportPartyInfoBills = $('#tblPartyInfo').datagrid('getRows');
        if (oExportPartyInfoBills.length > 0) {
            for (var i = 0; i < oExportPartyInfoBills.length; i++) {
                if (Boolean(oExportPartyInfoBills[i].Selected)) {
                    $('#tblPartyInfo').datagrid('checkRow', i);
                }
            }
        }
    }
    function GetsPartyInfo(oExportDocSetup)
    {
        var oExportDocSetupTemp = { ExportDocSetupID: oExportDocSetup.ExportDocSetupID,ExportBillDocID:oExportDocSetup.ExportBillDocID,ContractorID:_oExportBill.ApplicantID,ExportBillID:oExportDocSetup.ExportBillID};
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oExportDocSetupTemp,
            ControllerName: "ExportDocSetup",
            ActionName: "GetsPartyInfo",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {
            if (response.status && response.objs.length > 0)
            {
                var   oExportPartyInfoBills=response.objs;
                DynamicRefreshList(response.objs, 'tblPartyInfo');

            }
            else{
                DynamicRefreshList(_oExportPartyInfoBills, 'tblPartyInfo');
            }
            CheckExistingPartyInfo();
        });
    }
    function RefreshExportDocSetupControl(oExportDocSetup) {
        debugger;
        //if( oExportDocSetup.ExportBillDocID>0)
        //{ GetsPartyInfo(oExportDocSetup);}
        GetsPartyInfo(oExportDocSetup);

        $("#txtDocName").val(oExportDocSetup.DocName);
        $("#txtDocHeader").val(oExportDocSetup.DocHeader);
        $('#txtToTheOrderOf').val(oExportDocSetup.IssuingBank);
        $('#cboOrderOfBankType').val(oExportDocSetup.OrderOfBankTypeInInt);

        //$("#txtDocumentaryCreditNoDate").val(oExportDocSetup.DocumentaryCreditNoDate);
        //$("#txtAgainstExportLC").val(oExportDocSetup.AgainstExportLC);
        //$("#txtPortofLoading").val(oExportDocSetup.PortofLoading);
        //$("#txtFinalDestination").val(oExportDocSetup.FinalDestination);
        //$("#txtIssuingBank").val(oExportDocSetup.IssuingBank);
        //$("#txtNegotiatingBank").val(oExportDocSetup.NegotiatingBank);
        //$("#txtCountryofOrigin").val(oExportDocSetup.CountryofOrigin);
        //$("#txtTermsofPayment").val(oExportDocSetup.TermsofPayment);
        //$("#txtAccount").val(oExportDocSetup.Account);
        //$("#txtNotifyParty").val(oExportDocSetup.NotifyParty);
        //$("#txtRemarks").val(oExportDocSetup.Remarks);
        //$("#txtAmountInWord").val(oExportDocSetup.AmountInWord);
        $("#txtWecertifythat").val(oExportDocSetup.Wecertifythat);
        $("#txtCertification").val(oExportDocSetup.Certification);
        //$("#txtDeliveryTo").val(oExportDocSetup.DeliveryTo);
        //$("#txtChallanNo").val(oExportDocSetup.ChallanNo);
        //$("#txtIRC").val(oExportDocSetup.IRC);
        //$("#txtGarmentsQty").val(oExportDocSetup.GarmentsQty);
        //$("#txtHSCode").val(oExportDocSetup.HSCode);
        //$("#txtAreaCode").val(oExportDocSetup.AreaCode);
        //$("#txtSpecialNote").val(oExportDocSetup.SpecialNote);
        //$("#txtRemark").val(oExportDocSetup.Remark);

        //$("#chkIsPrintVat").prop("checked", oExportDocSetup.IsVat);
        //$("#chkIsPrintRegistration").prop("checked", oExportDocSetup.IsRegistration);


        //$("#chkIsPrintHeader").prop("checked", oExportDocSetup.IsPrintHeader);
        $("#chkIsPrintOriginal").prop("checked", oExportDocSetup.IsPrintOriginal);
        $("#chkIsPrintGrossNetWeight").prop("checked", oExportDocSetup.IsPrintGrossNetWeight);
        //$("#chkIsPrintDeliveryBy").prop("checked", oExportDocSetup.IsPrintDeliveryBy);
        //$("#chkIsPrintTerm").prop("checked", oExportDocSetup.IsPrintTerm);
        //$("#chkIsPrintQty").prop("checked", oExportDocSetup.IsPrintQty);
        //$("#chkIsPrintUnitPrice").prop("checked", oExportDocSetup.IsPrintUnitPrice);
        //$("#chkIsPrintValue").prop("checked", oExportDocSetup.IsPrintValue);
        //$("#chkIsPrintWeight").prop("checked", oExportDocSetup.IsPrintWeight);
        $("#chkIsPrintFrieghtPrepaid").prop("checked", oExportDocSetup.IsPrintFrieghtPrepaid);
        $("#chkIsPrintInvoiceDate").prop("checked", oExportDocSetup.IsPrintInvoiceDate);
        $("#chkForCaptionInDubleLine").prop("checked", oExportDocSetup.ForCaptionInDubleLine);
        $("#chkIsShowAmendmentNo").prop("checked", oExportDocSetup.IsShowAmendmentNo);
        if(oExportDocSetup.HSCode==null || oExportDocSetup.HSCode=="")
        {
            $("#chkIsPrintHSCode").prop("checked",false);
        }
        else
        {
            $("#chkIsPrintHSCode").prop("checked", true);
        }


        $("#txtClauseOne").val(oExportDocSetup.ClauseOne);
        $("#txtClauseTwo").val(oExportDocSetup.ClauseTwo);
        $("#txtClauseThree").val(oExportDocSetup.ClauseThree);
        $("#txtClauseFour").val(oExportDocSetup.ClauseFour);
        //$("#txtCarrier").val(oExportDocSetup.Carrier);

        //$("#txtAuthorisedSignature").val(oExportDocSetup.AuthorisedSignature);
        //$("#txtReceiverSignature").val(oExportDocSetup.ReceiverSignature);

        //$("#txtFor").val(oExportDocSetup.For);
        //$("#txtMUnitName").val(oExportDocSetup.MUnitName);

        //$("#txtNetWeightName").val(oExportDocSetup.NetWeightName);

        //$("#txtGrossWeightName").val(oExportDocSetup.GrossWeightName);
        //$("#txtBag_Name").val(oExportDocSetup.Bag_Name);
        //$("#txtCountryofOriginName").val(oExportDocSetup.CountryofOriginName);
        //$("#txtSellingOnAbout").val(oExportDocSetup.SellingOnAbout);
        //$("#txtPortofLoadingName").val(oExportDocSetup.PortofLoadingName);
        //$("#txtFinalDestinationName").val(oExportDocSetup.FinalDestinationName);
        $("#txtTruckNo_Print").val(oExportDocSetup.TruckNo_Print);
        $("#txtDriver_Print").val(oExportDocSetup.Driver_Print);
        $("#txtTruckNo").val(oExportDocSetup.TruckNo);
        $("#txtDriverName").val(oExportDocSetup.DriverName);
        //$("#txtTO").val(oExportDocSetup.TO);
        //$("#txtShippingMark").val(oExportDocSetup.ShippingMark);
        //$("#txtReceiverCluse").val(oExportDocSetup.ReceiverCluse);

        $("#txtCarrierName").val(oExportDocSetup.CarrierName);
        //$("#txtDescriptionOfGoods").val(oExportDocSetup.DescriptionOfGoods);
        //$("#txtMarkSAndNos").val(oExportDocSetup.MarkSAndNos);
        //$("#txtQtyInOne").val(oExportDocSetup.QtyInOne);
        //$("#txtQtyInTwo").val(oExportDocSetup.QtyInTwo);
        //$("#txtValueName").val(oExportDocSetup.ValueName);
        //$("#txtUPName").val(oExportDocSetup.UPName);
        //$("#txtNoOfBag").val(oExportDocSetup.NoOfBag);
        $("#txtCTPApplicant").val(oExportDocSetup.CTPApplicant);
        $("#txtGRPNonDate").val(oExportDocSetup.GRPNoDate);
        $("#txtASPERPI").val(oExportDocSetup.ASPERPI);
        $('#txtTruckReceiptDate').datebox('setValue', oExportDocSetup.TRDateSt);
        $("#txtTruckReceiptNo").val(oExportDocSetup.TRNo);
        $("#cboNotifyBy").val(oExportDocSetup.NotifyBy);
        $("#cboGoodsDesViewType").val(parseInt(oExportDocSetup.GoodsDesViewType));
        $("#txtBagCount").val(parseFloat(oExportDocSetup.BagCount));
        $("#txtWeightPBag").val(parseFloat(oExportDocSetup.WeightPBag));
    }

    function RefreshObjectExportDocSetup() {

        var nExportDocSetupId = (_oExportDocSetup == null ? 0 : _oExportDocSetup.ExportDocSetupID);
        var oExportDocSetup = {
            ExportDocSetupID: nExportDocSetupId,
            ExportBillDocID: _oExportDocSetup.ExportBillDocID,
            CompanyID:_oExportDocSetup.CompanyID,
            DocumentTypeInt:_oExportDocSetup.DocumentTypeInt,
            PrintOn: parseInt(_oExportDocSetup.PrintOn),
            DocName: $.trim(_oExportDocSetup.DocName),
            DocHeader:$.trim(_oExportDocSetup.DocHeader),
            Beneficiary: $.trim(_oExportDocSetup.Beneficiary),
            BillNo:$.trim(_oExportDocSetup.BillNo),
            NoAndDateOfDoc:$.trim(_oExportDocSetup.NoAndDateOfDoc),
            ProformaInvoiceNoAndDate:$.trim(_oExportDocSetup.ProformaInvoiceNoAndDate),
            AccountOf:$.trim(_oExportDocSetup.AccountOf),
            DocumentaryCreditNoDate: $.trim(_oExportDocSetup.DocumentaryCreditNoDate),
            AgainstExportLC: $.trim(_oExportDocSetup.AgainstExportLC),
            PortofLoading: $.trim(_oExportDocSetup.PortofLoading),
            FinalDestination:$.trim(_oExportDocSetup.FinalDestination),
            IssuingBank:$.trim(_oExportDocSetup.IssuingBank),
            NegotiatingBank:$.trim(_oExportDocSetup.NegotiatingBank),
            CountryofOrigin:$.trim(_oExportDocSetup.CountryofOrigin),
            TermsofPayment: $.trim(_oExportDocSetup.TermsofPayment),
            Account: $.trim(_oExportDocSetup.Account),
            NotifyParty:$.trim(_oExportDocSetup.NotifyParty),
            AmountInWord: $.trim(_oExportDocSetup.AmountInWord),
            Remarks: $.trim($("#txtRemarks").val()),
            Wecertifythat: $.trim($("#txtWecertifythat").val()),
            Certification: $.trim($("#txtCertification").val()),
            DeliveryTo: $.trim(_oExportDocSetup.DeliveryTo),
            IRC:  $.trim(_oExportDocSetup.IRC),
            GarmentsQty: $.trim(_oExportDocSetup.GarmentsQty),
            HSCode:  ($("#chkIsPrintHSCode").is(":checked")==true ? "HS Code" : ""),  //-- ;  $.trim(_oExportDocSetup.HSCode),
            AreaCode: $.trim(_oExportDocSetup.AreaCode),
            SpecialNote: $.trim(_oExportDocSetup.SpecialNote),
            Remark:$.trim(_oExportDocSetup.Remark),
            ChallanNo:$.trim(_oExportDocSetup.ChallanNo),

            //IsVat: $("#chkIsPrintVat").is(":checked"),
            //IsRegistration: $("#chkIsPrintRegistration").is(":checked"),

            IsPrintHeader:_oExportDocSetup.IsPrintHeader,
            IsPrintOriginal: $("#chkIsPrintOriginal").is(":checked"),
            IsPrintGrossNetWeight: $("#chkIsPrintGrossNetWeight").is(":checked"),
            IsPrintDeliveryBy :_oExportDocSetup.IsPrintDeliveryBy,
            IsPrintTerm: _oExportDocSetup.IsPrintTerm,
            IsPrintQty: _oExportDocSetup.IsPrintQty,
            IsPrintUnitPrice:_oExportDocSetup.IsPrintUnitPrice,
            IsPrintValue: _oExportDocSetup.IsPrintValue,
            IsPrintWeight: _oExportDocSetup.IsPrintWeight,
            IsPrintFrieghtPrepaid: $("#chkIsPrintFrieghtPrepaid").is(":checked"),
            IsPrintInvoiceDate: $("#chkIsPrintInvoiceDate").is(":checked"),
            ForCaptionInDubleLine:_oExportDocSetup.ForCaptionInDubleLine,
            IsShowAmendmentNo:_oExportDocSetup.IsShowAmendmentNo,
            BUID:_nBUID,
            ClauseOne: $.trim($("#txtClauseOne").val()),
            ClauseTwo: $.trim($("#txtClauseTwo").val()),
            ClauseThree: $.trim($("#txtClauseThree").val()),
            ClauseFour: $.trim($("#txtClauseFour").val()),
            Carrier:$.trim(_oExportDocSetup.Carrier),

            AuthorisedSignature:$.trim(_oExportDocSetup.AuthorisedSignature),
            ReceiverSignature: $.trim(_oExportDocSetup.ReceiverSignature),
            For: $.trim(_oExportDocSetup.For),
            MUnitName: $.trim(_oExportDocSetup.MUnitName),
            NetWeightName:$.trim(_oExportDocSetup.NetWeightName),
            GrossWeightName: $.trim(_oExportDocSetup.GrossWeightName),
            Bag_Name: $.trim(_oExportDocSetup.Bag_Name),
            CountryofOriginName :  $.trim(_oExportDocSetup.CountryofOriginName),
            SellingOnAbout :  $.trim(_oExportDocSetup.SellingOnAbout),
            PortofLoadingName:  $.trim(_oExportDocSetup.PortofLoadingName),
            FinalDestinationName: $.trim(_oExportDocSetup.FinalDestinationName),
            TruckNo_Print:  $.trim(_oExportDocSetup.TruckNo_Print),
            Driver_Print:  $.trim(_oExportDocSetup.Driver_Print),
            TruckNo: $.trim($("#txtTruckNo").val()),
            DriverName: $.trim($("#txtDriverName").val()),
            TRNo: $.trim($("#txtTruckReceiptNo").val()),
            TO:  $.trim(_oExportDocSetup.TO),
            ShippingMark: $.trim($("#txtShippingMark").val()),
            ReceiverCluse: $.trim($("#txtReceiverCluse").val()),
            CarrierName: $.trim($("#txtCarrierName").val()),
            DescriptionOfGoods: $.trim(_oExportDocSetup.DescriptionOfGoods),
            MarkSAndNos:  $.trim(_oExportDocSetup.MarkSAndNos),
            QtyInOne:  $.trim(_oExportDocSetup.QtyInOne),
            QtyInTwo:  $.trim(_oExportDocSetup.QtyInTwo),
            ValueName:  $.trim(_oExportDocSetup.ValueName),
            UPName: $.trim(_oExportDocSetup.UPName),
            CTPApplicant: $.trim($("#txtCTPApplicant").val()),
            GRPNoDate: $.trim($("#txtGRPNonDate").val()),
            ASPERPI:$.trim(_oExportDocSetup.ASPERPI),
            NoOfBag: $.trim($("#txtNoOfBag").val()),
            TRDate: $('#txtTruckReceiptDate').datebox('getValue'),
            NotifyBy:parseInt($("#cboNotifyBy").val()),
            GoodsDesViewType:parseInt($("#cboGoodsDesViewType").val()),
            BagCount:parseFloat($('#txtBagCount').val()),
            WeightPBag:parseFloat($('#txtWeightPBag').val()),
            ExportBillID:_oExportDocSetup.ExportBillID,
            ExportPartyInfoBills: $('#tblPartyInfo').datagrid('getChecked'),
            //, oExportDocSetup.FontSize_Normal
            //, oExportDocSetup.FontSize_Bold
            //  , oExportDocSetup.FontSize_ULine
            ToTheOrderOf :_oExportDocSetup.ToTheOrderOf,
            OrderOfBankTypeInInt :$("#cboOrderOfBankType ").val(),
        };
        return oExportDocSetup;
        debugger;

        $("#txtTruckNo").val(oExportDocSetup.TruckNo);
        $("#txtDriverName").val(oExportDocSetup.DriverName);

    }
    function ValidateInputExportDocSetup(e) {


        if ( _oExportDocSetup==null ||  _oExportDocSetup.ExportDocSetupID<=0)
        {
            alert("Doc Setup Not found!");
            $('#txtDocName').val("");
            $('#txtDocName').focus();
            $('#txtDocName').css("border-color", "#c00");
            return false;
        } else {
            $('#txtDocName').css("border-color", "");
        }
        if (_oExportDocSetup.ExportBillID<=0)
        {
            alert("Doc Setup Not found!");
            $('#txtDocName').val("");
            $('#txtDocName').focus();
            $('#txtDocName').css("border-color", "#c00");
            return false;
        } else {
            $('#txtDocName').css("border-color", "");
        }

        if (!$.trim($("#txtDocName").val()).length) {
            alert("Please enter ExportDocSetup name!");
            $('#txtDocName').val("");
            $('#txtDocName').focus();
            $('#txtDocName').css("border-color", "#c00");
            return false;
        } else {
            $('#txtDocName').css("border-color", "");
        }



        return true;
    }
    $("#btnSaveDoc").click(function () {
        debugger;
        if (!ValidateInputExportDocSetup()) return;
        var oExportDocSetup = RefreshObjectExportDocSetup();

        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oExportDocSetup,
            ObjectId: oExportDocSetup.ExportDocSetupID,
            ControllerName: "ExportDocSetup",
            ActionName: "Save_Bill",
            TableId: "tblExportDocSetups",
            IsWinClose: true
        };
        $.icsSave(obj);
    });

    $("#btnCloseExportDocSetup").click(function () {
        $("#winExportDocSetup").icsWindow('close');
        $(".wininputfieldstyle input").val("");
        //$("#chkIsOwnExportDocSetup").prop("checked", false);
    });
    $('#btnClose').click(function(e){
        window.location.href = sessionStorage.getItem("BackLink");
    });
    $("#btnCloseExportDocForwarding").click(function () {
        $("#winExportDocForwarding").icsWindow('close');
        $(".wininputfieldstyle input").val("");
    });
      /// bank Forwarding
    $("#btnExportDocForwarding").click(function () {
        //var oExportBill = $("#tblExportBills").datagrid("getSelected");
        if (_oExportBill == null || _oExportBill.ExportBillID <= 0) { alert("Please select an item from list!"); return; }
        $("#winExportDocForwarding").icsWindow('open', "Export Doc Bank Forwarding");
        ///   RefreshExportBillLayout("btnAddRecedFromParty");
        
        Gets_ExportDocForwarding(_oExportBill);
    });
      
    function Gets_ExportDocForwarding(oExportBill) {
        _oBankForwardingList = [];
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oExportBill,
            ControllerName: "ExportBankForwarding",
            ActionName: "GetbyExportBill",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {
            if (response.status && response.objs.length > 0) {
                if (response.objs.length > 0)
                {
                    _oBankForwardingList = response.objs;
                    DynamicRefreshList(response.objs, "tblExportDocForwarding");
                    $('#tblExportDocForwarding').datagrid({ selectOnCheck: false, checkOnSelect: true });
                }
                else {
                    DynamicRefreshList([], "tblExportDocForwarding");
                    _oBankForwardingList = [];
                }

            }
        });
    }
    $("#btnExportDocForwardingReload").click(function () {
        Gets_ExportDocForwarding_Reload(_oExportBill)
    });

    function Gets_ExportDocForwarding_Reload(oExportBill) {
        _oBankForwardingList = [];
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oExportBill,
            ControllerName: "ExportBankForwarding",
            ActionName: "GetbyExportBill_Reload",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {

            if (response.status && response.objs.length > 0) {
                if (response.objs.length > 0) {
                    _oBankForwardingList = response.objs;
                    DynamicRefreshList(response.objs, "tblExportDocForwarding");
                    $('#tblExportDocForwarding').datagrid({ selectOnCheck: false, checkOnSelect: true });
                }
                else { DynamicRefreshList([], "tblExportDocForwarding"); _oBankForwardingList = [];}

            }
        });
    }
    $("#btnSaveExportDocForwarding").click(function (e) {

        // if (!ValidateInputExportBill()) return;
        endEditing();
        var oExportDocForwarding = {
            ExportBillID: (_oExportBill != null) ? _oExportBill.ExportBillID : 0,
            ExportBankForwardingID:0,
            ExportBankForwardings:  $('#tblExportDocForwarding').datagrid('getChecked')
        };

        var obj =
            {
                BaseAddress: _sBaseAddress,
                Object: oExportDocForwarding,
                ObjectId: oExportDocForwarding.ExportBankForwardingID,
                ControllerName: "ExportBankForwarding",
                ActionName: "SaveExportBankForwarding",
                TableId: "tblExportDocForwarding",
                IsWinClose: true
            };
        $.icsSave(obj);
    });
    $("#btnAddExportDocForwarding").click(function (e) {

      
        var oExportDocForwarding = {
            ExportBillID: (_oExportBill != null) ? _oExportBill.ExportBillID : 0,
            ExportBankForwardingID:0,
            Name_Print:''
        };
        var oExportDocForwardings = $("#tblExportDocForwarding").datagrid("getRows");
        $('#tblExportDocForwarding').datagrid('appendRow',oExportDocForwarding);
        $('#tblExportDocForwarding').datagrid('selectRow',oExportDocForwardings.length-1);
    });
    $("#btnDeleteExportDocForwarding").click(function () {
        var oExportDocForwarding = $("#tblExportDocForwarding").datagrid("getSelected");
        var SelectedRowIndex = $('#tblExportDocForwarding').datagrid('getRowIndex', oExportDocForwarding);
        if (!confirm("Confirm to Delete?")) return false;
        if (oExportDocForwarding == null || oExportDocForwarding.ExportBankForwardingID <= 0) {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oExportDocForwarding,
            ControllerName: "ExportBankForwarding",
            ActionName: "DeleteExportBankForwarding",
            TableId: "tblExportDocForwarding",
            IsWinClose: false
        };
        $.icsDelete(obj);
        $('#tblExportDocForwarding').datagrid('deleteRow', SelectedRowIndex);
    });
      
    var editIndex = undefined;
    function endEditing() {
        if (editIndex == undefined) {
            return true;
        }
        if ($('#tblExportDocForwarding').datagrid('validateRow', editIndex)) {
            $('#tblExportDocForwarding').datagrid('endEdit', editIndex);
            $('#tblExportDocForwarding').datagrid('selectRow', editIndex);

            editIndex = undefined;
            return true;
        }
        else {
            return false;
        }
    }

    function onClickRow(index) {
        if (editIndex != index) {
            if (endEditing()) {
                $('#tblExportDocForwarding').datagrid('selectRow', index)
                        .datagrid('beginEdit', index);
                editIndex = index;
            }
            else {
                $('#tblExportDocForwarding').datagrid('selectRow', editIndex);
            }
        }
    }
    $("#btnTemplateExportDocForwarding").click(function () {
        if (_oBankForwardingList.length > 0)
        {
            for (var i = 0; i < _oBankForwardingList.length; i++) {
                if (_oBankForwardingList[i].Name_Print.toUpperCase() == "PACKING & WEIGHT LIST") {
                    _oBankForwardingList[i].Copies = 6;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "COMMERCIAL INVOICE") {
                    _oBankForwardingList[i].Copies = 8;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BILL OF EXCHANGE") {
                    _oBankForwardingList[i].Copies = 2;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BENEFICIARY CERTIFICATE") {
                    _oBankForwardingList[i].Copies = 2;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "CERTIFICATE OF ORIGIN") {
                    _oBankForwardingList[i].Copies = 6;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "TRUCK RECEIPT") {
                    _oBankForwardingList[i].Copies = 4;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "DELIVERY CHALLAN") {
                    _oBankForwardingList[i].Copies = 4;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "TO WHOM IT MAY CONCERN") {
                    _oBankForwardingList[i].Copies = 2;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "MUSOK-11") {
                    _oBankForwardingList[i].Copies = 0;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BACK TO BACK L/C(ORIGINAL)") {
                    _oBankForwardingList[i].Copies = 1;
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BTMA CERTIFICATE") {
                    _oBankForwardingList[i].Copies = 0;
                }
            }
            DynamicRefreshList(_oBankForwardingList, "tblExportDocForwarding");

            for (var i = 0; i < _oBankForwardingList.length; i++)
            {
                if (_oBankForwardingList[i].Name_Print.toUpperCase() == "PACKING & WEIGHT LIST") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "COMMERCIAL INVOICE") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BILL OF EXCHANGE") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BENEFICIARY CERTIFICATE") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "CERTIFICATE OF ORIGIN") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "TRUCK RECEIPT") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "DELIVERY CHALLAN") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "TO WHOM IT MAY CONCERN") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "MUSOK-11") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BACK TO BACK L/C(ORIGINAL)") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
                else if (_oBankForwardingList[i].Name_Print.toUpperCase() == "BTMA CERTIFICATE") {
                    $("#tblExportDocForwarding").datagrid("checkRow", i);
                }
            }
        }
    });
    /// Print Export Doc
    $("#btnPrintDoc").click(function () {
        var oExportDocSetup = $("#tblExportDocSetups").datagrid("getSelected");
        if (oExportDocSetup == null || oExportDocSetup.ExportDocSetupID <= 0) { alert("Please select an item from list!"); return; }
        window.open(_sBaseAddress + '/ExportBill/PrintExportDoc?id=' + oExportDocSetup.ExportBillID + "&nDocType=" +oExportDocSetup.ExportDocSetupID + "&nPrintType=" + 0 + "&nUnitType=" + 0 + "&nPageSize=" + 1+"&bIsApplicant=false", "_blank");

    });

</script>


                         
