@model ESimSol.BusinessObjects.CashFlowSetup
@{
    ViewBag.Title = "Statement of Comprehensive Income";
}


<div class="easyui-panel" title="" style="margin-left: 0px; height:100%; width:100%" fit="true">
    <div class="easyui-layout" data-options="fit:true">
        <div data-options="region:'north',split:true" style="width:100%;padding:5px; overflow:hidden">
            <div style="margin-bottom:5px">
                <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="false">Print</a>
                <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="false">Export To XL</a>
            </div>
        </div>
        <div data-options="region:'center'" style="width:100%;padding:20px; text-align:center">
            <div style="width:100%; border:1px solid black; margin-bottom:20px">
                <table  id="tblCashFlowStatement" border="0" cellpadding="1" cellspacing="0" width="100%">
                    <tr>
                        <td style="width:2%"></td>
                        <td colspan="4" style="width:98%; text-align:left">
                            <label id="lblCompanyName" style="font-size:16px; font-weight:bold"></label>
                        </td>                        
                    </tr>
                    <tr>                        
                        <td style="width:2%"></td>
                        <td colspan="4" style="width:98%; text-align:left">
                            <label id="lblStatementName" style="font-size:15px; font-weight:bold; color:gray"></label>
                        </td>                        
                    </tr>
                    <tr>
                        <td style="width:2%"></td>
                        <td colspan="4" style="width:98%; text-align:left">
                            <label id="lblStatementDate" style="font-size:13px;"></label>
                        </td>                        
                    </tr>                   
                    <tr>
                        <td style="width:2%"></td>
                        <td style="width:3%"></td>
                        <td style="width:47%;"></td>
                        <td style="width:20%; text-align:center; font-weight:bold"></td>
                        <td style="width:26%; text-align:right; border:1px solid black">
                            <label id="lblStatementDateWithCurrency" style="font-size:13px; font-weight:bold"></label>
                        </td>
                        <td style="width:2%"></td>
                    </tr>    
                    <tr>
                        <td style="width:2%"></td>
                        <td style="width:3%"></td>
                        <td  style="width:47%"></td>
                        <td style="width:20%; text-align:center; font-weight:bold"></td>
                        <td style="width:26%; text-align:right;"></td>
                        <td style="width:2%"></td>
                    </tr>                
                  
                </table>
            </div>
        </div>        
    </div>
</div>

<style>
       .segmentclass {        
        color: black;
        font-size : 12px;
        font-family : Tahoma;
        font-weight:bold;
        font-style:italic;
    }
    .subgroupclass {        
        color: black;
        font-size : 12px;
        font-family : Tahoma;           
    }
    .segmentsummeryclass {        
        color: black;
        font-size : 13px;
        font-family : Tahoma;  
        font-weight:bold;         
    }

    .highlight
    {
        background:#DAFFD6;
    }
    #tblCashFlowStatement tr:hover td,
    #tblCashFlowStatement tr:hover td.highlight
    {
        background:#D6DAD5;
    }
    label {
    font-weight: normal;
}
</style>
<script type="text/javascript">
    var _nSessionCurrentCompanyID=0;
    var _oCashFlowSetup=null;
    var _oAssets=[];
    var _oLiabilityAndOwnerEquitys=[];
    var _oCreditChartOfAccount=null;
    $(document).ready(function () {
        debugger;
        _oCashFlowSetup =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        RefreshControl(_oCashFlowSetup);
        RefreshTable(_oCashFlowSetup);
    });

   
    
    function RefreshControl(oCashFlowSetup)
    {
        $('#lblCompanyName').text(oCashFlowSetup.Company.Name);        
        $('#lblStatementDateWithCurrency').text(oCashFlowSetup.SessionDate+' '+oCashFlowSetup.Company.CurrencyName);
        var nMaxRowIndex = document.getElementById('tblCashFlowStatement').rows.length-1;
        for(var i=nMaxRowIndex; i>4; i--)
        {
            document.getElementById("tblCashFlowStatement").deleteRow(i);
        }
    }

    function RefreshTable(_oCashFlowSetup)
    {        
        var oCashFlowSetups = _oCashFlowSetup.CashFlowSetups;
        var oNetIncreaseFromCashflow = null;
        var oOpeningBalance = null;
        var oClosingBalance = null;
        var nCFTransactionCategoryInInt=0
        for(var i=0;  i<oCashFlowSetups.length; i++ )
        {   
            if(parseInt(oCashFlowSetups[i].CashFlowSetupID)===1003)
            {
                //for double line
                var table = document.getElementById('tblCashFlowStatement');
                var nRowIndex = table.rows.length;
                var row = table.insertRow(nRowIndex);

                var cellBlank = row.insertCell(0);
                cellBlank.width= "2%";
                cellBlank.innerHTML = '';

                var cellIndex = row.insertCell(1);
                cellIndex.width= "3%";            
                cellIndex.innerHTML = '';
                cellIndex.style.textAlign = 'left';

                var cellTransactionGroup = row.insertCell(2);
                cellTransactionGroup.width= "67%";
                cellTransactionGroup.colSpan= 2;
                cellTransactionGroup.innerHTML = '';
                cellTransactionGroup.style.textAlign = 'left';

                var cellAmount = row.insertCell(3);
                cellAmount.width= "26%";
                cellAmount.innerHTML = '';                    
                //cellAmount.style.borderBottom = "1px solid black";        
                cellAmount.style.textAlign = 'right';
                cellAmount.height = '20';
           
                var cellBlank2 = row.insertCell(4);
                cellBlank2.width= "2%";
                cellBlank2.innerHTML = '';
            }

            if(nCFTransactionCategoryInInt!=parseInt(oCashFlowSetups[i].CFTransactionCategoryInInt))
            {
                var table = document.getElementById('tblCashFlowStatement');
                var nRowIndex = table.rows.length;
                var row = table.insertRow(nRowIndex);

                var cellBlank = row.insertCell(0);
                cellBlank.colSpan= 6;
                cellBlank.width= "100%";
                cellBlank.innerHTML = '';
                cellBlank.height = '20';

                var table = document.getElementById('tblCashFlowStatement');
                var nRowIndex = table.rows.length;
                var row = table.insertRow(nRowIndex);

                var cellBlank = row.insertCell(0);
                cellBlank.width= "2%";
                cellBlank.innerHTML = '';

                var cellIndex = row.insertCell(1);
                cellIndex.width= "3%";            
                cellIndex.innerHTML = '';
                cellIndex.style.textAlign = 'left';

                var cellTransactionGroup = row.insertCell(2);
                cellTransactionGroup.width= "67%";
                cellTransactionGroup.colSpan= 2;
                cellTransactionGroup.innerHTML = '<label id="accountHead'+nRowIndex+'" rowIndex="'+nRowIndex+'" style="font-size:13px; font-weight:bold;">'+oCashFlowSetups[i].DisplayCaption+'</label>';
                cellTransactionGroup.style.textAlign = 'left';

                var cellAmount = row.insertCell(3);
                cellAmount.width= "26%";
                cellAmount.innerHTML = '';  
                cellAmount.style.borderBottom = "1px solid black";
                cellAmount.style.textAlign = 'right';
           
                var cellBlank2 = row.insertCell(4);
                cellBlank2.width= "2%";
                cellBlank2.innerHTML = '';
                i=i+1;
            }

            var table = document.getElementById('tblCashFlowStatement');
            var nRowIndex = table.rows.length;
            var row = table.insertRow(nRowIndex);

            var cellBlank = row.insertCell(0);
            cellBlank.width= "2%";
            cellBlank.innerHTML = '';

            var cellIndex = row.insertCell(1);
            cellIndex.width= "3%";            
            cellIndex.innerHTML = '';
            cellIndex.style.textAlign = 'left';

            var cellTransactionGroup = row.insertCell(2);
            cellTransactionGroup.width= "67%";
            cellTransactionGroup.colSpan= 2;
            if(parseInt(oCashFlowSetups[i].CashFlowSetupID)===1001 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1002 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1003 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1004)
            {
                cellTransactionGroup.innerHTML = '<label id="accountHead'+nRowIndex+'" rowIndex="'+nRowIndex+'" style="font-size:13px; font-weight:bold;">'+oCashFlowSetups[i].DisplayCaption+'</label>';
            }
            else
            {
                cellTransactionGroup.innerHTML = '<label id="accountHead'+nRowIndex+'" rowIndex="'+nRowIndex+'" style="font-size:13px;">'+oCashFlowSetups[i].DisplayCaption+'</label>';
            }
            cellTransactionGroup.style.textAlign = 'left';

            var cellAmount = row.insertCell(3);
            cellAmount.width= "26%";
            if(parseInt(oCashFlowSetups[i].CashFlowSetupID)===1001 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1002 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1003 || parseInt(oCashFlowSetups[i].CashFlowSetupID)===1004)
            {
                cellAmount.innerHTML = '<label id="amount'+nRowIndex+'" rowIndex="'+nRowIndex+'" style="font-size:13px; font-weight:bold;">'+oCashFlowSetups[i].AmountSt+'</label>';            
                cellAmount.style.borderTop = "1px solid black";
                cellAmount.style.borderBottom = "1px solid black";
            }
            else
            {
                cellAmount.innerHTML = '<label id="amount'+nRowIndex+'" rowIndex="'+nRowIndex+'" style="font-size:13px;">'+oCashFlowSetups[i].AmountSt+'</label>';
                cellAmount.style.borderLeft = "1px solid black";
                cellAmount.style.borderRight = "1px solid black";
            }
            cellAmount.style.textAlign = 'right';
           
            var cellBlank2 = row.insertCell(4);
            cellBlank2.width= "2%";
            cellBlank2.innerHTML = '';
            nCFTransactionCategoryInInt = parseInt(oCashFlowSetups[i].CFTransactionCategoryInInt);            
        }

        //for double line
        var table = document.getElementById('tblCashFlowStatement');
        var nRowIndex = table.rows.length;
        var row = table.insertRow(nRowIndex);

        var cellBlank = row.insertCell(0);
        cellBlank.width= "2%";
        cellBlank.innerHTML = '';

        var cellIndex = row.insertCell(1);
        cellIndex.width= "3%";            
        cellIndex.innerHTML = '';
        cellIndex.style.textAlign = 'left';

        var cellTransactionGroup = row.insertCell(2);
        cellTransactionGroup.width= "67%";
        cellTransactionGroup.colSpan= 2;
        cellTransactionGroup.innerHTML = '';
        cellTransactionGroup.style.textAlign = 'left';

        var cellAmount = row.insertCell(3);
        cellAmount.width= "26%";
        cellAmount.innerHTML = '';                    
        cellAmount.style.borderBottom = "1px solid black";        
        cellAmount.style.textAlign = 'right';
        cellBlank.height = '1';
           
        var cellBlank2 = row.insertCell(4);
        cellBlank2.width= "2%";
        cellBlank2.innerHTML = '';


        var table = document.getElementById('tblCashFlowStatement');
        var nRowIndex = table.rows.length;
        var row = table.insertRow(nRowIndex);

        var cellBlank = row.insertCell(0);
        cellBlank.colSpan= 6;
        cellBlank.width= "100%";
        cellBlank.innerHTML = '';
        cellBlank.height = '40';
    }



    $("#btnPrint").click(function(){
        window.open(sessionStorage.getItem("BaseAddress")+'/CashFlowSetup/PrintCFPaymentDetails', "_blank");
    });

   
    $("#btnPrintXL").click(function(){
        window.open(sessionStorage.getItem("BaseAddress")+'/CashFlowSetup/ExportCFPaymentsToExcel', "_blank");
    });
</script>
