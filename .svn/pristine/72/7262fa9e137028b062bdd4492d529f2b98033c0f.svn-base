@model IEnumerable<ESimSol.BusinessObjects.EmployeeProduction>

    <div style="margin-left:0px; height:550px; font-family:Tahoma">
        <table id="tblLinkingList" class="easyui-datagrid" style="width:1030px;height:500px;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar">
            <thead>
                <tr>

                    <th field="OrderRecapNo" width="70" align="center">Order No</th>
                    <th field="StyleNo" width="70" align="center">Style No.</th>

                    @*<th field="ColorName" width="60" align="center" >Color</th>
                        <th field="SizeCategoryName" width="60" align="center" >Size</th>
                        <th field="GarmentPartInString" width="70" align="center" >B. Part</th>*@

                    <th field="Color_Size_BodyPart" width="120" align="left">Color</th>
                    <th field="IssueDateInString" width="85" align="center">Issue Date</th>
                    <th field="MachineNo" width="55" align="center">M. No</th>
                    <th field="EmployeeNameCode" width="170" align="left">Employee</th>
                    <th field="EPSNO" width="150" align="left">TC No</th>
                    <th field="IssueQty" width="65" align="center">Issue(Pcs)</th>
                    <th field="RcvQty" width="65" align="center">Rcv(Pcs)</th>
                    <th field="EmpWiseBalanceQty" width="75" align="center">Balance(Pcs)</th>
                    <th field="RcvByDateInString" width="100" align="center">Receive Date</th>

                </tr>
            </thead>
        </table>
        ​<table>
            <tr>
                <td>
                    Load <input id="txtLoadRecords" type="text" style="width:70px" />  &nbsp; Records &nbsp; &nbsp;
                    <label id="lblcount"></label>
                    <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="Next()">Next</a>
                </td>

            </tr>
        </table>
        <div id="toolbar" style="height: 95px;">

            <input id="txtSearchByPSNo" type="text" style="width:202px;" placeholder="Type PSNo & press enter" />&nbsp;

            <input id="chkIssueDateWise" type="checkbox" />Issue Date Wise
            <input id="chkReceiveDateWise" type="checkbox" />Receive Date Wise&nbsp;&nbsp;
            User's Department Name : <span style="width:60px;"><label id="lblUserDepartment"></label></span>
            <input id="txtDepartment" type="text" style="width:155px; " placeholder="Pick Department" />
            <input id="btnDepartment" type="button" value="P" onclick="DepartmentPicker()" />
            <input id="btnCDepartment" type="button" value="C" style="  margin-right:2px;" />

            <br />

            @*<input id="dtDateFrom" type="text" style="width: 195px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat" />&nbsp;&nbsp; To &nbsp;
                <input id="dtDateTo" type="text" style="width: 160px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat" />
            *@

            @*<select id="cboDateType" style="width: 100px">
                    <option value='0'>None</option>
                    <option value='1'>Equal</option>
                    <option value='2'>Between</option>
                </select>*@
            <span id="regionDateFrom">
                <span>
                    <select id="cboYear" style="width:70px;"></select>
                </span><span>
                    <select id="cboMonth"></select>
                </span><span>
                    <select id="cboDay" style="width:61px;"></select>
                </span>
            </span><span id="regionDateTo" style="padding-left: 10px;">
                <span style="padding-right: 5px;">
                    To
                </span><span>
                    <select id="cboEndYear"></select>
                </span><span>
                    <select id="cboEndMonth"></select>
                </span><span>
                    <select id="cboEndDay"></select>
                </span>
            </span>

            <input id="txtCode" type="text" style="width:150px;" placeholder="Type Emp Code & Enter" />
            <input id="btnEmployeePicker" type="button" value="P" />
            <input id="btnCEmployee" type="button" value="C" />
            <input id="txtOrderNo" type="text" style="width:132px;" placeholder="Type OrderNo & Enter" />
            <input id="btnOrderRecapPicker" type="button" value="P" />
            <input id="btnCOrderNo" type="button" value="C" />
            <br />

            <input id="txtStyleNo" type="text" style="width:130px;" placeholder="Type StyleNo & Enter" />
            <input id="btnStylePicker" type="button" value="P" />
            <input id="btnCStyleNo" type="button" value="C" />
            <input id="txtUser" type="text" style="width:150px;" placeholder="Type UserName & Enter" />
            <input id="btnUserpicker" type="button" value="P" />
            <input id="btnCUser" type="button" value="C" />
            &nbsp;&nbsp;
            <input id="chkLoginUser" type="checkbox" checked="checked" />Login User
            <select id="cboGarmentPart" style="width:133px;"></select>
            @*@Html.DropDownList("cboGarmentPart", new SelectList(Enum.GetValues(typeof(ICS.Base.Client.Utility.EnumGarmentPart))), new { id = "cboGarmentPart", style = "width: 100px;" })*@
            <select id="cboSize" style="width:60px;"></select>
            <a id="btnSearchByCodeNo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true" onclick="SearchWithPasignation()">Search</a>&nbsp;&nbsp;&nbsp;&nbsp;

            <br />
            <a id="btnEPKnitting" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
            <a id="btnPrintDailyProduction" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true" title="Search by date,department,style and user">Print Daily Production</a>

        </div>
    </div>
    <script type="text/javascript">

        var _oLinkingLists=[];
        var _sBaseAddress="";
        var _obj=null;
        var _sPSNo="";
        var _oEmployee = null;
        var _oOrderRecap = null;
        var _oOrderRecaps = [];
        var _sOrderNos="";
        var _sStyleNos = "";
        var _sOrderIDs = "" ;
        var _sDepartmentIds = "";
        var _sDepartmentNames = "" ;
        var _sTechnicalSheetIDs = "";
        var _sUserIDs = "";
        var _nLoadRecords = 0;
        var _nRowLength = 0;
        var _bNext = false;
        var _nLastEPSID = 0;
        var _oEmployeeProductions = [];
        var _sParam = "";

        $(document).ready(function ()
        {
            debugger;
            _oLinkingLists =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            _obj = window.dialogArguments;
            $('#txtLoadRecords').numberbox({min:0, precision:0 });
            //document.getElementById('txtLoadRecords').value=100;
            $('#txtLoadRecords').numberbox('setValue',100);
            LoadGarmentPart();
            //$('#dtDateFrom').datebox('setValue', icsdateformat(new Date()));
            //$('#dtDateTo').datebox('setValue', icsdateformat(new Date()));
            SetDateTime();
            var oDate=new Date();
            SetStartTime(oDate);
            SetEndTime(oDate);
            //var nDateType = $("#cboDateType").val();
            //if (nDateType == 0)
            //{
            //document.getElementById("regionDateTo").style.display = 'none';
            //document.getElementById("regionDateFrom").style.display = 'none';
            //}

            SetEPSNO();
            document.getElementById("lblUserDepartment").innerHTML = _oLinkingLists[0].EmployeeOfficial.DepartmentName;
            //_sDepartmentNames = _oLinkingLists[0].EmployeeOfficial.DepartmentName;
            _sDepartmentNames = "Linking";
            LoadSize();
        });

        function LoadGarmentPart()
        {
            var listItems="";
            listItems += "<option value=0>" +"None" +"</option>";
            for (i = 0; i < _oLinkingLists[0].GarmentParts.length; i++)
            {
                listItems += "<option value='" + _oLinkingLists[0].GarmentParts[i].GPID+"'>" + _oLinkingLists[0].GarmentParts[i].Name+"</option>";
            }
            $("#cboGarmentPart").html(listItems);
        }

        function SetEPSNO()
        {
            var date = new Date();
            var y = date.getFullYear();
            var m = date.getMonth()+1;
            var d = date.getDate();

            if(m<10)
            {
                m = "0"+m;
            }
            if(d<10)
            {
                d = "0" + d;
            }

            var Year = y.toString();
            Year=Year.substring(Year.length-2,Year.length);
            document.getElementById("txtSearchByPSNo").value = "LN"+Year+m+d;
        }

        function LoadSize()
        {

            var listItems="";
            listItems += "<option value=0>" +"Size" +"</option>";
            for (i = 0; i < _oLinkingLists[0].SizeCategorys.length; i++)
            {
                listItems += "<option value='" + _oLinkingLists[0].SizeCategorys[i].SizeCategoryID+"'>" + _oLinkingLists[0].SizeCategorys[i].SizeCategoryName+"</option>";
            }
            $("#cboSize").html(listItems);
        }

        function RefreshList(oLinkingLists)
        {
            data = oLinkingLists ;
            data = { "total": "" + data.length + "", "rows": data };
            $('#tblLinkingList').datagrid('loadData', data);
        }

        //function  icsdateformat(date)
        //{
        //    var mthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
        //    var y = date.getFullYear();
        //    var m = date.getMonth();
        //    var d = date.getDate();
        //    var result= d +' '+ mthNames[m]+' '+ y;
        //    return result;
        //}

        //Sagor date picker start

        function SetDateTime()
        {
            var oDate=new Date();
            oDate.setFullYear(2014);
            /*---------------------------------------- Start Set Year-------------------------------------------*/
            var sYear="";
            sYear +="<option value='0'>"+'Year'+"</option>";
            for(var i=0; i<=10; i++)
            {
                sYear += "<option value='" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"'>" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"</option>";
            }
            $('#cboYear').html(sYear);
            $('#cboEndYear').html(sYear);
            /*---------------------------------------- End Set Year-------------------------------------------*/


            /*---------------------------------------- Start Set Month-------------------------------------------*/
            var sMonth="";
            var oMonths=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
            sMonth +="<option value='0'>"+'Month'+"</option>";
            for(var i=0; i<oMonths.length; i++)
            {
                sMonth += "<option value='" +(parseInt(i)+1)+"'>" + oMonths[i] +"</option>";
            }
            $('#cboMonth').html(sMonth);
            $('#cboEndMonth').html(sMonth);
            /*---------------------------------------- End Set Month-------------------------------------------*/


            /*---------------------------------------- Start Set Date-------------------------------------------*/
            var sDay ="<option value='0'>"+'Day'+"</option>";
            $('#cboDay').html(sDay);
            $('#cboEndDay').html(sDay);
            /*---------------------------------------- End Set Date-------------------------------------------*/
        }



        $('#cboYear').change(function(e)
        {
            var nYear=$('#cboYear').val();
            var nMonth=$('#cboMonth').val();
            if(nYear>0 && nMonth>0)
            {
                $('#cboDay').html(SetDateEvent(nYear, nMonth));
            }

        });

        $('#cboEndYear').change(function(e)
        {
            var nYear=$('#cboEndYear').val();
            var nMonth=$('#cboEndMonth').val();
            if(nYear>0 && nMonth>0)
            {
                $('#cboEndDay').html(SetDateEvent(nYear, nMonth));
            }

        });

        $('#cboMonth').change(function(e)
        {
            var nYear=$('#cboYear').val();
            var nMonth=$('#cboMonth').val();
            if(nYear>0 && nMonth>0)
            {
                $('#cboDay').html(SetDateEvent(nYear, nMonth));
            }

        });

        $('#cboEndMonth').change(function(e)
        {

            var nYear=$('#cboEndYear').val();
            var nMonth=$('#cboEndMonth').val();
            if(nYear>0 && nMonth>0)
            {
                $('#cboEndDay').html(SetDateEvent(nYear, nMonth));
            }

        });

        function SetDateEvent(nYear, nMonth)
        {
            var oDate=new Date();
            var sDay="";
            if( parseInt(nMonth)>0)
            {
                var nDay= new Date(parseInt(nYear), parseInt(nMonth), 0).getDate();
                sDay +="<option value='0'>"+'Day'+"</option>";
                for(var i=1; i<=parseInt(nDay); i++)
                {
                    if(i<10)
                    {
                        sDay += "<option value='" +i+"'>" + '0'+i +"</option>";
                    }
                    else
                    {
                        sDay += "<option value='" +i+"'>" + i +"</option>";
                    }

                }
            }
            return sDay;
        }


        function SetStartTime(oDate)
        {

            var nyear=oDate.getFullYear();
            var nmonth=oDate.getMonth()+1;
            var nday=oDate.getDate();
            $('#cboYear').val(nyear);
            $('#cboMonth').val(nmonth);
            $('#cboDay').html(SetDateEvent(nyear,nmonth));
            $('#cboDay').val(nday);
        }

        function SetEndTime(oDate)
        {
            debugger;
            var nyear=oDate.getFullYear();
            var nmonth=oDate.getMonth()+1;
            var nday=oDate.getDate();
            $('#cboEndYear').val(nyear);
            $('#cboEndMonth').val(nmonth);
            $('#cboEndDay').html(SetDateEvent(nyear,nmonth));
            $('#cboEndDay').val(nday);

        }

        function GenerateStartTimeInString()
        {
            var sDate=  $('#cboMonth').val() +'/'+ $('#cboDay').val() +'/'+ $('#cboYear').val();
            return sDate;
        }

        function GenerateEndTimeInString()
        {

            var sDate=  $('#cboEndMonth').val() +'/'+ $('#cboEndDay').val() +'/'+ $('#cboEndYear').val();
            return sDate;
        }

        function ValidationOfStartTime()
        {
            if($('#cboYear').val()==0)
            {
                alert("Please select a year.");
                document.getElementById('cboYear').focus();
                return false;
            }
            if($('#cboMonth').val()==0)
            {
                alert("Please select a month.");
                document.getElementById('cboMonth').focus();
                return false;
            }
            if($('#cboDay').val()==0)
            {
                alert("Please select a day.");
                document.getElementById('cboDay').focus();
                return false;
            }
            return true;
        }

        function ValidationOfEndTime()
        {
            if($('#cboEndYear').val()==0)
            {
                alert("Please select a year.");
                document.getElementById('cboEndYear').focus();
                return false;
            }
            if($('#cboEndMonth').val()==0)
            {
                alert("Please select a month.");
                document.getElementById('cboEndMonth').focus();
                return false;
            }
            if($('#cboEndDay').val()==0)
            {
                alert("Please select a day.");
                document.getElementById('cboEndDay').focus();
                return false;
            }
            return true;
        }


        //$('#cboDateType').change(function ()
        //{
        //        debugger
        //        var nDateType = $("#cboDateType").val();
        //        if (nDateType == 0) {
        //              document.getElementById("regionDateTo").style.display = 'none';
        //              document.getElementById("regionDateFrom").style.display = 'none';
        //        }
        //        if (nDateType == 1 )
        //        {
        //          document.getElementById("regionDateFrom").style.display = '';
        //          document.getElementById("regionDateTo").style.display = 'none';
        //        }
        //        if (nDateType == 2 )
        //        {
        //          document.getElementById("regionDateFrom").style.display = '';
        //          document.getElementById("regionDateTo").style.display = '';
        //        }
        //});

        //sagor date picker end

        $('#txtSearchByPSNo').keypress(function (e)
        {
            debugger
            var keyCode = e.keyCode || e.which;
            if (keyCode == 13)
            {
                _sPSNo = document.getElementById('txtSearchByPSNo').value;
                Search();
            }

        });

        $('#btnRefreshAll').click(function (e)
        {

            _sPSNo = "All";
            Search();

        });

        function Search()
        {
            debugger
            oEmployeeProduction={EPSNO:_sPSNo};
            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/EmployeeProduction/EmployeeProduction_LinkingSearch",
                traditional: true,
                data: JSON.stringify(oEmployeeProduction),
                contentType: "application/json; charset=utf-8",

                success: function(data)
                {
                    var oEmployeeProductions=[];
                    //debugger
                    oEmployeeProductions = jQuery.parseJSON(data);

                    if (oEmployeeProductions.length>0 && oEmployeeProductions[0].ErrorMessage=="")
                    {
                        RefreshList(oEmployeeProductions);
                    }
                    else
                    {
                        alert(oEmployeeProductions[0].ErrorMessage);
                        oEmployeeProductions=[];
                        RefreshList(oEmployeeProductions);
                    }
                },
                error: function(xhr, status, error)
                {
                    alert(error);
                }
            });
        }

        $('#txtCode').keypress(function (e)
        {

            var code = (e.keyCode ? e.keyCode : e.which);
            var sEmpCode=document.getElementById("txtCode").value;

            if (code == 13)//Enter key-13
            {
                if(sEmpCode=="")
                {
                    alert("Please Enter Code !");
                    return;
                }
                var nts=(new Date()).getTime()/1000;
                var oParameter = new Object();
                oParameter.MultipleItemReturn = false;
                var url = _sBaseAddress + "/Employee/EmployeePikerByCode?sCode="+sEmpCode+"&nDepartmentID="+_oLinkingLists[0].EmployeeOfficial.DepartmentID+"&nts="+nts;
                var nLeft=(window.screen.width/2)-(515/2);
                var nHeight=(window.screen.height/2)-(415/2);
                _oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:415px;dialogWidth:515px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
                //_oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:405px;dialogWidth:510px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

                if(_oEmployee!=null)
                {
                    if(_oEmployee.DesignationName=="" || _oEmployee.DepartmentName=="" || _oEmployee.LocationName=="")
                    {
                        alert("This Employee Has No Official Information !");
                        return;
                    }
                    $("#txtCode")[0].value=_oEmployee.Name+"["+_oEmployee.Code+"]";

                }
            }
        });


        function SearchWithPasignation()
        {
            if(!_bNext)
            {
                _nRowLength = 0;
                _nLastEPSID = 0;
            }
            var sDepartmentIDs = "";
            var bIssueDateWise= false;
            var bReceiveDateWise= false;

            //var dtDateFrom = $('#dtDateFrom').datebox('getValue');
            //var dtDateTo = $('#dtDateTo').datebox('getValue');

            if(!ValidationOfStartTime()) return;
            if(!ValidationOfEndTime()) return;

            var dtDateFrom = GenerateStartTimeInString();
            var dtDateTo = GenerateEndTimeInString();

            bIssueDateWise = document.getElementById("chkIssueDateWise").checked;
            bReceiveDateWise = document.getElementById("chkReceiveDateWise").checked;
            var nLoginID = 0;

            if(_sDepartmentIds == "")
            {
                sDepartmentIDs = "";//_oLinkingLists[0].EmployeeOfficial.DepartmentID;
            }
            else
            {
                sDepartmentIDs = _sDepartmentIds;
            }

            var  sCode = "";
            if(_oEmployee != null)
            {
                sCode = _oEmployee.Code;
            }

            //    var nOrderRecapId = 0;

            //    if(_oOrderRecap != null)
            //    {
            //        nOrderRecapId = _oOrderRecap.OrderRecapID ;
            //    }

            var nPP = 2;//Production Process= Linking (2)

            if(document.getElementById("chkLoginUser").checked == true)
            {

                nLoginID = 1;

            }

            var nGarmentPart = 0;
            var nSizeCategoryID = 0;
            nGarmentPart = document.getElementById('cboGarmentPart').value;
            nSizeCategoryID = document.getElementById('cboSize').value;

            //var sParam = dtDateFrom + "~"+ dtDateTo + "~" + sCode + "~" + _sOrderIDs+ "~" + _sStyleNos + "~" + nPP ;
            _nLoadRecords = document.getElementById("txtLoadRecords").value;
            _sParam = dtDateFrom+"~"+dtDateTo+"~"+sCode+"~"+_sOrderIDs+"~"+_sStyleNos+"~"+nPP+"~"+bIssueDateWise+"~"+bReceiveDateWise+"~"+sDepartmentIDs+"~"+nLoginID+"~"+_sUserIDs+"~"+nGarmentPart+"~"+nSizeCategoryID+"~"+_nLoadRecords+"~"+_nRowLength;

            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/EmployeeProduction/SearchByCodeAndDate",
                traditional: true,
                data: JSON.stringify({sParam : _sParam}),
                contentType: "application/json; charset=utf-8",

                success: function(data)
                {
                    var oEmployeeProductions=[];
                    //var oNEmployeeProductions=[];
                    oEmployeeProductions = jQuery.parseJSON(data);

                    if (oEmployeeProductions.length>0 && oEmployeeProductions[0].ErrorMessage=="")
                    {
                        //RefreshList(oNEmployeeProductions);
                        //RefreshList(oEmployeeProductions);
                        if(!_bNext)
                        {
                            _oEmployeeProductions=[];
                            RefreshList(_oEmployeeProductions);
                        }

                        for (var j = 0; j < oEmployeeProductions.length; j++)
                        {
                            $('#tblLinkingList').datagrid('appendRow',oEmployeeProductions[j]);
                        }

                    }
                    else
                    {
                        //alert(oEmployeeProductions[0].ErrorMessage);
                        //oEmployeeProductions=[];
                        //RefreshList(oEmployeeProductions);
                        if(_bNext == false)
                        {
                            alert("Data not found !!");
                            _oEmployeeProductions=[];
                            RefreshList(_oEmployeeProductions);
                        }
                        else
                        {
                            alert("No more data found !");
                        }
                    }
                    var oEmployeeProductions=$('#tblLinkingList').datagrid('getRows');
                    document.getElementById("lblcount").innerHTML = " | Count ="+ oEmployeeProductions.length;
                    _bNext = false;

                },
                error: function(xhr, status, error)
                {
                    alert(error);
                }

            });
        }

        function Next()
        {
            var oEmployeeProductions =[];
            oEmployeeProductions=$('#tblLinkingList').datagrid('getRows');
            _nRowLength = oEmployeeProductions.length;
            _bNext = true;

            if (oEmployeeProductions.length<=0)
            {
                alert('Please Select Criteria and click on "Search" to find information.!!');
                return;
            }
            var oEmployeeProduction = oEmployeeProductions[oEmployeeProductions.length-1];

            if (_nLastEPSID==oEmployeeProduction.EPSID)
            {
                alert('No more data found by this date range');
                return;
            }
            _nLastEPSID=oEmployeeProduction.EPSID;
            SearchWithPasignation()
        }

        $('#txtOrderNo').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            var sOrderNo = document.getElementById("txtOrderNo").value;

            if (code == 13)//Enter key-13
            {
                if(sOrderNo=="")
                {
                    alert("Please Enter Code !");
                    return;
                }

                var nts=(new Date()).getTime()/1000;
                var oParameter = new Object();
                oParameter.MultipleItemReturn = false;
                var url = _sBaseAddress + "/OrderRecap/OrderRecapPickerByOrderNo?sOrderNo="+sOrderNo+"&nts="+nts;
                var nLeft=(window.screen.width/2)-(455/2);
                var nHeight=(window.screen.height/2)-(415/2);
                _oOrderRecap = window.showModalDialog(url, oParameter, 'dialogHeight:410px;dialogWidth:455px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
                //_oOrderRecap = window.showModalDialog(url, oParameter, 'dialogHeight:405px;dialogWidth:450px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

                if(_oOrderRecap!=null)
                {
                    $("#txtOrderNo")[0].value=_oOrderRecap.OrderRecapNo;

                }
            }
        });

        $('#btnEmployeePicker').click(function (e)
        {
            var oParameter = new Object();
            oParameter.Name = "Employee Advance Search";
            oParameter.MultipleItemReturn=false;
            var url = _sBaseAddress + "/Employee/EmployeeHRMPiker";
            var nLeft=(window.screen.width/2)-(1000/2);
            var nHeight=(window.screen.height/2)-(510/2);
            _oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:510px;dialogWidth:1000px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
            //_oEmployee = window.showModalDialog(url, oParameter, 'dialogHeight:510px;dialogWidth:940px;dialogLeft:50;dialogRight:50;dialogTop:50;center:yes;resizable:yes;status:no;scroll:no');
            if(_oEmployee!=null)
            {
                if(_oEmployee.DesignationName=="" || _oEmployee.DepartmentName=="" || _oEmployee.LocationName=="")
                {
                    alert("This Employee Has No Official Information !");
                    return;
                }
                $("#txtCode")[0].value=_oEmployee.Name+"["+_oEmployee.Code+"]";

            }
        });


        $('#btnOrderRecapPicker').click(function (e)
        {
            var oParameter = new Object();
            oParameter.MultipleItemReturn = true;
            oParameter.name = "Order Recap Advance Search";
            var url =_sBaseAddress+ "/OrderRecap/OrderRecapSearch";
            var nLeft=(window.screen.width/2)-(910/2);
            var nHeight=(window.screen.height/2)-(540/2);
            _oOrderRecaps  = window.showModalDialog(url, oParameter, 'dialogHeight:540px;dialogWidth:910px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
            //_oOrderRecaps = window.showModalDialog(url, oParameter, 'dialogHeight:540px;dialogWidth:910px;dialogLeft:280;dialogTop:80;center:yes;resizable:no;status:no;scroll:no');

            if(_oOrderRecaps.length>0)
            {
                var sOrderNos = "" ;
                var sOrderIDs = "" ;
                for(var i = 0 ; i <_oOrderRecaps.length ; i++)
                {
                    sOrderNos += _oOrderRecaps[i].OrderRecapNo + ",";
                    sOrderIDs += _oOrderRecaps[i].OrderRecapID + ",";
                }

                _sOrderNos = sOrderNos.substring(0, sOrderNos.length-1) ;
                _sOrderIDs = sOrderIDs.substring(0, sOrderIDs.length-1) ;

                $("#txtOrderNo").val(_sOrderNos);


            }

        });

        $('#btnEPLinking').click(function (e)
        {

            var oLinkings = $('#tblLinkingList').datagrid('getRows');

            if(oLinkings.length <=0)
            {
                alert("There is nothing to print !");
                return ;
            }

            var tsv=((new Date()).getTime())/1000;

            window.open(_sBaseAddress+ "/EmployeeProduction/PrintOrderIssueSheet?sParam="+_sParam+"&ts="+tsv, "_blank");

        });

        $('#txtStyleNo').keypress(function (e)
        {

            var code = (e.keyCode ? e.keyCode : e.which);
            var sStyleNo = document.getElementById("txtStyleNo").value;

            if (code == 13)//Enter key-13
            {
                if(sStyleNo=="")
                {
                    alert("Please Enter Style No !");
                    return;
                }

                var oParameter = new Object();
                oParameter.Name = "Style Picker";
                oParameter.MultipleItemReturn=false;
                var tsv=((new Date()).getTime())/1000;
                var url =_sBaseAddress+ "/TechnicalSheet/StylePickerByName?sStyleNo="+sStyleNo+"&ts="+tsv;
                var nLeft=(window.screen.width/2)-(453/2);
                var nHeight=(window.screen.height/2)-(385/2);
                var oSelectedStyle = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
                //var oSelectedStyle = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:350;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

                if(oSelectedStyle != null)
                {

                    _sTechnicalSheetIDs = oSelectedStyle.TechnicalSheetID;
                    _sStyleNos = "'"+oSelectedStyle.StyleNo+"'";
                    $("#txtStyleNo").val(oSelectedStyle.StyleNo);

                }
            }
        });

        $('#btnStylePicker').click(function (e)
        {

            var sStyleNo = "";
            var oParameter = new Object();
            oParameter.Name = "Style Picker";
            oParameter.MultipleItemReturn=true;
            var tsv=((new Date()).getTime())/1000;
            var url =_sBaseAddress+ "/TechnicalSheet/StylePicker?sStyleNo="+sStyleNo+"&ts="+tsv;
            var nLeft=(window.screen.width/2)-(453/2);
            var nHeight=(window.screen.height/2)-(385/2);
            var oSelectedStyles = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
            //var oSelectedStyles = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:350;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

            if(oSelectedStyles.length>0)
            {

                var sStyleNos = "" ;
                var sTechnicalSheetIDs = "";
                for(var i = 0 ; i < oSelectedStyles.length ; i++)
                {
                    sStyleNos += "'"+oSelectedStyles[i].StyleNo+ "'" + ",";
                    sTechnicalSheetIDs += oSelectedStyles[i].TechnicalSheetID + ",";
                }

                _sStyleNos = sStyleNos.substring(0,sStyleNos.length-1) ;
                _sTechnicalSheetIDs = sTechnicalSheetIDs.substring(0,sTechnicalSheetIDs.length-1);
                $("#txtStyleNo").val(_sStyleNos);

            }
        });

        $('#btnCEmployee').click(function (e)
        {
            document.getElementById("txtCode").value = "" ;
            _oEmployee.Code = "" ;

        });

        $('#btnCOrderNo').click(function (e)
        {

            document.getElementById("txtOrderNo").value = "" ;
            _sOrderIDs = "" ;
            _sOrderNos = "" ;

        });

        $('#btnCStyleNo').click(function (e)
        {

            document.getElementById("txtStyleNo").value = "" ;
            _sStyleNos = "" ;
            _sTechnicalSheetIDs = "";
        });

        function DepartmentPicker()
        {

            var oParameter = new Object();
            oParameter.MultipleItemReturn = true;
            var url = _sBaseAddress + "/Department/DepartmentPickerWithCheckBox?id=0";
            var nLeft=(window.screen.width/2)-(550/2);
            var nHeight=(window.screen.height/2)-(470/2);
            var oReturnObjects = window.showModalDialog(url, oParameter, 'dialogHeight:470px;dialogWidth:550px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
            //var oReturnObjects = window.showModalDialog(url, oParameter, 'dialogHeight:470px;dialogWidth:550px;dialogLeft:400;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');
            if (oReturnObjects.length>0)
            {

                var sDepartmentNames = "" ;
                var sDepartmentIDs = "";
                for(var i = 0 ; i < oReturnObjects.length ; i++)
                {
                    sDepartmentNames += oReturnObjects[i].text+",";
                    sDepartmentIDs += oReturnObjects[i].id + ",";
                }
                _sDepartmentNames = "" ;
                _sDepartmentNames = sDepartmentNames.substring(0,sDepartmentNames.length-1) ;
                _sDepartmentIds = sDepartmentIDs.substring(0,sDepartmentIDs.length-1) ;

                $("#txtDepartment").val(_sDepartmentNames);

            }
        }

        $('#btnCDepartment').click(function (e)
        {

            document.getElementById("txtDepartment").value = "" ;
            _sDepartmentIds = "" ;

        });

        $('#btnPrintDailyProduction').click(function (e)
        {
            var sDepartmentIDs = "";
            var nLoginID = 0;

            if(!ValidationOfStartTime()) return;
            if(!ValidationOfEndTime()) return;

            var dtDateFrom = GenerateStartTimeInString();
            var dtDateTo = GenerateEndTimeInString();

            if(_sDepartmentIds == "")
            {
                sDepartmentIDs = _oLinkingLists[0].EmployeeOfficial.DepartmentID;
            }
            else
            {
                sDepartmentIDs = _sDepartmentIds;
            }
            if(document.getElementById("chkLoginUser").checked == true)
            {
                nLoginID = 1;
            }

            var sPP = 2;//ProductionProcess = 2(Linking)
            var sParams = dtDateFrom +"~"+ dtDateTo+"~"+sDepartmentIDs+"~"+_sDepartmentNames+"~"+sPP+"~"+_sTechnicalSheetIDs+"~"+nLoginID;
            var tsv=((new Date()).getTime())/1000;
            window.open(_sBaseAddress+ "/EmployeeProduction/PrintDailyProductionReport?sParams="+sParams+"&ts="+tsv, "_blank");

        });

        $('#btnUserpicker').click(function (e)
        {

            var oParameter = new Object();
            oParameter.Name = "User Picker";
            oParameter.MultipleItemReturn=true;
            var tsv=((new Date()).getTime())/1000;
            var url =_sBaseAddress+ "/User/UserPikerByName?sUserName="+""+"&ts="+tsv;
            var nLeft=(window.screen.width/2)-(453/2);
            var nHeight=(window.screen.height/2)-(385/2);
            var oSelectedUsers = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
            //var oSelectedUsers = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:350;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

            if(oSelectedUsers.length>0)
            {

                var sUserNames = "" ;
                var sUserIDs = "";

                for(var i = 0 ; i < oSelectedUsers.length ; i++)
                {
                    sUserNames += oSelectedUsers[i].UserName + ",";
                    sUserIDs += oSelectedUsers[i].UserID + ",";
                }

                _sUserNames = sUserNames.substring(0,sUserNames.length-1) ;
                _sUserIDs = sUserIDs.substring(0,sUserIDs.length-1);
                $("#txtUser").val(_sUserNames);

            }

        });

        $('#txtUser').keypress(function (e)
        {

            var code = (e.keyCode ? e.keyCode : e.which);
            var sUserName=document.getElementById("txtUser").value;

            if (code == 13)//Enter key-13
            {

                if(sUserName=="")
                {
                    alert("Please Enter Code !");
                    return;
                }

                var tsv=(new Date()).getTime()/1000;
                var oParameter = new Object();
                oParameter.MultipleItemReturn = false;

                var url =_sBaseAddress+ "/User/UserPikerByName?sUserName="+sUserName+"&ts="+tsv;
                var nLeft=(window.screen.width/2)-(453/2);
                var nHeight=(window.screen.height/2)-(385/2);
                var oSelectedUser = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:'+nLeft+';dialogTop:'+nHeight+';center:yes;resizable:no;status:no;scroll:yes');
                //var oSelectedUser = window.showModalDialog(url, oParameter, 'dialogHeight:385px;dialogWidth:453px;dialogLeft:350;dialogTop:100;center:yes;resizable:no;status:no;scroll:no');

                if(oSelectedUser != null)
                {

                    _sUserIDs = oSelectedUser.UserID;
                    _sUserNames = oSelectedUser.UserName;
                    $("#txtUser").val(_sUserNames);

                }
            }
        });

        $('#btnCUser').click(function (e)
        {

            document.getElementById("txtUser").value = "" ;
            _sUserIDs = "" ;

        });

    </script>
