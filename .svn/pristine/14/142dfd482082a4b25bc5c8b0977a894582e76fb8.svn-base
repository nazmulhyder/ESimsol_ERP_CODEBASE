@model IEnumerable<ESimSol.BusinessObjects.Employee>
    @{
        ViewBag.Title = "Employee ID Card";
    }
    <div style="margin-left:0px; height:500px" class="menuMainCollectionTable">
        <table id="tblEmployeeSalary" title="Employee Salary  List" class="easyui-datagrid" style="width:100%;height:560px" fitcolumns="false" rownumbers="true" pagination="true" singleselect="false" autorowheight="false" selectoncheck="false" checkonselect="true" toolbar="#toolbar">
            <thead>
                <tr>
                    <th data-options="field:'Selected',checkbox:true"></th>
                    <th field="Code" width="65">Code</th>
                    <th field="Name" width="180">Name</th>
                    <th field="BUName" width="200">Business Unit</th>
                    <th field="DepartmentName" width="100">Department</th>
                    <th field="DesignationName" width="100">Designation</th>
                    <th field="DateOfJoinInString" width="100">Date Of Join</th>
                    <th field="CardNo" width="150">Card/ Authentication No</th>

                </tr>
            </thead>
        </table>
        <div id="toolbar" style="height:auto;">

            <input id="txtBusinessUnit_Collection" type="text" style="width:130px;" placeholder="Pick Business Unit" />
            <a id="btnBusinessUnitPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetBusinessUnitPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtLocation_Colection" style="width:130px;" placeholder="Pick Location" type="text" />
            <a id="btnLocationPicker_Colection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetLocationPicker_Colection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtDepartment_Collection" style="width:130px;" type="text" placeholder="Pick Department" />
            <a id="btnDepartmentPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetDepartmentPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtDesignation_Collection" type="text" style="width:130px;" placeholder="Pick Designation" />
            <a id="btnDesignationPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnResetDesignationPicker_Collection" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtEmployee_Collection" style="width:130px;" type="text" placeholder="Type Code & Enter" />
            <a id="btnEmployee" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick"></a>
            <a id="btnCEmployee" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtEmployeeGroup" style="width:130px;" type="text" placeholder="Enter Group" />
            <a id="btnEmployeeGroupPicker" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick" />
            <a id="btnEmployeeGroupPickerReset" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>

            <input id="txtEmployeeBlock" style="width:130px;" type="text" placeholder="Enter Block" />
            <a id="btnEmployeeBlockPicker" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-pick" />
            <a id="btnEmployeeBlockPickerReset" href="javascript:void(0)" class="easyui-linkbutton" plain="true" iconcls="icon-clear"></a>


            <select id="cboCardShape" style="width:120px;"></select>
            <a id="btnAction" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Action</a>

            Exp. Date: <input id="dtExpireDate" type="text" style="width: 110px;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
            <a id="btnSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
            <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
            @*<a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="Next()">Next</a>*@
            <select id="cboClear" style="width:70px">
                <option value="0">All</option>
                <option value="1">UnChecked</option>
            </select>
            <input id="btnClearGrid" type="button" value="Clear" />

        </div>

        <div id="winEmpCardPrintItems" class="easyui-window winstyle" title="Print Items" style="width:25%; height:350px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <table id="tblEmpCardPrintItems" class="easyui-datagrid" style="width:99%; height:195px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" selectoncheck="false" checkonselect="false">
                <thead>
                    <tr>
                        <th data-options="field:'Selected',checkbox:true"></th>
                        <th field="Item" width="183" align="left">Items</th>
                    </tr>
                </thead>
            </table>
            <fieldset>
                <legend style="font-weight:bold"> Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px;width:100%; font-weight:bold">
                    <tr style="text-align:right; width:100%;">
                        <td style="text-align:right; width:40%;">
                            @*Exp. Date: <input id="dtExpireDate" type="text" style="width: 100%;" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" />*@
                        </td>
                        <td style="text-align:right;width:60%;">
                            <a id="btnOKCardPrintItems" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkEmpCardPrintItem()">OK</a>
                            <a id="btnCloseCardPrintItems" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true" onclick="CloseBOA()">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>

        <div id="winLocationPicker" class="easyui-window winstyle" title="Location Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="locationtree" data-options="checkbox:true" singleselect="false"></ul>
                </div>

                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnLocationPickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnLocationPickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div id="winEmployeePicker" class="easyui-window winstyle" title="Employee Picker" style="width:960px;" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="width: 100%; font-family: Tahoma;">
                <div style="width: 47%; float: left;">
                    <table class="tbl-AdvSearch">
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Employee Name :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEmployeeName" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Code :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEmpCodeForSearch" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Present Address :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtPresentAddress" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Permanent Address :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtPermanentAddress" class="txtfield-search txtReset" type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Authentication No :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtEnrollNo" class="txtReset" type="text" style="width:190px;" />
                                <input id="chkNotassignedyet" type="checkbox" class="chkReset" /> Not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Attendance Scheme :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtAttendanceScheme" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnAttScheme" class="pick-btn" type="button" value="P" />
                                <input id="btnResetAttScheme" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                BU :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboBU" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Location :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtLocation" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnLocationPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetLocationPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Dept./Section :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtDepartment" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnDepartmentPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetDepartmentPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Designation :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtDesignation" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnDesignationPicker" class="pick-btn" type="button" value="P" />
                                <input id="btnResetDesignationPicker" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Block :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input id="txtBlock" class="txtfield-picker txtReset" type="text" disabled />
                                <input id="btnBlock" class="pick-btn" type="button" value="P" />
                                <input id="btnResetBlock" class="pick-btn" type="button" value="R" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Employee Type :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeType" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Category:
                            </td>
                            <td class="td-AdvSearch-Level">
                                <div>
                                    <select id="cboCategory" style="width:160px; float:left;"></select>
                                    &nbsp; Gender :
                                    <select id="cboGender" style="width:80px; margin-right:10px;" class="cboReset">
                                        <option value="0">None</option>
                                        <option value="1">Male</option>
                                        <option value="2">Female</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Current Shift :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboShift_EmpSearch" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Card Status :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeCardStatus" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Working Status :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboEmployeeWorkigStatus" class="selection-search cboReset"></select>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Date Of Birth :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <select id="cboDateType" style="width: 75px" class="cboReset">
                                    <option value='0'>None</option>
                                    <option value='1'>Equal</option>
                                    <option value='2'>Between</option>
                                </select>
                                <span></span>
                                <select id="cboDayFrom" style="width: 50px" class="cboReset"></select>
                                <select id="cboMonthFrom" style="width: 53px" class="cboReset"></select>
                                <span id="regionDateTo">
                                    <span>To</span>
                                    <select id="cboDayTo" style="width: 50px" class="cboReset"> </select>
                                    <select id="cboMonthTo" style="width: 53px" class="cboReset"> </select>
                                </span>

                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level">
                                Joining Date :
                            </td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkJoiningDate" class="chkReset" />
                                <input id="dtDateFrom" type="text" style="width: 132px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />&nbsp; To &nbsp;
                                <input id="dtDateTo" type="text" style="width: 132px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkActive" class="chkReset" /> Active
                                <input type="checkbox" id="chkInActive" class="chkReset" />InActive
                                <input type="checkbox" id="chkUser" class="chkReset" /> User
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkOfficialNotAssign" class="chkReset" /> official Information is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkOfficialAssign" class="chkReset" /> official Information assigned employee
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkCardNotAssigned" class="chkReset" /> Card is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="checkbox" id="chkSalarystructureNotAssigned" class="chkReset" /> Salary structure is not assigned yet
                            </td>
                        </tr>
                        <tr>
                            <td class="td-AdvSearch-Level"></td>
                            <td class="td-AdvSearch-Input">
                                <input type="button" value="Reset" id="btnEmployeePickerReset" style="width: 70px" onclick="EmployeePickerReset()" />
                                <input type="button" value="Search" id="btnEmpPickerSearch" style="width: 70px" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div style="width: 52%; float: right;">
                    <table id="tblEmployeesForPicker" title="Employee List" class="easyui-datagrid" style="width: 480px; height: 480px;" fitcolumns="true" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                        <thead>
                            <tr>
                                <th data-options="field:'Selected',checkbox:true"></th>
                                <th field="Code" width="200"> Code</th>
                                <th field="Name" width="150">Employee Name</th>
                                <th field="DepartmentName" width="100">Department</th>
                                <th field="DesignationName" width="100">Designation</th>
                            </tr>
                        </thead>
                    </table>
                    <table style="width: 485px; font-size: 12px; font-weight: bold;">
                        <tr>
                            <td style="text-align: left">
                                <input id="chkRange" type="checkbox" />Range
                                <label id="lblRange1">
                                    <input id="txtFrom" type="text" style="width:40px" />&nbsp; To &nbsp;
                                </label>
                                <label id="lblRange2">
                                    <input id="txtTo" type="text" style="width:40px" />
                                </label>
                                <label id="lblcount"></label>
                            </td>
                            <td style="text-align: right">
                                <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="Next()">Next</a>
                                <a id="btnEmployeePickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                                <a id="btnEmployeePickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left"></td>
                            <td style="text-align: right"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <div id="winDepartmentPicker_Collection" class="easyui-window winstyle" title="Department Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="departmenttree_Collection" data-options="checkbox:true" singleselect="false"></ul>
                </div>
                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnDepartmentPickerOk_Collection" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnDepartmentPickerClose_Collection" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div id="winDepartmentPicker" class="easyui-window winstyle" title="Department Picker" style="width:350px; height:400px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div style="font-family:Tahoma">
                <div class="easyui-panel" style="width:335px;height:300px;overflow:auto">
                    <ul id="departmenttree" data-options="checkbox:false" singleselect="true"></ul>
                </div>

                <fieldset>
                    <legend style="font-weight:bold"> Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold">
                        <tr>
                            <td style="width:400px; text-align:right"></td>

                            <td style="width:50px">
                                <a id="btnDepartmentPickerOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true" onclick="OkButtonClick()">Ok</a>
                            </td>
                            <td style="width:50px">
                                <a id="btnDepartmentPickerClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

    </div>
    <style type="text/css">
        .lblStar {
            color: #ff0000;
            font-weight: bold;
        }

        .tbl-AdvSearch {
            width: 100%;
            font-size: 11px;
            font-weight: bold;
            text-align: left;
            margin-left: 3px;
        }

        .td-AdvSearch-Level {
            text-align: right;
        }

        .td-AdvSearch-Input {
            text-align: left;
        }

        .txtfield-search {
            width: 312px;
            text-align: left;
            font-size: 11px;
        }

        .txtfield-picker {
            width: 265px;
            text-align: left;
            font-size: 11px;
        }

        .selection-search {
            width: 310px;
            text-align: left;
            font-size: 11px;
        }

        .pick-btn {
            width: 20px;
            text-align: center;
            font-size: 11px;
        }
    </style>
    <script type="text/javascript">
        var _oEmployeeSalarys=null;
        var _sBaseAddress="";
        var _oEmployees=[];
        var _nLastEmployeeSalaryID = 0;
        var _oEmployeeSalarys = [];
        var _oEmployee = null;
        var _sSalarySchemeIDs = "";
        var _oMonths=[];

        var _sAttendanceSchemeID ="";
        var _sBusinessUnitIds = "";
        var _sLocationID = "";
        var _sDepartmentIds = "";
        var _sDepartmentNames = "";
        var _sDesignationIds = "";
        var _sDesignationNames = "";
        var _sEmployeeIDs="";
        var _sBlockNames="";
        var _sBMMIDs="";

        var _nLastEmployeeID = 0;
        var _bNext = false;
        var _nLoadRecords = 0;
        var _nRowLength = 0;

        var _oEmployeeTypes=[];
        var _oShifts=[];
        var _oEmployeeCSs=[];
        var _oEmployeeWSs=[];
        var _oBusinessUnits=[];
        var _oAURolesMapping=[];
        var _oMonths=[];
        var _sGroupNames="";
        var _sGroupIDs="";
        var _sGroupBlockNames="";
        var _sBlockIDs="";
        var _bNext = false;
        var _nRowLength = 0;
        var _nLastEmployeeID = 0;
        var _nLoadRecords = 0;
        var _sGroupNames="";
        var _sGroupIDs="";
        var _sBlockNames="";
        var _sBlockIDs="";
        var itemIDs="";
        var _oCardShapes = [];

        $(document).ready(function ()
        {
            _oEmployees =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            _oMonths= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.Months));
            _oAURolesMapping =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
            _oEmployeeTypes= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeTypes));
            _oShifts= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.Shifts));
            _oCardShapes= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.IDCardFormats));
            _oEmployeeCSs= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeCSs));
            _oEmployeeWSs= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeWSs));
            _oBusinessUnits=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
            var oEmployeeCategorys=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EmployeeCategorys));
            debugger;
            $('#dtExpireDate').datebox('setValue',icsdateformat(new Date()));
            InitializeAdvSearch();
            LoadYear();
            LoadCateGory(oEmployeeCategorys);
            $("#cboCardShape").icsLoadCombo({List: _oCardShapes, OptionValue: "id", DisplayText: "Value"});
        });



        function LoadCateGory(oEmployeeCategorys)
        {
            $("#cboCategory").icsLoadCombo({
                List: oEmployeeCategorys,
                OptionValue: "Value",
                DisplayText: "Text"
            });
        }

        function LoadYear()
        {
            var oDate=new Date();
            oDate.setFullYear(2014);
            var sYear="";
            sYear +="<option value='0'>"+'Year'+"</option>";
            for(var i=0; i<=15; i++)
            {
                sYear += "<option value='" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"'>" + (parseInt(oDate.getFullYear()) + parseInt(i)) +"</option>";
            }
            $('#cboYear').html(sYear);
            var oDate=new Date();
            $("#cboSalaryMonth_Collection").val(oDate.getMonth()+1);
            $("#cboYear").val(oDate.getFullYear());

        }



        /*---------------- emp Search Start click----------------*/

        function InitializeAdvSearch(){
            $('#dtDateFrom').datebox('setValue', icsdateformat(new Date()));
            $('#dtDateTo').datebox('setValue', icsdateformat(new Date()));

            $("#cboEmployeeType").icsLoadCombo({
                List: _oEmployeeTypes,
                OptionValue: "EmployeeTypeID",
                DisplayText: "Name"
            });
            $("#cboShift_EmpSearch").icsLoadCombo({
                List: _oShifts,
                OptionValue: "ShiftID",
                DisplayText: "ShiftWithDuration"
            });
            $("#cboEmployeeCardStatus").icsLoadCombo({
                List: _oEmployeeCSs,
                OptionValue: "Value",
                DisplayText: "Text"
            });
            $("#cboEmployeeWorkigStatus").icsLoadCombo({
                List: _oEmployeeWSs,
                OptionValue: "Value",
                DisplayText: "Text"
            });
            $("#cboBU").icsLoadCombo({
                List: _oBusinessUnits,
                OptionValue: "BusinessUnitID",
                DisplayText: "Name"
            });
            $('#txtFrom,#txtTo').numberbox({min:0, precision:0 });
            $('#txtFrom').numberbox('setValue',1);
            $('#txtTo').numberbox('setValue',50);
            $("#lblRange1").hide();

            var oMonths=[{MonthID:0,Name:'Jan'},{MonthID:1,Name:'Feb'},{MonthID:2,Name:'Mar'},{MonthID:3,Name:'Apr'},
                        {MonthID:4,Name:'May'},{MonthID:5,Name:'Jun'},{MonthID:6,Name:'Jul'},{MonthID:7,Name:'Aug'},
                        {MonthID:8,Name:'Sep'},{MonthID:9,Name:'Oct'},{MonthID:10,Name:'Nov'},{MonthID:11,Name:'Dec'},];

            $("#cboMonthFrom,#cboMonthTo").icsLoadCombo({
                List: oMonths,
                OptionValue: "MonthID",
                DisplayText: "Name",
                InitialValue:''
            });

            LoadDaysInMonth();
        }

        function LoadDaysInMonth(){
            $("#cboMonthFrom,#cboMonthTo").val((new Date()).getMonth());
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt((new Date()).getMonth())+1,0)).getDate();

            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayFrom,#cboDayTo").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        }

        $("#cboDateType").change(function(e){
            if($("#cboDateType").val()==1){
                $("#regionDateTo").hide();
            }
            else{
                $("#regionDateTo").show();
            }
        });

        $("#cboMonthFrom").change(function(e){
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt($("#cboMonthFrom").val())+1,0)).getDate();
            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayFrom").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        });

        $("#cboMonthTo").change(function(e){
            var nDaysInMonth=(new Date((new Date()).getFullYear(), parseInt($("#cboMonthTo").val())+1,0)).getDate();
            var oDays=[];
            for(var i=1;i<=nDaysInMonth;i++){
                oDays.push({DayID:i,Day:i});
            }
            $("#cboDayTo").icsLoadCombo({
                List: oDays,
                OptionValue: "DayID",
                DisplayText: "Day",
                InitialValue:''
            });
        });

        function EmployeePickerReset(){
            _nLastEmployeeID = 0;
            _sEmployeeIDs = "";
            _bNext = false;
            _nLoadRecords = 0;
            _nRowLength = 0;
            _sAttendanceSchemeID="";
            _sLocationID = "";
            _sDepartmentIds = "";
            _sDesignationIds = "";
            $(".txtReset").val("");
            $(".cboReset").val(0);
            $(".chkReset").prop("checked",false);

            $("#cboMonthFrom,#cboMonthTo").val((new Date()).getMonth());
            LoadDaysInMonth();

            DynamicRefreshList([], "tblEmployeesForPicker");
            $("#lblcount").html("");
            $('#txtFrom,#txtTo').numberbox({min:0, precision:0 });
            $('#txtFrom').numberbox('setValue',1);
            $('#txtTo').numberbox('setValue',50);
            $("#lblRange1").hide();
        }

        $("#btnEmployee").click(function () {
            EmployeePickerReset();
            $("#winEmployeePicker").icsWindow("open", " Employee Picker");
        });

        $('#chkRange').click(function()
        {
            if(document.getElementById("chkRange").checked == true)
            {
                $("#lblRange1").show();
            }
            else
            {
                $("#lblRange1").hide();
            }
        });

        $('#btnEmpPickerSearch').click(function () {
            _bNext = false;
            AdvSearch();
        });

        function Next() {
            var oEmployees = [];
            oEmployees = $('#tblEmployeesForPicker').datagrid('getRows');
            if (oEmployees.length <= 0) { alert('Please Select Criteria and click on "Search" to find information.!!'); return; }
            _nRowLength = oEmployees.length;
            _bNext = true;
            AdvSearch();
        }

        function AdvSearch(){
            if (!_bNext) {
                _nRowLength = 0;
                _nLastEmployeeID = 0;
            }
            _nLoadRecords = document.getElementById("txtTo").value;
            if ($("#chkRange").is(':checked')) {
                if($('#txtFrom').numberbox('getValue').length=='' || $('#txtTo').numberbox('getValue').length==''){alert("Please enter valid range.")}
                var nRangeFrom = parseInt($('#txtFrom').numberbox('getValue'));
                var nRangeTo = parseInt( $('#txtTo').numberbox('getValue'));
                if (nRangeFrom > nRangeTo) { alert("Invalid Range !");return; }
                _nRowLength = nRangeFrom - 1;
                _nLoadRecords = nRangeTo - nRangeFrom + 1;
            }
            debugger
            var sName = $.trim($("#txtEmployeeName").val());
            var sCode = $.trim($("#txtEmpCodeForSearch").val());
            var sEnrollNo = $.trim($("#txtEnrollNo").val());
            var bIsnotEnroll = $("#chkNotassignedyet").is(':checked');
            var nEmployeeTypeID=$("#cboEmployeeType").val();
            var nShiftID=$("#cboShift_EmpSearch").val();
            var nCardStatus=$("#cboEmployeeCardStatus").val();
            var nWorkingStatus=$("#cboEmployeeWorkigStatus").val();
            var nDateType=$("#cboDateType").val();
            var sDOBFrom= parseInt($("#cboMonthFrom").val())+1+'-'+$("#cboDayFrom").val();
            var sDOBTo= parseInt($("#cboMonthTo").val())+1+'-'+$("#cboDayTo").val();
            var sGender= $("#cboGender option:selected").text();

            var bIsActive = ($("#chkActive").is(':checked'))? 1 : 0;
            var bIsInactive = ($("#chkInActive").is(':checked'))? 1 : 0;
            var bIsUser = ($("#chkUser").is(':checked'))? 1 : 0;

            var bIsUnOfficial = ($("#chkOfficialNotAssign").is(':checked'))?1:0;
            var bIsOfficial = ($("#chkOfficialAssign").is(':checked'))? 1 : 0;

            var bIsCardNotAsigned = ($("#chkCardNotAssigned").is(':checked'))? 1 : 0;
            var bIsSalarystructureNotAsigned = ($("#chkSalarystructureNotAssigned").is(':checked'))? 1 : 0;

            var bIsJoiningDate = $("#chkJoiningDate").is(':checked');
            var dtDateFrom = $('#dtDateFrom').datebox('getValue');
            var dtDateTo = $('#dtDateTo').datebox('getValue');

            if(bIsJoiningDate)
            {
                if(new Date(dtDateFrom)>new Date(dtDateTo))
                {
                    alert("Invalid Joining Date Range!");
                    return;
                }
            }

            var nBusinessUnitID = $("#cboBU").val();
            var nCategory=$('#cboCategory').val();
            var sPresentAddress=$('#txtPresentAddress').val();
            var sPermanentAddress=$('#txtPermanentAddress').val();

            if(sName=='' && sCode=="" && sEnrollNo=="" && _sAttendanceSchemeID=="" && _sLocationID=="" && _sDepartmentIds=="" && _sDesignationIds=="" &&
               nEmployeeTypeID==0 && sGender=="None" && nShiftID==0 && bIsActive==0 && bIsUnOfficial==0 && bIsInactive==0 && _sEmployeeIDs=="" && bIsUser==0 &&
               bIsOfficial==0 && nCardStatus==0 && bIsCardNotAsigned==0 && nWorkingStatus==0 && bIsSalarystructureNotAsigned==0 && nDateType==0
               && !bIsnotEnroll && nCategory<=0 && nBusinessUnitID<=0 && sPresentAddress=="" && sPermanentAddress=="" && _sBMMIDs=="")
            {
                alert("Please enter your selection criteria."); return false;
            }

            var sParam = sName + '~' + sCode + '~' + _sAttendanceSchemeID + '~' + _sLocationID + '~' + _sDepartmentIds + '~' +_sDesignationIds + '~' +
                         sGender + '~' + nEmployeeTypeID + '~' + nShiftID + '~' + bIsActive + '~' + bIsUnOfficial + '~' + bIsInactive + '~' + _sEmployeeIDs + '~' +
                         bIsUser + '~' + bIsOfficial + '~' + nCardStatus + '~' + bIsCardNotAsigned + "~" + nWorkingStatus + "~" + bIsSalarystructureNotAsigned + "~" +
                         sDOBFrom + "~" + sDOBTo + "~" + nDateType + "~" + _nRowLength + "~" + _nLoadRecords+"~"+ bIsJoiningDate + "~" + dtDateFrom + "~" + dtDateTo
                        +"~"+sEnrollNo+"~"+bIsnotEnroll+"~"+nCategory+"~"+nBusinessUnitID+"~"+sPresentAddress+"~"+sPermanentAddress+"~"+_sBMMIDs;

            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/Employee/EmployeeSearch",
                traditional: true,
                data: JSON.stringify({ sParam: sParam }),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oEmps = jQuery.parseJSON(data);
                    if (oEmps != null) {
                        if (oEmps.length > 0) {
                            if(!_bNext){
                                DynamicRefreshList(oEmps,'tblEmployeesForPicker');
                            }
                            else{
                                var bAppend=false;
                                var oTEmps=$('#tblEmployeesForPicker').datagrid('getRows');
                                if(oTEmps.length>0){
                                    for (var i = 0; i < oEmps.length; i++) {
                                        var IsAppend=true;
                                        for (var j = 0; j < oTEmps.length; j++) {

                                            if(oEmps[i].EmployeeID==oTEmps[j].EmployeeID){
                                                IsAppend=false;
                                                break;
                                            }
                                        }
                                        if(IsAppend){
                                            bAppend=true;
                                            $('#tblEmployeesForPicker').datagrid('appendRow', oEmps[i]);
                                        }
                                    }
                                }
                                else{
                                    for (var j = 0; j < oEmps.length; j++) {
                                        bAppend=true;
                                        $('#tblEmployeesForPicker').datagrid('appendRow', oEmps[j]);
                                    }
                                }
                                if(!bAppend){
                                    alert("No more data found!");
                                }
                            }

                        }
                        else {
                            alert("No more data found!");
                        }
                        var oEmployees = $('#tblEmployeesForPicker').datagrid('getRows');
                        document.getElementById("lblcount").innerHTML = " | Count =" + oEmployees.length;
                        _bNext = false;
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });
        }

        $("#btnEmployeePickerOk").click(function () {
            var oEmployees = $('#tblEmployeesForPicker').datagrid('getChecked');
            if (oEmployees.length<=0) { alert("please select atleast one item");return; }
            for(var i = 0; i<oEmployees.length; i++)
            {
                $('#tblEmployeeSalary').datagrid('appendRow',oEmployees[i]);
            }
            var sEmpIDs="";
            var sEmpNames="";
            for(var i=0;i<oEmployees.length;i++)
            {
                sEmpIDs=sEmpIDs+oEmployees[i].EmployeeID+",";
                sEmpNames=sEmpNames+oEmployees[i].Name+",";
            }
            _sEmployeeIDs= sEmpIDs.substring(0,sEmpIDs.length-1);
            sEmpNames= sEmpNames.substring(0,sEmpNames.length-1);
            $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
            $("#txtEmployee_Collection").val(sEmpNames);
            $("#winEmployeePicker").icsWindow('close');
            SearchByDepartmentAndDateRangeWithPasignation();

        });

        $("#btnEmployeePickerClose").click(function () {
            $("#winEmployeePicker").icsWindow('close');
        });


        /*-------------Location Picker----------------*/
        var btnLocation="";
        $("#btnLocationPicker,#btnLocationPicker_Colection").click(function(e){
            debugger;
            btnLocation = $(this).attr("id");
            var sBusinessUnitIDs ="";
            var nBusinessUnitID=0;
            if(btnLocation=="btnLocationPicker")
            {
                nBusinessUnitID = $("#cboBU").val();
                sBusinessUnitIDs = String(nBusinessUnitID);
            }
            else{sBusinessUnitIDs=_sBusinessUnitIds;}
            $("#winLocationPicker").icsWindow('open');
            var oLocation={LocationID:0,BusinessUnitIDs:sBusinessUnitIDs};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oLocation,
                ControllerName: "Location",
                ActionName: "GetsLocationMenuTree",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.TLocation.id > 0) {
                        $('#locationtree').tree({ data: [response.obj.TLocation] });
                    }
                }
            });
        });

        $("#btnLocationPickerOk").click(function(e){
            if(btnLocation=="btnLocationPicker")
            {
                var oLocation = $('#locationtree').tree('getSelected');
                if(oLocation!=null && oLocation.id>0){
                    $("#winLocationPicker").icsWindow('close');
                    _sLocationID=oLocation.id;
                    $('#txtLocation').val(oLocation.text);
                }
                else{
                    alert("Please select a location.");
                }
            }
            else
            {
                var oLocations = $('#locationtree').tree('getChecked');
                if(oLocations!=null && oLocations.length>0)
                {
                    var LocationName="";
                    for(var i=0; i<oLocations.length; i++)
                    {
                        if(oLocations[i].id !=1)
                        {
                            LocationName+=oLocations[i].text+",";
                            _sLocationID+=oLocations[i].id+",";
                        }
                    }

                    LocationName=LocationName.substring(0,LocationName.length-1);
                    _sLocationID=_sLocationID.substring(0,_sLocationID.length-1);
                    $("#winLocationPicker").icsWindow('close');
                    $('#txtLocation_Colection').val(LocationName);
                }
                else
                {
                    alert("Please select a location.");
                }
            }
        });
        $('#btnClearGrid').click(function(e){
            if($('#cboClear').val()==0)
            {
                $('#tblEmployeeSalary').datagrid('loadData',[])
            }
            else if ($('#cboClear').val()==1)
            {
                var oData = $('#tblEmployeeSalary').datagrid('getChecked');
                $('#tblEmployeeSalary').datagrid('loadData',[]);
                $('#tblEmployeeSalary').datagrid('loadData',oData);
            }

        
        
        
        });
        $('#txtLocation_Colection').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                //$("#winLocationPicker").icsWindow('open');
                //var oLocation={LocationID:0};
                btnLocation = $(this).attr("id");
                var sBusinessUnitIDs ="";
                var nBusinessUnitID=0;
                if(btnLocation=="btnLocationPicker")
                {
                    nBusinessUnitID = $("#cboBU").val();
                    sBusinessUnitIDs = String(nBusinessUnitID);
                }
                else{sBusinessUnitIDs=_sBusinessUnitIds;}
                $("#winLocationPicker").icsWindow('open');
                var oLocation={LocationID:0,BusinessUnitIDs:sBusinessUnitIDs};

                var obj = {
                    BaseAddress: _sBaseAddress,
                    Object: oLocation,
                    ControllerName: "Location",
                    ActionName: "GetsLocationMenuTree",
                    IsWinClose: false
                };
                $.icsDataGet(obj, function (response) {

                    if (response.status && response.obj!=null) {
                        if (response.obj.TLocation.id > 0) {
                            $('#locationtree').tree({ data: [response.obj.TLocation] });
                        }
                    }
                });
            }
        });

        $("#btnLocationPickerClose").click(function(e){
            $("#winLocationPicker").icsWindow('close');
        });

        $("#btnResetLocationPicker,#btnResetLocationPicker_Colection").click(function(e){
            $('#txtLocation').val("");
            $('#txtLocation_Colection').val("");
            _sLocationID="";
        });

        $("#btnLocationPickerClose").click(function(e){
            $("#winLocationPicker").icsWindow('close');
        });

        /*-------------Department Picker----------------*/

        $("#btnDepartmentPicker").click(function(e){
            $("#winDepartmentPicker").icsWindow('open');
            var oDepartment={DepartmentID:0,BusinessUnitIDs:_sBusinessUnitIds,LocationIDs:_sLocationID};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDepartment,
                ControllerName: "Department",
                ActionName: "GetsDepartments",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.id > 0) {
                        $('#departmenttree').tree({ data: [response.obj] });
                    }
                }
            });
        });

        $("#btnDepartmentPickerOk").click(function(e){
            var oDepartment = $('#departmenttree').tree('getSelected');
            if(oDepartment!=null && oDepartment.id>0){
                $("#winDepartmentPicker").icsWindow('close');
                $('#txtDepartment').val(oDepartment.text);
                _sDepartmentIds= oDepartment.id;
            }
            else{
                alert("Please select a department.");
            }
        });

        $("#btnDepartmentPickerClose").click(function(e){
            $("#winDepartmentPicker").icsWindow('close');
        });

        $("#btnDepartmentPickerClose_Collection").click(function(e){
            $("#winDepartmentPicker_Collection").icsWindow('close');
        });

        $("#btnResetDepartmentPicker,#btnResetDepartmentPicker_Collection").click(function(e){
            $('#txtDepartment,#txtDepartment_Collection').val("");
            _sDepartmentIds="";
            _sDepartmentNames="";
        });

        /*-------------Designation Picker----------------*/
        var btnDesignation="";
        $("#btnDesignationPicker,#btnDesignationPicker_Collection").click(function(e){
            btnDesignation = $(this).attr("id");
            DesignationPicker();
        });

        $("#txtDesignation_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                btnDesignation ="btnDesignationPicker_Collection";
                DesignationPicker();
            }
        });

        function DesignationPicker()
        {
            var oDesignation={
                DesignationID:0,
                Params: _sBusinessUnitIds+'~'+_sLocationID+'~'+ _sDepartmentIds
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDesignation,
                ControllerName: "Designation",
                ActionName: "Gets",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].DesignationID > 0) {
                        var tblColums = [];
                        var oColumn = { field: "Code", title: "Code", width: 50, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 170, align: "left" };tblColums.push(oColumn);

                        var bmultiplereturn=false;
                        if(btnDesignation=="btnDesignationPicker_Collection"){bmultiplereturn=true;}

                        var oPickerParam = {
                            winid: 'winDesignation',
                            winclass:'clsDesignation',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblDesignation',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: bmultiplereturn,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Designation List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeDesignationPickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeDesignationPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oDesignations=[];

                if(btnDesignation=="btnDesignationPicker_Collection")
                {
                    oDesignations = $('#'+oPickerobj.tableid).datagrid('getChecked');
                }
                else
                {
                    var oDesignation = $('#'+oPickerobj.tableid).datagrid('getSelected');
                    oDesignations.push(oDesignation);
                }

                if (oPickerobj.winid == 'winDesignation')
                {
                    if(oDesignations!=null && oDesignations.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oDesignations.length; i++)
                        {
                            _sDesignationNames+=oDesignations[i].Name+",";
                            _sDesignationIds+=oDesignations[i].DesignationID+",";
                        }

                        _sDesignationNames=_sDesignationNames.substring(0,_sDesignationNames.length-1);
                        _sDesignationIds=_sDesignationIds.substring(0,_sDesignationIds.length-1);
                        if(btnDesignation=="btnDesignationPicker_Collection")
                        {
                            $("#txtDesignation_Collection").val(_sDesignationNames);
                        }
                        else
                        {
                            $("#txtDesignation").val(_sDesignationNames);
                        }
                    }
                    else{
                        alert("Please select a designation.");
                    }
                }
            });
        }

        $("#btnResetDesignationPicker,#btnResetDesignationPicker_Collection").click(function(e){
            $('#txtDesignation').val("");
            $('#txtDesignation_Collection').val("");
            _sDesignationIds="";
            _sDesignationNames = "";
        });


        /*---------------- emp Search End click ----------------*/

        /*---------------- emp Search Start keyprees----------------*/
        $('#btnSearch').click(function(e){
            SearchEmployeeByText();
        });
        $('#txtEmployee_Collection').keypress(function (e)
        {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var sCodeName = $.trim($("#txtEmployee_Collection").val());
                //if(sCodeName=='')
                //{
                //    alert("Please enter name or code to search.");
                //    $("#txtEmployee_Collection").focus(); return;
                //}
                SearchEmployeeByText(sCodeName);
            }
        });

        function SearchEmployeeByText(sEmpNameCode){
            var oEmployee = {
                Name: sEmpNameCode,
                Code: sEmpNameCode,
                BusinessUnitName:_sBusinessUnitIds,
                LocationName: _sLocationID,
                DepartmentName:_sDepartmentIds,
                DesignationName: _sDesignationIds,
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oEmployee,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeByNameCodeDesgDeptLocBUwithDRP",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {
                debugger;
                if (response.status && response.objs.length > 0) {
                    for(var i = 0; i<response.objs.length; i++)
                    {
                        $('#tblEmployeeSalary').datagrid('appendRow',response.objs[i]);
                    }


                    //$("#tblEmployeeSalary").datagrid("loadData", response.objs);
                    //if (response.objs[0].EmployeeID > 0) {

                    //    var tblColums = [];var oColumn = { field: "Code", title: "Code", width: 70, align: "left" };tblColums.push(oColumn);
                    //    oColumn = { field: "Name", title: "Name", width: 120, align: "left" };tblColums.push(oColumn);
                    //    oColumn = { field: "DepartmentName", title: "Department", width: 100, align: "left" };tblColums.push(oColumn);
                    //    oColumn = { field: "DesignationName", title: "Designation", width: 100, align: "left" };tblColums.push(oColumn);
                    //    var oPickerParam = {
                    //        winid: 'winEmployeePickerTextSearch',
                    //        winclass:'clsEmployeePickerTextSearch',
                    //        winwidth: 455,
                    //        winheight: 460,
                    //        tableid: 'tblEmployeePickerTextSearch',
                    //        tablecolumns: tblColums,
                    //        datalist: response.objs,
                    //        multiplereturn: false,
                    //        searchingbyfieldName:'Name',
                    //        windowTittle: 'Employee list'
                    //    };

                    //    $.icsPicker(oPickerParam);
                    //    IntializeEmployeePickerTextSearch(oPickerParam);//multiplereturn, winclassName

                    //}
                    //else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeEmployeePickerTextSearch(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
                if(oreturnObj == null || oreturnObj.EmployeeID<=0){  alert("please select an employee."); return false;}

                $("#"+oPickerobj.winid).icsWindow("close");
                $("#" + oPickerobj.winid).remove();
                if (oPickerobj.winid == 'winEmployeePickerTextSearch')
                {
                    if (oreturnObj != null && oreturnObj.EmployeeID > 0)
                    {
                        _sEmployeeIDs=oreturnObj.EmployeeID;
                        $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
                        $("#txtEmployee_Collection").val(oreturnObj.Name);
                        $("#winEmployeePicker").icsWindow('close');
                        SearchByDepartmentAndDateRangeWithPasignation();
                    }
                }
            });

            $(document).find('.' +oPickerobj.winclass).keydown(function (e) {
                if (e.which == 13)//enter=13
                {
                    var oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
                    if(oreturnObj == null || oreturnObj.EmployeeID<=0){  alert("please select an employee."); return false;}

                    $("#"+oPickerobj.winid).icsWindow("close");
                    $("#" + oPickerobj.winid).remove();

                    if (oPickerobj.winclass == 'clsEmployeePickerTextSearch')
                    {
                        if (oreturnObj != null && oreturnObj.EmployeeID > 0)
                        {
                            _sEmployeeIDs=oreturnObj.EmployeeID;
                            $('#txtEmployeeName').data("EmployeeIDs",_sEmployeeIDs);
                            $("#txtEmployee_Collection").val(oreturnObj.Name);
                            $("#winEmployeePicker").icsWindow('close');
                            SearchByDepartmentAndDateRangeWithPasignation();
                        }
                    }
                }
            });
        }

        $('#btnCEmployee').click(function (e)
        {
            document.getElementById("txtEmployee_Collection").value = "" ;
            $('#txtEmployeeName').data("EmployeeIDs","");
            _sEmployeeIDs = "";
        });

        /*---------------- emp Search Start keyprees----------------*/

        /*-------------Department Picker start Collection----------------*/
        $("#btnDepartmentPicker_Collection").click(function(e){
            DepartmentPicker();
        });

        $("#txtDepartment_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                DepartmentPicker();
            }
        });

        function DepartmentPicker()
        {
            $("#winDepartmentPicker_Collection").icsWindow('open');
            var oDepartment={DepartmentID:0,BusinessUnitIDs:_sBusinessUnitIds,LocationIDs:_sLocationID};
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oDepartment,
                ControllerName: "Department",
                ActionName: "GetsDepartments",
                IsWinClose: false
            };

            $.icsDataGet(obj, function (response) {
                if (response.status && response.obj!=null) {
                    if (response.obj.id > 0) {
                        $('#departmenttree_Collection').tree({ data: [response.obj] });
                    }
                }
            });
        }

        $("#btnDepartmentPickerOk_Collection").click(function(e){
            _sDepartmentNames="";
            _sDepartmentIds="";
            var oDepartments = $('#departmenttree_Collection').tree('getChecked');
            if(oDepartments!=null && oDepartments.length>0){
                $("#winDepartmentPicker_Collection").icsWindow('close');
                for(var i=0; i<oDepartments.length; i++)
                {
                    _sDepartmentNames+=oDepartments[i].text+",";
                    _sDepartmentIds+=oDepartments[i].id+",";
                }

                _sDepartmentNames=_sDepartmentNames.substring(0,_sDepartmentNames.length-1);
                _sDepartmentIds=_sDepartmentIds.substring(0,_sDepartmentIds.length-1);
                $("#txtDepartment_Collection").val(_sDepartmentNames);
            }
            else{
                alert("Please select a department.");
            }
        });

        /*-------------Start Business Unit Picker----------------*/
        $("#btnBusinessUnitPicker_Collection").click(function(e){
            BusinessUnitPicker();
        });

        $("#txtBusinessUnit_Collection").keypress(function(e){
            if (e.which == 13)//enter=13
            {
                BusinessUnitPicker();
            }
        });

        function BusinessUnitPicker()
        {
            var oBusinessUnit={
                BusinessUnitID:0
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oBusinessUnit,
                ControllerName: "BusinessUnit",
                ActionName: "GetsBusinessUnitWithPermission",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].BusinessUnitID > 0) {
                        var tblColums = [];
                        var oColumn = { field: "Code", title: "Code", width: 50, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 170, align: "left" };tblColums.push(oColumn);

                        var bmultiplereturn=true;

                        var oPickerParam = {
                            winid: 'winBusinessUnit',
                            winclass:'clsBusinessUnit',
                            winwidth: 320,
                            winheight: 400,
                            tableid: 'tblBusinessUnit',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: bmultiplereturn,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Business Unit List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeBusinessUnitPickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeBusinessUnitPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                var oBusinessUnits=[];
                oBusinessUnits = $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winBusinessUnit')
                {
                    if(oBusinessUnits!=null && oBusinessUnits.length>0)
                    {
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();
                        var sBusinessUnitName = "";
                        for(var i=0; i<oBusinessUnits.length; i++)
                        {
                            sBusinessUnitName+=oBusinessUnits[i].Name+",";
                            _sBusinessUnitIds+=oBusinessUnits[i].BusinessUnitID+",";
                        }

                        sBusinessUnitName=sBusinessUnitName.substring(0,sBusinessUnitName.length-1);
                        _sBusinessUnitIds=_sBusinessUnitIds.substring(0,_sBusinessUnitIds.length-1);
                        $("#txtBusinessUnit_Collection").val(sBusinessUnitName);
                    }
                    else
                    {
                        alert("Please select a Business Unit.");
                    }
                }
            });
        }

        $("#btnResetBusinessUnitPicker_Collection").click(function(e){
            $('#txtBusinessUnit_Collection').val("");
            _sBusinessUnitIds="";
        });



        $('#txtEmployeeGroup').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByGroup = $("#txtEmployeeGroup").val();
                var sTempName = "";
                SearchEmployeeGroup(txtSearchByGroup);
                $("#txtEmployeeGroup").val('');
            }
        });


        $("#btnEmployeeGroupPicker").click(function(e){
            SearchEmployeeGroup("");
        });
        function SearchEmployeeGroup(name) {
            $("#txtEmployeeGroup").val("");
            _sGroupNames = "";
            _sGroupIDs = "";
            var oGroup={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oGroup,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeGroupAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winGroup',
                            winclass:'clsGroup',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblGroup',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee Group List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeGroupPickerbutton(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeGroupPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oGroups=[];
                oGroups= $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winGroup')
                {
                    if(oGroups!=null && oGroups.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oGroups.length; i++)
                        {
                            _sGroupNames += oGroups[i].Name+",";
                            _sGroupIDs += oGroups[i].EmployeeTypeID+",";

                        }
                        _sGroupNames=_sGroupNames.substring(0,_sGroupNames.length-1);
                        _sGroupIDs=_sGroupIDs.substring(0,_sGroupIDs.length-1);
                        $("#txtEmployeeGroup").val(_sGroupNames);
                    }
                    else
                    {
                        alert("Please select a Employee Group.");
                    }
                }
            });
        }

        $("#btnEmployeeGroupPickerReset").click(function(e){

            $('#txtEmployeeGroup').val("");
            _sGroupIDs = "";
        });

        /*------------EmployeeBlock--------------*/

        $('#txtEmployeeBlock').keydown(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                var txtSearchByBlock = $("#txtEmployeeBlock").val();
                var sTempName = "";
                SearchEmployeeBlock(txtSearchByBlock);
                $("#txtEmployeeBlock").val('');
            }
        });

        $("#btnEmployeeBlockPicker").click(function(e){
            SearchEmployeeBlock("");
        });
        function SearchEmployeeBlock(name) {
            $("#txtEmployeeBlock").val("");
            _sBlockNames = "";
            _sBlockIDs = "";
            var oBlock={
                Name : name
            };
            debugger
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oBlock,
                ControllerName: "Employee",
                ActionName: "GetsEmployeeBlockAdvSrc",
                IsWinClose: false
            };
            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].EmployeeTypeID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "Name", title: "Name", width: 150, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winBlock',
                            winclass:'clsBlock',
                            winwidth: 320,
                            winheight: 460,
                            tableid: 'tblBlock',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Employee Block List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializeBlockPickerbutton(oPickerParam);//multiplereturn, winclassName

                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
            });
        }

        function IntializeBlockPickerbutton(oPickerobj)
        {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {

                var oGroups=[];
                oBlocks= $('#'+oPickerobj.tableid).datagrid('getChecked');
                if (oPickerobj.winid == 'winBlock')
                {
                    if(oBlocks!=null && oBlocks.length>0){
                        $("#"+oPickerobj.winid).icsWindow("close");
                        $("#" + oPickerobj.winid).remove();

                        for(var i=0; i<oBlocks.length; i++)
                        {
                            _sBlockNames += oBlocks[i].Name+",";
                            _sBlockIDs += oBlocks[i].EmployeeTypeID+",";

                        }
                        _sBlockNames=_sBlockNames.substring(0,_sBlockNames.length-1);
                        _sBlockIDs=_sBlockIDs.substring(0,_sBlockIDs.length-1);
                        $("#txtEmployeeBlock").val(_sBlockNames);
                    }
                    else
                    {
                        alert("Please select a Employee Block.");
                    }
                }
            });
        }


        $("#btnEmployeeBlockPickerReset").click(function(e){

            $('#txtEmployeeBlock').val("");
            _sBlockIDs = "";
        });

        $('#btnAction').click(function (e) {
            OpenWinEmpCardPrintItem();
        });

        function OkEmpCardPrintItem()
        {
            var oEmpCardPrintItems = $('#tblEmpCardPrintItems').datagrid('getChecked');

            if(oEmpCardPrintItems.length>0)
            {
                for(var i=0;i<oEmpCardPrintItems.length;i++)
                {
                    itemIDs += oEmpCardPrintItems[i].id +",";
                }
                itemIDs = itemIDs.substring(0,itemIDs.length-1);
            }

            $('#winEmpCardPrintItems').icsWindow('close');
        }

        function OpenWinEmpCardPrintItem()
        {
            var oObj= new Object();
            var oItems=[];
            oObj.id=1;
            oObj.Item="Joining Date";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=2;
            oObj.Item="B. Group";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=3;
            oObj.Item="Company Address";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=4;
            oObj.Item="Issue Date";
            oItems.push(oObj);


            oObj= new Object();
            oObj.id=5;
            oObj.Item="Pad Format";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=6;
            oObj.Item="Date of Birth";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=7;
            oObj.Item="ID Card";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=8;
            oObj.Item="BusinessUnit Address";
            oItems.push(oObj);

            oObj= new Object();
            oObj.id=9;
            oObj.Item="Back Address Company";
            oItems.push(oObj);


            DynamicRefreshList(oItems, "tblEmpCardPrintItems");
            $('#winEmpCardPrintItems').icsWindow('open');
        }
        function CloseWinEmpCardPrintItem()
        {
            $('#winEmpCardPrintItems').icsWindow('close');
        }

        function CloseBOA()
        {
            $("#winBOA").icsWindow("close");
            _nEmployeeID=0;
        }


        $('#btnPrint').click(function (e)
        {
            _bNext = false;
            Print();

        });
        function Next() {

            _nRowLength += 100;
            _bNext = true;
            Print();
        }
        function Print() {
            var oEmployees = $('#tblEmployeeSalary').datagrid('getChecked');
            if (oEmployees.length <= 0) {
                alert("Please Select At Least One Item !");
                return;
            }
            _sEmployeeIDs = "";
            for(var i=0; i<oEmployees.length;i++)
            {
                _sEmployeeIDs = _sEmployeeIDs + "," + oEmployees[i].EmployeeID;
            }
            if(_sEmployeeIDs.length>0)_sEmployeeIDs = _sEmployeeIDs.substr(1);

            debugger;
            var oSearchingOBJ = {
                Name:_sEmployeeIDs
            };


            $.ajax
    ({
        type: "POST",
        dataType: "json",
        url: _sBaseAddress + "/EmployeeIDCard/SetSessionSearchCriteria",
        traditional: true,
        data: JSON.stringify(oSearchingOBJ),
        contentType: "application/json; charset=utf-8",
        success: function (data) {
            debugger;
            var result=jQuery.parseJSON(data);
            if(result=="Successful")
            {
                var tsv = ((new Date()).getTime()) / 1000;
                if($("#cboCardShape").val()==0)
                {
                    alert("Please Select Any ID Card Format");
                    return;
                }
                else if($("#cboCardShape").val()==1)
                {
                    sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
                }
                else if($("#cboCardShape").val()==2)
                {
                    sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Landscape?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs;
                }
                else if($("#cboCardShape").val()==3)
                {
                    sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait_BothSide?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
                }
                else if($("#cboCardShape").val()==4)
                {
                    sUrl= _sBaseAddress+ "/EmployeeIDCard/IDCardBanglaBothSide?ts="+tsv;
                }
                window.open(sUrl, "_blank");
            }
        },
        error: function (xhr, status, error) {
            alert(error);
        }

    });




            $http.post(_sBaseAddress+'/EmployeeIDCard/SetSessionSearchCriteria',JSON.stringify(oSearchingOBJ)).then(
                                function (response) {
                                    debugger;
                                    var result=jQuery.parseJSON(response.data);
                                    console.log(result);
                                    debugger;
                                    if(result=="Successful")
                                    {
                                        var tsv = ((new Date()).getTime()) / 1000;
                                        if($("#cboCardShape").val()==0)
                                        {
                                            alert("Please Select Any ID Card Format");
                                            return;
                                        }
                                        else if($("#cboCardShape").val()==1)
                                        {
                                            sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
                                        }
                                        else if($("#cboCardShape").val()==2)
                                        {
                                            sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Landscape?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs;
                                        }
                                        else if($("#cboCardShape").val()==3)
                                        {
                                            sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait_BothSide?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
                                        }
                                        else if($("#cboCardShape").val()==4)
                                        {
                                            sUrl= _sBaseAddress+ "/EmployeeIDCard/IDCardBanglaBothSide?ts="+tsv;
                                        }
                                        window.open(sUrl, "_blank");
                                    }
                                    //window.open(_sBaseAddress + '/FDCRegister/PrintFDCRegister?ts=' + Math.random(420));
                                },
                                function (response) { alert(response.data);}
                        );



            if($("#cboCardShape").val()==0)
            {
                alert("Please Select Any ID Card Format");
                return;
            }
            else if($("#cboCardShape").val()==1)
            {
                sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
            }
            else if($("#cboCardShape").val()==2)
            {
                sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Landscape?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs;
            }
            else if($("#cboCardShape").val()==3)
            {
                sUrl= _sBaseAddress+ "/EmployeeIDCard/PrintEmployeeCard_Potrait_BothSide?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs+"&itemIDs="+itemIDs;
            }
            else if($("#cboCardShape").val()==4)
            {
                sUrl= _sBaseAddress+ "/EmployeeIDCard/IDCardBanglaBothSide?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs; //+ _nRowLength + "~" + _nLoadRecords+"~"
            }
            window.open(sUrl, "_blank");

            //if ($("#chkRange").is(':checked')) {
            //    if($('#txtFrom').numberbox('getValue').length=='' || $('#txtTo').numberbox('getValue').length==''){alert("Please enter valid range.")}
            //    var nRangeFrom = parseInt($('#txtFrom').numberbox('getValue'));
            //    var nRangeTo = parseInt( $('#txtTo').numberbox('getValue'));
            //    if (nRangeFrom > nRangeTo) { alert("Invalid Range !");return; }
            //    _nRowLength = nRangeFrom - 1;
            //    _nLoadRecords = nRangeTo - nRangeFrom + 1;
            //}



            //window.open(_sBaseAddress+ "/Employee/PrintIDCardWithSearchingCriteria?sEmpIDs="+_sEmployeeIDs+"&sBusinessUnitIDs="+_sBusinessUnitIds+"&sLocationID="+_sLocationID+"&sDepartmentIDs="+_sDepartmentIds+"&sDesignationIDs="+_sDesignationIds+"&expDate="+$('#dtExpireDate').datebox('getValue')+"&nRowLength=" + _nRowLength + "&nLoadRecords="+_nLoadRecords+"&sGroupIDs="+_sGroupIDs + "&sBlockIDs="+_sBlockIDs, "_blank"); //+ _nRowLength + "~" + _nLoadRecords+"~"

        }

    </script>
