<html>
<head>  
    <link href="@Url.Content("~/Content/CSS/icon.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/easyui.css")" rel="stylesheet" type="text/css" /> 
    <link href="@Url.Content("~/Content/CSS/Pikerstyle.css")" rel="stylesheet" type="text/css" />  

    <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>            
    <script src="@Url.Content("~/Scripts/jquery.ics.customize.js")" type="text/javascript"></script>  
    <script src="@Url.Content("~/Scripts/jquery.easyui.min.js")" type="text/javascript"></script>    

    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script> 
    <script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script> 
    
</head>
<body>

@model ESimSol.BusinessObjects.GUProductionOrder
<div style="font-family:Tahoma">           
<table border="0" cellspacing="2" cellpadding="2">
    <tr>
        <td style="background-color:#CFB53B; text-align:center; width:635px; color:White">
            <label id="lblAdvHeaderName" style="font-size:15px; font-weight:bold; text-decoration:Underline; width:635px">View Update Production Tolerance With Winding Status</label>
        </td>
    </tr>
</table>
<fieldset>
      <legend> Production Order Information </legend>
        <table border="0"style ="font-size:12px;">
            <tr>
                <td style="width:100px; text-align:right">Tolerance(%):</td>
                <td style="width:200px; text-align:left">  
                    @Html.TextBoxFor(model => model.ToleranceInPercent, new { style = "width: 200px;", id = "txtUTToleranceInPercent" })
                </td> 
                <td style="width:100px; text-align:right">Winding Status:</td>
                <td style="width:220px; text-align:left">  
                    @Html.DropDownList("WindingStatus", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumWindingStatus))), new { id = "cboUTWindingStatus", style = "width: 180px;" })
                </td> 
            </tr>  
        </table>
</fieldset>

    
<fieldset style="font-weight:bold;width:625px; ">
    <legend > Action : </legend>
        <table border="0" style="font-size:11px;font-weight:bold">
            <tr>
                <td style="width:480px; text-align:right">        
                </td>
                <td style="width:50px">
                   <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="UpdateUT()">Update</a>
                </td>
                <td style="width:50px">
                   <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" plain="true" onclick="CloseUT()">Close</a>
                </td>
             </tr>       
         </table>
</fieldset>
</div>
</body>
</html>

<script type="text/javascript"> 
 var _oGUProductionOrder=null;
 var _sBaseAddress="";
 var obj = window.dialogArguments;
 $(document).ready(function () {
     debugger;     
     _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));                  
     _oGUProductionOrder =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); 
     $('#txtUTToleranceInPercent').numberbox({min:0,precision:2});
     $('#txtUTToleranceInPercent').numberbox('setValue', _oGUProductionOrder.ToleranceInPercent);
});


function UpdateUT()
{
    debugger;
    if(!ValidateInputUT()) return;
    var oGUProductionOrder = _oGUProductionOrder;
    oGUProductionOrder.ToleranceInPercent = $('#txtUTToleranceInPercent').numberbox('getValue');
    oGUProductionOrder.WindingStatus = $('#cboUTWindingStatus').val();
    
    $.ajax({
            type: "POST",
            dataType: "json",            
            url : _sBaseAddress+"/GUProductionOrder/UpdateToleranceWithWindingStatus",
            traditional: true,
            data:  JSON.stringify(oGUProductionOrder),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                 _oGUProductionOrder= jQuery.parseJSON(data);
                 if(_oGUProductionOrder!=null)
                {
                     if (parseFloat(_oGUProductionOrder.ToleranceInPercent)>0) 
                    {                   
                        alert("Successfully Updated !!");                            
                        CloseUT();
                    }
                    else 
                    {
                         alert(_oGUProductionOrder.ErrorMessage);
                    }
                }
            },
            error: function (xhr, status, error) 
            {
                alert(error);
            }
        });
}



function ValidateInputUT()
{
  debugger;
  if($('#txtUTToleranceInPercent').numberbox('getValue') <=0) 
   { 
        alert("Tolerance Percent Should be greater than 0!");         
        return false; 
  }
  if($('#txtUTToleranceInPercent').numberbox('getValue') >100) 
  { 
      alert("Tolerance Percent Should be less than 100!");         
      return false; 
  }
   return true;
}
    
function CloseUT()
{
  //
}

$(document).keydown(function(e) {    
    //debugger;
    if(e.which == 27)//escape=27
    {
        //debugger;        
       CloseUT();
    }
});

</script>