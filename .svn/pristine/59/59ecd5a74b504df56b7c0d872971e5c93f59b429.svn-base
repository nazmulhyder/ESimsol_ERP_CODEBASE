@{
    ViewBag.Title = "ExportIncentive";
}
@model ESimSol.BusinessObjects.ExportIncentive

<div id="divCC" style="height:100%" ng-app="ExportIncentiveAPP" class="regionExportIncentive">
    <div style="height:100%;" ng-controller="ExportIncentiveCtrl">
        @*<div class="panel-header form-inline">
                <label style="padding-left:10px"> Unit: </label>
                <select style="width:30%; font-weight:bold;" class="form-control" ng-model="ExportIncentive.BUID" ng-options="item.id as item.Value for item in BusinessUnits" ng-disabled="cboDisabled">
                    <option value="">--Select Unit--</option>
                </select>
            </div>*@
        <div style="height:89%; overflow-y:scroll">
            <fieldset>
                <legend>Info</legend>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Applicant :</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.ApplicantName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Advising Bank:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.BBranchName_Advice" disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Nego. Bank:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.BBranchName_Nego" disabled />
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">LC No:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.ExportLCNo" disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">LC Date:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.OpeningDateST" placeholder=" Beneficiary's TIN...." disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Issue Bank:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.BankName_Issue" disabled />
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">L/C Value:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Amount_ST" placeholder=" Contractor's TIN...." disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Realized Value:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Amount_BillRealST" placeholder=" Contractor's TIN...." disabled />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Master L/C No:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.MasterLCNo" disabled />
                    </div>
                </div>
            </fieldset>
            @*BILL TABLE*@
            <fieldset>
                <legend>Details : </legend>
                <div class="row col-md-12">
                    <div ui-grid="gridOptions" ui-grid-selection ui-grid-resize-columns ui-grid-edit class="grid ui-grid-selectable"></div>
                </div>
            </fieldset>
            @*Application*@
            <fieldset>
                @*<legend>Application</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">SL No</label></div>
                    <div class="col-md-3 text-left">
                        <input type="text" class="form-control number" ng-model="ExportIncentive.SLNo" style="width:80%">
                    </div>

                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_Application" ng-disabled="disabled" />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Application By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.ApplicationByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(2)">Update</button></div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Application Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.ApplicationDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Incentive Value </label></div>
                    <div class="col-md-3 text-left">
                       <div class="input-group">
                           <input class="form-control number" style="width:35%;" ng-model="ExportIncentive.Percentage_Incentive" ng-keydown="SetIAmount()" ng-keyup="SetIAmount()" ng-disabled="disabled" />
                          
                           <input type="text" class="form-control number" style="width:65%" ng-model="ExportIncentive.Amount_Realized_PVST" disabled>
                       </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Is Signatory?</label></div>
                    <div class="col-md-2 text-left"> <input type="checkbox" ng-model="ExportIncentive.IsCopyTo" class="checkbox"> </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-primary" ng-click="PrintIncentive()">Preview</button></div>
                </div>
            </fieldset>
            @*PRC*@
            <fieldset>
                @*<legend>PRC</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">PRC Collect Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.PRCDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_PRC" ng-disabled="disabled" />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Collect By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.PRCCollectByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(1)">Update</button></div>
                </div>
            </fieldset>
          
            @*BTMA*@
            <fieldset>
                @*<legend>BTMA</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">BTMA Issue Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.BTMAIssueDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_BTMA" ng-disabled="disabled" />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Collect By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.BTMAIssueByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(3)">Update</button></div>
                </div>
            </fieldset>
            @*BANK SUB*@
            <fieldset>
                @*<legend>BankSub</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Bank Sub Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.BankSubDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_BankSub" ng-disabled="disabled" />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Collect By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.BankSubByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(6)">Update</button></div>
                </div>
            </fieldset>
            @*Audit*@
            <fieldset>
                @*<legend>Audit</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Audit Cert Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.AuditCertDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-3 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_Audit" ng-disabled="disabled" />
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Collect By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.AuditCertByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(4)">Update</button></div>
                </div>
            </fieldset>
            @*Realized*@
            <fieldset>
                @*<legend>Realized</legend>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Realized Date</label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group date date-container" style="width:80%">
                            <input type="text" class="form-control" ng-model="ExportIncentive.RealizedDateST" ng-init="initializeDatepicker()" ng-disabled="disabled"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-md-2 text-right"><label class="control-label">Realized Amount </label></div>
                    <div class="col-md-3 text-left">
                        <div class="input-group">
                            <select style="width:35%; font-weight:bold; font-size:11px" class="form-control" ng-model="ExportIncentive.CurrencyID_Real" ng-options="item.CurrencyID as item.Symbol for item in Currencys" ng-disabled="cboDisabled">
                                <option value="">-Select--</option>
                            </select>
                            <input class="form-control number" style="width:65%" ng-model="ExportIncentive.Amount_Realized" />
                        </div>
                    </div>
                   
                    <div class="col-md-2 text-right"><label class="control-label">Collect By:</label></div>
                    <div class="col-md-2 text-left">
                        <input class="form-control" ng-model="ExportIncentive.RealizedByName" disabled />
                    </div>
                    <div class="col-md-2 text-right"><button class="form-control btn btn-sm btn-success" ng-click="Update(5)">Update</button></div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right"><label class="control-label">Remarks:</label></div>
                    <div class="col-md-10 text-left">
                        <input class="form-control" ng-model="ExportIncentive.Remarks_Realized" ng-disabled="disabled" />
                    </div>
                </div>
            </fieldset>
        </div>

        <div style="height:9%; ">
            <fieldset style="position:relative">
                <legend>Action</legend>
                <div class="col-md-12 text-right">
                    @*<button type="button" class="btn btn-sm" aria-label="Left Align" ng-click="save_Revise()" ng-hide="hide_Revise"> <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"> Save(Revise)</span> </button>
                        <button type="button" class="btn btn-sm" aria-label="Left Align" ng-click="Approve()" ng-hide="hide_Approve"> <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"> Approve</span> </button>*@
                    @*<button type="button" class="btn btn-success btn-sm" aria-label="Left Align" ng-click="save()" ng-hide="hide_Save"> <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true">Save</span> </button>*@
                    <button type="button" id="btnClose" class="btn btn-danger btn-sm" aria-label="Left Align" ng-click="Close()"> <span class="glyphicon glyphicon-remove" aria-hidden="true"> Close</span> </button>
                </div>
            </fieldset>
        </div>
    </div>
</div>

<style type="text/css">
    .grid {
        width: 100%;
        height: 160px;
    }

    .regionExportIncentive .form-horizontal .control-label {
        padding-top: 3px;
    }

    .regionExportIncentive .form-control {
        height: 26px;
        padding: 0px 6px;
        font-size: 12px;
    }
    .MessageBoxDesign{
		    background: green;
            font-size:15px;
            font-weight:bold;

    }
	.MessageBoxDesign .panel-title{
        font-size:15px;
        font-weight:bold;
		color:#fff;
	}


    .regionExportIncentive .col-md-12 {
        width: 100%;
        padding-right: 5px;
        padding-left: 5px;
        margin-bottom: 5px;
    }

    .regionExportIncentive .col-md-2 {
        width: 11%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionExportIncentive .col-md-3 {
        width: 22%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionExportIncentive .col-md-4 {
        width: 35%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionExportIncentive .col-md-5 {
        width: 40%;
        padding-right: 5px;
        padding-left: 0px;
    }

    .regionExportIncentive .col-md-10 {
        width: 77%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionExportIncentive .btn-sm {
        padding: 3px 10px;
    }

    .regionExportIncentive .input-group-addon {
        padding: 4px 8px;
    }

    #progressbarParent {
        opacity: 0.8;
        background-color: #ffffff /*#DCD9D4*/;
        position: fixed;
        width: 100%;
        height: 100%;
        top: 0px;
        left: 0px;
        z-index: 1000;
    }
</style>

<script type="text/javascript">

    var _nBUID=0;
    _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
    var oExportIncentive =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
    debugger;
    var oExportBills =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExportBills));
    var oCurrencys =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
    @*var oExportIncentive =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExportIncentive));
    var oBusinessUnits =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));*@

    sessionStorage.setItem('BaseAddress',_sBaseAddress);
    _nBUID =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
    var ExportIncentiveModule = angular.module('ExportIncentiveAPP', ['ngAnimate', 'ui.bootstrap', 'ui.bootstrap.datetimepicker','ui.grid', 'ui.grid.selection','ui.grid.resizeColumns', 'ui.grid.edit','ms.service']);
    ExportIncentiveModule.controller('ExportIncentiveCtrl', function ($scope, $http, $uibModal, $log, uiGridConstants, msModal, userSession, advanceSearch) {

        $scope.initializeDatepicker  =function(){
            $('.date-container').datepicker({
                format: "dd M yyyy",
                calendarWeeks: true,
                autoclose: true,
                todayHighlight: true
            });
        }

        sessionStorage.removeItem("MasterLCNo");
        sessionStorage.setItem("MasterLCNo",oExportIncentive.MasterLCNo);

        $scope.ExportIncentive=oExportIncentive;
        debugger;

        $scope.ExportBills=oExportBills;
        $scope.Currencys=oCurrencys;
        if($scope.ExportIncentive.CurrencyID_Real==0){
            $scope.ExportIncentive.CurrencyID_Real=1;
        }
        userSession.setData('ExportIncentives',oExportIncentive);

        var oDetailColumns = [];
        var oColumn = null;
        oColumn = {name: ' ',width:'3%', cellTemplate: '<div style="padding-top:5px;"><span>{{grid.renderContainers.body.visibleRowCache.indexOf(row)+1}}</span></div>',cellClass: 'text-center', enableCellEdit: false, enableSorting:false, enableColumnResizing:false, enableColumnMenu:false};oDetailColumns.push(oColumn);
        oColumn ={ field: 'LDBCNo', name:'LDBCNo', width:'30%',enableCellEdit:false };oDetailColumns.push(oColumn);
        oColumn ={ field: 'Amount', name: 'Amount', cellClass: 'text-right',width: '10%' , cellFilter: 'number: 2', aggregationType: uiGridConstants.aggregationTypes.sum, aggregationHideLabel: true,  type: 'number', enableCellEdit:false,footerCellClass: 'text-right' ,footerCellFilter: 'number:0'};oDetailColumns.push(oColumn);
        oColumn ={ field: 'StateSt', name:'State', width:'10%',enableCellEdit:true };oDetailColumns.push(oColumn);
        //DD.LDBCNo, DD.Amount, DD.[State], DD.LDBCDate, DD.MaturityDate, DD.RelizationDate, DD.OverDueRate
        oColumn ={ field: 'LDBCDateSt', name:'LDBCDate', width:'10%',enableCellEdit:true };oDetailColumns.push(oColumn);
        oColumn ={ field: 'MaturityDateSt', name:'MaturityDate', width:'10%',enableCellEdit:true };oDetailColumns.push(oColumn);
        oColumn ={ field: 'RelizationDateSt', name:'RelizationDate', width:'10%',enableCellEdit:true };oDetailColumns.push(oColumn);
        oColumn ={ field: 'OverDueRate', name:'Time Lag', width:'10%',enableCellEdit:true };oDetailColumns.push(oColumn);

        $scope.gridOptions = {
            showColumnFooter: true,
            enableFullRowSelection: true,
            enableColumnResizing: true,
            enableSelectAll: false,
            multiSelect:false,
            enableHorizontalScrollbar: uiGridConstants.scrollbars.NEVER,
            columnDefs:oDetailColumns,
            data:$scope.ExportBills,
            onRegisterApi: function (gridApi) {
                $scope.gridDetailApi = gridApi;
                gridApi.edit.on.afterCellEdit($scope,
                    function (rowEntity, colDef, newValue, oldValue)
                    {
                        debugger;
                        rowEntity.Amount=rowEntity.Qty*rowEntity.UnitPrice;
                        //$scope.SetTotal();
                        return rowEntity;
                    });
            }
        };
              
        $scope.SetIAmount=function()
        {
            $scope.ExportIncentive.Amount_Realized_PVST= $scope.ExportIncentive.CurrencySymbol+ formatPrice($scope.ExportIncentive.Amount* (parseFloat($scope.ExportIncentive.Percentage_Incentive)/100))
        }

        $scope.PrintIncentive=function()
        {
            if($scope.ExportIncentive.ApplicationBy==0){
                alert("Sorry, Application Date Is Not Updated Yet!!");return false;
            }


            var oElementList = [{ DisplayName: ["Authorized Signatoy?"],  BOField: ["IsAuthorized"],   InputType: 'bool'}];

            var modalObj={
                size:'sm',
                title:"Print Incentive",
                url:_sBaseAddress+'/Home/AdvanceSearch',
                HtmlElements:oElementList,
                isAdvanceSearch:false
            }

            var modalInstance=advanceSearch.Instance(modalObj);
            modalInstance.result.then(function (result)
            {
                console.log(result);
                if($scope.ExportIncentive.ExportIncentiveID>0)    
                    window.open(_sBaseAddress+ "/ExportIncentive/PrintIncentive?id="+$scope.ExportIncentive.ExportIncentiveID+"&Authorized="+(result.IsAuthorized?1:2)+"&nBUID="+1,"_blank&");
            }, function ()
            {
                $log.info('Modal dismissed at: ' + new Date());
            });

           
        }
        $scope.Update=function(nOpt)
        {
            debugger;
            if(!$scope.ValidateInput(nOpt)) return;
            var oExportIncentive=$scope.ExportIncentive;
            oExportIncentive.UpdateOperation=nOpt;

            oExportIncentive.PRCDate=new Date($scope.ExportIncentive.PRCDateST);
            oExportIncentive.ApplicationDate=new Date($scope.ExportIncentive.ApplicationDateST);
            oExportIncentive.BTMAIssueDate=new Date($scope.ExportIncentive.BTMAIssueDateST);
            oExportIncentive.AuditCertDate=new Date($scope.ExportIncentive.AuditCertDateST);
            oExportIncentive.RealizedDate=new Date($scope.ExportIncentive.RealizedDateST);
            oExportIncentive.BankSubDate=new Date($scope.ExportIncentive.BankSubDateST);

            $http.post(sessionStorage.getItem('BaseAddress')+'/ExportIncentive/Update_Incentive',oExportIncentive).then(
                  function (response)
                  {
                      var oExportIncentive= jQuery.parseJSON(response.data);
                      if (oExportIncentive.ErrorMessage=="" || oExportIncentive.ErrorMessage==null)
                      {
                          //if(nOpt==1)
                          //    alert("PRC Successfully Updated!!");
                          //else if(nOpt==2)
                          //    alert("Application Successfully Updated!!");
                          //else if(nOpt==3)
                          //    alert("BTMA Successfully Updated!!");
                          //else if(nOpt==4)
                          //    alert("AuditCert Successfully Updated!!");
                          //else if(nOpt==5)
                          //    alert("Realizetion Successfully Updated!!"); 
                          //else if(nOpt==6)
                          //     alert("Bank Submission Successfully Updated!!");

                          if(nOpt==1)
                          {
                              var win = $.messager.show({title:'Notification',msg:'PRC Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          else if(nOpt==2)
                          {
                              var win = $.messager.show({title:'Notification',msg:'Application Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          else if(nOpt==3)
                          {
                              var win = $.messager.show({title:'Notification',msg:'BTMA Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          else if(nOpt==4)
                          {
                              var win = $.messager.show({title:'Notification',msg:'AuditCert Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          else if(nOpt==5)
                          {
                              var win = $.messager.show({title:'Notification',msg:'Realizetion Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          else if(nOpt==6)
                          {
                              var win = $.messager.show({title:'Notification',msg:'Bank Submission Successfully Updated!!',timeout:2000,showType:'slide'});
                              win.window('window').addClass('MessageBoxDesign');
                          }
                          oExportIncentive.MasterLCNo=sessionStorage.getItem("MasterLCNo");
                          userSession.setData('ExportIncentives',oExportIncentive);
                          $scope.ExportIncentive=oExportIncentive;
                      }
                      else
                      {
                          alert(oExportIncentive.ErrorMessage);
                      }
                  },
                      function (response) { debugger; alert(response.statusText)}
              );
        }
        $scope.ValidateInput = function(nOpt)
        {
            debugger;
            if(nOpt==1)
            {
                if($scope.ExportIncentive.PRCDate==0){
                    alert("Sorry, Application Date Is Not Updated Yet!!");return false;
                }
            }
            else if(nOpt==2)
            {
                if($scope.ExportIncentive.Percentage_Incentive<=0){
                    alert("Sorry, Incentive Percentage should be greater than zero!!");return false;
                }
            }
            else if(nOpt==3)
            {
                if($scope.ExportIncentive.PRCCollectBy==0){
                    alert("Sorry, PRC Date Is Not Updated Yet!!");return false;
                }
            }
            else if(nOpt==6)
            {
                if($scope.ExportIncentive.BTMAIssueBy==0){
                    alert("Sorry, BTMA Issue Date Is Not Updated Yet!!");return false;
                }
            }
            else if(nOpt==4)
            {
                if($scope.ExportIncentive.BankSubBy==0){
                    alert("Sorry, Bank Submission Date Is Not Updated Yet!!");return false;
                }
            }
            else if(nOpt==5)
            {
                if($scope.ExportIncentive.AuditCertBy==0){
                    alert("Sorry, AuditCert Date Is Not Updated Yet!!");return false;
                }
                if($scope.ExportIncentive.Amount_Realized==0){
                    alert("Sorry, Realized Amount Should Be Greater Than Zero!!");return false;
                }
            }
            return true;
        }
        if(sessionStorage.getItem("ExportIncentiveHeader")=="View ExportIncentive")
        {
            debugger;
            $("#divCC :input").prop('disabled', true);
            $('#btnClose').prop('disabled', false);
        }
        $scope.Close = function()
        {
            debugger;
            window.location.href = sessionStorage.getItem("BackLink");
        }
        $scope.keydown = function(e)
        {
            if(e.which == 27)//escape=27
            {
                window.location.href = sessionStorage.getItem("BackLink");
            }
        }
    });

</script>