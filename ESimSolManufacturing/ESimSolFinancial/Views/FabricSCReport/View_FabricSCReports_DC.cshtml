@model IEnumerable<ESimSol.BusinessObjects.FabricSCReport>
    @{
        ViewBag.Title = "PO Register";
    }


    <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progressbar" style="width:100%;height:37px;"></div>
        </div>
    </div>

    <div class="menuMainCollectionTable">
        <table id="tblFabricSCReports" title="Production Order(s)" class="easyui-datagrid" style="width:100%; height:100%" singleselect="true" data-options="fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarFabricSCReport', onLoadSuccess: onLoadSuccess">
            <thead>

            <th field="SCNoFull" width="11%" align="left">PO No</th>
            <th field="SCDateSt" width="6%" align="center">PO Issue Date</th>
            @*<th field="OrderTypeSt" width="10%" align="center"> Order Type</th>*@
            <th field="BuyerName" width="15%" align="left">Buying House</th>
            <th field="ContractorName" width="12%" align="left">Issue To</th>
            <th field="MKTGroup" width="8%" align="left"> MKT Team</th>
            <th field="MKTPName" width="8%" align="left"> Concern Person</th>
            <th field="OrderTypeSt" width="8%" align="center"> Order Type</th>

            <th field="CurrentStatusSt" width="6%" align="left"> Status</th>
            <th field="PINo" width="10%" align="left">PI No</th>
            @*<th field="PIDateSt" width="10%" align="left"> PI Date</th>
                <th field="LCNo" width="10%" align="left">L/C No</th>
                @*<th field="PIDateSt" width="20%" align="left"> Status</th>*@
            @*<th field="LCStatusSt" width="5%" align="left"> L/C Status</th>*@

            <th field="FabricNo" width="10%" align="left"> MKT Ref</th>
            <th field="Qty" formatter="formatPrice" width="8%" align="right">PO Qty(Y)</th>
            <th field="UnitPrice" formatter="formatPrice" width="6%" align="right">Unit Price</th>
            <th field="AmountSt" width="8%" align="right">Amount</th>
            <th field="Qty_PI" formatter="formatPrice" width="8%" align="right">Qty PI(Y)</th>
            <th field="Qty_PIBal" formatter="formatPrice" width="8%" align="right">Yet To PI(Y)</th>
            <th field="HLReference" width="10%" align="left"> H/L Ref</th>
            <th field="ExeNo" width="10%" align="left"> Dispo No</th>
            @*<th field="HLReference" width="10%" align="left"> Approval Ref.</th>*@
            <th field="Construction" width="10%" align="left"> Construction</th>
            <th field="ProductName" width="10%" align="left">Composition</th>
            <th field="Size" width="10%" align="left"> Size</th>
            <th field="FinishTypeName" width="10%" align="left">Finish Type</th>
            <th field="ColorInfo" width="10%" align="left"> Color</th>
            <th field="FabricWidth" width="15%" align="left">Width</th>
            <th field="FabricDesignName" width="10%" align="left">FabricDesignName</th>
            <th field="DeliveryDate_PPSt" width="10%" align="left">PP Sample Delivery Date</th>
            <th field="Qty_DO" formatter="formatPrice" width="10%" align="left">DO Qty(Y)</th>
            <th field="Qty_DC" formatter="formatPrice" width="10%" align="left">Delivery Qty(Y)</th>


            @*<th field="ExeNo" width="10%" align="left"> Dispo No</th>*@
            <th field="AttCount" width="8%">Attachment Count</th>

            </thead>
        </table>

        <div id="toolbarFabricSCReport">
            <input id="txtSearchbyPONo" type="text" placeholder="Search by PO No" style="width:120px" />
            <input id="txtSearchbyFabricNo" type="text" placeholder="Search by P No" style="width:120px" />
            Date :
            <input id="txtStartDate" type="text" style="width: 95px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
            To
            <input id="txtEndDate" type="text" style="width: 95px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                <a id="btnSearchByDate" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
            @*<a id="btnAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>*@
            @*<a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
                <a id="btnPartyWisePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print(Party Wise) </a>
                <a id="btnProductWisePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print(Product Wise) </a>*@
            <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">ExportXL</a>
        </div>
    </div>
    <div id="winAdvSearch" class="easyui-window winClass" style="width:620px" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div>
            <fieldset style="margin-bottom: 0px;">
                <legend>Searching Criteria</legend>
                <table style="width:100%;text-align:right;">
                    <tr>
                        <td style="width:20%;text-align:right;">
                            <label>P/I No :</label>
                        </td>
                        <td style=" width:30%;text-align:left;">
                            <input id="txtPINo" style="width:100%;" type="text" />
                        </td>
                        <td style=" width:20%;text-align:right;">
                            <label id="lblFabricAdv">Fabric No :</label>:
                        </td>
                        <td style=" width:30%;text-align:left;">
                            <input id="txtFabricID" style="width:80%;" type="text" />
                        </td>
                    </tr>

                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Issue To :</label>
                        </td>
                        <td colspan="3" style=" width:80%;text-align:left;">
                            <input id="txtContractorAdvS" style="width:80%;" type="text" placeholder="Type & Press Enter" />
                            <a id="btnPickContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnClrContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                        </td>
                    </tr>

                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Buying House :</label>
                        </td>
                        <td colspan="3" style=" width:80%;text-align:left;">
                            <input id="txtDeliverTo" style="width:80%;" type="text" placeholder="Type & Press Enter" />
                            <a id="btnPickDeliverTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnClrDeliverTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                        </td>
                    </tr>
                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Mkt Account:</label>
                        </td>
                        <td colspan="3" style=" width:80%;text-align:left;">
                            <input id="txtMktAccount" class="reset-text" placeholder="Search Concern Person" style="width:80%" />
                            <a id="btnPickMktAccount" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnResetMktPerson" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                        </td>
                    </tr>
                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>PO Date:</label>
                        </td>
                        <td colspan="3" style=" width:80%;text-align:right;">
                            <table style=" width:100%;text-align:left;">
                                <tr>
                                    <td style=" width:100%;text-align:left;">
                                        <select style="width:30%;" id="cboPODate" onchange="DateActions_OPDate(); "></select>
                                        <input id="txtFromPODate" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                        <input id="txtToPODate" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Approve Date:</label>
                        </td>
                        <td colspan="3" style=" width:80%;text-align:right;">
                            <table style=" width:100%;text-align:left;">
                                <tr>
                                    <td style=" width:100%;text-align:left;">
                                        <select style="width:30%;" id="cboApproveDate" onchange="DateActions_ApproveDate(); "></select>
                                        <input id="txtFromApproveDate" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                        <input id="txtToApproveDate" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Production Type:</label>
                        </td>
                        <td style=" width:30%;text-align:left;">
                            <select id="cboProductionType" style="width:90%;"><option value="0">All</option><option value="1">In House</option><option value="2">Sub Contract</option></select>
                        </td>
                        <td style=" width:20%;text-align:right;">
                            <label>Print PO:</label>
                        </td>
                        <td style=" width:30%;text-align:left;">
                            <select style="width:80%;" id="cboIsPrinting">
                                <option value="0">Default</option>
                                <option value="1">Print</option>
                                <option value="2">Not Print</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td style=" width:20%;text-align:right;">
                            <label>Order Type : </label>
                        </td>
                        <td colspan="3" style="width:95%;text-align:left;">
                            <div style="margin-top: 2px;">
                                <table style="width:100%; height: 150px;">
                                    <tr>
                                        <td style="width:50%;">
                                            <table id="tblOrderTypes" class="easyui-datagrid" title="" style="width:95%; height: 150px;" data-options="singleSelect: false,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, ">
                                                <thead>
                                                    <tr>
                                                        <th data-options="field:'Selected',checkbox:true"></th>
                                                        <th field="Value" width="80%"></th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </td>
                                        <td style="width:50%;">
                                            <table id="tblCurrentStatuss" class="easyui-datagrid" title="" style="width:95%; height: 150px;" data-options="singleSelect: false,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, ">
                                                <thead>
                                                    <tr>
                                                        <th data-options="field:'Selected',checkbox:true"></th>
                                                        <th field="Value" width="80%"></th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </td>
                                    </tr>
                                </table>


                            </div>
                        </td>
                    </tr>
                    

                </table>
            </fieldset>

            <fieldset>
                <legend>Actions : </legend>
                <table style="width:100%;text-align:right;">
                    <tr>
                        <td style="width:20%;text-align:right;">

                            <a id="btnResetAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>

                        </td>
                        <td style="width:80%;text-align:right;">
                            <label class="lblLoadingMessage" style="float: left;">Loading Please Wait...</label>
                            <a id="btnSearchAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
                            <a id="btnCloseAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>

            </fieldset>
        </div>
    </div>
    <div id="winExeEntry" class="easyui-window" title="Dispo No" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:true">

        <div>

            <div style="margin-left:0px; margin-top:0px">
                <table cellpadding="2" cellspacing="2" style="width:100%;">
                    <tr>
                        <td style="width:15%;text-align:right">
                            PO No:
                        </td>

                        <td style="width:20%">
                            <input type="text" id="txtSCNo_ExC" style="width:100%" disabled="disabled" />
                        </td>
                        <td style="width:20%;text-align:right">
                            Order Type:
                        </td>
                        <td style="width:20%">
                            <input type="text" id="txtOrderType" style="width:100%" disabled="disabled" />
                        </td>
                        <td style="width:25%;text-align:right"></td>

                    </tr>

                    <tr>
                        <td style="width:15%;text-align:right">
                            Issue To:
                        </td>

                        <td colspan="3" style="width:60%;text-align:left">
                            <input type="text" style="width:100%;" id="txtContractor_EXC" disabled="disabled" />
                        </td>
                        <td style="width:25%;text-align:right"></td>
                    </tr>
                </table>
                <table id="tblFSCDetails" title="Fabric Description" class="easyui-datagrid" style="width:100%;height:298px;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarOne" data-options="onClickRow: onClickRow">
                    <thead>
                        <tr>

                            <th field="IsProductionSt" width="6%" align="left"></th>
                            <th field="ProductName" width="12%" align="left">Composition</th>
                            <th field="FabricNo" width="10%" align="left">Mkt. Ref. No</th>
                            <th field="Construction" width="10%">Construction</th>
                            <th data-options="field:'ExeNo',width:180,height:60 ,align:'Left',editor:{type:'text'}" align="Left">Dispo No</th>
                            <th field="Qty" formatter="formatPrice" width="8%" align="right">Qty (Y)</th>
                            <th field="QtyTwo" formatter="formatPrice" width="8%" align="right">Qty (M)</th>
                            <th field="FabricWidth" width="10%">Fabric Width</th>
                            <th field="StyleNo" width="10%">Style No</th>
                            <th field="BuyerReference" width="10%">Buyer Ref</th>
                            <th field="ColorInfo" width="10%">Buyer Ref</th>
                            <th field="DesignPattern" width="10%">Design&Pattern</th>
                            <th field="Note" width="10%">Note</th>



                        </tr>
                    </thead>
                </table>
                <div id="toolbarOne">
                    <a id="btnRefresh" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Refresh</a>
                </div>
                <table id="tblTotalSumFSCDetails" style="width:100%;font-size:11px; font-weight:bold" border="0">
                    <tr>
                        <td id="tdTotalCaption" style="width: 40%; text-align: right; font-size: 12px; font-weight:bold"></td>
                        <td id="tdTotalCaption" style="width: 10%; text-align: right; font-size: 12px; font-weight:bold"> Total : </td>
                        <td style="width: 15%; text-align: right; font-size: 12px">
                            <label id="lblTotalQty" style="text-align: right; font-size:12px; float: right; font-weight:bold;">0.00</label>
                        </td>
                        <td style="width: 15%; text-align: right; font-size: 12px"></td>
                        <td id="tdTotalCaption" style="width: 20%; text-align: right; font-size: 12px; font-weight:bold">  </td>
                    </tr>
                </table>
            </div>
        </div>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnSaveExeNo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
            <a id="btnCloseExeNo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <style type="text/css">
        .lines-no .datagrid-body td {
            border-right: 1px dotted transparent;
            border-bottom: 1px dotted transparent;
        }
    </style>

    <script type="text/javascript">
        var _sBaseAddress="";
        var _oFabricSCReport=null;
        var _oFabricSCReports=[];
        var _oBankBranchs=[];
        var _oCurrencys=[];
        var _oLCTerms=[];
        var _oCompanys=[];
        var _oLCTerms=[];
        var _oCompareOperators=[];
        var _oPaymentInstructions=[];
        var _oFabricPOStatus = [];
        var _oOrderTypes=[];
        var _nBUID = 0;
        var _sContractorIds = '';
        var _sBuyerIds = '';
        var _sMAccountIds='';
        var _oBU = null;
        var _nReportType=0;
        var _sProductIds="";
        $(document).ready(function () {

            _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            _oFabricSCReports =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _oCurrencys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
            _oLCTerms = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.LCTerms));
            _oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
            _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
            _oPaymentInstructions = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PaymentInstructions));
            var oAuthorizationRolesMapping = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
            _oOrderTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.OrderTypes));
            _oFabricPOStatus = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricPOStatus));
            var oAuthorizationRolesMapping = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
            RefreshControlLayout(oAuthorizationRolesMapping);
            var oCellRowSpans = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.CellRowSpans));
            var oFabricPOSetup = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricPOSetup));
            $('#tblFabricSCReports').data('FDPs',_oFabricSCReports);
            $('#tblFabricSCReports').data('CellRowSpan',oCellRowSpans);
            DynamicRefreshList(_oFabricSCReports,'tblFabricSCReports');
           
            // DynamicRefreshList([], 'tblFabricSalesContracts');
            RefreshSetup(oFabricPOSetup);
            //$("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch").datebox({ disabled: false });
            //$("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
            //$("#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch").datebox({ disabled: false });
            //$("#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
            debugger;
            //$("#tblCurrentStatusAdvSearch").datagrid("checkAll");
            $("#progressbar").progressbar({ value: 0 });
            $("#progressbarParent").hide();
            $(".lblLoadingMessage").hide();
            LoadComboAdv();
            debugger;
            RefreshDate()
        });
        function RefreshSetup(oFabricPOSetup)
        {
            $('#lblFabricAdv').html(oFabricPOSetup.FabricCode);
            $("#txtSearchbyFabricNo").attr("placeholder","Type "+oFabricPOSetup.NoCode+" Number & Press Enter");
        }
        function RefreshControlLayout(oAuthorizationRolesMapping)
        {
            $("#tblFabricSCReports").datagrid("hideColumn", "UnitPrice");
            $("#tblFabricSCReports").datagrid("hideColumn", "AmountSt");
            if (PermissionChecker('RateView', 'FabricPO',oAuthorizationRolesMapping))
            {
                $("#tblFabricSCReports").datagrid("showColumn", "UnitPrice");
                $("#tblFabricSCReports").datagrid("showColumn", "AmountSt");
            }

        }

        $(document).keydown(function (e) { if (e.keyCode == 27) { $('div').icsWindow('close'); } });

        function RefreshDate()
        {
            $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
            $('#txtEndDate').datebox('setValue', icsdateformat(new Date()));
        }


        $("#btnPrint").click(function () {

            var sParams=sessionStorage.getItem("ParamsP");
            window.open(_sBaseAddress + '/FabricSCReport/Print_SampleOrderReport?sTempString=' + sParams, "_blank");
        });

        $("#btnPrintXL").click(function ()
        {
            var sTempString = $.trim($("#txtPINo").val()) + '~'
                            + $.trim($("#txtFabricID").val()) + '~'
                            + "" + '~'
                            + "" + '~'
                            + "" + '~'
                            + 5 + '~'
                            + $("#txtStartDate").datebox("getValue") + '~'
                            + $("#txtEndDate").datebox("getValue") + '~'
                            + 0 + '~'
                            + "" + '~'
                            + "" + '~'
                            + 0 + '~'
                            + 0 + '~'
                            + ""  + '~'
                            + ""  + '~'
                            + _nBUID + '~'
                            + "" + '~'+ 0

            var sSearchString=sessionStorage.getItem("ParamsP");
            if(sSearchString==null){ sSearchString=sTempString; }

            window.open(_sBaseAddress + '/FabricSCReport/Print_ReportXL_DC?sTempString=' + sTempString+"&BUID="+_nBUID, "_blank");
        });



        ////Start adv Searching

        function updateProgress() {
            var value =$('#progressbar').progressbar('getValue');
            if (value < 96){
                value += Math.floor(Math.random() * 10);
                $('#progressbar').progressbar('setValue', value);
            }
        }
        function hideShow(miliseconds) {
            $("#progressbarParent").hide();
        }
        //Account Of Picker

        $("#txtContractorAdvS").keydown(function (e) {
            if (e.keyCode === 13) // Enter Press
            {
                PickContractors_AdvS();
            }
            else if (e.keyCode === 08) {
                $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
                _sContractorIds = '';
            }
        });

        $("#btnClrContractorAdvS").click(function () {
            $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
            $("#txtContractorAdvS").val("");
            _sContractorIds = '';
        });

        $("#btnPickContractorAdvS").click(function () {
            PickContractors_AdvS();
        });
        function PickContractors_AdvS() {
            var oContractor = {
                Params: '2,3' + '~' + $.trim($("#txtContractorAdvS").val()+"~"+_nBUID)
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oContractor,
                ControllerName: "Contractor",
                ActionName: "ContractorSearchByNameType",
                IsWinClose: false
            };

            $("#progressbar").progressbar({ value: 0 });
            $("#progressbarParent").show();
            var intervalID = setInterval(updateProgress, 250);

            DynamicRefreshList([], "tblAccountsPickerAdvSearch");
            $.icsDataGets(obj, function (response) {
                clearInterval(intervalID);
                $("#progressbarParent").hide();
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].ContractorID > 0) {
                        var tblColums = []; var oColumn = { field: "ContractorID", title: "Code", width: 50, align: "left" }; tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 280, align: "left" }; tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winContractorPicker',
                            winclass: 'clsAccountOf',
                            winwidth: 400,
                            winheight: 460,
                            tableid: 'tblAccountOfs',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName: 'Name',
                            windowTittle: 'Contactor List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);
                    }
                    else {
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else {
                    alert("Sorry, No Contactor Found.");
                }
            });
        }
        //End Account Of Picker
        $("#btnClrDeliverTo").click(function () {
            $("#txtDeliverTo").val("");
            _sBuyerIds="";
        });

        $("#btnPickDeliverTo").click(function () {

            var oContractor = {
                Params: '2,3' + '~' + $.trim($("#txtDeliverTo").val()+'~'+_nBUID)
            };
            GetDeliverTo(oContractor);
        });

        $("#txtDeliverTo").keydown(function (e) {
            var nkeyCode = e.keyCode || e.which;
            if(nkeyCode==13){
                var sContractorName=$.trim($("#txtDeliverTo").val());
                if(sContractorName=="" || sContractorName==null)
                {
                    alert("Please, Type name or part of Name");
                    $("#txtDeliverTo").focus();
                    $("#txtDeliverTo").addClass("errorFieldBorder");
                    return;
                }
                var oContractor = {
                    Params: '2,3' + '~' + $.trim($("#txtDeliverTo").val()+'~'+_nBUID)
                };
                GetDeliverTo(oContractor);
            }
            else if(nkeyCode==8){
                $("#txtDeliverTo").val("");
                _sBuyerIds="";

            }
        });

        function GetDeliverTo(oContractor){


            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oContractor,
                ControllerName: "Contractor",
                ActionName: "ContractorSearchByNameType",
                IsWinClose: false
            };
            $("#progressbar").progressbar({ value: 0 });
            $("#progressbarParent").show();
            var intervalID = setInterval(updateProgress, 250);
            $.icsDataGets(obj, function (response) {
                clearInterval(intervalID);
                $("#progressbarParent").hide();
                if (response.status && response.objs.length > 0)
                {
                    if (response.objs[0].ContractorID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "ContractorID", title: "Code", width: 50, align: "center" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 190, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Phone", title: "Phone", width: 140, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winDeliverToPicker',
                            winclass:'clsDeliverToPicker',
                            winwidth: 460,
                            winheight: 460,
                            tableid: 'tblDeliverToPicker',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'Deliver To List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
                else{
                    alert("No contractor found.");
                }
            });
        }

        $("#btnResetMktPerson").click(function () {

            $("#txtMktAccount").val("");
            _sMAccountIds="";
        });

        $("#btnPickMktAccount").click(function () {
            debugger;
            var sName=$.trim($("#txtMktAccount").val());
            GetMktPersons(sName);
        });

        $("#txtMktAccount").keydown(function (e) {
            var nkeyCode = e.keyCode || e.which;
            if(nkeyCode==13){
                var sName=$.trim($("#txtMktAccount").val());
                if($('#txtMktAccount').val()==null || $('#txtMktAccount').val()=="")
                {
                    alert("Please Type Name or part Name and Press Enter.");
                    $('#txtMktAccount').focus();
                    return;
                }
                GetMktPersons(sName);
            }
            else if(nkeyCode==8){
                $("#txtMktAccount").val("");
                _sMAccountIds="";
            }
        });
        function GetMktPersons(sName){

            var oMarketingAccount_BU = {
                Name:sName,
                BUID:sessionStorage.getItem("BUID")
            };
            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oMarketingAccount_BU,
                ControllerName: "MarketingAccount",
                ActionName: "MarketingAccountSearchByNameAndGroup",
                IsWinClose: false
            };

            $.icsDataGets(obj, function (response) {

                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].MarketingAccountID > 0) {
                        debugger;
                        var tblColums = [];
                        var oColumn = { field: "MarketingAccountID", title: "Code", width: 50, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Name", title: "Name", width: 180, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "GroupName", title: "GroupName", width: 120, align: "left" };tblColums.push(oColumn);
                        oColumn = { field: "Phone", title: "Phone", width: 100, align: "left" };tblColums.push(oColumn);

                        var oPickerParam = {
                            winid: 'winMktAccount',
                            winclass:'clsMktPersonPicker',
                            winwidth: 460,
                            winheight: 460,
                            tableid: 'tblMktPersonPicker',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName:'Name',
                            windowTittle: 'MKT Person List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbutton(oPickerParam);//multiplereturn, winclassName
                    }
                    else { alert(response.objs[0].ErrorMessage); }
                }
                else{
                    alert("No marketing person found.");
                }
            });


        }
        //End Pick Mkt

        function IntializePickerbutton(oPickerobj) {
            $("#" + oPickerobj.winid).find("#btnOk").click(function () {
                SetPickerValueAssign(oPickerobj);
            });
            $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
                if (e.which === 13) {
                    SetPickerValueAssign(oPickerobj);
                }
            });
        }

        function SetPickerValueAssign(oPickerobj) {
            var oreturnObj = null, oreturnObjs = [];
            if (oPickerobj.multiplereturn) {
                oreturnObjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
            } else {
                oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
            }

            if (oPickerobj.winid == 'winContractorPicker')
            {
                if (oreturnObjs != null && oreturnObjs.length> 0)
                {

                    _sContractorIds=''; var sMessage='';
                    sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Contractors Selected" : oreturnObjs[0].Name;
                    $('#txtContractorAdvS').val(sMessage);
                    $("#txtContractorAdvS").addClass("fontColorOfPickItem");

                    for(var i=0;i<oreturnObjs.length;i++){
                        _sContractorIds=_sContractorIds+oreturnObjs[i].ContractorID+',';
                    }
                    _sContractorIds=_sContractorIds.substring(0,_sContractorIds.length-1);

                }
                else
                {
                    alert("Please select a contractor.");
                    return false;
                }
            }

            else if (oPickerobj.winid == 'winDeliverToPicker')
            {
                if (oreturnObjs != null && oreturnObjs.length> 0)
                {
                    var sMessage='';
                    _sBuyerIds="";
                    sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Buying House(s) Selected" : oreturnObjs[0].Name;
                    $('#txtDeliverTo').val(sMessage);
                    $("#txtDeliverTo").addClass("fontColorOfPickItem");

                    for(var i=0;i<oreturnObjs.length;i++){
                        _sBuyerIds=_sBuyerIds+oreturnObjs[i].ContractorID+',';
                    }
                    _sBuyerIds=_sBuyerIds.substring(0,_sBuyerIds.length-1);

                }
                else
                {
                    alert("Please select a Buying House.");
                    return false;
                }
            }
            else if (oPickerobj.winid == 'winMktAccount')
            {
                if (oreturnObjs != null && oreturnObjs.length> 0)
                {
                    var sMessage='';
                    _sMAccountIds="";
                    sMessage=(oreturnObjs.length>1)? oreturnObjs.length +"MKT Account(s) Selected" : oreturnObjs[0].Name;
                    $('#txtMktAccount').val(sMessage);
                    $("#txtMktAccount").addClass("fontColorOfPickItem");
                    for(var i=0;i<oreturnObjs.length;i++){
                        _sMAccountIds=_sMAccountIds+oreturnObjs[i].MarketingAccountID+',';
                    }
                    _sMAccountIds=_sMAccountIds.substring(0,_sMAccountIds.length-1);
                }
                else
                {
                    alert("Please select a MKt Account.");
                    return false;
                }
            }

            $("#" + oPickerobj.winid).icsWindow("close");
            $("#" + oPickerobj.winid).remove();
        }


        //End Buyer Search
        $("#btnResetAdvSearch").click(function () {
            ResetAdvSearchWindow();
            LoadComboAdv();
        });


        $("#btnSearchByDate").click(function ()
        {
            $(".lblLoadingMessage").show();
            var sOrderTypeIDs = "";
            var oOrderType = "";
            var sPONo="";
            var sCurrentStatus = "";
            var oCurrentStatuss = $("#tblCurrentStatuss").datagrid("getChecked");
            if (oCurrentStatuss.length > 0)
            {
                for (var i = 0;i<oCurrentStatuss.length; i++){
                    sCurrentStatus = oCurrentStatuss[i].id + "," + sCurrentStatus;
                }
                sCurrentStatus = sCurrentStatus.substring(0, sCurrentStatus.length - 1);
            }

            var sTempString = $.trim($("#txtPINo").val()) + '~'
                            + $.trim($("#txtFabricID").val()) + '~'
                            + _sContractorIds + '~'
                            + _sBuyerIds + '~'
                            + _sMAccountIds + '~'
                            + 5 + '~'
                            + $("#txtStartDate").datebox("getValue") + '~'
                            + $("#txtEndDate").datebox("getValue") + '~'
                            + 0 + '~'
                            + "" + '~'
                            + "" + '~'
                            + 0 + '~'
                            + 0 + '~'
                            + ""  + '~'
                            + ""  + '~'
                            + _nBUID + '~'
                            + txtSearchbyPONo + '~'+ 0



            var oFabricSCReport = {
                ErrorMessage: sTempString
            }
            sessionStorage.setItem("ParamsP", sTempString);
            $.ajax({
                type: "POST",
                dataType: "json",
                url: _sBaseAddress + "/FabricSCReport/AdvanchSearch",
                traditional: true,
                data: JSON.stringify(oFabricSCReport),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    debugger;
                    var result = data;

                    //var result = jQuery.parseJSON(data);
                    if(result.Item1.length<=0){
                        alert("No data found");
                    }
                    else{
                        $('#tblFabricSCReports').data('FDPs',result.Item1)
                        $('#tblFabricSCReports').data('CellRowSpan',result.Item2);
                        DynamicRefreshList(result.Item1,'tblFabricSCReports');
                        $(".lblLoadingMessage").hide();
                        $("#winAdvSearch").icsWindow("close");
                    }
                }
            });
        });
        function onLoadSuccess(data)
        {
            var oCellRowSpans=$('#tblFabricSCReports').data('CellRowSpan');
            var nIndex=0;
            var nSpan=0;
            for(var i=0;i<oCellRowSpans.length;i++){
                var oMCell=[oCellRowSpans[i].mergerCell];
                nIndex=oMCell[0][0];
                nSpan= oMCell[0][1];
                if(oCellRowSpans[i].FieldName=="Span"){
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'SCNoFull', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'SCDateSt', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'ContractorName', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'BuyerName', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'MKTGroup', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'MKTPName', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'OrderTypeSt', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'OrderTypeSt', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'ApproveByName', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'ApprovedDateSt', rowspan: nSpan});
                    $(this).datagrid('mergeCells',{index: nIndex, field: 'CurrentStatusSt', rowspan: nSpan});


                }
            }
        }
        ////Start adv Searching
        /// Search By No and Date
        $('#txtSearchbyPONo').keypress(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                if ($.trim($("#txtSearchbyPONo").val()) == "")
                {
                    alert("Please give PO No.");
                    return false;
                }
                var sPONo=$.trim($("#txtSearchbyPONo").val());
                var sOrderTypeIDs = "";
                var sCurrentStatus = "";
                _sContractorIds="";
                debugger;
                var sTempString = "" + '~'
                                + "" + '~'//$.trim($("#txtFabricID").val()) + '~'
                                + _sContractorIds + '~'
                                + _sBuyerIds + '~'
                                + _sMAccountIds + '~'
                                + 0 + '~'
                                + icsdateformat(new Date())+ '~'
                                + icsdateformat(new Date())+ '~'
                                + 0+ '~'
                                + icsdateformat(new Date()) + '~'
                                + icsdateformat(new Date())+ '~'
                                 + 0 + '~'
                                + 0 + '~'
                                + sOrderTypeIDs  + '~'
                                + sCurrentStatus  + '~'
                                +_nBUID  + '~'
                                +sPONo+'~'+0+'~'+"";




                var oFabricSCReport = {
                    SCNoFull:$.trim($("#txtSearchbyPONo").val()),
                    ErrorMessage: sTempString
                }
                sessionStorage.setItem("ParamsP", sTempString);
                $.ajax({
                    type: "POST",
                    dataType: "json",
                    url: _sBaseAddress + "/FabricSCReport/AdvanchSearch",
                    traditional: true,
                    data: JSON.stringify(oFabricSCReport),
                    contentType: "application/json; charset=utf-8",
                    success: function (data)
                    {
                        var result = data;
                        //var result = jQuery.parseJSON(data);
                        if(result.Item1.length<=0){
                            alert("No data found");
                        }
                        else{
                            $('#tblFabricSCReports').data('FDPs',result.Item1)
                            $('#tblFabricSCReports').data('CellRowSpan',result.Item2);
                            DynamicRefreshList(result.Item1,'tblFabricSCReports');
                            $(".lblLoadingMessage").hide();

                        }



                    }
                });
            }
        });
        $('#txtSearchbyFabricNo').keypress(function (e) {

            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)//Enter key-13
            {
                if ($.trim($("#txtSearchbyFabricNo").val()) == "")
                {
                    alert("Please give  No.");
                    return false;
                }
                var sOrderTypeIDs = "";
                var sCurrentStatus = "";
                _sContractorIds="";
                var sPONo="";
                debugger;
                var sTempString = "" + '~'
                                + $.trim($("#txtSearchbyFabricNo").val()) + '~'
                                + _sContractorIds + '~'
                                + _sBuyerIds + '~'
                                + _sMAccountIds + '~'
                                + 0 + '~'
                                + icsdateformat(new Date())+ '~'
                                + icsdateformat(new Date())+ '~'
                                + 0+ '~'
                                + icsdateformat(new Date()) + '~'
                                + icsdateformat(new Date())+ '~'
                                + 0 + '~'
                                + 0 + '~'
                                + sOrderTypeIDs  + '~'
                                + sCurrentStatus  + '~'
                                 +_nBUID  + '~'
                                +sPONo+'~'+0+'~'+"";




                var oFabricSCReport = {
                    SCNoFull:"",
                    ErrorMessage: sTempString
                }
                sessionStorage.setItem("ParamsP", sTempString);
                $.ajax({
                    type: "POST",
                    dataType: "json",
                    url: _sBaseAddress + "/FabricSCReport/AdvanchSearch",
                    traditional: true,
                    data: JSON.stringify(oFabricSCReport),
                    contentType: "application/json; charset=utf-8",
                    success: function (data)
                    {
                        var result = data;
                        if(result.Item1.length<=0){
                            alert("No data found");
                        }
                        else{
                            $('#tblFabricSCReports').data('FDPs',result.Item1)
                            $('#tblFabricSCReports').data('CellRowSpan',result.Item2);
                            DynamicRefreshList(result.Item1,'tblFabricSCReports');
                            $(".lblLoadingMessage").hide();

                        }


                    }
                });
            }
        });


        function LoadComboAdv()
        {
            DynamicRefreshList(_oOrderTypes, "tblOrderTypes");
            DynamicRefreshList(_oFabricPOStatus, "tblCurrentStatuss");
            $("#cboPODate,#cboApproveDate").icsLoadCombo({
                List: _oCompareOperators,
                OptionValue: "id",
                DisplayText: "Value"
            });
        }
        function CheckFromAndToDateValidation(OperationComboId, FromDateId, ToDateId) {
            $("#" + OperationComboId).parent().parent().parent().find("select").removeClass("errorFieldBorder");
            var nCboVal = $("#" + OperationComboId).val();
            if (parseInt(nCboVal) == 5 || parseInt(nCboVal) == 6) {
                var fromDate = $("#" + FromDateId).datebox("getValue");
                var toDate = $("#" + ToDateId).datebox("getValue");
                if (new Date(fromDate) > new Date(toDate)) {
                    $("#" + ToDateId).focus();
                    $("#" + OperationComboId).addClass("errorFieldBorder");
                    $(".lblLoadingMessage").hide();
                    return false;
                } else {
                    $("#" + OperationComboId).removeClass("errorFieldBorder");
                    return true;
                }
            } else {
                return true;
            }
        }

        function ResetAdvSearchWindow() {
            _sContractorIds = '';
            _sBankBranch_IssueIds = "";
            $(".lblLoadingMessage").hide();
            $("#winAdvSearch input").not("input[type='button']").val("");
            $("#winAdvSearch input").removeClass("fontColorOfPickItem");
            $("#winAdvSearch select").val(0);
            DateActions_OPDate();
            DateActions_ApproveDate();
            $("#txtFromPODate,#txtToPODate").datebox({ disabled: true });
            $("#txtFromPODate,#txtToPODate").datebox("setValue", icsdateformat(new Date()));

            $("#txtFromApproveDate,#txtToApproveDate").datebox({ disabled: true });
            $("#txtFromApproveDate,#txtToApproveDate").datebox("setValue", icsdateformat(new Date()));
        }

        function DateActions_OPDate() {
            DynamicDateActions("cboPODate", "txtFromPODate", "txtToPODate");
        }
        function DateActions_ApproveDate() {
            DynamicDateActions("cboApproveDate", "txtFromApproveDate", "txtToApproveDate");
        }


        $("#btnCloseAdvSearch").click(function () {
            $("#winAdvSearch").icsWindow("close");
        });
        $("#btnAdvSearch").click(function () {
            debugger;
            $(".lblLoadingMessage").hide();
            $("#winAdvSearch").icsWindow("open", "Production Request Advance Search");
            //DynamicRefreshList([], "tblExportPIAdvSearch");
            DynamicResetAdvSearchWindow("winAdvSearch");
            ResetAdvSearchWindow();
            LoadComboAdv();
        });

        /// end Adv Searching

        /// Update Dispo No
        $("#btnExeNoEntry").click(function () {

            var oFSC = $('#tblFabricSCReports').datagrid('getSelected');
            var nSelectedIndex= $('#tblFabricSCReports').datagrid('getRowIndex',oFSC);
            if (oFSC ==null || oFSC.FabricSalesContractID<=0) { alert("Please select an item from list."); return ; }
            $('#txtSCNo_ExC').val(oFSC.SCNoFull);
            $('#txtContractor_EXC').val(oFSC.ContractorName);
            $('#txtOrderType').val(oFSC.OrderTypeSt);

            $.ajax({
                type: "POST",
                url: _sBaseAddress + "/FabricSalesContract/GetsDetailByFSC",
                traditional: true,
                data: JSON.stringify(oFSC),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    debugger;
                    var oFSCDetails = jQuery.parseJSON(data);
                    if(oFSCDetails!=null )
                    {
                        DynamicRefreshList(oFSCDetails, "tblFSCDetails");
                    }
                    else{
                        DynamicRefreshList([], "tblFSCDetails");
                    }
                    RefreshTotalSummery();
                    $("#winExeEntry").icsWindow("open", "Dispo No Entry");

                }
            });

        });

        function RefreshTotalSummery() {
            var nTotalQty = 0;
            var nTotalValue = 0;
            var sCurrency = "";
            sCurrency = "";
            var oFSCDetails = $('#tblFSCDetails').datagrid('getRows');
            for (var i = 0; i < oFSCDetails.length; i++) {
                nTotalQty = nTotalQty + parseFloat(oFSCDetails[i].Qty);
            }
            document.getElementById("lblTotalQty").innerHTML = formatPrice(nTotalQty)+' Y';
        }


        $("#btnSaveExeNo").click(function (e) {
            var oFSCDetails = $('#tblFSCDetails').datagrid('getRows');

            if(oFSCDetails==null || oFSCDetails.length<=0)
            {
                alert("Please select a item from list!");
                return;
            }
            endEditing();
            var oFSC = $('#tblFabricSCReports').datagrid('getSelected');
            var nSelectedIndex= $('#tblFabricSCReports').datagrid('getRowIndex',oFSC);
            if (oFSC ==null || oFSC.FabricSalesContractID<=0) { alert("Please select an item from list."); return ; }
            oFSC.FabricSalesContractDetails=oFSCDetails;

            var obj =
                {
                    BaseAddress: _sBaseAddress,
                    Object: oFSC,
                    ObjectId: oFSC.FabricSalesContractID,
                    ControllerName: "FabricSalesContract",
                    ActionName: "Save_UpdateDispoNo",
                    TableId: "tblFabricSCReports",
                    IsWinClose: true
                };
            $.icsSave(obj, function (response) {
                if (response.status) {
                    //OperationPerformsExportLC(nRowIndex, response.obj);
                }
            });
        });
        $("#btnCloseExeNo").click(function () {
            $("#winExeEntry").icsWindow("close");
        });
        ///

        var editIndex = undefined;
        function endEditing() {

            if (editIndex == undefined) {
                return true;
            }
            debugger;
            if ($('#tblFSCDetails').datagrid('validateRow', editIndex)) {
                $('#tblFSCDetails').datagrid('endEdit', editIndex);
                $('#tblFSCDetails').datagrid('selectRow', editIndex);
                var sCurrency = "";
                var oPIDetail = $('#tblFSCDetails').datagrid('getSelected');

                if (oPIDetail == null) {
                    return;
                }
                $('#tblFSCDetails').datagrid('updateRow', { index: editIndex, row: oPIDetail });
                // RefreshTotalSummery();


                editIndex = undefined;
                return true;
            }
            else {
                return false;
            }
        }


        function onClickRow(index) {

            if (editIndex != index) {
                if (endEditing()) {
                    $('#tblFSCDetails').datagrid('selectRow', index).datagrid('beginEdit', index);
                    var oExportPIDetail = $('#tblFSCDetails').datagrid('getSelected');
                    editIndex = index;
                }
                else {
                    $('#tblFSCDetails').datagrid('selectRow', editIndex);
                }
            }
        }


        $('#btnRequestForLabdip').click(function (e) {
            //ResetControll();
            var oFSC = $('#tblFabricSCReports').datagrid('getSelected');
            var nSelectedIndex= $('#tblFabricSCReports').datagrid('getRowIndex',oFSC);
            if (oFSC ==null || oFSC.FabricID<=0) { alert("Please select an item from list."); return ; }

            sessionStorage.setItem("Operation", "New");
            sessionStorage.setItem("SelectedRowIndex", nSelectedIndex);
            sessionStorage.setItem("FabricHeader", "Labdip");
            sessionStorage.setItem("Fabrics", JSON.stringify($('#tblFabricSCReports').datagrid('getRows')));
            sessionStorage.setItem("BackLink", window.location.href);
            window.location.href = _sBaseAddress + "/LabDip/ViewLabdipFromFabric?nId=" + oFSC.FabricID + "&buid=" + _nBUID;
        });
    </script>


