@{
    ViewBag.Title = "Delivery Orders";
}
@model IEnumerable<ESimSol.BusinessObjects.SUDeliveryOrder>
    <head>
        <title>LC Terms</title>

        <script src="@Url.Content("~/Views/SUDeliveryOrder/SUDeliveryOrder.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/SUDeliveryOrder/SUDeliveryOrders.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/SUDeliveryOrder/AdvSearch.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/ProductCategory/ProductPicker.js")" type="text/javascript"></script>
    </head>
    <body>

        <div id="winSUAttachment" class="easyui-window" title="SU Attachments" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            @using (Html.BeginForm("UploadAttchment", "SUDeliveryOrder", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank" }))
            {
                <table id="tblSUAttachment" class="easyui-datagrid" style="width:798px;height:350px;margin:0;" data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarSUAttachment' ">
                    <thead>
                        <tr>
                            <th field="AttatchmentName" width="60%">AttatchmentName</th>
                            <th field="Remarks" width="30%">Remarks</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarSUAttachment">
                    <input type="text" name="ObjectID" id="txtSUIdSubmit" hidden="hidden" />
                    <input type="file" id="fileControl" name="file" style="width: 200px;" />
                    Remark :
                    <input id="txtRemarks" name="Remarks" type="text" />
                    <input id="btnSubmitSUAttachment" type="submit" value="Upload" style="font-weight: bold;" />
                    <input id="btnDeleteSUAttachment" type="button" value="Delete" style="font-weight: bold" />
                </div>
            }
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <table border="0" cellpadding="2" cellspacing="2">
                    <tr>
                        <td style="width:395px; text-align:left">
                            @using (Html.BeginForm("DownloadAttachment", "SUDeliveryOrder", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank" }))
                            {
                                <input type="text" name="SUAttchmentID" id="txtSUAttchmentID" hidden="hidden" />
                                <input type="submit" value="Download" id="btnDownload" />
                            }
                        </td>
                        <td style="width:395px"><a id="btnCloseSUAttachment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a></td>
                    </tr>
                </table>
            </fieldset>
        </div>

        <div id="winExportPIProducts" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divExportPIProductsPicker" tabindex="-1">
                <table id="tblExportPIProductsPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarExportPIProductsPicker' ">
                    <thead>
                        <tr>
                            <th data-options="field:'Selected',checkbox:true"></th>
                            <th field="ProductName" width="50%" align="left">Product Name</th>
                            <th field="Qty" width="15%" align="right">Qty(KG)</th>
                            <th field="UnitPrice" width="20%" align="right">Unit Price</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarExportPIProductsPicker">
                    <input id="txtSearchByExportPIProductsNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by PI No" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkExportPIProductsPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseExportPIProductsPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winPrintFormat2" style="width:250px;" class="easyui-window winstyle" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset>
                <legend>Format : </legend>
                <table style="width:100%;">
                    <tr>
                        <td>
                            <input id="chkInLBS2" type="checkbox" checked /> In LBS
                        </td>
                        <td>
                            
                            <input id="chkInKg2" type="checkbox"  /> In KG
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input id="chkPrintTitleInText2" type="checkbox" checked />Pad Format
                        </td>
                        <td>
                            <input id="chkPrintTitleInImg2" type="checkbox" /> Image Format
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkPrintFormat2" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                <a id="btnClosePrintFormat2" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winPrintFormat1" style="width:200px;" class="easyui-window winstyle" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset>
                <legend>Qty Format : </legend>
                <table style="width:100%;">
                    <tr>
                        <td>
                            <input id="chkInKg1" type="checkbox" checked /> In KG
                        </td>
                        <td>
                            <input id="chkInLBS1" type="checkbox" /> In LBS
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                @using (Html.BeginForm("PrintSUDO", "SUDeliveryOrder", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank", @class = "PrintForm" }))
                {
                    <input type="text" name="txtSUDeliveryOrderCollectionList" id="txtSUDeliveryOrderCollectionList" hidden="hidden" />
                    <input type="submit" id="btnOkPrintFormat1" value="   Print List" class="icon-print PrintList" onclick=" return isValidSUDeliveryOrder() " style="margin-top: 4px;" />
                }
                <a id="btnClosePrintFormat1" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winReviseHistory" class="easyui-window" title="Revise History" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <table id="tblReviseHistory" class="easyui-datagrid" style="width: 900px; height: 350px; margin: 0;" data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarReviseHistory' ">
                <thead>
                    <tr>
                        <th field="DONo" width="15%">DONo</th>
                        <th field="DODateSt" width="15%" align="center">DO Date</th>
                        <th field="DOStatusSt" width="15%">Status</th>
                        <th field="BuyerName" width="20%">Buyer Name</th>
                        <th field="DOTypeSt" width="15%">DO Type</th>
                        <th field="DeliveredToName" width="20%">Delivered To</th>
                        <th field="DeliveryDateSt" width="20%" align="center">Delivery Date</th>
                        <th field="MKTPName" width="20%">MKT Person</th>
                        <th field="QtySt" width="15%" align="right">Qty</th>
                        <th field="AmountSt" width="15%" align="right">Amount</th>
                    </tr>
                </thead>
            </table>
            <div id="toolbarReviseHistory">
                <a id="btnViewReviseHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Details</a>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnCloseReviseHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winBuyerPickerAdvSearch" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divBuyerPickerAdvSearch" tabindex="-1">
                <table id="tblBuyersPickerAdvSearch" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarBuyerPickerAdvSearch' ">
                    <thead>
                        <tr>
                            <th field="Name" width="240" align="left">Name</th>
                            <th field="ContractorTypeInString" width="150" align="left">Type</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarBuyerPickerAdvSearch">
                    <input id="txtSearchByBuyerNamePickerAdvSearch" class="txtPickerSearchInputField" type="text" placeholder="Search by name" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkBuyerPickerAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseBuyerPickerAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winAdvSearchSUDeliveryOrder" class="easyui-window winstyle" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <table class="tblAdvSearch">
                <tr>
                    <td>
                        <fieldset style="margin-bottom: 0px;" class="abc">
                            <legend>Searching Criteria</legend>
                            <table class="tblASWrapper">
                                <tr>
                                    <td>
                                        <label>DO No :</label>
                                    </td>
                                    <td>
                                        <input id="txtDONoAdvSearch" type="text" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Buyer :</label>
                                    </td>
                                    <td class="oneTextTwoButton">
                                        <input id="txtSearchByBuyersAdvSearch" type="text" placeholder="Type Name & Press Enter" />
                                        <input id="btnClrBuyerAdvSearch" type="button" value="C" />
                                        <input id="btnPickBuyerAdvSearch" type="button" value="P" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>PI No :</label>
                                    </td>
                                    <td class="oneTextTwoButton">
                                        <input id="txtPINoAdvSearch" type="text" placeholder="Type PI No & Press Enter" />
                                        <input id="btnClrPINoAdvSearch" type="button" value="C" />
                                        <input id="btnPickPINoAdvSearch" type="button" value="P" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>LC No :</label>
                                    </td>
                                    <td class="oneTextTwoButton">
                                        <input id="txtLCNoAdvSearch" type="text" placeholder="Type LC No & Press Enter" />
                                        <input id="btnClrLCNoAdvSearch" type="button" value="C" />
                                        <input id="btnPickLCNoAdvSearch" type="button" value="P" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>MKT Person :</label>
                                    </td>
                                    <td>
                                        <select id="cboMKTPersonAdvSearch"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>DO Type :</label>
                                    </td>
                                    <td>
                                        <select id="cboDOTypeAdvSearch"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Status :</label>
                                    </td>
                                    <td>
                                        <div style="">
                                            <table id="tblStatusAdvSearch" class="easyui-datagrid" title="" style="width: 275px; height: 140px;" data-options="singleSelect: false,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, ">
                                                <thead>
                                                    <tr>
                                                        <th data-options="field:'Selected',checkbox:true"></th>
                                                        <th field="Value" width="98%">Status</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="10" colspan="2"></td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <input id="chkDODate" type="checkbox" style="margin: 0;" onchange="ChangeDODates();"/>
                                        <label style="margin-right: 1px;">DO Date :</label>
                                        <input id="txtFromDODateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                        <label style="margin: 0 26px 0 26px;">To</label>
                                        <input id="txtToDODateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                    </td>
                                </tr>
                                <tr>
                                    <td height="10" colspan="2"></td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <input id="chkDeliveryDate" type="checkbox" style="margin: 0;" onchange="ChangeDeliveryDates();" />
                                        <label style="margin-right: 1px;">Del. Date :</label>
                                        <input id="txtFromDeliveryDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                        <label style="margin: 0 24px 0 24px;">To</label>
                                        <input id="txtToDeliveryDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                    </td>
                                </tr>
                                <tr>
                                    <td height="20" colspan="2"></td>
                                </tr>
                                <tr>
                                    <td class="btnResetSearch" colspan="2">
                                        <input id="btnResetAdvSearch" type="button" value="Reset" />
                                        <input id="btnSearchAdvSearch" type="button" value="Search" />
                                    </td>
                                </tr>
                            </table>
                        </fieldset>
                    </td>
                    <td>
                        <div style="margin-top: 6px;">
                            <table id="tblSUDeliveryOrderAdvSearch" class="easyui-datagrid" title="Delivery Order(s)" style="width: 600px; height: 462px;" data-options="singleSelect: false,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, ">
                                <thead>
                                    <tr>
                                        <th data-options="field:'Selected',checkbox:true"></th>
                                        <th field="DONo" width="30%">DONo</th>
                                        <th field="DODateSt" width="25%" align="center">DO Date</th>
                                        <th field="DOStatusSt" width="25%">Status</th>
                                        <th field="BuyerName" width="25%">Buyer Name</th>
                                        <th field="DOTypeSt" width="25%">DO Type</th>
                                        <th field="DeliveredToName" width="25%">Delivered To</th>
                                        <th field="DeliveryDateSt" width="25%" align="center">Delivery Date</th>
                                        <th field="MKTPName" width="25%">MKT Person</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <label class="lblLoadingMessage" style="float:left;">Loading Please Wait...</label>
                <a id="btnOkAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winExportPIProducts" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divExportPIProductsPicker" tabindex="-1">
                <table id="tblExportPIProductsPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarExportPIProductsPicker' ">
                    <thead>
                        <tr>
                            <th data-options="field:'Selected',checkbox:true"></th>
                            <th field="ProductName" width="50%" align="left">Product Name</th>
                            <th field="Qty" width="15%" align="right">Qty(KG)</th>
                            <th field="UnitPrice" width="20%" align="right">Unit Price</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarExportPIProductsPicker">
                    <input id="txtSearchByExportPIProductsNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by PI No" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkExportPIProductsPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseExportPIProductsPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winPINo" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divPINoPicker" tabindex="-1">
                <table id="tblPINosPicker" class="easyui-datagrid" style="width: 800px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarPINoPicker' ">
                    <thead>
                        <tr>
                            <th field="PINo" width="20%">PI No</th>
                            <th field="LCNoSt" width="20%">LC No</th>
                            <th field="IssueDateInString" width="18%" align="center">Issue Date</th>
                            <th field="ContractorNameCode" width="20%">Account of</th>
                            <th field="BuyerName" width="20%">Buying House</th>
                            <th field="AmountSt" width="15%" align="right">Total Value</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarPINoPicker">
                    <input id="txtSearchByPINoNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by PI No" />
                    <a id="btnRefreshPINoPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Refresh</a>
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkPINoPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnClosePINoPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winProductPicker" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divProductPicker" tabindex="-1">
                <table id="tblProductsPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarProductPicker' ">
                    <thead>
                        <tr>
                            <th field="ProductCode" width="22%" align="left">Product Code</th>
                            <th field="ProductName" width="40%" align="left">Product Name</th>
                            <th field="ShortName" width="40%" align="left">Short Name</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarProductPicker">
                    <input id="txtSearchByProductNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by name" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkProductPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseProductPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winBuyerPicker" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divBuyerPicker" tabindex="-1">
                <table id="tblBuyersPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarBuyerPicker' ">
                    <thead>
                        <tr>
                            <th field="Name" width="240" align="left">Name</th>
                            <th field="ContractorTypeInString" width="150" align="left">Type</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarBuyerPicker">
                    <input id="txtSearchByBuyerNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by name" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkBuyerPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseBuyerPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winDeliveryToPicker" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divDeliveryToPicker" tabindex="-1">
                <table id="tblDeliveryTosPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarDeliveryToPicker' ">
                    <thead>
                        <tr>
                            <th field="Name" width="240" align="left">Name</th>
                            <th field="ContractorTypeInString" width="150" align="left">Type</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarDeliveryToPicker">
                    <input id="txtSearchByDeliveryToNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by name" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkDeliveryToPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseDeliveryToPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winSUDeliveryOrder" class="easyui-window" title="Delivery Order (DO)" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset>
                <legend>Delivery Order :</legend>
                    <table border="0" cellspacing="2" cellpadding="2" class="CaptionStyle">
                        <tr>
                            <td style="width:100px; text-align:right">
                                DO No : 
                            </td>
                            <td style="">
                                <input type="text" style="width:110px;margin-right:3px;" id="txtDONoSUDeliveryOrder" disabled="disabled"/>
                                DO Type :
                                <select id="cboDOTypeSUDeliveryOrder" class="buyer"></select>
                            </td>
                            <td style="width:200px; text-align:right">
                                PI No :
                            </td>
                            <td>
                                <input id="txtPINoSUDeliveryOrder" type="text" style="width:70%;" disabled />
                                <input id="btnClearPINoSUDeliveryOrder" class="shortBtn" type="button" style="width:12%;" value="C" />
                                <input id="btnPINoSUDeliveryOrder" class="shortBtn" type="button" style="width:12%;" value="P" />
                                <input id="btnDisplayAdvanceDOs" class="shortBtn" type="button" style="width:16%;" value="A.DO" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:100px; text-align:right">
                                Buyer : 
                            </td>
                            <td style="text-align:left">
                                <select id="cboBuyerSUDeliveryOrder" style="width:120px;"></select>
                                <input id="txtSearchByBuyerSUDeliveryOrder" class="buyer" type="text" style="" placeholder="Type & Press Enter" />
                                <input id="btnClrBuyerSUDeliveryOrder" class="buyer" type="button" value="C" />
                                <input id="btnPickBuyerSUDeliveryOrder" class="buyer" type="button" value="P" />
                            </td>
                            <td style="width:200px; text-align:right">
                                Contact Personnel :
                            </td>
                            <td style="">
                                <select id="cboContactPersonnelSUDeliveryOrder" style="width:100%;" class="buyer"></select>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:100px; text-align:right">
                                Deliver To : 
                            </td>
                            <td style="text-align:left">
                                <select id="cboDeliveryToSUDeliveryOrder" style="width:120px;"></select>
                                <input id="txtSearchByDeliveryToSUDeliveryOrder" type="text" style="" placeholder="Type & Press Enter" />
                                <input id="btnClrDeliveryToSUDeliveryOrder" type="button" value="C" />
                                <input id="btnPickDeliveryToSUDeliveryOrder" type="button" value="P" />
                            </td>
                            <td style="text-align:right">
                                Contact Info :
                            </td>
                            <td style="">
                                <input id="txtContactInfoSUDeliveryOrder" type="text" style="width:98%;" class="buyer" disabled />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:100px; text-align:right">
                                Deliver Point : 
                            </td>
                            <td style="">
                                <input id="txtDeliverPointSUDeliveryOrder" type="text" style="width:98%;"/>
                            </td>
                            <td style="width:200px; text-align:right">
                                <label style="width:150px;">MKT Person : </label>
                            </td>
                            <td style="">
                                <select id="cboMKTPersonSUDeliveryOrder" style="width:100%;"></select>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:100px; text-align:right">
                                DO Date :
                            </td>
                            <td style="">
                                <input id="txtDODateSUDeliveryOrder" type="text" style="width:100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                <label style="margin-left:35px;">Delivery Date :</label>
                                <input id="txtDeliveryDateSUDeliveryOrder" type="text" style="width:100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                            <td style="width:200px; text-align:right">
                                <label class="LCNoRelated">LC No :</label>
                            </td>
                            <td style="">
                                <label id="lblLCNo" class="LCNoRelated" style="font-weight:100;"></label>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:100px; text-align:right">
                                Remarks :
                            </td>
                            <td colspan="3">
                                <input id="txtRemarksSUDeliveryOrder" type="text" style="width:99%;" />
                            </td>
                        </tr>
                    </table>
            </fieldset>
            <div style="margin-left:2px; margin-top:2px">
                <table id="tblSUDeliveryOrderDetails" title="Products/Item Description" class="easyui-datagrid" style="width:917px;height:300px;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarSUDeliveryOrderDetail" data-options="onClickRow: onClickRowSUDO">
                    @*<thead>
                        <tr>
                            <th field="ProductCode" width="10%" align="left">Product Code</th>
                            <th field="ProductName" width="20%" align="left">Item Description</th>
                            <th data-options="field:'Qty',align:'right',editor:{type:'numberbox',options:{precision:3}}" width="15%" align="right">Qty(kG)</th>
                            <th field="QtyInLbs" width="15%" align="right">Qty(LBS)</th>
                            <th data-options="field:'UnitPrice',align:'right',editor:{type:'numberbox',options:{precision:2}}" width="10%" align="right">Unit Price/KG</th>
                            <th field="UnitPriceInLbs" width="15%" align="right">Unit Price/LBS</th>
                            <th field="AmountSt" width="15%" align="right">Amount</th>
                        </tr>
                    </thead>*@
                </table>
                <div id="toolbarSUDeliveryOrderDetail">
                    <label id="lblSUDeliveryOrderDetailLabel">Product :</label>
                    <input id="txtProductNameSUDeliveryOrderDetail" type="text" class="productItemsSUDeliveryOrder" placeholder="Type Product & Press Enter" style="width:210px;" />
                    <input id="btnClrProductSUDeliveryOrderDetail" class="productItemsSUDeliveryOrder" type="button" value="C" />
                    <input id="btnPickProductSUDeliveryOrderDetail" class="productItemsSUDeliveryOrder" type="button" value="P" />
                    <a id="btnProductAddSUDeliveryOrderDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
                    <a id="btnProductRemoveSUDeliveryOrderDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove</a>
                    <a id="btnRefreshSUDeliveryOrderDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Refresh</a>
                    <a id="btnPIProductsSUDeliveryOrderDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">PI Products</a>
                    <div style="float:right;">
                        Currency :
                        <select id="cboCurrencySUDeliveryOrder" style="width:100px;"></select>
                    </div>
                </div>
            </div>
            <table id="TotalSummerySUDOD" border="0">
                <tbody>
                    <tr>
                        <td style="width: 100px;"></td>
                        <td id="tdTotalCaption" style="width: 186px; text-align: right; font-size: 12px; font-weight:bold"> Total : </td>
                        <td style="width: 133px; text-align: right; font-size: 12px">
                            <label id="lblTotalQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                        </td>
                        <td style="width: 129px; text-align: right; font-size: 12px">
                            <label id="lblTotalQtyLBS" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                        </td>

                        <td style="width: 328px; text-align: right; font-size: 12px">
                            <label id="lblCurrency" style="font-weight:bold;margin-right:2px;"></label>
                            <label id="lblTotalValue" style="text-align: right; font-size:12px; float: right; font-weight:bold"> 0.00</label>
                        </td>

                    </tr>
                </tbody>
            </table>
            <table id="TotalSummerySUDODForSampleDO" border="0" style="display: table;">
                <tbody>
                    <tr>
                        <td style="width:80px;"></td>
                        <td id="tdTotalCaption" style="width: 483px; text-align: right; font-size: 12px; font-weight:bold"> Total : </td>
                        <td style=" width: 72px;text-align: right; font-size: 12px">
                            <label id="lblTotalCones" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                        </td>
                        <td style="width: 100px;"></td>
                        <td style=" width: 79px;text-align: right; font-size: 12px">
                            <label id="lblTotalQtyinKG" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                        </td>

                        <td style=" width: 73px;text-align: right; font-size: 12px">
                            <label id="lblTotalQtyinLBS" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                        </td>
                    </tr>
                </tbody>
            </table>
            <fieldset class="actionfieldsetstyle">
                <legend style="font-weight:bold;text-align:left;"> Action : </legend>
                <a id="btnSaveAcceptReviseSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                <a id="btnSaveSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                <a id="btnCloseSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div class="menuMainCollectionTable">
            <table id="tblSUDeliveryOrders" title="Delivery Order" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarSUDeliveryOrder">
                <thead>
                    <tr>
                        <th field="DONo" width="15%">DONo</th>
                        <th field="DODateSt" width="10%" align="center">DO Date</th>
                        <th field="DOStatusSt" width="15%">Status</th>
                        <th field="BuyerName" width="20%">Buyer Name</th>
                        <th field="DOTypeSt" width="15%">DO Type</th>
                        <th field="DeliveredToName" width="20%">Delivered To</th>
                        <th field="DeliveryDateSt" width="10%" align="center">Delivery Date</th>
                        <th field="MKTPName" width="20%">MKT Person</th>
                        <th field="QtySt" width="12%" align="right">Qty</th>
                        <th field="AmountSt" width="12%" align="right">Amount</th>
                        <th field="ApprovedByName" width="15%">Approve By</th>
                        <th field="TotalAttachmentWithDoID" width="12%" align="center" formatter="ShowAttachments">Total Attachment</th>
                    </tr>
                </thead>
            </table>
            <div id="toolbarSUDeliveryOrder">
                <table>
                    <tr>
                        <td>
                            <input id="txtSearchBySUDeliveryOrder" type="text" placeholder="Search by Do No" style="width: 120px;" />
                            <input id="txtDODateSUDeliveryOrders" type="text" class="easyui-datebox" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:100px;float:left" />
                            <a id="btnSearchByDateSUDeliveryOrders" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            <a id="btnAdvSearchSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>
                            <a id="btnWaitingApprovalSUDeliveryOrders" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Waiting For Approval</a>
                            <a id="btnAddSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">New</a>
                            <a id="btnEditSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                            <a id="btnViewSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">View</a>
                            <a id="btnDeleteSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                            <a id="btnReqForApproveSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-redo" plain="true">Req For App</a>
                            <a id="btnUndoReqSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true">Undo</a>
                            <a id="btnApproveSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-approved" plain="true">Approve</a>
                            <a id="btnUndoApproveSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-undo" plain="true">Undo</a>
                            <a id="btnReqForReviseSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-redo" plain="true">Req For Revise</a>
                            <a id="btnAcceptReviseSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-approved" plain="true">Accept Revise</a>
                            <a id="btnReviseHistorySUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Revise History</a>
                            <a id="btnAttachment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-attachment" plain="true">Attachment</a>
                            <a id="btnCancelSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Cancel</a>
                            <a id="btnPreviewSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                            <a id="btnPrintSUDeliveryOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print List</a>    
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </body>
    <style type="text/css">
        .tblAdvSearch .tblASWrapper {
            width: 360px;
        }
        .tblAdvSearch .tblASWrapper input[type="text"] {
            width: 98%;
        }

        .tblAdvSearch .tblASWrapper select {
            width: 100%;
        }
        .tblAdvSearch .oneTextTwoButton input[type='text']{
            width: 72%;
        }
        .tblAdvSearch .oneTextTwoButton input[type='button']{
            width: 11%;
        }
        .btnResetSearch input[type="button"] {
            width: 20%;
        }
        #btnSearchAdvSearch {
            float: right;
        }
    </style>

<script type="text/javascript">
    var _sBaseAddress=null;
    var _oSUDeliveryOrder=null;
    var _oSUDeliveryOrders=[];
    var _oDOTypes=[];
    var _oContractorTypes=[];
    var _oMktPersons=[];
    var _oCurrencys=[];
    var _oDOStatus=[];
    var _oSUDeliveryOrderDetail=null;
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oSUDeliveryOrders =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oDOTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DOTypes));
        _oContractorTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ContractorTypes));
        _oMktPersons = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MktPersons));
        _oCurrencys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
        _oDOStatus = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DOStatus));
        $("#txtDODateSUDeliveryOrder,#txtDeliveryDateSUDeliveryOrder,#txtFromDODateAdvSearch,#txtToDODateAdvSearch,#txtFromDeliveryDateAdvSearch,#txtToDeliveryDateAdvSearch").datebox({ disabled: false });
        $("#txtDODateSUDeliveryOrder,#txtDeliveryDateSUDeliveryOrder,#txtFromDODateAdvSearch,#txtToDODateAdvSearch,#txtFromDeliveryDateAdvSearch,#txtToDeliveryDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        $(".LCNoRelated").hide();
        $("#btnDisplayAdvanceDOs").hide();
        InitializeSUDeliveryOrdersEvents();
        InitializeSUDeliveryOrderEvents();
        InitializeAdvSearchSUDeliveryOrderEvents();
        InitializeProductPickerEvents();
        $("#txtSearchBySUDeliveryOrder").focus();

        SelectItemFromSession("SUDeliveryOrder", "SUDeliveryOrderID",_oSUDeliveryOrders,"tblSUDeliveryOrders");

    });
    $(document).keydown(function (e) { if (e.keyCode == 27) { $('div').icsWindow('close'); } });

    function ShowAttachments(value)
    {
        var nTotalAttachment = value.split("~")[0];
        var nSUDOID = value.split("~")[1];
        var s = "";
        if(parseFloat(nTotalAttachment) > 0)
        {
            s = '<a href="javascript:void(0)" onclick = "OpenAttachmentPicker('+nSUDOID+')"">'+nTotalAttachment+'</a>';
        }else
        {
            s = nTotalAttachment;
        }
        return s;
    }

    function OpenAttachmentPicker(nSUDOID)
    {
        //Ratin
        if(nSUDOID>0)
        {
            var oSU = {
                SUDeliveryOrderID : nSUDOID
            };
            if(oSU==null || parseInt(oSU.SUDeliveryOrderID)<=0)
            {
                alert("Please select an item from list!");
                return;
            }
            var oSUAttachment = {
                ObjectID : oSU.SUDeliveryOrderID,
                ObjectType : 1 //SUDeliveryOrder
            };
            $.ajax({
                type: "POST",
                url: _sBaseAddress + "/SUDeliveryOrder/GetsAttachmentById",
                traditional: true,
                data: JSON.stringify(oSUAttachment),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oSUAttachments = jQuery.parseJSON(data);
                    if (oSUAttachments != null) {
                        if (oSUAttachments.length > 0) {
                            DynamicRefreshList(oSUAttachments, "tblSUAttachment");
                        }
                        else {
                            DynamicRefreshList([], "tblSUAttachment");
                        }
                    }
                }
            });
            $("#txtSUIdSubmit").val('0');     
            $("#txtRemarks").val('');        
            $("#fileControl").val('');        
            $("#winSUAttachment").icsWindow("Open","Delivery Order Attachments");
        }
    }

    $("#btnAcceptReviseSUDeliveryOrder").click(function(){
        var oSUDeliveryOrder = $("#tblSUDeliveryOrders").datagrid("getSelected");
        if (oSUDeliveryOrder == null || parseInt(oSUDeliveryOrder.SUDeliveryOrderID) <= 0) {
            alert("Please select an item from list!"); return;
        }
        else if (parseInt(oSUDeliveryOrder.DOStatusInInt) == 8) {
            alert("Sorry, This Delivery Order already closed.");
            return false;
        }
        else if (parseInt(oSUDeliveryOrder.DOStatusInInt) != 7) {
            alert("Sorry, Delivery Order Status must be Request For Revise for this action.");
            return false;
        }

        var oSUDeliveryOrder = $("#tblSUDeliveryOrders").datagrid("getSelected");
        if(oSUDeliveryOrder == null || oSUDeliveryOrder.SUDeliveryOrderID <= 0)
        {
            alert("Please select an item from list.");
            return false;
        }

        var obj = {
            BaseAddress: _sBaseAddress,
            TableId: "",
            OpenedPageTitle: "Add Delivery Order",
            Object: oSUDeliveryOrder,
            ObjectId: oSUDeliveryOrder.SUDeliveryOrderID,
            PrimaryKeyName: "SUDeliveryOrderID",
            ControllerName: "SUDeliveryOrder",
            ActionName: "View_SUDeliveryOrder",
            BtnID: $(this).attr("id")
        };
        $.icsOpenPickerInNewPage(obj);
    });

    $("#btnEditSUDeliveryOrder,#btnViewSUDeliveryOrder").click(function(){
        var oSUDeliveryOrder = $("#tblSUDeliveryOrders").datagrid("getSelected");
        if(oSUDeliveryOrder == null || oSUDeliveryOrder.SUDeliveryOrderID <= 0)
        {
            alert("Please select an item from list.");
            return false;
        }

       
        if($(this).attr("id") == "btnEditSUDeliveryOrder")
        {
            if(oSUDeliveryOrder.ApprovedBy > 0)
            {
                alert("Already Approved, Cann't edit.");
                return false;
            }
        }


        var obj = {
            BaseAddress: _sBaseAddress,
            TableId: "",
            OpenedPageTitle: "Add Delivery Order",
            Object: oSUDeliveryOrder,
            ObjectId: oSUDeliveryOrder.SUDeliveryOrderID,
            PrimaryKeyName: "SUDeliveryOrderID",
            ControllerName: "SUDeliveryOrder",
            ActionName: "View_SUDeliveryOrder",
            BtnID: $(this).attr("id")
        };
        $.icsOpenPickerInNewPage(obj);
    });

    $("#btnAddSUDeliveryOrder").click(function(){
        var oSUDeliveryOrder = {
            SUDeliveryOrderID: 0
        };

        var obj = {
            BaseAddress: _sBaseAddress,
            TableId: "",
            OpenedPageTitle: "Add Delivery Order",
            Object: oSUDeliveryOrder,
            ObjectId: oSUDeliveryOrder.SUDeliveryOrderID,
            PrimaryKeyName: "SUDeliveryOrderID",
            ControllerName: "SUDeliveryOrder",
            ActionName: "View_SUDeliveryOrder",
            BtnID: $(this).attr("id")
        };
        $.icsOpenPickerInNewPage(obj);
    });





    //File Attachment
    $("#btnCloseSUAttachment").click(function() {
        $("#winSUAttachment").icsWindow("close");
    });

    $("#btnDownload").click(function() {  
        var oSUAttachment = $("#tblSUAttachment").datagrid("getSelected");
        if (oSUAttachment == null || parseInt(oSUAttachment.SUAttachmentID) <= 0) {
            alert("Please select an item from list!");
            return false;
        }
        $('#txtSUAttchmentID').val(oSUAttachment.SUAttachmentID);        
    });

    $("#btnDeleteSUAttachment").click(function() {        
        var oSUAttachment = $("#tblSUAttachment").datagrid("getSelected");
        if (oSUAttachment == null || parseInt(oSUAttachment.SUAttachmentID) <= 0) {
            alert("Please select an item from list!");
            return false;
        }
        if (!confirm("Confirm to Delete?")) return false;

        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oSUAttachment,
            ControllerName: "SUDeliveryOrder",
            ActionName: "DeleteSUAttachment",
            TableId: "tblSUAttachment",
            IsWinClose: false
        };
        $.icsDelete(obj);
    });

    $("#btnSubmitSUAttachment").click(function(e) {
        var oSUDO = $("#tblSUDeliveryOrders").datagrid("getSelected");
        $("#txtSUIdSubmit").val(oSUDO.SUDeliveryOrderID);
        $("#winSUAttachment").icsWindow("close");
    });

    $("#btnAttachment").click(function() {
        var oSU = $("#tblSUDeliveryOrders").datagrid('getSelected');
        if(oSU==null || parseInt(oSU.SUDeliveryOrderID)<=0)
        {
            alert("Please select an item from list!");
            return;
        }
        var oSUAttachment = {
            ObjectID : oSU.SUDeliveryOrderID,
            ObjectType : 1 //SUDeliveryOrder
        };
        $.ajax({
            type: "POST",
            url: _sBaseAddress + "/SUDeliveryOrder/GetsAttachmentById",
            traditional: true,
            data: JSON.stringify(oSUAttachment),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oSUAttachments = jQuery.parseJSON(data);
                if (oSUAttachments != null) {
                    if (oSUAttachments.length > 0) {
                        DynamicRefreshList(oSUAttachments, "tblSUAttachment");
                    }
                    else {
                        DynamicRefreshList([], "tblSUAttachment");
                    }
                }
            }
        });
        $("#txtSUIdSubmit").val('0');     
        $("#txtRemarks").val('');        
        $("#fileControl").val('');        
        $("#winSUAttachment").icsWindow("Open","Delivery Order Attachments");
    });
</script>
