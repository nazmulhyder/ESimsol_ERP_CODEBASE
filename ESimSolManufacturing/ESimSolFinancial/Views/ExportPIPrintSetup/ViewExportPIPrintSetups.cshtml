@{
    ViewBag.Title = "Export PI Print Setup List";
}
@model IEnumerable<ESimSol.BusinessObjects.ExportPIPrintSetup>

 <head>
  <title>ExportPIPrintSetup</title>

  @*<script src="@Url.Content("~/Views/ExportPIPrintSetup/ExportPIPrintSetup.js")" type="text/javascript"></script>
  <script src="@Url.Content("~/Views/ExportPIPrintSetup/ExportPIPrintSetups.js")" type="text/javascript"></script>*@
</head>

    
<body>
 
    <div id="winExportPIPrintSetup" class="easyui-window winstyle" title=" Informations" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div>
            <fieldset>
                <table class="tbl">
                    <tr>

                        <td style="width:70px; font-family:Tahoma">
                            <label style="width:60px">B. Unit :</label>
                        </td>
                        <td style="width:200px">
                            <select id="cboBU" style="width:80%" ></select>
                        </td>
                        <td style="width:100px">
                            
                        </td>
                        <td style="width:200px">
                            
                        </td>
                        <td style="width:100px">
                            
                        </td>
                        <td style="width:100px">
                            
                        </td>
</tr>
                    <tr>
                        <td style="width:70px; font-family:Tahoma">
                            <label style="width:70px; font-family:Tahoma">SetUp No:</label>
                        </td>
                        <td style="width:200px" >
                            <input style="width: 150px" id="txtSetupNo" type="text" disabled="disabled" />
                        </td>
                        <td style="width:100px">
                            <label style="width:100px; font-family:Tahoma">SetUp Date :</label>
                        </td>
                        <td style="width:200px">
                            <input type="text" class="easyui-datebox" style="width: 150px;" id="txtDate"
                                   data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                        <td style="width:100px">
                            <label style="width:100px; font-family:Tahoma">  SetUp Note :</label>
                        </td>
                        <td style="width:100px">
                            <input style="width: 100px" type="text" id="txtSetupNote" />
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <table class="tbl">
                    <tr>
                        <td style="width:200px">
                            <label style="font-family:Tahoma">Part Shipment:</label>
                        </td>
                        <td style="width:200px">
                            <input style="width: 200px" id="txtPartShipment" type="text" />
                        </td>
                        <td style="width:200px">
                            <label style="font-family:Tahoma">Shipment By:</label>
                        </td>
                        <td style="width:200px">
                            <input style="width: 200px" id="txtShipmentBy" type="text" />
                        </td>
                   

                    </tr>
                    <tr>
                      
                        <td style="width:200px">
                            <label style="font-family:Tahoma">Place Of Shipment:</label>
                        </td>
                        <td style="width:200px">
                            <input style="width: 200px" id="txtPlaceofShipment" type="text" />
                        </td>
                        <td style="width:200px">
                            <label style="font-family:Tahoma">Place Of Delivery:</label>
                        </td>
                        <td style="width:200px">
                            <input style="width: 200px" id="txtPlaceofDelivery" type="text" />
                        </td>

                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <table class="tbl">
                    <tr>
                        <td style="width:10%;text-align:right">
                            Print Header:
                        </td>
                        <td style="width:15%;">
                            <select style="width: 80%;" id="cboHeaderType">
                                <option value="0">--Select-</option>
                                <option value="1">Normal Format</option>
                                <option value="2">Pad Format</option>
                                <option value="3">Image Format</option>

                            </select>
                        </td>
                        <td style="width:15%;text-align:right">
                            Print On:
                        </td>
                        <td style="width:10%">
                            <select id="cboPrintNo" style=" width:90%;"></select>
                        </td>
                        @*<td style="width:15%; font-family:Tahoma">
                            <input id="chkIsPrintHeader" type="checkbox" />Print Header
                        </td>*@
                      
                        <td style="width:15%;text-align:right;font-family:Tahoma">
                           Validity Days :
                        </td>
                        <td style="width:2%">
                            <input id="txtValidityDays" type="text" placeholder="Validity Days" />
                        </td>
                       
                    </tr>

                </table>
            </fieldset>
            <fieldset>
                <table class="tbl">
                    <tr>
                        <td style="width:20%">
                            <label style="font-family:Tahoma">BIN, Vat No:</label>
                        </td>
                        <td style="width:50%;text-align:left">
                            <input style="width:70%" id="txtBINNo" type="text" />
                        </td>
                        <td style="width:15%;text-align:right;font-family:Tahoma">
                            <label>Base Currency:</label>
                        </td>
                        <td style="width:15%">
                            <select id="cboCurrency" style="width:100%"></select>
                        </td>
                        
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <table class="tbl">
                    <tr>
                        <td class="tdInput">
                            <input id="txtAcceptanceBy" type="text" placeholder="Acceptance By" />
                        </td>
                        <td class="tdInput">
                            <input id="txtFor" type="text" placeholder="For" />
                        </td>
                    </tr>
                </table>
            </fieldset>
            
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnSaveExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                <a id="btnCloseExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
    </div>

<div class="menuMainCollectionTable">
    <table id="tblExportPIPrintSetups" title="Export PI Print Setup List" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="fasle" singleselect="true" autorowheight="false" toolbar="#toolbarExportPIPrintSetup">
        <thead>
            <tr>
                <th field="SetupNo" width="10%">Setup No</th>
                <th field="Note" width="15%">Setup Name</th>
                <th field="DateInString" width="10%">Setup Date</th>
                <th field="PartShipment" width="30%">PartShipment</th>
                <th field="ShipmentBy" width="10%">ShipmentBy</th>
                <th field="PlaceOfShipment" width="10%">PlaceOfShipment</th>
                <th field="ActivityInString" width="10%">Activity</th>      
            </tr>
        </thead>
    </table>
    <div id="toolbarExportPIPrintSetup">
        <a id="btnAddExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
        <a id="btnEditExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
        <a id="btnDeleteExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
        <a id="btnViewExportPIPrintSetup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Details</a>
      <a id="btnActivity" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Activity</a>
      </div>
</div>

</body>
<style type="text/css">
                          #winExportPIPrintSetup {
                              width: 800px;
                          }
</style>



<script type="text/javascript">
    var _sBaseAddress="";
    var _oExportPIPrintSetup=null;
    var _oExportPIPrintSetups=[];
    var _oBusinessUnits=[];
    var _oCurrencys=[];
    var _oPrintNos=[];
    var _nBUID = 0;
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oExportPIPrintSetups =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oBusinessUnits = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
        _oCurrencys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
        _oPrintNos = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PrintNoList));
        _nBUID = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.BUID));        
        $('#txtValidityDays').icsCurrencyBox(null, null,0);
        DynamicRefreshList(_oExportPIPrintSetups, "tblExportPIPrintSetups");
        if(sessionStorage.getItem('TempRowIndex')!=undefined)
        {
            $('#tblExportPIPrintSetups').datagrid('selectRow',parseInt(sessionStorage.getItem('TempRowIndex')));
        }
        RefreshCBO();
    });
    function RefreshCBO()
    {
        $("#cboBU").icsLoadCombo({
            List: _oBusinessUnits,
            OptionValue: "BusinessUnitID",
            DisplayText: "BUTypeSt"
        });
        $("#cboCurrency").icsLoadCombo({
            List: _oCurrencys,
            OptionValue: "CurrencyID",
            DisplayText: "CurrencyName"
        });
        $("#cboPrintNo").icsLoadCombo({
            List: _oPrintNos,
            OptionValue: "id",
            DisplayText: "Value"
        });  
    }
    $(document).keydown(function (e) { if (e.keyCode == 27) { $('#winExportPIPrintSetup').icsWindow('close'); } });


    $("#btnSaveExportPIPrintSetup").click(function (e) {

        if (!ValidateInputExportPIPrintSetup()) return;
        var oExportPIPrintSetup = RefreshObjectExportPIPrintSetup();
        var obj =
            {
                BaseAddress: _sBaseAddress,
                Object: oExportPIPrintSetup,
                ObjectId: oExportPIPrintSetup.ExportPIPrintSetupID,
                ControllerName: "ExportPIPrintSetup",
                ActionName: "Save",
                TableId: "tblExportPIPrintSetups",
                IsWinClose: true
            };
        $.icsSave(obj);
    });

    $("#btnCloseExportPIPrintSetup").click(function () {
        $("#winExportPIPrintSetup").icsWindow("close");
        $("#winExportPIPrintSetup input").val("");
        $("#winExportPIPrintSetup select").val(0);
    });

    function RefreshObjectExportPIPrintSetup() {

        if (_nBUID <= 0 || _nBUID == null) {
            _nBUID = $("#cboBU").val();
        }

        var oExportPIPrintSetup = {
            ExportPIPrintSetupID: (_oExportPIPrintSetup != null) ? _oExportPIPrintSetup.ExportPIPrintSetupID : 0,
            SetupNo: $("#txtSetupNo").val(),
            Date: $('#txtDate').datebox('getValue'),
            Note: $("#txtSetupNote").val(),
            Preface: $("#txtPreface").val(),
            PartShipment: $("#txtPartShipment").val(),
            ShipmentBy: $("#txtShipmentBy").val(),
            PlaceOfShipment: $("#txtPlaceofShipment").val(),
            PlaceOfDelivery: $("#txtPlaceofDelivery").val(),
            BINNo: $("#txtBINNo").val(),
            AcceptanceBy: $("#txtAcceptanceBy").val(),
            BUID:_nBUID,
            BaseCurrencyID:$('#cboCurrency').val(),
            ValidityDays:parseFloat(icsRemoveComma($('#txtValidityDays').val())),
            PrintNo: $("#cboPrintNo").val(),
            HeaderType:$("#cboHeaderType").val(),
            For: $("#txtFor").val()
     
        };
        return oExportPIPrintSetup;
    }


    function ValidateInputExportPIPrintSetup()
    {

        if (!$.trim($('#txtSetupNote').val()).length) {
            alert("Please enter ExportPIPrintSetup name."); $('#txtSetupNote').focus();
            $('#txtSetupNote').css("border", "1px solid #c00");
            return false;
        } else { $('#txtSetupNote').css("border", ""); }
        return true;
    }



    $("#btnAddExportPIPrintSetup").click(function () {
        $("#winExportPIPrintSetup").icsWindow('open',"Add ExportPIPrintSetup");
        $("#winExportPIPrintSetup input").val("");
        $("#winExportPIPrintSetup select").val(0);
        _oExportPIPrintSetup = null;
        RefreshExportPIPrintSetupLayout("btnAddExportPIPrintSetup");
    });

    $("#btnEditExportPIPrintSetup").click(function () {
        var oExportPIPrintSetup = $("#tblExportPIPrintSetups").datagrid("getSelected");
        if (oExportPIPrintSetup == null || oExportPIPrintSetup.ExportPIPrintSetupID <= 0) { alert("Please select an item from list!"); return; }
        $("#winExportPIPrintSetup").icsWindow('open', "Edit ExportPIPrintSetup");
        RefreshExportPIPrintSetupLayout("btnEditExportPIPrintSetup");
        GetExportPIPrintSetupInformation(oExportPIPrintSetup);
    });

    $("#btnViewExportPIPrintSetup").click(function () {
        var oExportPIPrintSetup = $("#tblExportPIPrintSetups").datagrid("getSelected");
        if (oExportPIPrintSetup == null || oExportPIPrintSetup.ExportPIPrintSetupID <= 0) {alert("Please select an item from list!");return; }
        $("#winExportPIPrintSetup").icsWindow('open',"View ExportPIPrintSetup");
        RefreshExportPIPrintSetupLayout("btnViewExportPIPrintSetup");
        GetExportPIPrintSetupInformation(oExportPIPrintSetup);
    });

    $("#btnDeleteExportPIPrintSetup").click(function () {
        var oExportPIPrintSetup = $("#tblExportPIPrintSetups").datagrid("getSelected");
        if (oExportPIPrintSetup == null || oExportPIPrintSetup.ExportPIPrintSetupID <= 0) {
            alert("Please select an item from list.");
            return false;
        }
        if (!confirm("Confirm to Delete?")) return false;
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oExportPIPrintSetup,
            ObjectId: oExportPIPrintSetup.ExportPIPrintSetupID,
            ControllerName: "ExportPIPrintSetup",
            ActionName: "Delete",
            TableId: "tblExportPIPrintSetups",
            IsWinClose: true
        };
        $.icsDelete(obj);
    });

    $("#btnActivity").click(function () {
        debugger;
        var oExportPIPrintSetup = $("#tblExportPIPrintSetups").datagrid("getSelected");
        var SelectedRowIndex = $('#tblExportPIPrintSetups').datagrid('getRowIndex', oExportPIPrintSetup);
        sessionStorage.setItem('TempRowIndex',SelectedRowIndex);
        if (oExportPIPrintSetup == null || parseInt(oExportPIPrintSetup.ExportPIPrintSetupID)<= 0)
        {
            alert("Please select an item from list.");
            return false;
        }
        if (oExportPIPrintSetup.Activity == true) 
        {
            if (!confirm("Confirm to In Active?")) return false;
            oExportPIPrintSetup.Activity=false;
        }
        else {
            if (!confirm("Confirm to Active?")) return false;
            oExportPIPrintSetup.Activity=true;
        }

        $.ajax({
            type: "POST",
            dataType: "json",
            url : sessionStorage.getItem('BaseAddress')+  "/ExportPIPrintSetup/ActiveInactive",
            traditional: true,
            data:  JSON.stringify(oExportPIPrintSetup),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oExportPIPrintSetup = jQuery.parseJSON(data);                
                if (oExportPIPrintSetup.ErrorMessage ==="") {
                    alert("Data Saved sucessfully");                    
                    window.location.href = window.location.href;
                }
                else {
                    alert(oExportPIPrintSetup.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    });
    
    function GetExportPIPrintSetupInformation(oExportPIPrintSetup) {
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oExportPIPrintSetup,
            ControllerName: "ExportPIPrintSetup",
            ActionName: "Get",
            IsWinClose: false
        };

        $.icsDataGet(obj, function (response) {
            debugger;
            if (response.status && response.obj!=null) {
                if (response.obj.ExportPIPrintSetupID > 0) { RefreshExportPIPrintSetupControl(response.obj); }
                else { alert(response.obj.ErrorMessage); }
            }
            else
            {

                alert("No information found.");
            }
        });
    }

    function RefreshExportPIPrintSetupLayout(buttonId) {
        debugger;
        if (buttonId === "btnViewExportPIPrintSetup") {
            $("#winExportPIPrintSetup input").prop("disabled", true);
            $("#btnSaveExportPIPrintSetup").hide();
        }
        else {
            $("#winExportPIPrintSetup input").prop("disabled", false);
            $("#btnSaveExportPIPrintSetup").show();
        }
        $(".disabled input").prop("disabled", true);
    }

    function RefreshExportPIPrintSetupControl(oExportPIPrintSetup)
    {
        _oExportPIPrintSetup = oExportPIPrintSetup;
        $("#txtSetupNo").val(_oExportPIPrintSetup.SetupNo);
        $('#txtDate').datebox('setValue', _oExportPIPrintSetup.DateInString);
        $("#txtSetupNote").val(_oExportPIPrintSetup.Note);
        $("#txtPreface").val(_oExportPIPrintSetup.Preface);
        $("#txtPartShipment").val(_oExportPIPrintSetup.PartShipment);
        $("#txtShipmentBy").val(_oExportPIPrintSetup.ShipmentBy);
        $("#txtPlaceofShipment").val(_oExportPIPrintSetup.PlaceOfShipment);
        $("#txtPlaceofDelivery").val(_oExportPIPrintSetup.PlaceOfDelivery);
        $("#txtBINNo").val(_oExportPIPrintSetup.BINNo);
        $("#cboBU").val(_oExportPIPrintSetup.BUID);
        $("#cboCurrency").val(_oExportPIPrintSetup.BaseCurrencyID);
        $("#txtValidityDays").val(_oExportPIPrintSetup.ValidityDays);
        $("#txtFor").val(_oExportPIPrintSetup.For);
        $("#txtAcceptanceBy").val(_oExportPIPrintSetup.AcceptanceBy);
        $("#cboPrintNo").val(_oExportPIPrintSetup.PrintNo);
        $("#cboHeaderType").val(_oExportPIPrintSetup.HeaderType);

    }

</script>
