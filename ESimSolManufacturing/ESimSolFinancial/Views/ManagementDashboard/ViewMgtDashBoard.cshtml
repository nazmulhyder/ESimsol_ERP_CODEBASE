@{
    ViewBag.Title = "Management Dashboard";
}
@model ESimSol.BusinessObjects.MgtDBObj
<html>
<body>
    <div class="easyui-panel" title="Management Dashboard" id="PnlMgtDashBoard" style="width:100%;height:100%;" data-options="fit:true,border:false,tools:'#panelMgtDashBoardAccount'">
        <div class="easyui-layout menuMainCollectionTable" style="width:100%;height:100%;">
            <div data-options="region:'north'" style="height:60px;width:100%;">
                <table id="tblMgtDashBoardAccounts" style="font-weight:bold" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar">
                    <thead>
                        <tr>
                            <th field="CashBalanceSt" width="16%" align="right"><label>Cash Balance</label></th>
                            <th field="BankBalanceSt" width="16%" align="right"><label>Bank Balance</label></th>
                            <th field="ForeignBankBalanceSt" width="16%" align="right"><label>Foreign Bank Balance</label></th>
                            <th field="ReceivableSt" width="16%" align="right"><label>Receivable (Customer)</label></th>
                            <th field="PayableSt" width="16%" align="right"><label>Payable (Supplier)</label></th>
                            <th field="BankLoanSt" width="16%" align="right"><label>Bank Loan</label></th>
                        </tr>
                    </thead>
                </table>
            </div>
            @*<div data-options="region:'south',split:true" style="height:50px;">derarew</div>*@
            <div data-options="region:'west'" title="ORDER, MKT & PRODUCTION" style="width:220px;">
                <div style="width:100%;height:100%">
                    <div class="easyui-accordion" style="width:100%;height:100%;">
                        <div title="Order Summery" data-options="iconCls:'icon-details'" style="overflow:auto;">
                            <div style="height:7%;">
                                <input id="txtStartDateForOrderSummery" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                To
                                <input id="txtEndDateForOrderSummery" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                <a id="btnSearchForOrderSummery" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            </div>
                            <div style="height:93%;">
                                <table id="tblOrderSummery" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">Operation Type</th>
                                            <th field="RefQtySt" width="41%" align="right">Qty</th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>

                        </div>
                        <div title="Top 10 MKT Performance" data-options="iconCls:'icon-details'">
                            <div style="height:7%;">
                                <input id="txtStartDateForMarketingPerformance" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                To
                                <input id="txtEndDateForMarketingPerformance" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                <a id="btnSearchForMarketingPerformance" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            </div>
                            <div style="height:93%;">
                                <table id="tblMarketingPerformance" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">MKT Person</th>
                                            <th field="RefAmountSt" width="41%" align="right">Amount</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div title="Heighest Produced Prod." data-options="iconCls:'icon-details'">
                            <div style="height:7%;">
                                <input id="txtStartDateForHeighestProducedProduct" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                To
                                <input id="txtEndDateForHeighestProducedProduct" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                <a id="btnSearchForHeighestProducedProduct" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            </div>
                            <div style="height:93%;">
                                <table id="tblHeighestProducedProducts" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">Product</th>
                                            <th field="RefQty" width="41%" align="right">Qty</th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-options="region:'center'">
                <div class="easyui-panel" style="width:100%;height:100%;">
                    <div class="easyui-layout" data-options="fit:true">
                        <div data-options="region:'north',split:true" style="height:50%">
                            <div class="easyui-layout" data-options="fit:true">
                                <div data-options="region:'west',split:true" style="width:50%">
                                    <div style="text-align:center;height:100%; width:100%;margin:0 auto">
                                        <div id="barChartPIVsLCRcv" style="text-align:center;height:180px; width:98%;margin:0 auto"></div>
                                        <div id="barChartPIVsLCRcvName" style="width:90%;margin:0 auto; margin-top:5px; text-align:center; font-weight:bold;"></div>
                                        <div style="width:100%;margin:0 auto; margin-top:1px; text-align:center; font-weight:bold">
                                            <a id="lblSalesStatement" style="font-weight:bold; color:blue; cursor:pointer">Sales Statement</a> ||
                                            <a id="lblExportFollowup" style="font-weight:bold; color:blue; cursor:pointer">Export Followup</a> ||
                                            <a id="lblExportOutStanding" style="font-weight:bold; color:blue; cursor:pointer">OutStanding</a>||
                                            <a id="btnChartFullView" style="font-weight:bold;color:blue;cursor:pointer"  >More..</a> 
                                        </div>
                                    </div>
                                </div>
                                <div data-options="region:'center'">
                                    <div style="text-align:center;height:100%; width:100%;margin:0 auto">
                                        <div id="barChartExportReceivableVsImportPayable" style="text-align:center;height:180px; width:98%;margin:0 auto"></div>
                                        <div id="barChartExportReceivableVsImportPayableName" style="width:90%;margin:0 auto; margin-top:5px; text-align:center; font-weight:bold"></div>
                                        <div style="width:100%;margin:0 auto; margin-top:1px; text-align:center; font-weight:bold">
                                            <a id="lblImportPIRegister" style="font-weight:bold; color:blue; cursor:pointer">ImportPI Register</a> ||
                                            <a id="lblImportLCRegister" style="font-weight:bold; color:blue; cursor:pointer">ImportLC Register</a> ||
                                            <a id="lblImportOutStanding" style="font-weight:bold; color:blue; cursor:pointer">OutStanding</a>||
                                            <a id="btnChartExportImportFullView" style="font-weight:bold;color:blue;cursor:pointer">More..</a>                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div data-options="region:'south',split:true" style="height:50%">
                            <div class="easyui-layout" data-options="fit:true">
                                <div data-options="region:'west',split:true" style="width:50%">                                    
                                    <div style="height:100%;">
                                        <table id="tblStockSummery" title="Stock Summery" class="easyui-datagrid" style="height:100%; width:100%" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                            <thead>
                                                <tr>
                                                    <th field="RefCaption" width="30%" align="left">Product Type</th>
                                                    <th field="MUnit" width="15%" align="left">M.Unit</th>
                                                    <th field="RefQtySt" width="25%" align="right">Qty</th>
                                                    <th field="RefAmountSt" width="25%" align="right">Stock Value</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                                <div data-options="region:'center'">
                                    <div style="height:100%;">
                                        <table id="tblDyeingForeCast" title="Production Forecast" class="easyui-datagrid" style="height:100%; width:100%" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true" toolbar="#toolbarDyeingForeCast">
                                            <thead>
                                                <tr>
                                                    <th field="DyeingTypeSt" width="18%" align="left">Dyeing Type</th>
                                                    <th field="YetToProdQtySt" width="23%" align="right">Prod Pending</th>
                                                    <th field="VirtualYetToProdQtySt" width="23%" align="right">Equivalent Qty</th>
                                                    <th field="ProductionCapacitySt" width="18%" align="right">Capacity</th>
                                                    <th field="ReqDaysSt" width="12%" align="left">Req Days</th>
                                                </tr>
                                            </thead>
                                        </table>    
                                        <div id="toolbarDyeingForeCast">
                                            <select style="width:140px" id="cboForecastLayout"></select>
                                            <input id="txtStartDateDyeingForeCast" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:95px" />
                                            To
                                            <input id="txtEndDateDyeingForeCast" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:95px" />
                                            <a id="btnSearchDyeingForeCast" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                                        </div>                                    
                                    </div>                                                                  
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-options="region:'east'" title="CUSTOMER & SELLING PRODUCT" style="width:220px;">
                <div style="width:100%;height:100%">
                    <div class="easyui-accordion" style="width:100%;height:100%;">
                        <div title="Top 10 Customer" data-options="iconCls:'icon-details'" style="overflow:auto;">
                            <div style="height:7%;">
                                <input id="txtStartDateForTop10Customer" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                To
                                <input id="txtEndDateForTop10Customer" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                <a id="btnSearchForTop10Customer" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            </div>
                            <div style="height:93%;">
                                <table id="tblTop10Customers" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">Customer</th>
                                            <th field="RefAmountSt" width="41%" align="right">Amount</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div title="Top 10 Overdue Customer" data-options="iconCls:'icon-details'" style="">                            
                            <div style="height:100%;">
                                <table id="tblTop5OverdueCustomers" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">Customer</th>
                                            <th field="RefAmountSt" width="41%" align="right">Amount</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>

                        </div>
                        <div title="Heighest Selling Prod." data-options="iconCls:'icon-details'" style="">
                            <div style="height:7%;">
                                <input id="txtStartDateForHeighestSellingProduct" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                To
                                <input id="txtEndDateForHeighestSellingProduct" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:75px" />
                                <a id="btnSearchForHeighestSellingProduct" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
                            </div>
                            <div style="height:93%;">
                                <table id="tblHeighestSellingProducts" class="easyui-datagrid" style="height:100%" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" showfooter="true">
                                    <thead>
                                        <tr>
                                            <th field="RefCaption" width="55%" align="left">Product</th>
                                            <th field="RefQtySt" width="41%" align="right">Amount</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>

                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>
    <div id="panelMgtDashBoardAccount" style="">        
        <input id="txtReportDate" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style="width:100px" />
        <select id="cboBusinessUnit" style="width:100px;height:22px;"></select>
        <a id="btnSearchDashBoard" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>
        &nbsp;&nbsp;
    </div>
</body>
</html>

<script type="text/javascript">
    $(document).ready(function () {
        var sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oMgtDBObj = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        var oBusinessUnits = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
        var oMgtDashBoardAccounts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MgtDashBoardAccounts));
        var oOrderSummerys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.OrderSummerys));
        var oTop5MKTPerformances = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Top5MKTPerformances));
        var oHighestProducedProducts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.HighestProducedProducts));
        var oTopTenCustomers = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.TopTenCustomers));
        var oTopFiveOverDueCustomers = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.TopFiveOverDueCustomers));
        var oHighestSellingProducts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.HighestSellingProducts));
        var oExpPIIssueVsLCRcvs = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExpPIIssueVsLCRcvs));
        var oExportRecevableVsImportPayables = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ExportRecevableVsImportPayables));
        var oStockSummerys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.StockSummerys));
        var oDyeingForeCasts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DyeingForeCasts));
        var oForecastLayouts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ForecastLayout));
        var sStartDateForecast= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ForecastStartDate));
        var sEndDateForecast = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ForecastEndDate));

        $('#PnlMgtDashBoard').data("BaseAddress", sBaseAddress);        
        $('#txtReportDate').datebox('setValue', oMgtDBObj.ReportDateSt);
        $("#cboBusinessUnit").icsLoadCombo({ List: oBusinessUnits, OptionValue: "BusinessUnitID", DisplayText: "ShortName", InitialValue:"--Select BU--" });
        $("#cboForecastLayout").icsLoadCombo({ List: oForecastLayouts, OptionValue: "id", DisplayText: "Value", InitialValue:"--Select Layout--" });    
        $('#txtStartDateDyeingForeCast').datebox('setValue', sStartDateForecast);
        $('#txtEndDateDyeingForeCast').datebox('setValue', sEndDateForecast);

        $('#AppMainLayout').layout('collapse', 'west');        
        $('#AppMainLayout').layout('expand', 'west');
        $('#AppMainLayout').layout('collapse', 'west');
        
        $("#cboForecastLayout").val(1);
        $("#cboBusinessUnit").val(parseInt(oMgtDBObj.BUID));
        $('#PnlMgtDashBoard').panel('setTitle', "Management Dashboard : " +oMgtDBObj.RefCaption);
        $('#txtStartDateForOrderSummery').datebox('setValue', oMgtDBObj.StartDateSt);
        $('#txtEndDateForOrderSummery').datebox('setValue', oMgtDBObj.EndDateSt);
        $('#txtStartDateForMarketingPerformance').datebox('setValue', oMgtDBObj.StartDateSt);
        $('#txtEndDateForMarketingPerformance').datebox('setValue', oMgtDBObj.EndDateSt);
        $('#txtStartDateForHeighestProducedProduct').datebox('setValue', oMgtDBObj.StartDateSt);
        $('#txtEndDateForHeighestProducedProduct').datebox('setValue', oMgtDBObj.EndDateSt);
        $('#txtStartDateForTop10Customer').datebox('setValue', oMgtDBObj.StartDateSt);
        $('#txtEndDateForTop10Customer').datebox('setValue', oMgtDBObj.EndDateSt);        
        $('#txtStartDateForHeighestSellingProduct').datebox('setValue', oMgtDBObj.StartDateSt);
        $('#txtEndDateForHeighestSellingProduct').datebox('setValue', oMgtDBObj.EndDateSt);

        DynamicRefreshList(oMgtDashBoardAccounts, "tblMgtDashBoardAccounts");
        DynamicRefreshList(oOrderSummerys, "tblOrderSummery");
        DynamicRefreshList(oTop5MKTPerformances, "tblMarketingPerformance");
        DynamicRefreshList(oHighestProducedProducts, "tblHeighestProducedProducts");
        DynamicRefreshList(oTopTenCustomers, "tblTop10Customers");
        DynamicRefreshList(oTopFiveOverDueCustomers, "tblTop5OverdueCustomers");
        DynamicRefreshList(oHighestSellingProducts, "tblHeighestSellingProducts");
        DynamicRefreshList(oStockSummerys, "tblStockSummery");
        DynamicRefreshList(oDyeingForeCasts, "tblDyeingForeCast");
        
        LoadExpPIIssueVsLCRcvChart(oExpPIIssueVsLCRcvs);
        LoadExportRecevableVsImportPayableChart(oExportRecevableVsImportPayables);
                        
        RefreshFooter(2); //Top_Five_Marketing_Performance = 2
        RefreshFooter(3); //Highest_Produced_Product = 3
        RefreshFooter(4); //Top_Ten_Customer = 4
        RefreshFooter(5); //Top_Five_Over_Due_Customer = 5
        RefreshFooter(6); //Highest_Selling_Product = 6
        RefreshFooter(9); //Stock_Summery = 9
        RefreshFooter(10); //DyeingForeCast = 10
    });

    function RefreshFooter(nRefType)
    {
        var FooterField=[];
        var obj=new Object();
               
        if(parseInt(nRefType)===2)
        {
            //Top_Five_Marketing_Performance = 2
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewMKTDetails()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblMarketingPerformance').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===3)
        {
            //Highest_Produced_Product = 3
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewHighestProducedProducts()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblHeighestProducedProducts').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===4)
        {
            //Top_Ten_Customer = 4
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewTopTenCustomer()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblTop10Customers').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===5)
        {
            //Top_Five_Over_Due_Customer = 5
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewOverDueCustomers()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblTop5OverdueCustomers').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===6)
        {
            //Highest_Selling_Product = 6
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewHighestSellingProducts()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblHeighestSellingProducts').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===9)
        {
            //Stock_Summery = 9
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewStockSummery()">View More... ...</a>'
            obj['RefCaption']= sLinkText;
            FooterField.push(obj);
            $('#tblStockSummery').datagrid('reloadFooter',FooterField);
        }
        if(parseInt(nRefType)===10)
        {
            //DyeingForeCast = 10
            var sLinkText  = '<a style="font-weight:bold; color:blue; cursor:pointer" onclick="ViewProductionForeCast()">Full View... ...</a>'
            obj['DyeingTypeSt']= sLinkText;
            FooterField.push(obj);
            $('#tblDyeingForeCast').datagrid('reloadFooter',FooterField);
        }
    }
    
    function ViewMKTDetails()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportLCReport/View_ExportProductReports?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }

    //function ViewHighestProducedProducts()
    //{
    //    if(parseInt($("#cboBusinessUnit").val()) <= 0){
    //        alert("Please Enter Business Unit!!");
    //        $("#cboBusinessUnit").focus();
    //        return false;
    //    }
    //    window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/RouteSheet/ViewRouteSheetMultiYarnOut?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    //}

    function ViewHighestProducedProducts()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        var oObj = $('#tblHeighestProducedProducts').datagrid('getSelected');
        if(oObj == null || oObj.RefValueID <= 0){
            alert("Please select an Item!!");
            return false;
        }
        //var sTemp = 0 + '~' + $('#txtStartDateForHeighestProducedProduct').datebox('getValue') + '~' + $('#txtEndDateForHeighestProducedProduct').datebox('getValue') 
        //                           + '~' + "" + '~' + "" + '~' + "" + "~" + 0 + "~" + "" + "~" + 4 + "~" + 5 + '~' + $('#txtStartDateForHeighestProducedProduct').datebox('getValue') + '~' + $('#txtEndDateForHeighestProducedProduct').datebox('getValue')
        //                           + '~' + "" + '~' + 0 +'~'+false+'~'+false+'~'+""+'~'+""+'~'+oObj.RefValueID;
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/RouteSheet/ViewRouteSheetMultiYarnOut2?buid="+parseInt($("#cboBusinessUnit").val())+"&nProductID="+oObj.RefValueID+"&dStartDate="+$('#txtStartDateForHeighestProducedProduct').datebox('getValue')+"&dEndDate="+$('#txtEndDateForHeighestProducedProduct').datebox('getValue'), "_blank");
    }

    function ViewTopTenCustomer()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportLCRegister/ViewExportLCRegisters?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }

    function ViewOverDueCustomers()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportOutstanding/ViewExportOutstandings?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }

    function ViewHighestSellingProducts()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportLCRegister/ViewExportLCRegisters?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }

    function ViewStockSummery()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/InventoryTraking/ViewInventoryTrakingsDyeing?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
        //window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ItemMovement/ViewItemMovements?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }
    
    $("#btnSearchDashBoard").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        var sReportDate = $('#txtReportDate').datebox('getValue');
        if(sReportDate===null || sReportDate==="")
        {
            alert("Please select report date!");
            $('#txtReportDate').focus();
            return false;
        }
        window.location.href = $('#PnlMgtDashBoard').data("BaseAddress") + "/ManagementDashboard/ViewMgtDashBoard?nbuid="+parseInt($("#cboBusinessUnit").val())+"&sreportdate="+sReportDate+"&menuid=0";
    });
    
    $("#lblSalesStatement").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/SalesStatement/View_SalesStatements?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#lblExportFollowup").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportFollowup/View_ExportFollowups?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#btnChartFullView").click(function (){        
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ManagementDashboard/ViewMgtPIvsLC?nbuid=0&sreportdate=", "_blank");
    });

    $("#btnChartExportImportFullView").click(function (){
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ManagementDashboard/ViewMgtExportvsImport?nbuid=1&sreportdate=", "_blank");
    });

    function ViewProductionForeCast()
    {
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ManagementDashboard/ViewProductionForeCastFull?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    }

    $("#btnSearchDyeingForeCast").click(function (){
        RefreshDyeingForeCast();
    });

    $("#cboForecastLayout").change(function (e){        
        RefreshDyeingForeCast();
    });

    function RefreshDyeingForeCast()
    {
        if(parseInt($("#cboForecastLayout").val()) <= 0){
            DynamicRefreshList([], "tblDyeingForeCast");
            return;
        }
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return;
        }

        var sStartDate   = $('#txtStartDateDyeingForeCast').datebox('getValue');
        var sEndDate   = $('#txtEndDateDyeingForeCast').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateDyeingForeCast').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateDyeingForeCast').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateDyeingForeCast').focus();
            return false;
        }
        
        var oDyeingForeCast ={
            BUID : parseInt($("#cboBusinessUnit").val()),           
            ForecastLayoutInt : parseInt($("#cboForecastLayout").val()),
            StartDate : $('#txtStartDateDyeingForeCast').datebox('getValue'),
            EndDate : $('#txtEndDateDyeingForeCast').datebox('getValue')
        };
        $.ajax({
            type: "POST",
            dataType: "json",
            url : $('#PnlMgtDashBoard').data("BaseAddress") +"/ManagementDashboard/GetsDyeingForeCast",
            traditional: true,
            data:  JSON.stringify(oDyeingForeCast),
            contentType: "application/json; charset=utf-8",
            success: function (data) {                
                var oDyeingForeCasts = jQuery.parseJSON(data);
                if(oDyeingForeCasts!=null && oDyeingForeCasts.length>0)
                {
                    if(oDyeingForeCasts[0].ErrorMessage === null || oDyeingForeCasts[0].ErrorMessage === "")
                    {
                        DynamicRefreshList(oDyeingForeCasts, "tblDyeingForeCast");
                    }
                    else
                    {
                        alert(oDyeingForeCasts[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("Data Not Found!");
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    }

    $("#lblExportOutStanding").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ExportOutstanding/ViewExportOutstandings?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#lblImportPIRegister").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ImportPIRegister/ViewImportPIRegisters?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#lblImportLCRegister").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ImportLCRegister/ViewImportLCRegisters?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#lblImportOutStanding").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }
        window.open($('#PnlMgtDashBoard').data("BaseAddress") + "/ImportOutstanding/ViewImportOutstanding?buid="+parseInt($("#cboBusinessUnit").val())+"&menuid=0", "_blank");
    });

    $("#btnSearchForOrderSummery").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }

        var sStartDate   = $('#txtStartDateForOrderSummery').datebox('getValue');
        var sEndDate   = $('#txtEndDateForOrderSummery').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateForOrderSummery').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateForOrderSummery').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateForOrderSummery').focus();
            return false;
        }

        var oMgtDBObj ={
            BUID: parseInt($("#cboBusinessUnit").val()),
            StartDate : $('#txtStartDateForOrderSummery').datebox('getValue'),
            EndDate : $('#txtEndDateForOrderSummery').datebox('getValue'),
            RefTypeInt : 1 //Order_Summery = 1
        }
        GetsMgtDBData(oMgtDBObj, "tblOrderSummery");
    });

    $("#btnSearchForMarketingPerformance").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }

        var sStartDate   = $('#txtStartDateForMarketingPerformance').datebox('getValue');
        var sEndDate   = $('#txtEndDateForMarketingPerformance').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateForMarketingPerformance').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateForMarketingPerformance').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateForMarketingPerformance').focus();
            return false;
        }

        var oMgtDBObj ={
            BUID: parseInt($("#cboBusinessUnit").val()),
            StartDate : $('#txtStartDateForMarketingPerformance').datebox('getValue'),
            EndDate : $('#txtEndDateForMarketingPerformance').datebox('getValue'),
            RefTypeInt : 2 //Top_Five_Marketing_Performance = 2
        }
        GetsMgtDBData(oMgtDBObj, "tblMarketingPerformance");
    });

    $("#btnSearchForHeighestProducedProduct").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }

        var sStartDate   = $('#txtStartDateForHeighestProducedProduct').datebox('getValue');
        var sEndDate   = $('#txtEndDateForHeighestProducedProduct').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateForHeighestProducedProduct').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateForHeighestProducedProduct').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateForHeighestProducedProduct').focus();
            return false;
        }

        var oMgtDBObj ={
            BUID: parseInt($("#cboBusinessUnit").val()),
            StartDate : $('#txtStartDateForHeighestProducedProduct').datebox('getValue'),
            EndDate : $('#txtEndDateForHeighestProducedProduct').datebox('getValue'),
            RefTypeInt : 3 //Highest_Produced_Product = 3
        }
        GetsMgtDBData(oMgtDBObj, "tblHeighestProducedProducts");
    });

    $("#btnSearchForTop10Customer").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }

        var sStartDate   = $('#txtStartDateForTop10Customer').datebox('getValue');
        var sEndDate   = $('#txtEndDateForTop10Customer').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateForTop10Customer').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateForTop10Customer').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateForTop10Customer').focus();
            return false;
        }

        var oMgtDBObj ={
            BUID: parseInt($("#cboBusinessUnit").val()),
            StartDate : $('#txtStartDateForTop10Customer').datebox('getValue'),
            EndDate : $('#txtEndDateForTop10Customer').datebox('getValue'),
            RefTypeInt : 4 //Top_Ten_Customer = 4
        }
        GetsMgtDBData(oMgtDBObj, "tblTop10Customers");
    });
        
    $("#btnSearchForHeighestSellingProduct").click(function (){
        if(parseInt($("#cboBusinessUnit").val()) <= 0){
            alert("Please Enter Business Unit!!");
            $("#cboBusinessUnit").focus();
            return false;
        }

        var sStartDate   = $('#txtStartDateForHeighestSellingProduct').datebox('getValue');
        var sEndDate   = $('#txtEndDateForHeighestSellingProduct').datebox('getValue');
        if(sStartDate===null || sStartDate==="")
        {
            alert("Please select start date!");
            $('#txtStartDateForHeighestSellingProduct').focus();
            return false;
        }
        if(sEndDate===null || sEndDate==="")
        {
            alert("Please select end date!");
            $('#txtEndDateForHeighestSellingProduct').focus();
            return false;
        }
        if(new Date(sStartDate) > new Date(sEndDate))
        {
            alert("Start date must be smallar than or equal end date!");
            $('#txtStartDateForHeighestSellingProduct').focus();
            return false;
        }

        var oMgtDBObj ={
            BUID: parseInt($("#cboBusinessUnit").val()),
            StartDate : $('#txtStartDateForHeighestSellingProduct').datebox('getValue'),
            EndDate : $('#txtEndDateForHeighestSellingProduct').datebox('getValue'),
            RefTypeInt : 6 //Highest_Selling_Product = 6
        }
        GetsMgtDBData(oMgtDBObj, "tblHeighestSellingProducts");
    });

    function GetsMgtDBData(oMgtDBObj, sTableID){        
        $.ajax({
            type: "POST",
            dataType: "json",
            url : $('#PnlMgtDashBoard').data("BaseAddress") +"/ManagementDashboard/GetsMgtDBData",
            traditional: true,
            data:  JSON.stringify(oMgtDBObj),
            contentType: "application/json; charset=utf-8",
            success: function (data) { 
                debugger;
                var oMgtDBObjs = jQuery.parseJSON(data);
                if(oMgtDBObjs!=null && oMgtDBObjs.length>0)
                {
                    if(oMgtDBObjs[0].ErrorMessage === null || oMgtDBObjs[0].ErrorMessage === "")
                    {
                        DynamicRefreshList(oMgtDBObjs, sTableID);
                    }
                    else
                    {
                        alert(oMgtDBObjs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("Data Not Found!");
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    }

    function LoadExpPIIssueVsLCRcvChart(oExpPIIssueVsLCRcvs)
    {        
        var oGraphPIData = [];
        var oGraphLCRcvData = [];
        var oGraphTicks=[];
        var oDataPoint=[]; var x=0; var y=0;
        var oTickPoint=[]; var xx=0; var yy="";

        oDataPoint.push(0);
        oDataPoint.push(0)
        oGraphPIData.push(oDataPoint);

        oDataPoint=[];
        oDataPoint.push(0);
        oDataPoint.push(0)
        oGraphLCRcvData.push(oDataPoint);

        oTickPoint.push(0);
        oTickPoint.push('');
        oGraphTicks.push(oTickPoint);

        //oExpPIIssueVsLCRcvs =[];
        //var oExpPIIssueVsLCRcv = {TempID : 0, ExportPIAmount : 120540,  LCRcvAmount : 130500, RefCaption: "May 18"};
        //oExpPIIssueVsLCRcvs.push(oExpPIIssueVsLCRcv);
        //oExpPIIssueVsLCRcv = {TempID : 1, ExportPIAmount : 150500,  LCRcvAmount : 102460, RefCaption: "Jun 18"};
        //oExpPIIssueVsLCRcvs.push(oExpPIIssueVsLCRcv);
        //oExpPIIssueVsLCRcv = {TempID : 2, ExportPIAmount : 130600,  LCRcvAmount : 90000, RefCaption: "Jul 18"};
        //oExpPIIssueVsLCRcvs.push(oExpPIIssueVsLCRcv);
        //oExpPIIssueVsLCRcv = {TempID : 3, ExportPIAmount : 80540,  LCRcvAmount : 120000, RefCaption: "Aug 18"};
        //oExpPIIssueVsLCRcvs.push(oExpPIIssueVsLCRcv);
        //oExpPIIssueVsLCRcv = {TempID : 4, ExportPIAmount : 140000,  LCRcvAmount : 115000, RefCaption: "Sep 18"};
        //oExpPIIssueVsLCRcvs.push(oExpPIIssueVsLCRcv);
        
        for(var i=0; i< oExpPIIssueVsLCRcvs.length; i++)
        {
            oDataPoint=[];
            x = oExpPIIssueVsLCRcvs[i].TempID;
            y = oExpPIIssueVsLCRcvs[i].ExportPIAmount;
            oDataPoint.push(x);
            oDataPoint.push(y)
            oGraphPIData.push(oDataPoint);

            oDataPoint=[];
            x = oExpPIIssueVsLCRcvs[i].TempID;
            y = oExpPIIssueVsLCRcvs[i].LCRcvAmount;
            oDataPoint.push(x);
            oDataPoint.push(y)
            oGraphLCRcvData.push(oDataPoint);

            oTickPoint=[];
            xx = oExpPIIssueVsLCRcvs[i].TempID;
            yy = oExpPIIssueVsLCRcvs[i].RefCaption;
            oTickPoint.push(xx);
            oTickPoint.push(yy);
            oGraphTicks.push(oTickPoint);
        }



        var options = {
            series: {
                bars: {
                    show: true,
                    barWidth: 0.1,
                    order: 1,
                    align: "center"
                }
            },
            points: { show: true },
            xaxis: {
                axisLabel: "Month/Week",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 8,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 5,
                ticks: oGraphTicks

            },

            yaxis: {
                axisLabel: "Focast/Commission Value",
                position: "left",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 8,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 0,
                tickFormatter: function (v, axis) {
                    return formatPrice(v);
                }
            },

            legend: {
                noColumns: 0,
                labelBoxBorderColor: "#000000",
                position: "nw"
            },

            grid: {
                hoverable: true,
                borderWidth: 1,
                backgroundColor: { colors: ["#ffffff", "#EDF5FF"]
                }
            }
        };

        function gd(year, month, day) {
            return new Date(year, month, day).getTime();
        }

        var oGraphDataSet = [
                             { label: "PI Issue", data: oGraphPIData  , color: "#291BF5" },
                             { label: "LC Received", data: oGraphLCRcvData, color: "#A4472A" }

        ];

        var oExpPIIssueVsLCRcvPlot = $.plot($("#barChartPIVsLCRcv"), oGraphDataSet, options);
        $.plot($("#barChartPIVsLCRcv"), oGraphDataSet, options);
        $("#barChartPIVsLCRcv").UseTooltip();
        $('#barChartPIVsLCRcvName').html("Fig : PI Issued vs LC Received($)");
        //SetExpPIIssueVsLCRcvPoint(oExpPIIssueVsLCRcvPlot);
    }

    function SetExpPIIssueVsLCRcvPoint(oExpPIIssueVsLCRcvPlot)
    {        
        var PIContext = oExpPIIssueVsLCRcvPlot.getCanvas().getContext("2d");
        var oPIValues = oExpPIIssueVsLCRcvPlot.getData()[0].data;

        var xaxis = oExpPIIssueVsLCRcvPlot.getXAxes()[0];
        var yaxis = oExpPIIssueVsLCRcvPlot.getYAxes()[0];

        var offset = oExpPIIssueVsLCRcvPlot.getPlotOffset();
        PIContext.font = "8px 'Tahoma'";

        var LCRcvContext = oExpPIIssueVsLCRcvPlot.getCanvas().getContext("2d");
        var oLCRcvValues = oExpPIIssueVsLCRcvPlot.getData()[1].data;

        for (var i = 0; i <oPIValues.length; i++){
            PIContext .fillStyle = "Blue";
            var PItext = parseInt(oPIValues[i][1]) + '';
            var PImetrics = PIContext.measureText(PItext);
            var xPos = parseFloat(xaxis.p2c(oPIValues[i][0])) -parseFloat(offset.left)+ parseFloat(PImetrics.width/2)+1;            
            var yPos = yaxis.p2c(oPIValues[i][1]) + offset.top - 5;
            xPos =parseFloat(xPos)- parseFloat(1);
            PIContext .fillText(PItext,xPos, yPos);


            LCRcvContext.fillStyle = "Maroon";
            var Acctualetext = parseInt(oLCRcvValues[i][1]) + '';
            var LCRcvmetrics = LCRcvContext.measureText(Acctualetext);
            xPos = xaxis.p2c(oLCRcvValues[i][0]) +offset.left - parseFloat(LCRcvmetrics.width/2);
            yPos = yaxis.p2c(oLCRcvValues[i][1]) + offset.top - 5;
            LCRcvContext.fillText(Acctualetext, xPos, yPos);
        }
    }

    function LoadExportRecevableVsImportPayableChart(oExportRecevableVsImportPayables)
    {        
        var oGraphExportRecevableData = [];
        var oGraphImportPayableData = [];
        var oGraphTicks=[];
        var oDataPoint=[]; var x=0; var y=0;
        var oTickPoint=[]; var xx=0; var yy="";

        oDataPoint.push(0);
        oDataPoint.push(0)
        oGraphExportRecevableData.push(oDataPoint);

        oDataPoint=[];
        oDataPoint.push(0);
        oDataPoint.push(0)
        oGraphImportPayableData.push(oDataPoint);

        oTickPoint.push(0);
        oTickPoint.push('');
        oGraphTicks.push(oTickPoint);

        //oExportRecevableVsImportPayables =[];
        //var oExportRecevableVsImportPayable = {TempID : 0, ExportRecevableAmount : 120540,  ImportPayableAmount : 130500, RefCaption: "Oct 18"};
        //oExportRecevableVsImportPayables.push(oExportRecevableVsImportPayable);
        //oExportRecevableVsImportPayable = {TempID : 1, ExportRecevableAmount : 150500,  ImportPayableAmount : 102460, RefCaption: "Nov 18"};
        //oExportRecevableVsImportPayables.push(oExportRecevableVsImportPayable);
        //oExportRecevableVsImportPayable = {TempID : 2, ExportRecevableAmount : 130600,  ImportPayableAmount : 90000, RefCaption: "Dec 18"};
        //oExportRecevableVsImportPayables.push(oExportRecevableVsImportPayable);
        //oExportRecevableVsImportPayable = {TempID : 3, ExportRecevableAmount : 80540,  ImportPayableAmount : 120000, RefCaption: "Jan 19"};
        //oExportRecevableVsImportPayables.push(oExportRecevableVsImportPayable);
        //oExportRecevableVsImportPayable = {TempID : 4, ExportRecevableAmount : 140000,  ImportPayableAmount : 115000, RefCaption: "Feb 19"};
        //oExportRecevableVsImportPayables.push(oExportRecevableVsImportPayable);
        
        for(var i=0; i< oExportRecevableVsImportPayables.length; i++)
        {
            oDataPoint=[];
            x = oExportRecevableVsImportPayables[i].TempID;
            y = oExportRecevableVsImportPayables[i].ExportRecevableAmount;
            oDataPoint.push(x);
            oDataPoint.push(y)
            oGraphExportRecevableData.push(oDataPoint);

            oDataPoint=[];
            x = oExportRecevableVsImportPayables[i].TempID;
            y = oExportRecevableVsImportPayables[i].ImportPayableAmount;
            oDataPoint.push(x);
            oDataPoint.push(y)
            oGraphImportPayableData.push(oDataPoint);

            oTickPoint=[];
            xx = oExportRecevableVsImportPayables[i].TempID;
            yy = oExportRecevableVsImportPayables[i].RefCaption;
            oTickPoint.push(xx);
            oTickPoint.push(yy);
            oGraphTicks.push(oTickPoint);
        }



        var options = {
            series: {
                bars: {
                    show: true,
                    barWidth: 0.1,
                    order: 1,
                    align: "center"
                }
            },
            points: { show: true },
            xaxis: {
                axisLabel: "Month/Week",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 8,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 5,
                ticks: oGraphTicks

            },

            yaxis: {
                axisLabel: "Focast/Commission Value",
                position: "left",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 8,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 0,
                tickFormatter: function (v, axis) {
                    return formatPrice(v);
                }
            },

            legend: {
                noColumns: 0,
                labelBoxBorderColor: "#000000",
                position: "nw"
            },

            grid: {
                hoverable: true,
                borderWidth: 1,
                backgroundColor: { colors: ["#ffffff", "#EDF5FF"]
                }
            }
        };

        function gd(year, month, day) {
            return new Date(year, month, day).getTime();
        }

        var oGraphDataSet = [
                             { label: "Export Recevable", data: oGraphExportRecevableData  , color: "#291BF5" },
                             { label: "Import Payable", data: oGraphImportPayableData, color: "#A4472A" }

        ];

        var oExportRecevableVsImportPayablePlot = $.plot($("#barChartExportReceivableVsImportPayable"), oGraphDataSet, options);
        $.plot($("#barChartExportReceivableVsImportPayable"), oGraphDataSet, options);
        $("#barChartExportReceivableVsImportPayable").UseTooltip();
        $('#barChartExportReceivableVsImportPayableName').html("Fig : Export Recevable vs Import Payable($)");
        //SetExportRecevableVsImportPayablePoint(oExportRecevableVsImportPayablePlot);
    }

    function SetExportRecevableVsImportPayablePoint(oExportRecevableVsImportPayablePlot)
    {        
        var ExportRecevableContext = oExportRecevableVsImportPayablePlot.getCanvas().getContext("2d");
        var oExportRecevableValues = oExportRecevableVsImportPayablePlot.getData()[0].data;

        var xaxis = oExportRecevableVsImportPayablePlot.getXAxes()[0];
        var yaxis = oExportRecevableVsImportPayablePlot.getYAxes()[0];

        var offset = oExportRecevableVsImportPayablePlot.getPlotOffset();
        ExportRecevableContext.font = "8px 'Tahoma'";

        var ImportPayableContext = oExportRecevableVsImportPayablePlot.getCanvas().getContext("2d");
        var oImportPayableValues = oExportRecevableVsImportPayablePlot.getData()[1].data;

        for (var i = 0; i <oExportRecevableValues.length; i++){
            ExportRecevableContext .fillStyle = "Blue";
            var ExportRecevabletext = parseInt(oExportRecevableValues[i][1]) + '';
            var ExportRecevablemetrics = ExportRecevableContext.measureText(ExportRecevabletext);
            var xPos = parseFloat(xaxis.p2c(oExportRecevableValues[i][0])) -parseFloat(offset.left)+ parseFloat(ExportRecevablemetrics.width/2)+1;            
            var yPos = yaxis.p2c(oExportRecevableValues[i][1]) + offset.top - 5;
            xPos =parseFloat(xPos)- parseFloat(1);
            ExportRecevableContext .fillText(ExportRecevabletext,xPos, yPos);


            ImportPayableContext.fillStyle = "Maroon";
            var Acctualetext = parseInt(oImportPayableValues[i][1]) + '';
            var ImportPayablemetrics = ImportPayableContext.measureText(Acctualetext);
            xPos = xaxis.p2c(oImportPayableValues[i][0]) +offset.left - parseFloat(ImportPayablemetrics.width/2);
            yPos = yaxis.p2c(oImportPayableValues[i][1]) + offset.top - 5;
            ImportPayableContext.fillText(Acctualetext, xPos, yPos);
        }
    }

    var previousPoint = null, previousLabel = null;
    $.fn.UseTooltip = function () {
        $(this).bind("plothover", function (event, pos, item) {
            if (item) {
                if ((previousLabel != item.series.label) || (previousPoint != item.dataIndex)) {
                    previousPoint = item.dataIndex;
                    previousLabel = item.series.label;
                    $("#tooltip").remove();

                    var x = item.datapoint[0];
                    var y = item.datapoint[1];
                    nValue = false;
                    var color = item.series.color;

                    showTooltip(item.pageX,
                        item.pageY,
                        color,
                        "<strong>" + item.series.label + "</strong><br>" + item.series.xaxis.ticks[previousPoint].label+ " : <strong>" + formatPrice(y) + "</strong>");
                }
            } else {
                $("#tooltip").remove();
                previousPoint = null;
            }
        });
    };

    function showTooltip(x, y, color, contents) {
        $('<div id="tooltip">' + contents + '</div>').css({
            position: 'absolute',
            display: 'none',
            top: y - 40,
            left: x - 120,
            border: '2px solid ' + color,
            padding: '3px',
            'font-size': '9px',
            'border-radius': '5px',
            'background-color': '#fff',
            'font-family': 'Verdana, Arial, Helvetica, Tahoma, sans-serif',
            opacity: 0.9
        }).appendTo("body").fadeIn(200);
    }
</script>