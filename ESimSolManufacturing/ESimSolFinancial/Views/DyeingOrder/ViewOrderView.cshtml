<html>
<head>
    <title>Sale Order </title>
</head>
<body>

    @model ESimSol.BusinessObjects.DyeingOrder
    <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progressbar" style="width:100%;height:37px;"></div>
        </div>
    </div>
    <div class="menuMainCollectionTable">
        <div id="tabOrder" class="easyui-tabs" style="width:100%;">
            <div title="Order Info" style="width:100%;">
               
                    @*<legend id="leOrder" style="font-weight:bold"> Order entry: </legend>*@
                    <table  style="width:100%;border:1px solid black;" cellpadding="2" cellspacing="2">
                        <tr >
                            <td id="rtDyeingStep"  style="width: 20%; text-align: left" rowspan="2">
                                <table style="width:100%;border:1px solid black; border-collapse:collapse;text-align:left" border="1" cellpadding="0" cellspacing="0">

                                    <tr style="text-align:left;">
                                        <td style="text-align:left;"><input id="chkIsInHouseYes" type="checkbox" onclick="if(this.checked){IsInHouseYes()}else{IsInHouseNo()}" /> In House</td>
                                        <td style="text-align:left;"><input id="chkIsInHouseNo" type="checkbox" onclick="if(this.checked){IsInHouseNo()}else{IsInHouseYes()}" /> Outside</td>
                                    </tr>
                                    <tr style="text-align:left;">
                                        <td style="text-align:left;">Type:</td>
                                        <td style="width:50%; text-align: left">
                                            <select id="cboDyeingStepType" style="width:100%"></select>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td style="width: 15%; text-align: right">
                                <label>Order No</label>
                            </td>
                            <td style="width: 20%; text-align: left">
                                <input id="txtOrderNo" class="reset-text" placeholder="Auto Generate" style="width: 100%" />
                            </td>
                            <td style="width: 10%; text-align: right">
                                <label>Date</label>
                            </td>
                            <td style="width: 10%; text-align: left">
                                <input id="dtOrderDate" type="date" class="easyui-datebox" style="width: 105px;" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                            <td style="width:8%; text-align: right">
                                <label>Status</label>
                            </td>
                            <td style="width: 17%; text-align: right">
                                <input id="txtInvoiceNo" class="reset-text" style="width: 100%" placeholder="Auto Generate" readonly="readonly" />
                            </td>


                        </tr>
                        <tr>

                            <td style="width: 15%; text-align: right">
                                <label>
                                    Con Person
                                </label><span class="lblBUName"></span>:

                            </td>
                            <td style="width: 20%; text-align: left">
                                <input id="txtMktAccount" class="reset-text" placeholder="Search Concern Person" style="width:62%" />
                                <a id="btnPickMktAccount" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetMktPerson" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>
                            <td style="width: 10%; text-align: right">
                                <label>Payment Terms</label>
                            </td>
                            <td style="width: 10%; text-align: left">
                                <select id="cboPaymentType" onchange="ChangePaymentType()" style="width: 100%"></select>
                            </td>
                            <td style="width: 8%; text-align: right">
                                <span class="lblExportPINo"></span>
                            </td>
                            <td style="width: 17%; text-align: left">
                                <input id="txtExportPINo" style="width: 60%" class="reset-text" placeholder="" />
                                <a id="btnPickExportPI" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetExportPI" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>


                        </tr>

                    </table>

               
                <fieldset>
                    <legend id="leOrderTwo" style="font-weight:bold">  Order entry: </legend>
                    <table style="width:100%">

                        <tr>
                            <td style="width: 10%; text-align: right">
                                <label>Account Of:</label>
                            </td>
                            <td colspan="5" style="width: 50%; text-align: left">
                                <input id="txtIssueTo" style="width:80%" placeholder=" search issue to" />
                                <a id="btnPickIssueTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetIssueTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>
                            <td style="width: 15%; text-align: right">
                                <label>Concern Person:</label>
                            </td>
                            <td style="width: 25%; text-align: left">
                                <select id="cboCPIssueTo" style="width:60%"></select>
                                <a id="btnLoadIssueToCP" href=" javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false"></a>
                                <a id="btnNewIssueToCP" href=" javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false"></a>
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 10%; text-align: right">
                                <label>Deliver To:</label>
                            </td>
                            <td colspan="5" style="width: 50%; text-align: left">
                                <input id="txtDeliverTo" style="width:80%" placeholder="Search Delivery To" />
                                <a id="btnPickDeliverTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetDeliverTo" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>
                            <td style="width: 15%; text-align: right">
                                <label>Concern Person:</label>
                            </td>
                            <td style="width: 25%; text-align: left">

                                <select id="cboCPDeliverTo" style="width:60%"></select>
                                <a id="btnLoadDeliveryCP" href=" javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false"></a>
                                <a id="btnNewDeliveryCP" href=" javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false"></a>
                            </td>
                        </tr>
                    </table>
                    <table style="width:100%">
                        <tr>
                            <td style="width: 10%; text-align: right">

                                <label>Style No:</label>
                            </td>
                            <td style="width: 15%; text-align: left">
                                <input id="txtStyleNo" class="reset-text" placeholder="Style No" />
                            </td>
                            <td style="width: 10%; text-align: right">
                                <label>Ref No:</label>
                            </td>
                            <td style="width: 20%; text-align: left">
                                <input id="txtBuyerRef" style="width: 100%;" placeholder=" type buyer reference" />
                            </td>

                            <td style="width: 10%; text-align: right">
                                <label>Priority:</label>
                            </td>
                            <td style="width: 10%; text-align: left">
                                <select id="cboPriorityLevel" style="width:100%"></select>
                            </td>

                            <td style="width: 15%; text-align: right">
                                <label>Light Source(1st):</label>
                            </td>
                            <td style="width: 10%; text-align: left">
                                <select id="cboLightSource" style="width:90%"></select>
                            </td>

                        </tr>

                        <tr>
                            <td style="width: 10%; text-align:right">
                                <label>Remarks:</label>
                            </td>
                            <td colspan="5" style=" width:75%; text-align:left">
                                <input id="txtNote" style="width: 100%;" placeholder="Type Note" />
                            </td>
                            <td style="width: 15%; text-align: right">
                                <label id="lblLightSourceTwo">Light Source(2nd):</label>
                            </td>
                            <td style="width: 10%; text-align: left">
                                <select id="cboLightSourceTwo" style="width:90%"></select>
                            </td>
                        </tr>

                    </table>

                </fieldset>

                <fieldset>
                    <legend id="leOrderThree">Order Detail</legend>
                    <div style="width:99%;">
                        <table id="tblDyeingOrderDetail" class="easyui-datagrid" style="height: 200px; width:100%;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar">
                            <thead>
                                <tr>
                                    
                                    <th field="StatusSt" width="12%" align="left">Status </th>
                                    <th field="ProductNameCode" width="18%" align="left">Yarn </th>
                                    <th field="ColorNo" width="10%" align="left">Color No</th>
                                    <th field="ColorName" width="10%" align="left">ColorName</th>
                                    <th field="BuyerRef" width="10%" align="left">Yarn Lot</th>
                                    <th field="ShadeSt" width="5%" align="left">Shade</th>
                                    <th field="PantonNo" width="8%" align="left">Panton No</th>
                                    <th field="Qty" width="10%" align="right" formatter="formatPrice">Qty(<label id="lblMUName"></label>)</th>
                                    <th field="UnitPrice" width="10%" align="right" formatter="formatPrice">Unit Price($/<label id="lblMUName2"></label>)</th>
                                    <th field="Amount" width="10%" align="right" formatter="formatPrice">Amount($)</th>
                                    <th field="LabDipTypeSt" width="6%" align="left">LabDip Type</th>
                                    <th field="ApproveLotNo" width="10%" align="center">Batch/Lot No</th>
                                </tr>
                            </thead>
                        </table>
                        <div id="toolbar">
                            <a id="btnHoldProduction" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Hold Production</a>
                            <a id="btnBooking" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Booking</a>
                            <a id="btnHoldRunning" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Running</a>
                            @*<a id="btnHoldDelivery" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Hold Delivery</a>*@
                            
                        </div>
                        <table border="0" cellpadding="0" cellspacing="0" style="width:100%;">
                            <tr>
                                <td style="width:65%;  text-align:right;font-weight:bold;">Total:</td>
                                <td style="width:10%;  text-align:right;font-weight:bold;"><label id="lblTotalQty">0</label> </td>
                                <td style="width:5%;  text-align:right;font-weight:bold;"> </td>
                                <td style="width:10%; text-align:right; font-weight:bold;"><label id="lblTotalAmount"> </label> </td>
                                <td style="width:5%;  text-align:right;font-weight:bold;"> </td>
                            </tr>
                        </table>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>Action</legend>
                    <table border="0" cellpadding="0" cellspacing="0" style="float:right; width:100%;">
                        <tr>
                            <td style=" float:left;  width:10%; ">
                              
                            </td>
                            <td style="float:left;  width:20%; ">
                                <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
                            </td>
                            <td style="width:70%;float:right; text-align:right">
                                <a id="btnIsClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Close/Running</a>
                                <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <div title="Specification" >
                <div >
                    <fieldset>
                        <legend>Delivery Specification </legend>
                        <table style="width: 100%;height:65px; text-align: left">
                            <tr>
                                <td style="width:20%; text-align: left">
                                    Delivery Place:
                                </td>
                                <td style="width: 80%; text-align: left">
                                    <input id="txtDeliveryZone" class="reset-text" placeholder="Search Delivery Zone" style="width:60%" />
                                    <a id="btnPickDeliveryZone" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                    <a id="btnReseDeliveryZone" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                                    <a id="btnNewDeliveryZone" href=" javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false"></a>
                                    <a id="btnEditDeliveryZone" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true"></a>
                                </td>

                            </tr>
                        </table>
                    </fieldset>
</div>
                <fieldset>
                    <legend>Specification </legend>
                    <div title="Note(s)">
                        <table id="tblDONote_DO" class="easyui-datagrid" style="width:99%; height:325px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#TCtoolbar" data-options="singleSelect: true, fitColumns:false,  rownumbers:true,pagination:false,autoRowHeight:false, onClickRow: onClickRowTC">
                            <thead>
                                <tr>
                                    <th field="OrderNote" width="80%" align="left" data-options="field:'OrderNote',editor:{type:'text',options:{precision:0}}"> Terms & Condition </th>
                                </tr>
                            </thead>
                        </table>
                        <div id="TCtoolbar" style=" height:25px;">
                            <a id="btnAddDONote" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-pick" onclick="PickDONote()" plain="true">Pick</a>
                            <a id="btnRemoveDONote" href="javascript:void(0)" class="easyui-linkbutton" onclick="RemoveDONote()" iconcls="icon-remove" plain="true">Remove</a>
                            <a id="btnRefreshDONote" href="javascript:void(0)" class="easyui-linkbutton" onclick="RefreshDONote()" iconcls="icon-reload" plain="true">Refresh</a>
                        </div>
                    </div>
                </fieldset>
                    <fieldset class="actionfieldsetstyle">
                        <legend style="font-weight:bold;font-size:11px"> Action : </legend>
                        <table style="width:100%" border="0" cellspacing="2" cellpadding="2">
                            <tr>
                                <td style=" float:left;  width:40%;text-align:left">
                                </td>
                                <td style="width:30%"></td>
                                <td style="width:30%;text-align:right">
                                    <a id="btnSaveDONote" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                                    <a id="btnCloseTwo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-closed" plain="true">Close</a>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
</div>
        </div>
        
    </div>
    <div id="winDyeingOrderDetail" class=" easyui-window winclass" title="Edit Payment info" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div>
          
                <fieldset>
                    <table border="0" cellspacing="2" cellpadding="2" style="width:100%; font-size: 11px; font-weight: bold">

                        <tr>
                            <td style="width: 20%; text-align: right">
                                Yarn  :
                            </td>
                            <td colspan="3" style="width:80%">
                                <input id="txtProduct" class="reset-text" placeholder="Type & Press entry For Yarn" style="width: 85%" />
                                <a id="btnPickProduct" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetProduct" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>

                        </tr>
                        <tr>
                            <td style="width: 20%; text-align: right">
                                <label>
                                    Qty(
                                </label><span class="lblMUnitOne"></span>):

                            </td>

                            <td style="width: 30%; text-align: left">

                                <input type="text" style="width: 60%; text-align:right" id="txtQtyInOne" />

                            </td>
                            <td style="width: 20%; text-align: right">
                                <label>
                                    Qty(
                                </label><span class="lblMUnitTwo"></span>):

                            </td>

                            <td style="width: 30%; text-align: left">

                                <input type="text" style="width: 60%; text-align:right" id="txtQtyInTwo" />

                            </td>

                        </tr>
                        <tr>
                            <td style="width: 20%; text-align: right">
                              
                                <label>
                                    Unit Price ($/
                                </label><span class="lblMUnitOne"></span>):

                            </td>

                            <td style="width:30%; text-align: left">

                                <input type="text" style="width: 60%; text-align:right" id="txtUnitPriceInOne" />

                            </td>
                            <td style="width: 20%; text-align: right">
                                <label>
                                    Unit Price ($/
                                </label><span class="lblMUnitTwo"></span>):
                            </td>

                            <td style="width: 30%; text-align: left">

                                <input type="text" style="width:60%; text-align:right" id="txtUnitPriceInTwo" />

                            </td>

                        </tr>
                        
                    </table>
                </fieldset>
            <fieldset>
                <table border="0" cellspacing="2" cellpadding="2" style="width:100%; font-size: 11px; font-weight: bold">
                    <tr>
                        <td style="width: 20%; text-align: right">Type</td>
                        <td style="width: 30%;">
                            <select id="cboLabDipType" style="width:50%" onchange="ChangeLabDipType()"></select>
                        </td>
                        <td style="width: 20%; text-align: right">
                            Shade
                        </td>
                        <td style="width: 30%;">
                            <select style="width: 63px;" id="cboShade">
                                <option value="0">NA</option>
                                <option value="1">A</option>
                                <option value="2">B</option>
                                <option value="3">C</option>
                                <option value="4">D</option>
                                <option value="5">E</option>
                                <option value="6">F</option>
                                <option value="7">G</option>
                                <option value="8">H</option>
                                <option value="9">I</option>
                                <option value="10">J</option>
                                <option value="11">K</option>
                                <option value="12">L</option>
                                <option value="13">M</option>
                                <option value="14">N</option>
                                <option value="15">O</option>

                            </select>
                            <input id="txtShade" type="text"  style="width: 63px" disabled="disabled" />
                        </td>

                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                            LD/Color No
                        </td>
                        <td style="width: 30%;">
                            <input type="text" style="width: 80%;" id="txtColorNo" /><input type="button" style="width: 16%;"
                                                                                            value="Pic" id="btnColorNo" />
                        </td>
                        <td style="width: 20%; text-align: right">
                            Labdip Order No
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 80%;" id="txtLabdipNo" /><input type="button" style="width: 16%;"
                                                                                             value="Pic" id="btnLabdipNo" />


                        </td>
                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                           Match To(Lot/Batch No):
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 100%" id="txtApproveLotNo" />
                        </td>
                        <td style="width: 20%; text-align: right">
                            Color Name :
                        </td>
                        <td style="width: 30%">
                            <input type="text" disabled="disabled" style="width: 100%" id="txtColorName" />
                        </td>
                    </tr>
                    <tr>
                     
                        <td style="width: 20%; text-align: right">
                            Yarn Lot:
                        </td>
                        <td style="width: 30%">
                            <input type="text" disabled="disabled" style="width: 100%" id="txtBuyerRef_PCol" />
                        </td>
                        <td style="width: 20%; text-align: right">
                            Dev. Product:
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 100%" id="txtColorDevProduct" disabled="disabled" />
                        </td>

                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                           Hank/Cone:
                        </td>
                        <td style="width: 30%">
                            <select style="width: 100%;" id="cboHankorCone">                    
                            </select>
                        </td>
                        <td style="width: 20%; text-align: right">
                            Panton No :
                        </td>
                        <td style="width: 30%">
                            <input type="text" disabled="disabled" style="width: 100%" id="txtPantonNo" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                            NoOfCone(Warp) :
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 100%" id="txtNoOfCone" />
                        </td>
                        <td style="width: 20%; text-align: right">
                            LengthOfCone(Warp) :
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 100%" id="txtLengthOfCone" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                            NoOfCone(Weft) :
                        </td>
                        <td style="width: 30%">
                            <input type="text" style="width: 100%" id="txtNoOfCone_Weft" />
                        </td>
                        <td style="width: 20%; text-align: right">
                            Buyer Combo :
                        </td>
                        <td style="width: 30%">
                            @*<input type="text" style="width: 100%" id="txtBuyerCombo" />*@
                            <input id="txtBuyerCombo" type="number" min="0" pattern="^[0-9]" step="1" class="only-number" style="width: 70%" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 20%; text-align: right">
                            Note :
                        </td>
                        <td style="width: 30%">
                            <input type="text" id="txtNoteDetail" style="width: 100%;" />
                        </td>
                        <td style="width: 20%; text-align: right">
                           Exp. Delivery Date :
                        </td>
                        <td style="width: 30%">
                            <input type="text" class="easyui-datebox" style="width: 70%;" data-options="formatter:icsdateformat,parser:icsdateparser"
                                   id="txtDeliveryDate" />
                        </td>
                    </tr>
                </table>


            </fieldset>
            <div style="width:100%;">
                <fieldset>
                    <legend style="font-weight: bold">Action : </legend>
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold; width:100%">
                        <tr>
                            <td style="width:80%; text-align:right"></td>
                            <td style="width: 10%">
                                <a id="btnOk" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Ok</a>
                            </td>
                            <td style="width: 10%">
                                <a id="btnClose_DODetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>
    </div>
    <div id="winDONote" style="width:70%; text-align:center;" class="easyui-window winstyle" title="Specification orTerms And Condition Picker" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="width:100%; text-align:left;">
            <input type="text" id="txtDONote" placeholder="Search By Name" style="width:350px; text-align:left;" />&nbsp;&nbsp;&nbsp;
            <table id="tblDONote" title="" class="easyui-datagrid" style="height:300px; " fitcolumns="false" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                <thead>
                    <tr>
                        <th data-options="field:'Selected',checkbox:true"></th>
                        <th field="OrderNote" width="80%">Clause</th>
                    </tr>
                </thead>
            </table>
        </div>

        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnOkDyeingOrderNote" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
            <a id="btnCloseDONote" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <div id="winDeliveryZone" style="width:500px;" class="easyui-window" title="Order" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div>
            <fieldset>
                <legend style="font-weight:bold"> Delivery Place/Zone: </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="width:100%; font-size:11px; font-weight:bold">
                    
                    <tr>
                        <td style="width:30%;text-align:right">
                            Zone/Place/Address:
                        </td>

                        <td style="width:70%">
                            <input id="txtDeliveryZoneNew" type="text" style="width:100%" />
                        </td>
                       
                    </tr>


                </table>
            </fieldset>
        </div>
        <fieldset>
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="width:100%; font-size:11px; font-weight:bold;">
                <tr>
                    <td style="width:100%;text-align:right;">
                        <a id="btnSaveDeliveryZone" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCloseDeliveryZone" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>

                </tr>
            </table>
        </fieldset>
    </div>
</body>
</html>

<style type="text/css">
  
   
    
    .td-col-6 input {
        width: 70%;
    }

    .td-col-14 input {
        width: 86%;
    }

    .send-to .td-col-14 input {
        width: 85.7%;
    }


    .hp-ph .td-col-8 input {
        width: 66%;
    }

    .hp-ph .td-col-8 select {
        width: 96%;
    }

    .td-Note input {
        width: 97.5%;
    }

    .td-col-14 select {
        width: 15%;
    }

    .td-product input {
        width: 60%;
    }

    .number-combo input {
        width: 10%;
    }

    .td-KnitPly select {
        width: 95%;
    }


    
</style>

<script type="text/javascript">

    var _sBaseAddress = "";
    var _oDyeingOrder=null;
    var _nMktAccountID=0;
    var _nContractorID=0;
    var _nDeliveryToID=0;
    var _nProductID=0;
    var _bIsIssueTo=true;
    var _oCPIssueTos=[];
    var _oCPDeliveryTos=[];
    var _oPaymentTypes=[];
    var _oDUOrderSetup=[];
    var _oLightSources=[];
    var _oPriorityLevels=[];
    var _oIsAdd=false;
    var _nLabDipDetailID=0;
    var _nDyeingOrderDetailID=0;
    var _nSelectedRowIndex=0;
    var _oMUnitCon=null;
    var _sBackLink="";
    $(document).ready(function () {

        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oDyeingOrder =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oCPIssueTos =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.CPIssueTos));
        _oCPDeliveryTos =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.CPDeliveryTos));
        var oLightSources=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.LightSources));
        var oPriorityLevels =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.EnumPriorityLevels));
        var oDUOrderSetup =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.DUOrderSetup));
        var oPaymentTypes =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.PaymentTypes));
        var oLabDipTypeObj =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.LabDipTypeObj));
        var oDUDyeingSteps =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.DUDyeingSteps));
        var oDyeingTypes =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.DyeingTypes));
        _oMUnitCon =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.MeasurementUnitCon));
        var oBU =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.BU));
        var oDyeingOrderNotes =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(@ViewBag.DyeingOrderNotes));

        debugger;
        $("#cboDyeingStepType").icsLoadCombo({
            List: oDUDyeingSteps,
            OptionValue: "DyeingStepType",
            DisplayText: "Name",
        });
        $("#cboHankorCone").icsLoadCombo({
            List: oDyeingTypes,
            OptionValue: "DyeingType",
            DisplayText: "Name",
        });
        $("#cboLightSource,#cboLightSourceTwo").icsLoadCombo({
            List: oLightSources,
            OptionValue: "LightSourceID",
            DisplayText: "Descriptions",

        });
        $("#cboPriorityLevel").icsLoadCombo({
            List: oPriorityLevels,
            OptionValue: "Value",
            DisplayText: "Text",

        });

        $("#cboPaymentType").icsLoadCombo({
            List: oPaymentTypes,
            OptionValue: "Value",
            DisplayText: "Text",

        });
        $("#cboLabDipType").icsLoadCombo({
            List: oLabDipTypeObj,
            OptionValue: "id",
            DisplayText: "Value",

        });
        Initialization(oDyeingOrder,((sessionStorage.length>0)?sessionStorage.getItem('Operation'):'New'));
        DynamicRefreshList(oDyeingOrderNotes, 'tblDONote_DO');
        _sBackLink=sessionStorage.getItem("BackLink");
        $('#txtUnitPriceInOne').val(0);
        $('#txtQtyInOne').val(0);
        $("#progressbar").progressbar({ value: 0 });
        $("#progressbarParent").hide();

        //document.getElementById('leOrder').innerHTML =oDUOrderSetup.OrderName;
        document.getElementById('leOrderTwo').innerHTML = oDUOrderSetup.OrderName;
        document.getElementById('leOrderThree').innerHTML = oDUOrderSetup.OrderName+" Detail";
        $(".lblMUnitOne").html(_oMUnitCon.FromMUnit);
        $(".lblMUnitTwo").html(_oMUnitCon.ToMUnit);
        $(".lblBUName").html(" "+oBU.ShortName);
        $('#lblMUName,#lblMUName2').html(oDUOrderSetup.MUName);
        if(oDUOrderSetup.IsApplyDyeingStep)
        {
            $("#rtDyeingStep").show();
        }
        else{  $("#rtDyeingStep").hide();}
        if(!oDUOrderSetup.IsApplyOutside)
        {
            $("#lblLightSourceTwo").hide();
            $("#cboLightSourceTwo").hide();
        }
        
    });
 

    function updateProgress() {
        var value =$('#progressbar').progressbar('getValue');
        if (value < 96){
            value += Math.floor(Math.random() * 10);
            $('#progressbar').progressbar('setValue', value);
        }
    }
    function hideShow(miliseconds) {
        $("#progressbarParent").hide();
    }
    $("#txtQtyInOne,#txtQtyInTwo,#txtUnitPriceInOne,#txtUnitPriceInTwo").keypress(function (e) {
        if (e.which != 8 && e.which != 0  && e.which != 46  && (e.which < 48 || e.which > 57)) {
            return false;
        }

    });

    $("#txtOrderNo").keypress(function (e) {
        if (e.which != 8 && e.which != 0  && e.which != 46 && e.which != 45  && (e.which < 48 || e.which > 57)) {
            return false;
        }

    });
    function Initialization(oDyeingOrder, sOperation){
    
        RefreshControl(oDyeingOrder);

         $('.ics-pick').hide();
         $('input,select').not('#txtDyeingOrderNo').prop('disabled',true);
      
        if(sOperation=="View")
        {
            $('#btnBooking,#btnHoldProduction,#toolbar,#btnHoldRunning,#btnIsClose,.ics-pick').hide();
            $('input,select').not('#txtDyeingOrderNo').prop('disabled',true);
        }
       
    }


    function LoadIssueContactPersonnel(oCPs){
        $("#cboCPIssueTo").icsLoadCombo({
            List: oCPs,
            OptionValue: "ContactPersonnelID",
            DisplayText: "Name",
            
        });
        if(_nDeliveryToID==_nContractorID)
        {
            $("#cboCPDeliverTo").icsLoadCombo({
                List: oCPs,
                OptionValue: "ContactPersonnelID",
                DisplayText: "Name",
           
            });
        }
    }

    function LoadDeliveredContactPersonnel(oCPs){
        $("#cboCPDeliverTo").icsLoadCombo({
            List: oCPs,
            OptionValue: "ContactPersonnelID",
            DisplayText: "Name",
           
        });
    }

    function ChangePaymentType()
    {
        var ncboPaymentType=parseInt($("#cboPaymentType").val());
        $("#txtExportPINo" ).prop({disabled:true});
        if( ncboPaymentType===2)
        {
            $("#txtExportPINo").show();
            $("#btnPickExportPI").show();
            $("#btnResetExportPI").show();
            $(".lblExportPINo").html("P/I No");
            $("#txtExportPINo").val(_oDyeingOrder.ExportPINo);
            $("#txtExportPINo" ).prop({disabled:false});
        }
        else if( ncboPaymentType===3)
        {
            $("#txtExportPINo").show();
            $("#btnPickExportPI").hide();
            $("#btnResetExportPI").hide();
            $(".lblExportPINo").html("P/I No");
            _oDyeingOrder.ExportPIID=0;
            $("#txtExportPINo").val("");


        }
        else
        {
            $("#txtExportPINo").show();
            $("#btnPickExportPI").hide();
            $("#btnResetExportPI").hide();
            _oDyeingOrder.ExportPIID=0;
            $(".lblExportPINo").html("MR No");
            $("#txtExportPINo").val("");
            $("#txtExportPINo" ).prop({disabled:true});
        }
    }

 

    function RefreshControl(oDyeingOrder){
        debugger;
        _oDyeingOrder=oDyeingOrder;
        _nMktAccountID=oDyeingOrder.MKTEmpID;
        _nContractorID=oDyeingOrder.ContractorID;
        _nDeliveryToID=oDyeingOrder.DeliveryToID;

        $('#txtMktAccount').val(oDyeingOrder.MKTPName);
        $('#txtIssueTo').val(oDyeingOrder.ContractorName);
        $('#txtDeliverTo').val(oDyeingOrder.DeliveryToName);

        $('#txtExportPINo').val(oDyeingOrder.ExportPINo);
        $('#txtInvoiceNo').val(oDyeingOrder.IsCloseSt);

        $('#txtOrderNo').val(oDyeingOrder.PONo);
        $('#dtOrderDate').datebox('setValue',oDyeingOrder.OrderDateSt);
        //$('#cboOrderType').val(oDyeingOrder.DyeingOrderType);
        $('#cboPaymentType').val(oDyeingOrder.PaymentType);

        $('#cboCPIssueTo').val(oDyeingOrder.ContactPersonnelID);
        $('#cboCPDeliverTo').val(oDyeingOrder.ContactPersonnelID_DelTo);

        //$('#dtSeekingDate').datebox('setValue',oDyeingOrder.SeekingDateStr);
        $('#cboPriorityLevel').val(oDyeingOrder.PriorityInt);

        $('#txtStyleNo').val(oDyeingOrder.StyleNo);
        $('#cboLightSource').val(oDyeingOrder.LightSourchID);
        $('#cboLightSourceTwo').val(oDyeingOrder.LightSourchIDTwo);
        $('#txtBuyerRef').val(oDyeingOrder.RefNo);
        $('#txtNote').val(oDyeingOrder.Note);
        $('#txtDeliveryZone').val(oDyeingOrder.DeliveryZone);

        if(oDyeingOrder.DyeingOrderDetails!==null && oDyeingOrder.DyeingOrderDetails.length>0)
        {
            DynamicRefreshList(oDyeingOrder.DyeingOrderDetails, 'tblDyeingOrderDetail');
        }
        else{
            DynamicRefreshList([], 'tblDyeingOrderDetail');
        }
        $("#chkIsInHouseYes").prop("checked", oDyeingOrder.IsInHouse);
        $("#chkIsInHouseNo").prop("checked", !oDyeingOrder.IsInHouse);
        $('#cboDyeingStepType').val(oDyeingOrder.DyeingStepTypeInt);
        //$('#txtQtyInOne').icsCurrencyBox();
        //$('#txtQtyInTwo').icsCurrencyBox();
        //$('#txtUnitPriceInOne').icsCurrencyBox();
        //$('#txtUnitPriceInTwo').icsCurrencyBox();
        RefreshSummary();
    }


    $("#btnHoldProduction").click(function () {
        debugger;

        debugger;
        var oDyeingOrderDetail = $('#tblDyeingOrderDetail').datagrid('getSelected');
        if (!confirm("Confirm to hold Production?")) return false;
        if (oDyeingOrderDetail == null || oDyeingOrderDetail.DyeingOrderDetailID <= 0) {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        oDyeingOrderDetail.Status=4;
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oDyeingOrderDetail,
            ObjectId: oDyeingOrderDetail.DyeingOrderDetailID,
            ControllerName: "DyeingOrder",
            ActionName: "OrderHold",
            TableId: "tblDyeingOrderDetail",
            IsWinClose: false
        };
        $.icsSave(obj);
        var SelectedRowIndex = $('#tblDyeingOrderDetail').datagrid('getRowIndex', oDyeingOrderDetail);
        $('#tblDyeingOrderDetail').datagrid('updateRow', { index: SelectedRowIndex, row: oDyeingOrderDetail });

    });
    
    $("#btnBooking").click(function () {

        debugger;
        var oDyeingOrderDetail = $('#tblDyeingOrderDetail').datagrid('getSelected');
        if (!confirm("Confirm to hold Production?")) return false;
        if (oDyeingOrderDetail == null || oDyeingOrderDetail.DyeingOrderDetailID <= 0) {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        oDyeingOrderDetail.Status=3;
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oDyeingOrderDetail,
            ObjectId: oDyeingOrderDetail.DyeingOrderDetailID,
            ControllerName: "DyeingOrder",
            ActionName: "OrderHold",
            TableId: "tblDyeingOrderDetail",
            IsWinClose: false
        };
        $.icsSave(obj);
        var SelectedRowIndex = $('#tblDyeingOrderDetail').datagrid('getRowIndex', oDyeingOrderDetail);
        $('#tblDyeingOrderDetail').datagrid('updateRow', { index: SelectedRowIndex, row: oDyeingOrderDetail });

    });

    $("#btnHoldRunning").click(function () {
        debugger;
        var oDyeingOrderDetail = $('#tblDyeingOrderDetail').datagrid('getSelected');
        if (!confirm("Confirm to running?")) return false;
        if (oDyeingOrderDetail == null || oDyeingOrderDetail.DyeingOrderDetailID <= 0) {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        oDyeingOrderDetail.Status=2;
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oDyeingOrderDetail,
            ObjectId: oDyeingOrderDetail.DyeingOrderDetailID,
            ControllerName: "DyeingOrder",
            ActionName: "OrderHold",
            TableId: "tblDyeingOrderDetail",
            IsWinClose: false
        };
        $.icsSave(obj);
        var SelectedRowIndex = $('#tblDyeingOrderDetail').datagrid('getRowIndex', oDyeingOrderDetail);
        $('#tblDyeingOrderDetail').datagrid('updateRow', { index: SelectedRowIndex, row: oDyeingOrderDetail });
     

    });
    $("#btnIsClose").click(function () {
        debugger;
       
        if (!confirm("Confirm to Close?")) return false;
        if (_oDyeingOrder == null || _oDyeingOrder.DyeingOrderID <= 0) {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: _oDyeingOrder,
            ObjectId: _oDyeingOrder.DyeingOrderID,
            ControllerName: "DyeingOrder",
            ActionName: "OrderClose",
            TableId: "",
            IsWinClose: false
        };
        $.icsSave(obj, function (response)
        {
            $('#btnIsClose').show();
            if (response.status && response.obj != null) {
                if (response.obj.DyeingOrderID > 0)
                {
                    debugger;
                    var oDyeingOrders =sessionStorage.getItem("DyeingOrders");
                    var nIndex= parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    
                    _oDyeingOrder=response.obj;
                    $('#txtInvoiceNo').val(_oDyeingOrder.IsCloseSt);
                    if(oDyeingOrders!=null)
                    {
                        oDyeingOrders = jQuery.parseJSON(oDyeingOrders);
                    }
                    else
                    {
                        oDyeingOrders=[];
                    }
                    if(nIndex!=-1)
                    {
                        oDyeingOrders[nIndex]=_oDyeingOrder;
                    }
                    else
                    {
                        sessionStorage.setItem("SelectedRowIndex", oDyeingOrders.length);
                        oDyeingOrders.push(_oDyeingOrder);
                    }
                    sessionStorage.setItem("DyeingOrders", JSON.stringify(oDyeingOrders));
                    window.location.href = _sBackLink;
                }
            }
        });
    });


    $('#btnClose,#btnCloseTwo').click(function(e){
        window.location.href = sessionStorage.getItem("BackLink");
    });

    function RefreshControlDetail(oDyeingOrderDetail)
    {
        debugger;
        document.getElementById("txtColorDevProduct").disabled = true;
        document.getElementById("txtShade").disabled = true;

        $('#txtQtyInOne').val(parseFloat(oDyeingOrderDetail.Qty).toFixed(4));
        //$('#txtQtyInTwo').val(parseFloat(oDyeingOrderDetail.Qty).toFixed(2));
        $('#txtUnitPriceInOne').val(parseFloat(oDyeingOrderDetail.UnitPrice).toFixed(4));
        //$('#txtUnitPriceInTwo').val(parseFloat(oDyeingOrderDetail.UnitPrice).toFixed(2));
        $('#txtProduct').val(oDyeingOrderDetail.ProductName);

        $('#txtApproveLotNo').val(oDyeingOrderDetail.ApproveLotNo);
        $('#txtColorDevProduct').val(oDyeingOrderDetail.ColorDevelopProduct);
        $('#txtNoteDetail').val(oDyeingOrderDetail.Note);
        $('#txtBuyerCombo').val(oDyeingOrderDetail.BuyerCombo);
        $('#txtLabdipNo').val(oDyeingOrderDetail.LabdipNo);
        $('#cboLabDipType').val(oDyeingOrderDetail.LabDipType);
        $('#cboShade').val(oDyeingOrderDetail.Shade);
        $('#txtColorName').val(oDyeingOrderDetail.ColorName);
        $('#txtBuyerRef_PCol').val(oDyeingOrderDetail.BuyerRef);
        $('#txtColorNo').val(oDyeingOrderDetail.ColorNo);
        $('#txtPantonNo').val(oDyeingOrderDetail.PantonNo);
        $('#cboHankorCone').val(oDyeingOrderDetail.HankorCone);
        $('#txtNoOfCone_Weft').val(oDyeingOrderDetail.NoOfCone_Weft);
        $('#txtNoOfCone').val(oDyeingOrderDetail.NoOfCone);
        $('#txtLengthOfCone').val(oDyeingOrderDetail.LengthOfCone);
      
        if (oDyeingOrderDetail.DeliveryDateSt != "") {
            $('#txtDeliveryDate').datebox('setValue', oDyeingOrderDetail.DeliveryDateSt);
        }
       

        ConvertIntoKgs_UnitPrice();
        ConvertIntoKg_Qty();
        ChangeLabDipType();
    }


   
    function RefreshObjectDetail(){



        var ocboLabDipType = document.getElementById("cboLabDipType");
        var sLabDipType = ocboLabDipType.options[ocboLabDipType.selectedIndex].text;
        var cboShade = document.getElementById("cboShade");
        var sShade = cboShade.options[cboShade.selectedIndex].text;


        var   oDyeingOrderDetail= {
            DyeingOrderDetailID :_nDyeingOrderDetailID,
            DyeingOrderID : (_oDyeingOrder!=null && _oDyeingOrder.DyeingOrderID>0)? _oDyeingOrder.DyeingOrderID:0,
            LabDipDetailID:_nLabDipDetailID,
            ProductID : _nProductID,
            ProductName: $('#txtProduct').val(),
            ProductNameCode: $('#txtProduct').val(),
            Shade: $('#cboShade').val(),
            ShadeSt:sShade,
            LabDipType: $('#cboLabDipType').val(),
            LabDipTypeSt: sLabDipType,
            LabdipNo:"",
            ColorName: $('#txtColorName').val(),
            BuyerRef: $('#txtBuyerRef_PCol').val(),
            ApproveLotNo: $('#txtApproveLotNo').val(),
            ColorNo:$('#txtColorNo').val(),
            PantonNo:$('#txtPantonNo').val(),
            Qty: $('#txtQtyInOne').val(),
            UnitPrice: $('#txtUnitPriceInOne').val(),
            Amount:0,
            HankorCone:parseInt($('#cboHankorCone').val()),
            BuyerCombo:$('#txtBuyerCombo').val(),
            NoOfCone: $('#txtNoOfCone').val(),
            LengthOfCone:  $('#txtLengthOfCone').val(),
            NoOfCone_Weft: $('#txtNoOfCone_Weft').val(),
            LengthOfCone_Weft: $('#txtLengthOfCone').val(),
            Note:$('#txtNoteDetail').val(),
            DeliveryDate:$('#txtDeliveryDate').datebox('getValue'),
            DeliveryDateSt: icsdateformat(new Date())
        };

        return oDyeingOrderDetail;
    }

   

    function RefreshSummary()
    {
        var oDODetails = $('#tblDyeingOrderDetail').datagrid('getRows');
        var nTotalQty = 0, nTotalAmount= 0;
        for(var i = 0; i<oDODetails.length;i++)
        {
            nTotalQty+=parseFloat(oDODetails[i].Qty);
            nTotalAmount+=parseFloat(oDODetails[i].Qty*oDODetails[i].UnitPrice);
        }
        document.getElementById('lblTotalQty').innerHTML = formatPrice(nTotalQty,0)+""+_oMUnitCon.FromMUnit;
        document.getElementById('lblTotalAmount').innerHTML = "$"+formatPrice(nTotalAmount,0);
    }

 


    /////Instraction///--
    function PickDONote() {

        var oDyeingOrderNote = {
            Note:"",
            DyeingOrderID:0,
            DyeingOrderNoteID:0
        };
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oDyeingOrderNote,
            ControllerName: "DyeingOrderNote",
            ActionName: "GetsByDO",
            IsWinClose: false
        };
        $("#progressbar").progressbar({ value: 0 });
        $("#progressbarParent").show();
        var intervalID = setInterval(updateProgress, 250);
        $.icsDataGets(obj, function (response) {
            clearInterval(intervalID);
            $("#progressbarParent").hide();
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].DyeingOrderNoteID > 0)
                {
                    debugger;
                    $("#winDONote input").val("");
                    sessionStorage.setItem('DyeingOrderNote',JSON.stringify(response.objs));
                    DynamicRefreshList(response.objs, "tblDONote");
                    $("#winDONote").icsWindow('open', "Special instruction Picker");
                }
                else {
                    sessionStorage.setItem('DyeingOrderNote',JSON.stringify([]));
                    alert(response.objs[0].ErrorMessage);
                }
            }
            else {
                alert("Sorry, There is No Terms and Condition Found.");
            }
        });
    }

    $("#btnOkDyeingOrderNote").click(function () {
        debugger;
        var oSelectedObjs = $('#tblDONote').datagrid('getChecked');
        if(oSelectedObjs.length>0)
        {
            //var oExistingItems = [];
            //oExistingItems = $('#tblDONote_DO').datagrid('getRows');
            if(_oDyeingOrder.DyeingOrderID<=0)
            {
                alert("Invaild Order");
                return;
            }
            for(var i = 0;i<oSelectedObjs.length;i++)
            {
                var oDONote = {
                    DyeingOrderNoteID: 0,
                    DyeingOrderID: _oDyeingOrder.DyeingOrderID,
                    Sequence:0,
                    OrderNote: oSelectedObjs[i].OrderNote
                };
                var bExists= IsExist(oSelectedObjs[i].OrderNote)
                if(!bExists)
                {
                    $('#tblDONote_DO').datagrid('appendRow', oDONote);
                }

            }
        }
        $("#winDONote").icsWindow('close');
    });

   

    $("#btnCloseDONote").click(function () {
        $("#winDONote").icsWindow('close');
    });
    $('#txtDONote').keyup(function (e) {
        var c = String.fromCharCode(e.which);
        var txtDONote = $('#txtDONote').val();
        var oSearchedPITAndCs = [];  var sTempName="";
        var oDyeingOrderNotes = $('#tblDONote').datagrid('getRows');
        if (e.which == 8)
        {
            oDyeingOrderNotes = jQuery.parseJSON(sessionStorage.getItem('DyeingOrderNote'));
        }
        for(var i=0;i<oDyeingOrderNotes.length;++i){
            sTempName=oDyeingOrderNotes[i].OrderNote;
            n=sTempName.toUpperCase().indexOf(txtDONote.toUpperCase())
            if(n!=-1)
            {
                oSearchedPITAndCs.push(oDyeingOrderNotes[i]);
            }
        }
        DynamicRefreshList(oSearchedPITAndCs, "tblDONote");
    });


    function RefreshDONote()
    {
        endEditingTC();
        sTableId='tblDONote_DO';
        var oTermsConditions = $('#'+sTableId).datagrid('getRows');
        DynamicRefreshList(oTermsConditions, sTableId);
    }

    function RemoveDONote()
    {
        var oDyeingOrderNote = $("#tblDONote_DO").datagrid("getSelected");
        if (oDyeingOrderNote == null) { alert("Please select an item from list!"); return false; }
        var nIndex=$('#tblDONote_DO').datagrid('getRowIndex',oDyeingOrderNote);
        if (!confirm("Confirm to Delete?")) return false;

        if(oDyeingOrderNote.DyeingOrderNoteID<=0)
        {
            $("#tblDONote_DO").datagrid("deleteRow", nIndex);
        }
        else
        {
            var obj =
                     {
                         BaseAddress: _sBaseAddress,
                         Object: oDyeingOrderNote,
                         ControllerName: "DyeingOrderNote",
                         ActionName: "DeleteDyeingOrderNote",
                         TableId: "tblDONote_DO",
                         IsWinClose: false
                     };
            $.icsDelete(obj);
        }

    }
    var editTCIndex = undefined;
    function endEditingTC() {
        if (editTCIndex == undefined) { return true }
        if ($('#tblDONote_DO').datagrid('validateRow', editTCIndex)) {

            $('#tblDONote_DO').datagrid('endEdit', editTCIndex);
            editTCIndex = undefined;
            return true;
        }
        else {
            return false;
        }
    }

    function onClickRowTC(index) {

        if (editTCIndex != index) {
            if (endEditingTC()) {
                $('#tblDONote_DO').datagrid('selectRow', index)
                        .datagrid('beginEdit', index);
                editTCIndex = index;
            }
            else {
                $('#tblDONote_DO').datagrid('selectRow', editTCIndex);
            }
        }
    }

   
</script>