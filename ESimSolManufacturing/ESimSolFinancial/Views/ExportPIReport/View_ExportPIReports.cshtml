@model IEnumerable<ESimSol.BusinessObjects.ExportPIReport>
    @{
        ViewBag.Title = "View PI Report";
    }
   <head>
        <title>LC Terms</title>
  </head>
 <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
                          <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
                              <label style="font-size:18px;">Please wait</label>
                              <div id="progressbar" style="width:100%;height:37px;"></div>
                          </div>
                      </div>
 <div class="menuMainCollectionTable">
  <table id="tblExportPIs" title="Export PI(s)" class="easyui-datagrid" style="width: 100%; height:100%; margin: 0;" data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarExportPIReport' ">
         <thead>
             <tr>
                 <th field="IssueDateSt" width="10%" align="left">Date</th>
                 <th field="PINo" width="10%" align="left">PI No</th>
                 <th field="ContractorName" width="15%" align="left"><label id="lblContractor">Factory</label> Name</th>
                 <th field="BuyerName" width="12%" align="right"><label id="lblBuyer">Buying House</label></th>
                 <th field="ProductName" width="10%" align="left"><label id="lblProduct">Yarn</label> Name</th>
                 <th field="QtySt" width="10%" align="right">Qty</th>
                 <th field="UnitPriceSt" width="10%" align="right">Unit Price</th>
                 <th field="AmountST" width="10%" align="right">Amount</th>
                 <th field="CPersonName" width="10%" align="left">Buyer Concern Person</th>
                 <th field="MKTPName" width="10%" align="left">Concern Person</th>
                 <th field="LCNo" width="12%" align="left">L/C No</th>
                 <th field="BankName" width="12%" align="left">Bank Name</th>
                 <th field="PIStatusSt" width="12%" align="left">Status</th>
                 <th field="LCStatusSt" width="12%" align="left">L/C Status</th>
                 <th field="Amount_Accep" width="10%" align="left" formatter="formatPrice">Amount(Acceptance)</th>
                 <th field="Amount_Maturity" width="10%" align="left" formatter="formatPrice">Amount(Maturity)</th>
                 
             </tr>
         </thead>
     </table>
   
  <div id="toolbarExportPIReport">
      <input id="txtSearchByExportPI" type="text" placeholder="Search by PI No" style="width: 100px" />
      @*<input id="txtStartDate" type="text" style="width: 95px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
      <a id="btnSearchByDate" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>*@
     
      <a id="btnAdvSearchExportPI" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>
      <a id="btnPrintShowDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">History Detail</a>
      <a id="btnPrintPI" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
      <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>
       <a id="btnPartyWisePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print(Party Wise) </a>
      <a id="btnProductWisePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print(Product Wise) </a>
      <a id="btnBankWisePrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print(Bank Wise)</a>
      <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">ExportXL</a>
    </div>
 </div>
 <div id="winAdvSearchExportPI" class="easyui-window winClass" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
    <table style="width:100%;">
        <tr>
            <td>
                <fieldset style="margin-bottom: 0px;">
                    <legend>Searching Criteria</legend>
                    <table>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Account Of :</label>
                            </td>
                            <td colspan="3" style=" width:80%;text-align:left;">
                                <input id="txtContractorAdvS" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                <a id="btnPickContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnClrContractorAdvS" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>

                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Buying House :</label>
                            </td>
                            <td colspan="3" style=" width:80%;text-align:left;">
                                <input id="txtSearchByBuyersAdvSearch" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                <a id="btnClrSearchByBuyersAdvSearch" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnPickSearchByBuyersAdvSearch" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Product(s) :</label>
                            </td>
                            <td colspan="3" style=" width:80%;text-align:left;">
                                <input id="txtSearchByProductsAdvSearch" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                <a id="btnClrSearchByProductsAdvSearch" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnPickSearchByProductsAdvSearch" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Issue Date :</label>
                            </td>
                            <td colspan="3">
                                <select id="cboIssueDateAdvSearch" style="width:30%;" onchange="DateActionsIssueDateAdvSearch();"></select>
                                <input id="txtFromIssueDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                <input id="txtToIssueDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Validity Date :</label>
                            </td>
                            <td colspan="3">
                                <select id="cboValidityDateAdvSearch" style="width:30%;" onchange=" DateActionsValidityDateAdvSearch(); "></select>
                                <input id="txtFromValidityDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                <input id="txtToValidityDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>LC Date :</label>
                            </td>
                            <td colspan="3">
                                <select id="cboLCDateAdvSearch" style="width:30%;" onchange=" DateActionsLCDateAdvSearch(); "></select>
                                <input id="txtFromLCDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                <input id="txtToLCDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Payment Type </label>
                            </td>
                            <td>
                                <select id="cboPaymentType" style="width: 100%;"></select>
                            </td>
                            <td style="text-align:right;">
                                <label>PI Type :</label>
                            </td>
                            <td>
                                <select id="cboPITypeAdv" style="width: 100%;float:right;"><option value="-1">None</option><option value="0">Open</option><option value="1">Order Sheet</option></select>
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Bank :</label>
                            </td>
                            <td colspan="3">
                                <select id="cboPIBankAdvSearch" style="width:100%;"></select>
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <span class="lblBUSName"></span> <label> Concern</label>
                            </td>
                            <td>
                                <select id="cboMkPersonAdvSearch" style="width:100%;"></select>
                            </td>
                            <td style="text-align:right;">
                                <label>Product Type:</label>
                            </td>
                            <td>
                                <select id="cboProductNature" style="width: 100%;float:right;"><option value="-1">None</option><option value="0">Dyeing</option><option value="1">Hanger</option><option value="2">Poly</option></select>
                            </td>                            
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Buyer Concern </label>
                            </td>
                            <td colspan="3" style=" width:80%;text-align:left;">
                                <input id="txtContactPersonnel" style="width:75%;" type="text" placeholder="Type & Press Enter" />
                                <a id="btnPickContactPersonnel" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnClrContactPersonnel" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>

                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:right;">
                                <label>Style No :</label>
                            </td>
                            <td colspan="3">
                                <input id="txtSearchByStyleNoAdvSearch" type="text" style="width:100%" />
                            </td>
                        </tr>
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                <label>Status By Date :</label>
                            </td>
                            <td colspan="3">
                                <select id="cboStatusAdvSearch" style="width:30%;" onchange=" DateActionsStatusDateAdvSearch(); "></select>
                                <input id="txtFromStatusDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                                <input id="txtToStatusDateAdvSearch" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:right;">
                                <label>Status :</label>
                            </td>
                            <td colspan="3">
                                <table id="tblCurrentStatusAdvSearch" class="easyui-datagrid" title="" style="width:100%; height: 110px;" data-options="singleSelect: false,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false">
                                    <thead>
                                        <tr>
                                            <th data-options="field:'Selected',checkbox:true"></th>
                                            <th field="Value" width="80%">Status Name</th>
                                        </tr>
                                    </thead>
                                </table>
                            </td>
                        </tr>     
                        <tr>
                            <td style=" width:20%;text-align:right;">
                                
                            </td>
                            <td colspan="3">
                                <input id="chkYetToSAN" type="checkbox" style="width:5%;" />
                                <label>Waiting For Create Sample Adjustment </label>
                            </td>
                        </tr>
                                
                        <tr>
                            <td height="5px" colspan="4"></td>
                        </tr>
                    </table>
                </fieldset>
            </td>
        </tr>
    </table>

    <fieldset class="actionfieldsetstyle">
        <legend>Actions : </legend>
        <label class="lblLoadingMessage" style="float: left;">Loading Please Wait...</label>
        <a id="btnResetAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>
        <a id="btnSearchAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
        <a id="btnCloseAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
    </fieldset>
</div>
 <style type="text/css">
    .lines-no .datagrid-body td {
        border-right: 1px dotted transparent;
        border-bottom: 1px dotted transparent;
    }
 
</style>

 <script type="text/javascript">
    var _sBaseAddress="";
    var _oExportPIReport=null;
    var _oExportPIReports=[];
    var _oBankBranchs=[];
    var _oCurrencys=[];
    var _oCompanys=[];
    var _oExportBill=null;
    var _oCompareOperators=[];

    var _oPIStatusObjs = [];
    var _oPIPaymentTypes=[];
    var _oTextileUnits=[];
    var _oMktPersons=[];

    var _sControllerName="";
    var _nBUID = 0;
    var _sContractorIds = '';
    var _sBuyerIDsAdvSearch = '';
    var _sProductIDsAdvSearch = '';
    var _oBU = null;
    var _nReportType=0;
    var _sCPersonnelIds="";
    $(document).ready(function () {

        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oExportPIReports =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _oPIStatusObjs = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PIStatusObjs));
        _oBankBranchs = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BankBranchs));
        _oMktPersons = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MktPersons));
        _oPIPaymentTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PIPaymentTypes));
        _oBU = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BU));
        $("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch").datebox({ disabled: false });
        $("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        $("#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch").datebox({ disabled: false });
        $("#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        if(_oBU.BusinessUnitType!=1){$('#lblContractor').html('Contractor');$('#lblBuyer').html('Buyer Name');$('#lblProduct').html('Product');};
        $(".lblBUSName").html(_oBU.ShortName);
        $("#tblCurrentStatusAdvSearch").datagrid("checkAll");
        $("#progressbar").progressbar({ value: 0 });
        $("#progressbarParent").hide();

        LoadAllComboExportPIAdv();
        DateActionsIssueDateAdvSearch();
        DateActionsValidityDateAdvSearch();
        DateActionsLCDateAdvSearch();
        DateActionsStatusDateAdvSearch();
        $(".lblLoadingMessage").hide();
        debugger;
        RefreshDate()
    });

     $(document).keydown(function (e) { if (e.keyCode == 27) { $('div').icsWindow('close'); } });

     function RefreshDate()
     {
         $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
     }
   

     $("#btnPrint").click(function () {

         var sParams=sessionStorage.getItem("Params");
         window.open(_sBaseAddress + '/ExportPIReport/Print_ExportPIReport?sTempString=' + sParams+"&nBUID="+_nBUID, "_blank");
     });
     $("#btnPartyWisePrint").click(function () {

         var sParams=sessionStorage.getItem("Params");

         window.open(_sBaseAddress + '/ExportPIReport/Print_PartyWisePIReport?sTempString=' + sParams+"&nBUID="+_nBUID, "_blank");
     });
     $("#btnProductWisePrint").click(function () {

         var sParams=sessionStorage.getItem("Params");
         window.open(_sBaseAddress + '/ExportPIReport/Print_ProductWisePIReport?sTempString=' + sParams+"&nBUID="+_nBUID, "_blank");
     });
     $("#btnBankWisePrint").click(function () {

         var sParams=sessionStorage.getItem("Params");
         window.open(_sBaseAddress + '/ExportPIReport/Print_BankWisePIReport?sTempString=' + sParams+"&nBUID="+_nBUID, "_blank");
     });
     $("#btnPrintXL").click(function () {

         var sParams=sessionStorage.getItem("Params");
         window.open(_sBaseAddress + '/ExportPIReport/Print_PIReportXL?sTempString=' + sParams+"&nBUID="+_nBUID, "_blank");
     });
     //Search Control

     function updateProgress() {
         var value =$('#progressbar').progressbar('getValue');
         if (value < 96){
             value += Math.floor(Math.random() * 10);
             $('#progressbar').progressbar('setValue', value);
         }
     }
     function hideShow(miliseconds) {
         $("#progressbarParent").hide();
     }
     //Account Of Picker

     $("#txtContractorAdvS").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             PickAccountOfPIAdvSearch();
         }
         else if (e.keyCode === 08) {
             $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
             _sContractorIds = '';
             _sCPersonnelIds="";
         }
     });

     $("#btnClrContractorAdvS").click(function () {
         $("#txtContractorAdvS").removeClass("fontColorOfPickItem");
         $("#txtContractorAdvS").val("");
         _sContractorIds = '';
         _sCPersonnelIds="";
     });

     $("#btnPickContractorAdvS").click(function () {
         PickAccountOfPIAdvSearch();
     });
     $("#txtSearchByAccountNamePickerAdvSearch").keydown(function (e) {
         var obj = {
             Event: e,
             SearchProperty: "Name",
             GlobalObjectList: _oAccountsOf,
             TableId: "tblAccountsPickerAdvSearch"
         };
         $('#txtSearchByAccountNamePickerAdvSearch').icsSearchByText(obj);
     });

     //End Account Of Picker
     $("#txtSearchByBuyersAdvSearch").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             PickBuyerPIAdvSearch();
         }
         else if (e.keyCode === 08) {
             $("#txtSearchByBuyersAdvSearch").removeClass("fontColorOfPickItem");
             _sBuyerIDsAdvSearch ="";
         }
     });

     $("#btnClrSearchByBuyersAdvSearch").click(function () {
         $("#txtSearchByBuyersAdvSearch").removeClass("fontColorOfPickItem");
         $("#txtSearchByBuyersAdvSearch").val("");
         _sBuyerIDsAdvSearch ="";
     });

     $("#btnPickSearchByBuyersAdvSearch").click(function () {
         PickBuyerPIAdvSearch();
     });

     //End Buyer Search

     //Start Search By Products
     $("#txtSearchByProductsAdvSearch").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             PickProductPIAdvSearch();
         }
         else if (e.keyCode === 08) {
             $("#txtSearchByProductsAdvSearch").removeClass("fontColorOfPickItem");
             _sProductIDsAdvSearch ="";
         }
     });

     $("#btnClrSearchByProductsAdvSearch").click(function () {
         $("#txtSearchByProductsAdvSearch").removeClass("fontColorOfPickItem");
         $("#txtSearchByProductsAdvSearch").val("");
         _sProductIDsAdvSearch ="";
     });

     $("#btnPickSearchByProductsAdvSearch").click(function () {
         PickBuyerPIAdvSearch();
     });
     //End Search By Products


     $("#btnResetAdvSearch").click(function () {
         ResetAdvSearchWindow();
         DateActionsIssueDateAdvSearch();
         DateActionsValidityDateAdvSearch();
         DateActionsLCDateAdvSearch();
         DateActionsStatusDateAdvSearch();
     });

     $("#btnSearchAdvSearch").click(function () {
         debugger;
         $('#tblExportPIAdvSearch').datagrid({ selectOnCheck: false, checkOnSelect: true });

         $(".lblLoadingMessage").show();
         DynamicRefreshList([], "tblExportPIAdvSearch");
         var checkDate = CheckFromAndToDateValidation("cboIssueDateAdvSearch", "txtFromIssueDateAdvSearch", "txtToIssueDateAdvSearch");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }
         checkDate = CheckFromAndToDateValidation("cboValidityDateAdvSearch", "txtFromIssueDateAdvSearch", "txtToValidityDateAdvSearch");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }
         checkDate = CheckFromAndToDateValidation("cboLCDateAdvSearch", "txtFromLCDateAdvSearch", "txtToLCDateAdvSearch");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }
         checkDate = CheckFromAndToDateValidation("cboStatusAdvSearch", "txtFromStatusDateAdvSearch", "txtToStatusDateAdvSearch");
         if (!checkDate) {
             alert("Start date must be greater than end date.");
             return false;
         }

         //var nContractorID = parseInt(_sContractorIds);
         //var nBuyerID = parseInt(_sBuyerIDsAdvSearch);
         var nCboIssueDate = parseInt($("#cboIssueDateAdvSearch").val());
         var dFromIssueDate = $('#txtFromIssueDateAdvSearch').datebox('getValue');
         var dToIssueDate = $('#txtToIssueDateAdvSearch').datebox('getValue');

         var nCboValidityDate = parseInt($("#cboValidityDateAdvSearch").val());
         var dFromValidityDate = $('#txtFromValidityDateAdvSearch').datebox('getValue');
         var dToValidityDate = $('#txtToValidityDateAdvSearch').datebox('getValue');

         var nCboLCDate = parseInt($("#cboLCDateAdvSearch").val());
         var dFromLCDate = $('#txtFromLCDateAdvSearch').datebox('getValue');
         var dToLCDate = $('#txtToLCDateAdvSearch').datebox('getValue');

         var nCboPIBank = parseInt($("#cboPIBankAdvSearch").val());
         var ncboPaymentType = parseInt($("#cboPaymentType").val());
         var nCboMkPerson = parseInt($("#cboMkPersonAdvSearch").val());
         var nProductNature = parseInt($("#cboProductNature").val());

         var sCurrentStatus = "";
         var oPIStatus = $("#tblCurrentStatusAdvSearch").datagrid("getChecked");
         for (var i = 0; i < oPIStatus.length; i++) {
             sCurrentStatus = oPIStatus[i].id + "," +sCurrentStatus;
         }
         sCurrentStatus = sCurrentStatus.substring(0, sCurrentStatus.length - 1);

         //var bExportLCIsntCreateYet = $("#chkExportLCIsntCreateYet").is(':checked');

         var nPIType = parseInt($("#cboPITypeAdv").val());
         var sFEONo = $.trim($("#txtSearchByFEONoAdvSearch").val());
         var sConstruction = $.trim($("#txtSearchByConstructionAdvSearch").val());

         var sStyleNo = $.trim($("#txtSearchByStyleNoAdvSearch").val());

         var nCboStatusDate = parseInt($("#cboStatusAdvSearch").val());
         var dFromStatusDate = $('#txtFromStatusDateAdvSearch').datebox('getValue');
         var dToStatusDate = $('#txtToStatusDateAdvSearch').datebox('getValue');
         var bYetToSAN = $("#chkYetToSAN").is(':checked');
         //var bYetNotMakeFEO = $("#chkYetNotMakeFEO").is(':checked');
         var sParams = _sContractorIds + "~" +
                       _sBuyerIDsAdvSearch + "~" +
                       nCboIssueDate + "~" +
                       dFromIssueDate + "~" +
                       dToIssueDate + "~" +
                       nCboValidityDate + "~" +
                       dFromValidityDate + "~" +
                       dToValidityDate + "~" +
                       nCboLCDate + "~" +
                       dFromLCDate + "~" +
                       dToLCDate + "~" +
                       nCboPIBank + "~" +
                       nCboMkPerson + "~" +
                       sCurrentStatus + "~" +
                       ncboPaymentType + "~" +
                       nPIType + "~" +
                       sStyleNo+"~"+
                       nCboStatusDate + "~" +
                       dFromStatusDate + "~" +
                       dToStatusDate + "~" +
                       _nBUID+"~"+
                       _sProductIDsAdvSearch+"~"+
                       nProductNature+"~"+
                       _sCPersonnelIds+"~"+bYetToSAN
         sessionStorage.setItem("Params", sParams);
         var oExportPI = {
             ErrorMessage : sParams
         };

         $.ajax({
             type: "POST",
             dataType: "json",
             url: _sBaseAddress + "/ExportPIReport/AdvSearch",
             traditional: true,
             data: JSON.stringify(oExportPI),
             contentType: "application/json; charset=utf-8",
             success: function (data) {
                 var oExportPIReports = data;
                 if(oExportPIReports.length<=0 || oExportPIReports == null)
                 {
                     DynamicRefreshList([],"tblExportPIs");
                     alert("Data not found");
                 }
                 else
                 {
                     _oExportPIReports = oExportPIReports;
                     DynamicRefreshList(_oExportPIReports,"tblExportPIs");
                     $("#winAdvSearchExportPI").icsWindow("close");
                 }
               
                 $(".lblLoadingMessage").hide();
             }
         });
     });
     $("#btnSearchByDate").click(function () {
         _nReportType=1;
         
         var nCboIssueDate = 1;
         var dFromIssueDate = $('#txtStartDate').datebox('getValue');
         var dToIssueDate = $('#txtStartDate').datebox('getValue');


         var nCboValidityDate = parseInt($("#cboValidityDateAdvSearch").val());
         var dFromValidityDate = $('#txtFromValidityDateAdvSearch').datebox('getValue');
         var dToValidityDate = $('#txtToValidityDateAdvSearch').datebox('getValue');

         var nCboLCDate = parseInt($("#cboLCDateAdvSearch").val());
         var dFromLCDate = $('#txtFromLCDateAdvSearch').datebox('getValue');
         var dToLCDate = $('#txtToLCDateAdvSearch').datebox('getValue');

         var nCboPIBank = parseInt($("#cboPIBankAdvSearch").val());
         var ncboPaymentType = parseInt($("#cboPaymentType").val());
         var nCboMkPerson = parseInt($("#cboMkPersonAdvSearch").val());

         var sCurrentStatus = "";
         var oPIStatus = $("#tblCurrentStatusAdvSearch").datagrid("getChecked");
         for (var i = 0; i < oPIStatus.length; i++) {
             sCurrentStatus = oPIStatus[i].id + "," +sCurrentStatus;
         }
         sCurrentStatus = sCurrentStatus.substring(0, sCurrentStatus.length - 1);

         //var bExportLCIsntCreateYet = $("#chkExportLCIsntCreateYet").is(':checked');

         var nPIType = parseInt($("#cboPITypeAdv").val());
         var sFEONo = $.trim($("#txtSearchByFEONoAdvSearch").val());
         var sConstruction = $.trim($("#txtSearchByConstructionAdvSearch").val());

         var sStyleNo = $.trim($("#txtSearchByStyleNoAdvSearch").val());

         var nCboStatusDate = parseInt($("#cboStatusAdvSearch").val());
         var dFromStatusDate = $('#txtFromStatusDateAdvSearch').datebox('getValue');
         var dToStatusDate = $('#txtToStatusDateAdvSearch').datebox('getValue');

         //var bYetNotMakeFEO = $("#chkYetNotMakeFEO").is(':checked');
         var sParams = _sContractorIds + "~" +
                       _sBuyerIDsAdvSearch + "~" +
                       nCboIssueDate + "~" +
                       dFromIssueDate + "~" +
                       dToIssueDate + "~" +
                       nCboValidityDate + "~" +
                       dFromValidityDate + "~" +
                       dToValidityDate + "~" +
                       nCboLCDate + "~" +
                       dFromLCDate + "~" +
                       dToLCDate + "~" +
                       nCboPIBank + "~" +
                       nCboMkPerson + "~" +
                       sCurrentStatus + "~" +
                       ncboPaymentType + "~" +
                       nPIType + "~" +
                       sStyleNo+"~"+
                       nCboStatusDate + "~" +
                       dFromStatusDate + "~" +
                       dToStatusDate + "~" +
                       _nBUID;
      
         sessionStorage.setItem("Params", sParams);
         var oExportPIReport = {
             ErrorMessage : sParams
         };
     
         Search(oExportPIReport);
     });

     function Search(oExportPIReport)
     {

         $.ajax
           ({
               type: "POST",
               dataType: "json",
               url : _sBaseAddress+  "/ExportPIReport/GetsByDate",
               data:  JSON.stringify(oExportPIReport),
               contentType: "application/json; charset=utf-8",
               success: function (data) {
                   var oExportPIReports = data;
                   debugger;
                   if(oExportPIReports.length<=0 || oExportPIReports == null)
                   {
                       
                       DynamicRefreshList([],"tblExportPIs");
                       alert("Data not found");
                       return;
                   }
                   else
                   {
                       _oExportPIReports = oExportPIReports;
                       DynamicRefreshList(_oExportPIReports,"tblExportPIs");
                      
                   }
                   $(".lblLoadingMessage").hide();
               },
               error: function (xhr, status, error)
               {
                   alert(error);
               }
           });
     }


     $("#btnOkAdvSearch").click(function() {
         var oExportPIs = $("#tblExportPIAdvSearch").datagrid('getChecked');
         if (oExportPIs.length > 0) {
             $("#winAdvSearchExportPI").icsWindow("close");
             if (_sControllerName == "ExportPIReport") {
                 DynamicRefreshList(oExportPIs, "tblExportPIs");
             }
             else {
                 DynamicRefreshList(oExportPIs, "tblExportPIs");
             }
         }
         else {
             alert("Please select minimum one item from list.");
             return false;
         }
     });


     function LoadAllComboExportPIAdv()
     {
         //$("#cboPITypeAdv").icsLoadCombo({
         //    List: _oPIPaymentTypes,
         //    OptionValue: "id",
         //    DisplayText: "Value"
         //});

         $('#cboPITypeAdv').val(-1);//reset None

         $("#cboPaymentType").icsLoadCombo({
             List: _oPIPaymentTypes,
             OptionValue: "id",
             DisplayText: "Value"
         });

         $("#cboIssueDateAdvSearch, #cboValidityDateAdvSearch, #cboLCDateAdvSearch,#cboStatusAdvSearch").icsLoadCombo({
             List: _oCompareOperators,
             OptionValue: "id",
             DisplayText: "Value"
         });

         $("#cboPIBankAdvSearch").icsLoadCombo({
             List: _oBankBranchs,
             OptionValue: "BankBranchID",
             DisplayText: "BankBranchName"
         });

         $("#cboMkPersonAdvSearch").icsLoadCombo({
             List: _oMktPersons,
             OptionValue: "MarketingAccountID",
             DisplayText: "Name"
         });
     }
     function CheckFromAndToDateValidation(OperationComboId, FromDateId, ToDateId) {
         $("#" + OperationComboId).parent().parent().parent().find("select").removeClass("errorFieldBorder");
         var nCboVal = $("#" + OperationComboId).val();
         if (parseInt(nCboVal) == 5 || parseInt(nCboVal) == 6) {
             var fromDate = $("#" + FromDateId).datebox("getValue");
             var toDate = $("#" + ToDateId).datebox("getValue");
             if (new Date(fromDate) > new Date(toDate)) {
                 $("#" + ToDateId).focus();
                 $("#" + OperationComboId).addClass("errorFieldBorder");
                 $(".lblLoadingMessage").hide();
                 return false;
             } else {
                 $("#" + OperationComboId).removeClass("errorFieldBorder");
                 return true;
             }
         } else {
             return true;
         }
     }

     function ResetAdvSearchWindow() {
         _sContractorIds = '';
         _sBuyerIDsAdvSearch = "";
         _sProductIDsAdvSearch="";
         _sCPersonnelIds="";
         $("#winAdvSearchExportPI input").not("input[type='button']").val("");
         $("#winAdvSearchExportPI input").removeClass("fontColorOfPickItem");
         $("#winAdvSearchExportPI select").val(0);
         $('#cboPITypeAdv').val(-1);//reset None
         DateActionsIssueDateAdvSearch();
         DateActionsValidityDateAdvSearch();
         DateActionsLCDateAdvSearch();
         DynamicRefreshList([],"tblExportPIAdvSearch");
         //$('#chkExportLCIsntCreateYet,#chkYetNotMakeFEO').prop('checked', false);
         $("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch,#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch,#txtFromLCDateAdvSearch,#txtToLCDateAdvSearch").datebox({ disabled: true });
         $("#txtFromIssueDateAdvSearch,#txtToIssueDateAdvSearch,#txtFromValidityDateAdvSearch,#txtToValidityDateAdvSearch,#txtFromLCDateAdvSearch,#txtToLCDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
         DynamicRefreshList([], "tblCurrentStatusAdvSearch");
         DynamicRefreshList(_oPIStatusObjs, "tblCurrentStatusAdvSearch");
         $('#cboProductNature').val(-1);
     }

     function PickAccountOfPIAdvSearch() {
         var oContractor = {
             Params: '2,3' + '~' + $.trim($("#txtContractorAdvS").val()+"~"+_nBUID)
         };
         var obj = {
             BaseAddress: _sBaseAddress,
             Object: oContractor,
             ControllerName: "Contractor",
             ActionName: "ContractorSearchByNameType",
             IsWinClose: false
         };

         $("#progressbar").progressbar({ value: 0 });
         $("#progressbarParent").show();
         var intervalID = setInterval(updateProgress, 250);

         DynamicRefreshList([], "tblAccountsPickerAdvSearch");
         $.icsDataGets(obj, function (response) {
             clearInterval(intervalID);
             $("#progressbarParent").hide();
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].ContractorID > 0) {
                     var tblColums = []; var oColumn = { field: "ContractorID", title: "Code", width: 50, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "Name", title: "Name", width: 280, align: "left" }; tblColums.push(oColumn);

                     var oPickerParam = {
                         winid: 'winAccountOfs',
                         winclass: 'clsAccountOf',
                         winwidth: 400,
                         winheight: 460,
                         tableid: 'tblAccountOfs',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'Name',
                         windowTittle: 'Contactor List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbuttonPI(oPickerParam);
                 }
                 else {
                     alert(response.objs[0].ErrorMessage);
                 }
             }
             else {
                 alert("Sorry, No Contactor Found.");
             }
         });
     }

     function PickBuyerPIAdvSearch() {
         var oContractor = {
             Params: '2' + '~' + $.trim($("#txtSearchByBuyersAdvSearch").val()+"~"+_nBUID)
         };
         var obj = {
             BaseAddress: _sBaseAddress,
             Object: oContractor,
             ControllerName: "Contractor",
             ActionName: "ContractorSearchByNameType",
             IsWinClose: false
         };
         $("#progressbar").progressbar({ value: 0 });
         $("#progressbarParent").show();
         var intervalID = setInterval(updateProgress, 250);
         DynamicRefreshList([], "tblContractorsPickerAdvSearch");
         $.icsDataGets(obj, function (response) {
             clearInterval(intervalID);
             $("#progressbarParent").hide();
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].ContractorID > 0) {
                     var tblColums = []; var oColumn = { field: "ContractorID", title: "Code", width: 50, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "Name", title: "Name", width: 280, align: "left" }; tblColums.push(oColumn);
                     var oPickerParam = {
                         winid: 'winBuyers',
                         winclass: 'clsBuyer',
                         winwidth: 400,
                         winheight: 460,
                         tableid: 'tblBuyers',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'Name',
                         windowTittle: 'Buyer List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbuttonPI(oPickerParam);
                 }
                 else {
                     alert(response.objs[0].ErrorMessage);
                 }
             }
             else {
                 alert("Sorry, No Contactor Found.");
             }
         });
     }

     function PickProductPIAdvSearch() {

         var oProduct = { BUID : _nBUID, ProductName:$.trim($("#txtSearchByProductsAdvSearch").val())};
         var obj = {
             BaseAddress: _sBaseAddress,
             Object: oProduct,
             ControllerName: "Product",
             ActionName: "SearchByProductBUWise",
             IsWinClose: false
         };
         $.icsDataGets(obj, function (response) {
             debugger;
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].ProductID > 0) {
                     var tblColums = [];
                     var oColumn = { field: "ProductCode", title: "Code", width: 100, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "ProductName", title: "Name", width: 300, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "MUnit", title: "Unit", width: 70, align: "left" }; tblColums.push(oColumn);
                     var oPickerParam = {
                         winid: 'winProductPicker',
                         winclass: 'clsProductPicker',
                         winwidth: 600,
                         winheight: 460,
                         tableid: 'tblProductPicker',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'NameCode',
                         windowTittle: 'Product List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbuttonPI(oPickerParam);
                 }
                 else {
                     alert(response.objs[0].ErrorMessage);
                 }

             }else{
                 alert("Data Not Found.");
             }
         });
     }
     $("#txtContactPersonnel").keydown(function (e) {
         if (e.keyCode === 13) // Enter Press
         {
             if($.trim($("#txtContactPersonnel").val())==null || $.trim($("#txtContactPersonnel").val())=="")
             {
                 alert("Please select at least one Buyer, or Type name or part Name!");
                 return false;
             }

             PickCPersonnel();
         }
         else if (e.keyCode === 08) {
             $("#txtContactPersonnel").removeClass("fontColorOfPickItem");
             _sCPersonnelIds = '';
         }
     });

     $("#btnClrContactPersonnel").click(function () {
         $("#txtContactPersonnel").removeClass("fontColorOfPickItem");
         $("#txtContactPersonnel").val("");
         _sCPersonnelIds = '';
     });

     $("#btnPickContactPersonnel").click(function () {

         if(_sContractorIds === ""&& _sBuyerIDsAdvSearch === "" && $.trim($("#txtContactPersonnel").val())=="")
         {
             alert("Please select at least one Buyer, or Type name or part Name!");
             return false;
         }

         PickCPersonnel();
     });
     function PickCPersonnel() {
       
         var sContractorID='';
         if(_sContractorIds.length>0)
         {
             sContractorID=_sContractorIds;
         }
         else if(_sContractorIds.length>0 && _sBuyerIDsAdvSearch.length>0)
         {
             sContractorID=_sContractorIds+','+_sBuyerIDsAdvSearch;
         }
         else if(_sContractorIds.length<0 && _sBuyerIDsAdvSearch.length>0)
         {
             sContractorID=_sBuyerIDsAdvSearch;
         }
            
         var oContactPersonnel = { ContractorName:sContractorID,Name:$.trim($("#txtContactPersonnel").val())};
         var obj = {
             BaseAddress: _sBaseAddress,
             Object: oContactPersonnel,
             ControllerName: "ContractorPersonal",
             ActionName: "GetsByContractors",
             IsWinClose: false
         };

         $("#progressbar").progressbar({ value: 0 });
         $("#progressbarParent").show();
         var intervalID = setInterval(updateProgress, 250);

         DynamicRefreshList([], "tblAccountsPickerAdvSearch");
         $.icsDataGets(obj, function (response) {
             clearInterval(intervalID);
             $("#progressbarParent").hide();
             if (response.status && response.objs.length > 0) {
                 if (response.objs[0].ContactPersonnelID > 0)
                 {
                     var tblColums = [];var oColumn ={};
                     oColumn= { field: "ContactPersonnelID", title: "Code", width: 60, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "Name", title: "Name", width: 180, align: "left" }; tblColums.push(oColumn);
                     oColumn = { field: "ContractorName", title: "ContractorName", width: 150, align: "left" }; tblColums.push(oColumn);
                     var oPickerParam = {
                         winid: 'winCPersonPicker',
                         winclass: 'clsCPersinPicker',
                         winwidth: 600,
                         winheight: 460,
                         tableid: 'tblCPersonPicker',
                         tablecolumns: tblColums,
                         datalist: response.objs,
                         multiplereturn: true,
                         searchingbyfieldName: 'Name',
                         windowTittle: 'Person List'
                     };
                     $.icsPicker(oPickerParam);
                     IntializePickerbuttonPI(oPickerParam);//multiple return
                 }
                 else {
                     alert("Data Not Found");
                 }
             }
             else {
                 alert("Data Not Found.");
             }
         });
     }

     function IntializePickerbuttonPI(oPickerobj) {
         $("#" + oPickerobj.winid).find("#btnOk").click(function () {
             SetPickerValueAssignPI(oPickerobj);
         });
         $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
             if (e.which === 13) {
                 SetPickerValueAssignPI(oPickerobj);
             }
         });
     }

     function SetPickerValueAssignPI(oPickerobj) {
         var oreturnObj = null, oreturnObjs = [];
         if (oPickerobj.multiplereturn) {
             oreturnObjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
         } else {
             oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
         }

         if (oPickerobj.winid == 'winAccountOfs')
         {
             if (oreturnObjs != null && oreturnObjs.length> 0)
             {

                 _sContractorIds=''; var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Contractors Selected" : oreturnObjs[0].Name;
                 $('#txtContractorAdvS').val(sMessage);
                 $("#txtContractorAdvS").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sContractorIds=_sContractorIds+oreturnObjs[i].ContractorID+',';
                 }
                 _sContractorIds=_sContractorIds.substring(0,_sContractorIds.length-1);

             }
             else
             {
                 alert("Please select a contractor.");
                 return false;
             }
         }
         else if (oPickerobj.winid == 'winBuyers') {
             if (oreturnObjs != null && oreturnObjs.length> 0)
             {
                 _sBuyerIDsAdvSearch='';
                 var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Contractors Selected" : oreturnObjs[0].Name;
                 $('#txtSearchByBuyersAdvSearch').val(sMessage);
                 $("#txtSearchByBuyersAdvSearch").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sBuyerIDsAdvSearch=_sBuyerIDsAdvSearch+oreturnObjs[i].ContractorID+',';
                 }
                 _sBuyerIDsAdvSearch=_sBuyerIDsAdvSearch.substring(0,_sBuyerIDsAdvSearch.length-1);
             }
             else
             {
                 alert("Please select a buyer.");
                 return false;
             }
         }
         else if (oPickerobj.winid == 'winCPersonPicker')
         {
             debugger;

             if (oreturnObjs!=null && oreturnObjs.length > 0) {

                 _sCPersonnelIds=''; var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Con Person Selected" : oreturnObjs[0].Name;
                 $('#txtContactPersonnel').val(sMessage);
                 $("#txtContactPersonnel").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sCPersonnelIds=_sCPersonnelIds+oreturnObjs[i].ContactPersonnelID+',';
                 }
                 _sCPersonnelIds=_sCPersonnelIds.substring(0,_sCPersonnelIds.length-1);
             }
         }
         else if (oPickerobj.winid == 'winProductPicker') {
             if (oreturnObjs != null && oreturnObjs.length> 0)
             {
                 _sProductIDsAdvSearch='';
                 var sMessage='';
                 sMessage=(oreturnObjs.length>1)? oreturnObjs.length +" Products Selected" : oreturnObjs[0].ProductName;
                 $('#txtSearchByProductsAdvSearch').val(sMessage);
                 $("#txtSearchByProductsAdvSearch").addClass("fontColorOfPickItem");

                 for(var i=0;i<oreturnObjs.length;i++){
                     _sProductIDsAdvSearch=_sProductIDsAdvSearch+oreturnObjs[i].ProductID+',';
                 }
                 _sProductIDsAdvSearch=_sProductIDsAdvSearch.substring(0,_sProductIDsAdvSearch.length-1);
             }
             else
             {
                 alert("Please select a buyer.");
                 return false;
             }
         }

         $("#" + oPickerobj.winid).icsWindow("close");
         $("#" + oPickerobj.winid).remove();
     }

     function DateActionsIssueDateAdvSearch() {
         DynamicDateActions("cboIssueDateAdvSearch", "txtFromIssueDateAdvSearch", "txtToIssueDateAdvSearch");
     }

     function DateActionsValidityDateAdvSearch() {
         DynamicDateActions("cboValidityDateAdvSearch", "txtFromValidityDateAdvSearch", "txtToValidityDateAdvSearch");
     }

     function DateActionsLCDateAdvSearch() {
         DynamicDateActions("cboLCDateAdvSearch", "txtFromLCDateAdvSearch", "txtToLCDateAdvSearch");
     }
     function DateActionsStatusDateAdvSearch() {
         DynamicDateActions("cboStatusAdvSearch", "txtFromStatusDateAdvSearch", "txtToStatusDateAdvSearch");
     }

     $("#btnCloseAdvSearch").click(function () {
         $("#winAdvSearchExportPI").icsWindow("close");
     });

     //Operations
     $("#txtSearchByExportPI").keyup(function (e) {
         if (e.keyCode == 13) {
             var oExportPI = {
                 PINo : $("#txtSearchByExportPI").val(),
                 BUID:_nBUID
             };

             if (oExportPI.BUID<=0)
             {
                 alert("Invalid Business unit.");
                 return false;
             }

             $.ajax({
                 type: "POST",
                 dataType: "json",
                 url: _sBaseAddress + "/ExportPIReport/GetsByNo",
                 traditional: true,
                 data: JSON.stringify(oExportPI),
                 contentType: "application/json; charset=utf-8",
                 success: function (data) {
                     var oExportPIs = data;
                     if (oExportPIs != null) {
                         if (oExportPIs.length > 0) {
                             DynamicRefreshList(oExportPIs, "tblExportPIs");
                         }
                         else {
                             DynamicRefreshList([], "tblExportPIs");
                         }
                     } else {
                         DynamicRefreshList([], "tblExportPIs");
                     }
                 },
                 error: function (xhr, status, error) {
                     alert(error);
                 }
             });
         }
         else {

             var txtSearchBy = $("#txtSearchByExportPI").val();
             var oCurrentLists = $("#tblExportPIs").datagrid("getRows");
             var sTempSearchString = "";
             var oSearchedLists = [];
             if (e.keyCode == 8) {
                 oCurrentLists = _oExportPIs;
             }
             for (var i = 0; i < oCurrentLists.length; i++) {
                 sTempSearchString = oCurrentLists[i].PINo;
                 var n = sTempSearchString.toUpperCase().indexOf(txtSearchBy.toUpperCase());
                 if (n != -1) {
                     if (parseInt(nTextileUnitInInt) > 0) {
                         if (oCurrentLists[i].TextileUnitInInt == parseInt(nTextileUnitInInt)) {
                             oSearchedLists.push(oCurrentLists[i]);
                         }
                     }
                     else {
                         oSearchedLists.push(oCurrentLists[i]);
                     }
                 }
             }
             DynamicRefreshList(oSearchedLists, "tblExportPIs");
         }
     });
     $("#btnAdvSearchExportPI").click(function () {
         debugger;
         $("#winAdvSearchExportPI").icsWindow("open", "Export PI Advance Search");
         DynamicRefreshList([], "tblExportPIAdvSearch");
         DynamicResetAdvSearchWindow("winAdvSearchExportPI");
         DynamicDateActions("cboDateOptionAdvSearch", "txtFromDateAdvSearch", "txtToDateAdvSearch");
         DynamicDateActions("cboValidityDateAdvSearch", "txtFromValidityDateAdvSearch", "txtToValidityDateAdvSearch");
         DynamicDateActions("cboLCDateAdvSearch", "txtFromLCDateAdvSearch", "txtToLCDateAdvSearch");
         DynamicDateActions("cboStatusAdvSearch", "txtFromStatusDateAdvSearch", "txtToStatusDateAdvSearch");
         ResetAdvSearchWindow();
     });


     $("#btnPrintShowDetail").click(function() {
         var oExportPI= $('#tblExportPIs').datagrid('getSelected');
         if(oExportPI==null || oExportPI.ExportPIID<=0)
         {
             alert("Please select a item from list!");
             return;
         }
         var nts = ((new Date()).getTime()) / 1000;
       
         window.open(_sBaseAddress + '/ExportSCDO/PrintStatement_DOBalanceByPI?nExportPIID=' + parseInt(oExportPI.ExportPIID) + "&nDOID=" + parseInt(0) + "&nProductID=" + parseInt(0) + "&nts=" + nts, "_blank");
     });

     $("#btnPrintPI").click(function () {
         var oExportPI= $('#tblExportPIs').datagrid('getSelected');
         if(oExportPI==null || oExportPI.ExportPIID<=0)
         {
             alert("Please select a item from list!");
             return;
         }
         var nts = ((new Date()).getTime()) / 1000;
         window.open(_sBaseAddress + '/ExportPI/PrintoExportPIPreview?id=' +oExportPI.ExportPIID + "&bPrintFormat=true&nTitleTypeInImg=1" , "_blank");//Defalult false
     });
 </script>


