<html>
<head>

</head>
<body>

    @model ESimSol.BusinessObjects.Fabric
    <div id="divFabric" class="easyui-panel" title="Add Fabric" style="font-family:Tahoma; height:100%; width:100%">
        <div style="width:100%; height:87%; text-align:center">

            <fieldset>
                <legend style="font-weight:bold;text-align:left;"></legend>
                <table style="width: 100%;">
                    <tr>
                        <td style="width:10%; text-align:right;font-weight:bold">
                            Buyer:
                        </td>
                        <td colspan="3" style="width:40%;text-align:left">
                            <input id="txtContractorName" class="reset-text" style="width:76%;" placeholder="Type & Press Enter" disabled="disabled" />
                            @*<a id="btnContractor" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                <a id="btnResetContractor" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>*@
                        </td>
                        <td style="width:10%; text-align:right;font-weight:bold">
                            <label id="lblFabricNoTwo">FABRIC No</label>:
                        </td>
                        <td style="width:15%">
                            <input id="txtP" style="width:20%" placeholder="P" type="text" disabled="disabled" />
                            <input id="txtFabricNoFabric" style="width:75%" type="text" disabled="disabled" />
                        </td>
                        <td style="width:10%; text-align:right;font-weight:bold">
                            <label>Issue DT :</label>
                        </td>
                        <td style="width:15%">
                            <input id="txtPODate" type="text" style="width: 100%;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>

                    </tr>
                    <tr>
                        <td style="width:10%; text-align:right;font-weight:bold">
                            Style:
                        </td>
                        <td style="width:15%;text-align:left">
                            <input id="txtStyleNo" class="reset-text" style="width:100%" placeholder="Type & Press Enter" disabled="disabled" />
                        </td>
                        <td style="width:10%;text-align:left">
                            Buyer Ref.:

                        </td>
                        <td style="width:15%;text-align:left">
                            <input id="txtBuyerReference" class="reset-text" style="width:100%" placeholder="Type & Press Enter" disabled="disabled" />

                        </td>
                        <td style="width:10%; text-align:right;font-weight:bold">
                            <label>Mkt. Person :</label>
                        </td>
                        <td colspan="3" style="width:40%">
                            <input id="txtMKTPName" class="reset-text" style="width:100%;" placeholder="Type & Press Enter" disabled="disabled" />
                        </td>


                    </tr>

                </table>
            </fieldset>
            
            <div style="float:left; width:100%">
                <fieldset>
                    <legend style="text-align:left; font-weight:bolder;">Lab Detail</legend>
                    <table style="width:100% ;height:150px">
                        <tr>
                            <td style="width:60% ;height:150px">

                                <table cellpadding="2" style="width:100% ;height:140px">
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Composition Warp:</label></td>
                                        <td style="width:30%;text-align:left"><select style="width:100% ;" id="cboProductWarpRnd" disabled="disabled"></select></td>
                                        <td style="width:10%;text-align:right"><label> Weft:</label></td>
                                        <td style="width:30%;text-align:left"><select style="width:100% ;" id="cboProductWeftRnd" disabled="disabled"></select></td>
                                    </tr>


                                    <tr>
                                        <td style="width:30%;text-align:right">
                                            <label>Const.(Actual):</label>
                                        </td>
                                        <td colspan="3" style="width:70%;text-align:left">
                                            <input id="txtWarpCount" style="width:21%" placeholder="Warp" type="text" disabled="disabled" /><label>x</label>
                                            <input id="txtWeftCount" style="width:21%" placeholder="Weft" type="text" disabled="disabled" /><label>/</label>
                                            <input id="txtEPI" style="width:21%" placeholder="EPI" type="text" disabled="disabled" /><label>x</label>
                                            <input id="txtPPI" style="width:21%" placeholder="PPI" type="text" disabled="disabled" />
                                        </td>
                                    </tr>
                                    <tr id="rtAdjDocCharge" style="vertical-align:top">
                                        <td style="width: 30%; text-align: right">
                                            <label>Const.(Suggested):</label>
                                        </td>
                                        <td style="width:30%; text-align: left">
                                            <input id="txtConstructionSuggest" style="width:100%" type="text" disabled="disabled" />
                                        <td style="width:10%;text-align:right" ></td>
                                        <td style="width:30%;text-align:left"></td>

                                    </tr>
                                    <tr id="rtAdjDocCharge" style="vertical-align:top">
                                        <td style="width: 30%; text-align: right">
                                            <label>Yarn Quality:</label>
                                        </td>
                                        <td style="width:30%; text-align: left">
                                            <input id="txtYarnQuality" style="width:100%" type="text" disabled="disabled" />
                                        <td style="width:10%;text-align:right"><label>Yarn Ply:</label></td>
                                        <td style="width:30%;text-align:left"><input id="txtYarnFly" style="width:100%" type="text" disabled="disabled" /></td>

                                    </tr>
                                    <tr id="rtAdjDocCharge" style="vertical-align:top">
                                        <td style="width: 30%; text-align: right">
                                            <label>Remarks(RnD):</label>
                                        </td>
                                        <td colspan="3" style="width:70%;text-align:left"><textarea rows="1" id="txtNoteRnD" style="text-align:left; width:96%; height:20px; font-family:Tahoma; font-size:12px" disabled="disabled" placeholder="Type RnD Remarks"></textarea></td>

                                    </tr>
                                    <tr>
                                        <td style="width: 30%; text-align: right"></td>
                                        <td colspan="3" style="width:70%;text-align:left"></td>


                                    </tr>

                                </table>

                            </td>
                            <td style="width:40% ;height:150px">


                                <table style="width:100% ;height:140px;">


                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Width :</label></td>
                                        <td style="width:70%;text-align:left"><input style="width:100%" id="txtFabricWidthRnD" type="text" disabled="disabled" /></td>
                                    </tr>

                                    @*<tr>
                                            <td style="width:30%;text-align:right"><label>Process Type :</label></td>
                                            <td style="width:70%;text-align:left"><select style="width:100%" id="cboProcessTypeFabric"></select> </td>
                                        </tr>
                                        <tr>

                                            <td style="width:30%;text-align:right"><label>Fabric Design :</label></td>
                                            <td style="width:70%;text-align:left"><select style="width:100%" id="cboProcessTypeFabric"></select> </td>
                                        </tr>*@
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Weave:</label></td>
                                        <td style="width:70%;text-align:left"><select style="width:100%" id="cboWeaveRnD" disabled="disabled"></select> </td>

                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Finish Type :</label></td>
                                        <td style="width:70%;text-align:left"><select style="width:100%" id="cboFinishTypeRnD" disabled="disabled"></select> </td>

                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Weight Actual:</label></td>
                                        <td style="width:70%;text-align:left"><input id="txtWeightAct" type="text" disabled="disabled" /> </td>

                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Weight Calculated:</label></td>
                                        <td style="width:70%;text-align:left"><input id="txtWeightCal" type="text" disabled="disabled" /></td>

                                    </tr>

                                </table>

                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <div style="float:left; width:100%">
                <fieldset>
                    <legend style="text-align:left; font-weight:bolder;">MKT Detail</legend>
                    <table style="width:100% ;height:150px">
                        <tr>
                            <td style="width:60% ;height:150px">

                                <table cellpadding="2" style="width:100% ;height:140px;vertical-align:top">
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Composition Warp:</label></td>
                                        <td style="width:30%;text-align:left"><select style="width:100% ;" id="cboProductWarp" ></select></td>
                                        <td style="width:10%;text-align:right"><label> Weft:</label></td>
                                        <td style="width:30%;text-align:left"><select style="width:100% ;" id="cboProductWeft"></select></td>
                                    </tr>

                                    <tr style="vertical-align:top">
                                        <td style="width: 30%; text-align: right">
                                            <label>Construction:</label>
                                        </td>
                                        <td style="width:30%; text-align: left">
                                            <input id="txtConstruction" type="text"  />
                                        </td>
                                        <td style="width: 10%; text-align: right">
                                            <label>Construction(PI):</label>
                                        </td>
                                        <td style="width:30%; text-align: left">
                                            <input id="txtConstructionPI" type="text"/>
                                        </td>

                                    </tr>
                                   
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Weight:</label></td>
                                        <td style="width:30%;text-align:left"><input id="txtWeightDec" style="width:60%" type="number" /> GSM</td>
                                        <td style="width:10%;text-align:right"><label>No of Frame:</label></td>
                                        <td style="width:30%;text-align:left"><input id="txtNoOfFrame"  type="number" style="width:100%;"  /></td>
                                    </tr>

                                   
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Note:</label></td>
                                        <td colspan="3" style="width:70%;text-align:left"><textarea rows="1" id="txtNoteMKT" style="text-align:left; width:99%; height:20px; font-family:Tahoma; font-size:12px"  placeholder="Narration"></textarea></td>
                                    </tr>


                                </table>

                            </td>
                            <td style="width:40% ;height:150px">

                                <table style="width:100% ;height:140px;">
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Width :</label></td>
                                        <td style="width:70%;text-align:left"><input style="width:100%" id="txtFabricWidthFabric" type="text" /></td>
                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Fabric Design :</label></td>
                                        <td style="width:70%;text-align:left"><select style="width:100%" id="cboFabricDesign"></select> </td>
                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Weave:</label></td>
                                        <td style="width:70%;text-align:left"><select style="width:100%" id="cboWeaveFabric"></select> </td>
                                    </tr>
                                    <tr>
                                        <td style="width:30%;text-align:right"><label>Finish Type :</label></td>
                                        <td style="width:70%;text-align:left"><select style="width:100%" id="cboFinishTypeFabric"></select> </td>
                                    </tr>

                                </table>

                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>

        <div style="width:100%; height:10%">
            <fieldset>
                <legend style="font-weight: bold">Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold; width:100%">
                    <tr>
                        <td style="width:30%">
                         <a id="btnPOPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Order Statement</a>
                         <a id="btnPrintAnalysisResult" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                        </td>
                        <td style="width:50%; text-align:right"></td>
                        
                        <td style="width: 10%">
                            <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        </td>
                        <td style="width: 10%">
                            <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>
</body>
</html>


<script type="text/javascript">
    var _oFabric=null;
    var _sBaseAddress="",_sBackTo="";
    var _oFinishTypes = [];
    var _oCompareOperators = [];
    var _oPriorityLevels = [];
    var _oSwatchTypes = [];
    var _oProcessTypes=[];
    var _oFabricWeaves=[];
    var _oFabricDesigns=[];
    var _oLightSources=[];
    var _nCurrentUserID=0;
    var _oProducts=[];
    var _nBUID = 0;
    var _nSelectedRowIndex = -1;
    var _oFabricSCReport = null;
    var _oFabricOrderSetups=[];
    var _nMenuid=0;
    var _oFabricRnD=[];

    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _nMenuid = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.MenuID]));
        _oFabric =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oFinishTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FinishTypes));
        _oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
        _oPriorityLevels = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PriorityLevels));
        _oSwatchTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.SwatchTypes));
        _oProcessTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ProcessTypes));
        _oFabricWeaves = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricWeaves));
        _oFabricDesigns = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricDesigns));
        _oLightSources = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.LightSources));
        _oProducts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Products));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _nCurrentUserID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CurrentUserID));
        var oFabricPOSetup = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricPOSetup));
        _oFabricOrderSetups= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricOrderSetups));
        var oAuthorizationRolesMapping = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
        _oFabricRnD= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricRnD));
        debugger;
        RefreshSetup(oFabricPOSetup);
        LoadComboboxesFabric();
        RefreshFabricControl();
        RefreshFabricControlRnd();
        _sBackTo=sessionStorage.getItem("BackLink");
        _sFabricHeader=sessionStorage.getItem("FabricHeader");
        $('#divFabric').panel({ title:_sFabricHeader});
        //RefreshControlLayout(oAuthorizationRolesMapping);

    });
    function RefreshSetup(oFabricPOSetup)
    {
        $('#lblFabricNoTwo').html(oFabricPOSetup.FabricCode);
        // $("#txtSearchbyFabricNo").attr("placeholder","Search by "+oFabricPOSetup.NoCode+" No");
        $("#txtP").attr("placeholder",oFabricPOSetup.NoCode);
        //$('#lblHLRefNo').html("Lab Ref No:");
        //if(oFabricPOSetup.IsLDApply==false)
        //{
        //    $('#lblHLRefNo').html("H/L No:");
        //    $('#btnAddFNLabdipDetail,#btnPrintFabricOrder').hide();
        //}

    }

    function LoadComboboxesFabric() {

        debugger;
        //PickProductInFabric();
        //    _oFabricOrderSetups
        $("#cboProductWarp,#cboProductWeft,#cboProductWarpRnd,#cboProductWeftRnd").icsLoadCombo({
            List: _oProducts,
            OptionValue: "ProductID",
            DisplayText: "ProductName"
        });

        $("#cboFinishTypeFabric,#cboFinishTypeRnD").icsLoadCombo({
            List: _oFinishTypes,
            OptionValue: "FabricProcessID",
            DisplayText: "Name"
        });

        //$("#cboSwatchTypeSubmit").icsLoadCombo({
        //    List: _oSwatchTypes,
        //    OptionValue: "id",
        //    DisplayText: "Value"
        //});

        $("#cboProcessTypeFabric").icsLoadCombo({
            List: _oProcessTypes,
            OptionValue: "FabricProcessID",
            DisplayText: "Name"
        });

        $("#cboWeaveFabric,#cboWeaveRnD").icsLoadCombo({
            List: _oFabricWeaves,
            OptionValue: "FabricProcessID",
            DisplayText: "Name"
        });

        $("#cboFabricDesign").icsLoadCombo({
            List: _oFabricDesigns,
            OptionValue: "FabricProcessID",
            DisplayText: "Name"
        });

        //$("#cboPrimaryLightSource,#cboSecondaryLightSource").icsLoadCombo({
        //    List: _oLightSources,
        //    OptionValue: "LightSourceID",
        //    DisplayText: "Descriptions"
        //});
    }

    function RefreshFabricControl() {
        debugger;

        $("#txtFabricNoFabric").val(_oFabric.FabricNo);
        $("#txtBuyerReference").val(_oFabric.BuyerReference);
        $("#txtStyleNo").val(_oFabric.StyleNo);
        //  $("#txtProduct").val(oFabric.ProductName);
        //_nProductId = oFabric.ProductID;
        $("#txtConstruction").val(_oFabric.Construction);
        $("#txtConstructionPI").val(_oFabric.ConstructionPI);
        $("#txtMKTPName").val(_oFabric.MKTPersonName);
        $("#txtContractorName").val(_oFabric.BuyerName);
        $("#txtNoOfFrame").val(parseInt(_oFabric.NoOfFrame));
        $("#txtWeightDec").val(parseFloat(_oFabric.WeightDec));
        //$("#txtEndUse").val(_oFabric.EndUse);
        $("#txtPODate").datebox("setValue", _oFabric.IssueDateInString);
        $("#txtNoteMKT").val(_oFabric.NoteRnD);
        $("#txtColor").val(_oFabric.ColorInfo);
        $("#txtFabricWidthFabric").val(_oFabric.FabricWidth);
        $("#cboFinishTypeFabric").val(_oFabric.FinishType);
        $("#cboProcessTypeFabric").val(_oFabric.ProcessType);
        $("#cboFabricDesign").val(_oFabric.FabricDesignID);
        $("#cboWeaveFabric").val(_oFabric.FabricWeave);
        $("#cboProductWarp").val(_oFabric.ProductID);
        $("#cboProductWeft").val(_oFabric.ProductIDWeft);
       
    }

    function RefreshFabricControlRnd() {
        debugger;
        $('#cboProductWarpRnd').val(_oFabricRnD.ProductIDWarp);
        $('#cboProductWeftRnd').val(parseInt(_oFabricRnD.ProductIDWarp));
        $("#txtWarpCount").val(_oFabricRnD.WarpCount);
        $("#txtWeftCount").val(_oFabricRnD.WeftCount);
        $("#txtEPI").val(_oFabricRnD.EPI);
        $("#txtPPI").val(_oFabricRnD.PPI);
        $("#txtYarnQuality").val(_oFabricRnD.YarnQuality);
        $("#txtYarnFly").val(_oFabricRnD.YarnFly);
        $("#txtNoteRnD").val(_oFabricRnD.Note);
        $("#txtFabricWidthRnD").val(_oFabricRnD.FabricWidth);
        $('#cboWeaveRnD').val(_oFabricRnD.FabricWeave);
        $('#cboFinishTypeRnD').val(_oFabricRnD.FinishType);
        $("#txtWeightAct").val(_oFabricRnD.WeightAct);
        $("#txtWeightCal").val(_oFabricRnD.WeightCal);
        $("#txtConstructionSuggest").val(_oFabricRnD.ConstructionSuggest);
        $("#txtYarnFly").val(_oFabricRnD.YarnFly);
        $("#txtYarnQuality").val(_oFabricRnD.YarnQuality);
    }


    //function ValidateInput()
    //{
    //    if(document.getElementById("txtName").value==null || document.getElementById("txtName").value=="")
    //    {
    //        alert("Please enter Fabric name!");
    //        $('#txtName').focus();
    //        return false;
    //    }

    //    var oConTyps= $('#tblConType').datagrid('getChecked')

    //    if(oConTyps.length<=0 || oConTyps ==null)
    //    {
    //        alert("Please select Fabric type!");
    //        $('#tblConType').focus();
    //        return false;
    //    }

    //    if(document.getElementById("txtAddress").value==null || document.getElementById("txtAddress").value=="")
    //    {
    //        alert("Please enter Fabric address!");
    //        $('#txtAddress').focus();
    //        return false;
    //    }

    //    if(document.getElementById("txtShortName").value==null || document.getElementById("txtShortName").value=="")
    //    {
    //        alert("Please enter Fabric short Name!");
    //        $('#txtShortName').focus();
    //        return false;
    //    }

    //    var input = $("#txtShortName").val();
    //    var inputLength = input.length;
    //    var output = input.replace(/[^a-zA-Z0-9& ]/g, "")

    //    var outputLength = output.length;
    //    if (inputLength != outputLength)
    //    {
    //        alert("Symbol Not Allow for Short Name!");
    //        $('#txtShortName').focus();
    //        return false;
    //    }
    //    return true;
    //}


    function RefreshObject()
    {

        var oFabric= {

            FabricID : _oFabric.FabricID,
            ProductID:parseInt($('#cboProductWarp').val()),
            ProductIDWeft :parseInt($('#cboProductWeft').val()),
            Construction : $.trim($("#txtConstruction").val()),
            ConstructionPI : $.trim($("#txtConstructionPI").val()),
            FabricWidth :  $.trim($("#txtFabricWidthFabric").val()),
            FinishType: parseInt($('#cboFinishTypeFabric').val()),
            //ProcessType: parseInt($('#cboProcessTypeFabric').val()),
            FabricDesignID: parseInt($('#cboFabricDesign').val()),
            FabricWeave: parseInt($('#cboWeaveFabric').val()),
            Remarks:  $.trim($("#txtNoteMKT").val()),
            WeightDec : parseFloat($("#txtWeightDec").val()),
            NoOfFrame : parseInt($("#txtNoOfFrame").val())
         
        };
        return oFabric;
    }

    $("#btnSave").click(function(){
        // if(!ValidateInput()) return;
        debugger;
        var oFabric=RefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+  "/Fabric/SaveReceived",
            traditional: true,
            data:  JSON.stringify(oFabric),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var oFabric = jQuery.parseJSON(data);
                if (oFabric.FabricID>0 && (oFabric.ErrorMessage=="" || oFabric.ErrorMessage==null)) {
                    _oFabric=oFabric;
                    alert("Data Saved sucessfully");
                    //var oFabrics =sessionStorage.getItem("Fabrics");
                    //var nIndex= parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    //if(oFabrics!=null)
                    //{
                    //    oFabrics = jQuery.parseJSON(oFabrics);
                    //}
                    //else
                    //{
                    //    oFabrics=[];
                    //}
                    //if(nIndex!=-1)
                    //{
                    //    oFabrics[nIndex]=oFabric;
                    //}
                    //else
                    //{
                    //    sessionStorage.setItem("SelectedRowIndex", oFabrics.length);
                    //    oFabrics.push(oFabric);
                    //}
                    //sessionStorage.setItem("Fabrics", JSON.stringify(oFabrics));
                    //window.location.href = _sBackTo;
                }
                else {
                    alert(oFabric.ErrorMessage);
                    return;
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
    });

    $("#btnClose").click(function(){
        debugger;
        window.location.href = _sBackTo;
    });

    $(document).keydown(function(e) {
        if(e.which == 27)//escape=27
        {
            window.location.href = _sBackTo;
        }
    });
    $("#btnPOPrint").click(function ()
    {
        debugger;
        
        if(_oFabric==null || _oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
      
        window.open(_sBaseAddress + '/Fabric/OrderStatementPrint?nFabricID=' + _oFabric.FabricID+"&buid="+_nBUID);
    });
    $("#btnPrintAnalysisResult").click(function () {

        if(_oFabric==null || _oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
            
        var url = _sBaseAddress + "/FabricSCReport/PrintFabricAnalysis?nId="+0+"&nFabricID=" + _oFabric.FabricID + "&buid=" + _nBUID;
        window.open(url, "_blank");
    });

    //function RefreshControlLayout(oAuthorizationRolesMapping)
    //{
    //    $("#btnPOPrint").hide();
    //    if(oAuthorizationRolesMapping.length>0)
    //    {    
    //        if (PermissionChecker('ViewCMValue', 'Fabric',oAuthorizationRolesMapping))
    //        {
    //            $("#btnPOPrint").show();
    //        }
    //    }
    //}

</script>