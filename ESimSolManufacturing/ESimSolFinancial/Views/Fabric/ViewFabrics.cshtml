<script src="http://malsup.github.com/jquery.form.js"></script>
@{
    ViewBag.Title = "Fabrics List";
}

@model IEnumerable<ESimSol.BusinessObjects.Fabric>
<head>
    <title></title>
    <script src="@Url.Content("~/Views/Fabric/AdvSearch.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Views/Fabric/Fabric.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Views/Fabric/Fabrics.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Views/Fabric/FNLabdipDetail.js")" type="text/javascript"></script>
    <link href="@Url.Content("~/Content/CSS/MeetingSummary.css")" rel="stylesheet" type="text/css" />


    @*<script src="@Url.Content("~/Views/MarketingSchedule/MarketingSchedule.js")" type="text/javascript"></script>*@  

       
</head>
<body>
    
    <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progressbar" style="width:100%;height:37px;"></div>
        </div>
    </div>
  
    <div id="winFabric" style="width:900px;" class="easyui-window winstyle" title="Fabric" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <fieldset>
            <table class="tbl">
                <tr style="vertical-align:top">
                    <td style="width:50%">
                        <table cellspacing="1" cellpadding="1" border="0" class="tbl">
                            <tr>
                                <td class="tdLabel">
                                    <label id="lblFabricNoTwo"></label>:
                                </td>
                                <td class="tdInput">
                                    <div style="float:left">
                                        <div style="float:left; width:6%">
                                            <input id="txtP" placeholder="P" type="text" />
                                        </div>
                                        <div style="float:left; width:29%">
                                            <input id="txtFabricNoFabric" placeholder="YY MM XXXXX" type="text" />
                                        </div>
                                        <div style="float:left; width:25%" class="text-right">
                                            <label>Issue Date :</label>
                                        </div>
                                        <div style="float:left; width:35%">
                                            <input id="txtDateFabric" type="text" style="width: 100%;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                        </div> 
                                    </div>
                                    
                                </td>
                            </tr>
                            <tr class="oneTextTwoButton">
                                <td class="tdLabel">
                                    <label class="lblStar">*</label>
                                    <label>Mkt. Person :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboMktPersonsFabric"></select>
                                </td>
                            </tr>
                            <tr class="oneTextTwoButton">
                                <td class="tdLabel">
                                    <label class="lblStar">*</label>
                                    <label>Buyer :</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtContractorName" class="reset-text" style="width:76%;" placeholder="Type & Press Enter" />
                                    <a id="btnContractor" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                                    <a id="btnResetContractor" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Buyer Ref :</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtBuyerReferenceFabric" type="text" />
                                </td>
                            </tr>
                            <tr class="oneTextTwoButton">
                                <td class="tdLabel">
                                    <label class="lblStar">*</label>
                                    <label>Composition :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboProductFabric"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Construction :</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtConstructionFabric" type="text" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Construction(PI):</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtConstructionFabricPI" type="text" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Width :</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtFabricWidthFabric" type="text" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Process Type :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboProcessTypeFabric"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Fabric Design :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboFabricDesign"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Weave:</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboWeaveFabric"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Finish Type :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboFinishTypeFabric"></select>
                                </td>
                            </tr>
                          
                            <tr>
                                <td class="tdLabel">
                                    <label>Style No :</label>
                                </td>
                                <td class="tdInputC">
                                    <input id="txtStyleNoFabric" type="text" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Color :</label>
                                </td>
                                <td class="tdInputC">
                                    <input id="txtColorFabric" type="text" />
                                </td>
                            </tr>
                            @*<tr>
                                <td class="tdLabel">
                                    <label>Actual Construction:</label>
                                </td>
                                <td class="tdInputC">
                                    <input id="txtActualConstruction" type="text" />
                                </td>
                            </tr>*@
                        </table>
                    </td>
                    <td style="vertical-align:top; width:50%">
                        <table class="tbl">

                            <tr style="vertical-align:top">
                             
                              
                                    @*<table style="width:100%;border:1px solid grey; border-collapse:collapse;text-align:left" border="1" cellpadding="0" cellspacing="0">
                <tr>
                    <td style="width:40%;font-size:13px; font-weight: bold;text-align:center">Buyer Request</td>
                    <td style="width:30%;font-size:13px; font-weight: bold;text-align:center">Seeking Date</td>
                    <td style="width:30%;font-size:13px; font-weight: bold;text-align:center">Sets</td>
                </tr>
                <tr style="text-align:left;">
                    <td style="text-align:left; width:40%;"><input id="chkIsHandLoom" type="checkbox" />Hand Loom</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtHandLoomDate" type="text" style="width: 100px;" class="easyui-datebox"  data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtHandLommSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr class="regionFabricStage">
                    <td style="text-align:left; width:40%;"><input id="chkIsSample" type="checkbox" />Sample</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtSampleDate" type="text" style="width: 100px;" class="easyui-datebox"  data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtSampleSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr class="regionFabricStage">
                    <td style="text-align:left; width:40%;"><input id="chkIsBulk" type="checkbox" />Bulk</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtBulkDate" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtBulkSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr>
                    <td style="text-align:left; width:40%;"><input id="chkIsAnalysis" type="checkbox" />Analysis</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtAnalysis" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtAnalysisSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr class="regionFabricStage">
                    <td style="text-align:left; width:40%;"><input id="chkIsCAD" type="checkbox" />CAD</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtCADDate" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtCadSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr class="regionFabricStage">
                    <td style="text-align:left; width:40%;"><input id="chkIsColor" type="checkbox" />Color Standard</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtColorDate" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtColorSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr>
                    <td style="text-align:left; width:40%;"><input id="chkIsLabdip" type="checkbox" />Labdip</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtLabdipDate" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtLabdipSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
                <tr>
                    <td style="text-align:left; width:40%;"><input id="chkIsYarnSkein" type="checkbox" />YarnSkein</td>
                    <td class="tdInputDateBox" style="width:30%;">
                        <input id="txtYarnSkein" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                    </td>
                    <td style="text-align:left; width:30%;"><input id="txtYarnSkeinSet" class="numberField" type="text" style="width:100%;" /></td>
                </tr>
            </table>*@
                                <td class="tdLabel">
                                    <label>Order Type:</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboFabricOrderType"></select>
                                </td>
                                
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Seeking Date:</label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtSeekingDate" type="text" style="width:40%;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:32%"></td>
                                <td class="tdInputChk">

                                    <ul style="margin-left:0px;">
                                        <li><input id="chkWashFabric" type="checkbox" />Wash</li>
                                        <li><input id="chkFinishFabric" type="checkbox" />Finish</li>
                                        <li><input id="chkDyeingFabric" type="checkbox" />Dyeing</li>
                                        <li><input id="chkPrintFabric" type="checkbox" />Print</li>
                                    </ul>

                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Priority Level :</label>
                                </td>
                                <td class="tdInput">
                                    <select id="cboPriorityLevelFabric"></select>
                                </td>
                            </tr>
                           
                            <tr>
                                <td class="tdLabel">
                                    <label id="lblHLRefNo">H/L No:</label>
                                
                                </td>
                                <td class="tdInputC">
                                    <input id="txtHLNo" type="text" style="width:100%;" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Primary Light Src. :</label>
                                </td>
                                <td class="tdInputC">
                                    <select id="cboPrimaryLightSource" style="width:100%;"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Secondary Light Src. :</label>
                                </td>
                                <td class="tdInputC">
                                    <select id="cboSecondaryLightSource" style="width:100%;"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>End Use:</label>
                                </td>
                                <td class="tdInputC">
                                    <input id="txtEndUse" type="text" style="width:100%;" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>No of Frame:</label>
                                </td>
                                <td class="tdInputC">
                                    <div style="float:left; width:100%">
                                        <div style="float:left; width:30%">
                                            <input id="txtNoOfFrame" class="numberFormat" type="text" style="width:100%;" />
                                        </div>
                                        <div class="fabricWeftColor" style="float:left; width:25%; text-align:right">
                                            <label>Weft Color:</label>
                                        </div>
                                        <div class="fabricWeftColor"  style="float:left; width:45%">
                                            <input id="txtWeftColor" type="text" style="width:100%;" />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Weight:</label>
                                </td>
                                <td class="tdInputC">
                                    <input id="txtWeightDec" style="width:60%" type="text" /> GSM
                                </td>
                            </tr>
                            <tr>
                                <td class="tdLabel">
                                    <label>Note :</label>
                                </td>
                                <td class="tdInputC">
                                    @*<input id="txtNoteFabric" type="text" />*@
                                    <textarea rows="1" id="txtNoteFabric" style="text-align:left; width:99%; height:40px; font-family:Tahoma; font-size:12px" placeholder="Narration"></textarea>
                                </td>
                            </tr>

                            <tr id="trFabricHideShowFields">
                                <td class="tdLabel">
                                    <label class="">Request Date : </label>
                                </td>
                                <td class="tdInput">
                                    <input id="txtRequestDateFabric" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                    <label style="margin-left: 1px;">Sub Date : </label>
                                    <input id="txtSubDateFabric" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                </td>
                            </tr>
                            @*<tr>
                                <td class="tdLabel">
                                    <label>Seeking Date:</label>
                                </td>
                                <td class="tdInputDateBox">

                                    <input id="txtSeekingDateFabric" type="text" style="width: 100px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                </td>
                            </tr>*@
                        </table>
                    </td>
                </tr>
            </table>
        </fieldset>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <table border="0" cellpadding="0" cellspacing="0" style="float:right; width:100%;">
                <tr>
                    <td style="text-align:left">
                        <a id="btnShowHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">History</a>
                    </td>
                    <td>
                        <label id="lblGiveInfo" style="color:#c00;">No Of Copy</label>
                        <input id="txtCopyNo" style="width:2%" placeholder="1" class="number" type="text" />
                        <a id="btnReFabricSubmissionSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCopyFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-copy" plain="true">Copy</a>
                        <a id="btnSaveFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCloseFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>

    <div class="menuMainCollectionTable">
        @*<table id="tblFabrics" title="Fabric List" class="easyui-datagrid" style="width:100%;" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="true" toolbar="#toolbarFabric">*@
        <table id="tblFabrics"  style="width:100%; height:100%" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="true" toolbar="#toolbarFabric" data-options="rowStyler: function(index,row){
                                         if (row.ApprovedBy!=0){
                                            return 'color:#016B18; font-weight:bold;';
                                        }
                                    }
                    ">
            <thead>
                <tr>
                    <th data-options="field:'Selected',checkbox:true"></th>
                    <th field="IssueDateInString" width="10%" align="center">Issue Date</th>
                    @*<th field="FabricNo" width="10%">P Number/Fabric ID</th>*@
                    <th field="FabricNo" width="10%"><label id="lblFabricNo"></label></th>
                    <th field="MKTPersonName" width="15%">Mkt. Person</th>
                    <th field="BuyerName" width="20%">Buyer Name</th>
                    <th field="Construction" width="20%">Construction</th>
                    <th field="ProcessTypeName" width="15%">Process Type</th>
                    <th field="FabricDesignName" width="15%">Fabric Design</th>
                    <th field="FabricWidth" width="15%">Width</th>
                    <th field="StyleNo" width="10%">Style No</th>
                    <th field="FinishTypeName" width="15%">Finish Type</th>
                    <th field="FabricWeaveName" width="15%">Weave</th>
                    <th field="IsWash" width="5%" formatter="FormatIsTrue" align="center">Wash</th>
                    <th field="IsFinish" width="5%" formatter="FormatIsTrue" align="center">Finish</th>
                    <th field="IsDyeing" width="5%" formatter="FormatIsTrue" align="center">Dyeing</th>
                    <th field="IsPrint" width="5%" formatter="FormatIsTrue" align="center">Print</th>
                    <th field="PriorityLevelInString" width="10%">Priority Level</th>
                    <th field="SeekingSubmissionDateInString" width="10%" align="center">Seeking Sub Date</th>
                    <th field="ReceiveDateSt" width="10%" align="center">Receive Date</th>
                    <th field="SubmissionDateSt" width="10%" align="center">Submission Date</th>
                    <th field="ApprovedByNameSt" width="20%">Approved By</th>
                    <th field="PrepareByName" width="20%">Prepare By</th>
                    <th field="AttCount" width="8%">Attachment Count</th>
                    
                </tr>
            </thead>
        </table>
        <div id="toolbarFabric">
            <table>
                <tr>
                    <td>
                        <input type="text" id="txtSearchbyFabricNo" placeholder="Search By P Number" />
                        <input type="text" id="txtSearchByBuyerName" placeholder="Search By Buyer" />
                        <a id="btnAdvSearchFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>
                        <a id="btnAddFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">New</a>
                        <a id="btnEditFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                        <a id="btnViewFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">View</a>
                        <a id="btnDeleteFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                        <a id="btnApproveFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-approved" plain="true">Approve</a>
                        <a id="btnCopy" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-copy" plain="true">Copy</a>
                        <a id="btnReFabricSubmissionFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Re-Fabric Submission</a>
                        @*<a id="btnPreviewFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>*@
                        <a id="btnAttachment" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-attachment" plain="true">Attachment</a>
                      
                        @*<a id="btnPrintDeskLoomFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print Desk Loom</a>*@
                        
                        <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">ExportXL</a>
                        
                        <a id="btnAddFNLabdipDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Lab dip</a>
                        @*<a id="btnFNPlanning" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Planning</a>*@
                        <a id="btnPrintAnalysis" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                        <a id="btnPrintStickerFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Sticker Print</a>
                        <a id="btnFabricHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Fabric History</a>
                        @*<a id="btnPrintFabricOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Fabric Order</a>*@
                     
                        
                        <a id="btnSchedule" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">MKT Summary</a>
                        <a id="btnLabInfo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Analysis Result</a>

                        
                          @*<a id="btnRemoveFromList" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-Reset" plain="true">Remove From List</a>*@
                        @*@using (Html.BeginForm("PrintFabrics", "Fabric", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank", @class = "PrintForm" }))
                        {
                            <input type="text" name="txtFabricCollectionList" id="txtFabricCollectionList" hidden="hidden" />
                            <input type="submit" id="btnPrintFabric" value="   Print List" class="icon-print PrintList" onclick=" return isValidFabric() " />
                        }*@
                    </td>
                </tr>
            </table>
        </div>
    </div>
    
    <div id="winPrintStickerHeader" style="width:300px;" class="easyui-window" title="Contractor" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div id="divPrintStickerHeader" tabindex="-1">
            <fieldset>
                <legend>Set Sticker Header : </legend>
                <label>Sticker Header :</label>
                <input id="txtStickerHeaderFabric" type="text" />
            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <table border="0" cellpadding="2" cellspacing="2">
                    <tr>
                        <td style="width:395px; text-align:left">
                            <a id="btnOkStickerHeaderFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Sticker Print</a>
                        </td>
                        <td style="width:395px"><a id="btnCloseStickerHeaderFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a></td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>
  
    <div id="winAdvSearchFabric" class="easyui-window winstyle" style="width:900px;" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <fieldset style="margin-bottom: 0px;">
            <legend>Searching Criteria</legend>
            <div style="width:48%;float:left;">
                <table class="tblASWrapper" style="width:100%;">
                    <tr>
                        <td style="width:25%;">
                            <label id="lblFabricNoAdv">P Number :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtBuyerReferenceFabricAdvSearch" type="text" style="width:92%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Buyer :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            @*<input id="txtContractorNameAdv" type="text" placeholder="Type & Press Enter" style="width:73%" />
                                <input id="btnClrSearchByBuyerAdvSearch" type="button" value="C" style="width:27px;" />
                                <input id="btnPickSearchByBuyerAdvSearch" type="button" value="P" style="width:27px;" />*@

                            <input id="txtContractorNameAdv" class="reset-text" style="width:72%;" placeholder="Type & Press Enter" />
                            <a id="btnContractorAdv" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnResetContractorAdv" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>

                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Composition :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtCompositionAdvSearch" type="text" style="width:92%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Buyer Ref :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtBuyerReferenceAdvSearch" type="text" style="width:92%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>MKT Person :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            @*<select id="cboMktPersonsAdvSearch" style="width:94%;"></select>*@

                            <input id="txtMktAccountAdv" class="reset-text" style="width:72%;" placeholder="Type & Press Enter" />
                            <a id="btnMktAccountAdv" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnResetMktAccountdv" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                        </td>
                    </tr>

                    <tr>
                        <td style="width:25%;">
                            <label>MKT Group :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtMktGroup" class="reset-text" style="width:72%;" placeholder="Type & Press Enter" />
                            <a id="btnPickMktGroup" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-pick" plain="true"></a>
                            <a id="btnResetMktGroup" href="javascript:void(0)" class="easyui-linkbutton ics-pick" iconcls="icon-clear" plain="true"></a>
                        </td>
                    </tr>

                    <tr>
                        <td style="width:25%;">
                            <label>Finish Type :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <select id="cboFinishTypeAdvSearch" style="width:94%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Process Type :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <select id="cboProcessTypeAdvSearch" style="width:94%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Weave Type :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <select id="cboWeaveTypeAdvSearch" style="width:94%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Fabric Design :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <select id="cboFabricDesignTypeAdvSearch" style="width:94%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;">
                            <label>Construction :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtConstructionAdvSearch" type="text" style="width:92%;" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Color :</label>
                        </td>
                        <td style="width:73%;text-align:left">
                            <input id="txtColorAdvSearch" type="text" style="width:38%;" />
                            <label>Style :</label>
                            <input id="txtStyleAdvSearch" type="text" style="width:39%;" />
                        </td>
                    </tr>
                </table>
            </div>
            <div style="width:48%;margin-right:5px;float:left;">
                <table class="tblASWrapper" style="width:100%;">
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>Issue Date :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkIssueDateAdvSearch" type="checkbox" />
                            @*<select id="cboDateOptionAdvSearch" onchange=" DateActions(); " style="width:33%"></select>*@
                            <input id="txtFromDateIssueDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateIssueDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>LabDip Req :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkLabDipRequestAdvSearch" type="checkbox" />
                            <input id="txtFromDateLabDipRequestAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateLabDipRequestAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>Fab.Pattern :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkFabricPatternAdvSearch" type="checkbox" />
                            <input id="txtFromDateLabFabricPatternAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateFabricPatternAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>Approve Date :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkApproveDateAdvSearch" type="checkbox" />
                            <input id="txtFromDateApproveDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateApproveDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>Receive Date :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkReceiveDateAdvSearch" type="checkbox" />
                            <input id="txtFromDateReceiveDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateReceiveDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td class="advIssDate" style="width:25%;">
                            <label>Sub Date :</label>
                        </td>
                        <td style="width:73%;" class="alignLeft">
                            <input id="chkSubmissionDateAdvSearch" type="checkbox" />
                            <input id="txtFromDateSubmissionDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDateSubmissionDateAdvSearch" type="text" style="width: 120px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;"></td>
                        <td style="text-align:left;width:73%;">
                            <input id="chkYetToLabDipAdvSearch" type="checkbox" style="margin-left:17px;" />
                            <label>Yet to LabDip</label>
                            <input id="chkYetToPatternAdvSearch" type="checkbox" style="margin-left: 11px;" />
                            <label>Yet to Pattern</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:25%;"></td>
                        <td style="text-align:left;width:73%;">
                            <input id="chkApproveAdvSearch" type="checkbox" style="margin-left:17px;" />
                            <label style="display:inline;margin-right:20px;">Approve</label>
                            <input id="chkUnapproveAdvSearch" type="checkbox" style="margin-left: 21px;" />
                            <label>Unapprove</label>
                        </td>
                    </tr>
                </table>
            </div>
        </fieldset>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <label class="lblLoadingMessage" style="float: left;">Loading Please Wait...</label>
            @*<a id="btnOkAdvSearchFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>*@
            <a id="btnResetAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>
            <a id="btnSearchAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
            <a id="btnCloseAdvSearchFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>

    <div id="winFabricHistory" class="easyui-window" title="Fabric Suggestion History" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:true">
        <table id="tblFabricHistory" class="easyui-datagrid" style="width:100%;height:298px;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false">
            <thead>
                <tr>
                    <th field="ModifiedTimeStr" width="12%">Modified Time</th>
                    <th field="ModifiedByName" width="10%">Modified By</th>
                    <th field="FabricNo" width="12%" align="left">PO NO</th>
                    <th field="ProductName" width="12%" align="left">Composition</th>
                    <th field="Construction" width="10%">Construction</th>
                    <th field="ColorInfo" width="10%">Color Info</th>
                    <th field="FabricWidth" width="10%">Fabric Width</th>
                    <th field="WeftColor" width="10%">Weft Color</th>
                    <th field="ActualConstruction" width="12%">Actual Construction</th>
                    <th field="FinishTypeName" width="10%">Finish Type</th>
                    <th field="ProcessTypeName" width="10%">Process Type</th>
                    <th field="CreatedByName" width="10%">Created By</th>
                </tr>
            </thead>
        </table>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnCloseFabricHistory" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>

    <div id="winFNLabdip" class="easyui-window winstyle" title="Labdip" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <fieldset>
            <fieldset>
                <legend>Fabric Info</legend>
                <table border="0"cellpadding="2"cellspacing="2" style="width:100%">
                    <tr>
                        <td style="width:10%; text-align:right">
                            <label>Fabric ID </label>
                        </td>
                        <td style="width:15%; text-align:left">
                            <input id="txtFabricNo_LD" style="float:left;width:100%;" disabled="disabled" />
                        </td>
                        <td style="width:15%; text-align:right">
                            <label>Composition</label>
                        </td>
                        <td style="width:20%;text-align:left">
                            <input id="txtComposition_LD" style="width:100%;" disabled="disabled" />
                        </td>
                        <td style="width:20%;text-align:right">
                            <label>Construction</label>
                        </td>
                        <td style="width:20%;text-align:left">
                            <input id="txtConstruction_LD" style="float:left; width:100%;" disabled="disabled" />
                        </td>
                    </tr>
                   

                </table>
            </fieldset>
            <fieldset>
                <legend>LabDip entry</legend>
                <table style="width:100%">
                    <tr>
                        <td  style="width:10%;text-align:right">
                            <label>Color Name:</label>
                        </td>
                        <td style="width:15%;text-align:left">
                            <input id="txtColorNameLD" class="reset-text" style="width:100%;" placeholder="Type Color Name" />
                        </td>
                        <td style="width:10%;text-align:right">
                            <label>Panton No:</label>

                        </td>
                        <td style="width:15%;text-align:left">
                            <input id="txtPantonNo" class="reset-text" placeholder="Panton No" />
                        </td>
                        <td style="width:10%;text-align:right">
                            <label>Shade Count:</label>
                        </td>
                        <td style="width:5%;text-align:left">
                            @*<input id="txtColorSet" type="number" min="0" pattern="^[0-9]" step="1" class="only-number combo-number" />*@
                            <select style="width: 100%;" id="cboShadeCount">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>
                        </td>
                        <td style="width:10%;text-align:right">
                          
                        </td>
                        <td style="width:5%;text-align:left">
                           
                        </td>
                        <td style=" width:6%;text-align:right">
                            @*<label>No. Ply:</label>*@
                        </td>
                        <td style="width:5%;text-align:left">
                            @*<select style="width: 100%;" id="cboCombo">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>*@
                        </td>

                    </tr>
                    <tr>
                        <td style="width:10%;text-align:right">
                            <label>Ref No:</label>
                        </td>
                        <td style="width:15%;text-align:left">
                            <input id="txtRGB" class="reset-text" style="width:100%;" placeholder="Ref No" />
                        </td>
                        <td style="width:10%;text-align:right">
                            <label>Remarks:</label>

                        </td>
                        <td colspan="6" style="width:15%;text-align:left">
                            <input id="txtNoteLD" style="width:100%;" placeholder="Note" />
                        </td>
                      
                    </tr>
                   
                </table>
            </fieldset>
            <div style="padding-left:2px; padding-right:2px;">
                <table id="tblLabDipDetail" class="easyui-datagrid" style="height:200px; width:100%;" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarLabDip" >
                    <thead>
                        <tr>
                            <th field="IssueDateSt" width="12%" align="center">Date</th>
                            <th field="ColorName" width="15%" align="center">Color Name</th>
                            <th field="PantonNo" width="15%" align="center">Panton No</th>
                            <th field="LabdipNo" width="10%" align="center"><label id="lblColorNoNameTwo">LD No</label></th>
                            <th field="ShadeCount" width="6%" align="center">Shade</th>
                            <th field="RGB" width="10%" align="center">Ref No</th>
                            <th field="Note" width="20%" align="center">Remarks</th>
                            <th field="Status" width="10%" align="left">Status</th>
                            <th field="ShadeStr" width="6%" align="left">Shade(Approve)</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarLabDip">
                    @*<a id="btnAddLabDip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
                    <a id="btnUpdateLabDip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Update</a>
                    <a id="btnEditLabDip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                    <a id="btnRemoveLabDip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove</a>*@
                    <a id="btnReLabDip" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Re-Lab</a>
                    <input id="txtLDNo" type="text" style="width:100px;margin:0 5px 0 5px;" placeholder="Type new LD No" />
                    <a id="btnSaveLDNo" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true"> LD No</a>
                    <a id="btnIssued" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-forword" plain="true">Issued</a>
                    <a id="btnAssignShade" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Assign Shade</a>
                </div>
            </div>
        </fieldset>
        <fieldset >
            <legend>Actions : </legend>
            <table border="0" cellpadding="0" cellspacing="0" style="width:100%;">
                <tr>
                    <td style="text-align:left"></td>
                    <td style ="text-align:right">
                        <a id="btnCloseLD" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
</tr>
            </table>
        </fieldset>
    </div>

    <div id="winPrintFabricOrder" style="width:300px;" class="easyui-window" title="Fabric Order" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div>
            <fieldset>
                <legend>Print Order </legend>

                <div class="col-md-12">
                    <label>Fabric Type:</label>
                    <select id="cboFabricOrder"></select>
                </div>
            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <table border="0" cellpadding="2" cellspacing="2">
                    <tr>
                        <td style="width:395px; text-align:left">
                            <a id="btnOkFabricOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print Order </a>
                        </td>
                        <td style="width:395px"><a id="btnCloseFabricOrder" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a></td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>


    @*Meeting Summary*@
    <div id="winMarketingSummarys" style="width:660px;" class="easyui-window winstyle" title="Marketing Meeting Summary" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div id="OperationsMeetingSummary" style="width:645px;">
            <div>
                <table>
                    <tr>
                        <td style="width:100px;" align="right">
                            <label>MKT Person :</label>
                        </td>
                        <td style="width:190px;">
                            <input id="txtMKTPersonMeetingSummary" style="width:130px" type="text" placeholder="Type and press enter" />
                            <button id="btnCancelMKTPerson" style="width:25px">C</button>
                            <button id="btnPickMKTPerson" style="width:25px">P</button>
                        </td>
                        <td style="width:150px;" align="right">
                            <label>Buyer :</label>
                        </td>
                        <td style="width:190px;">
                            <input id="txtBuyerMeetingSummary" type="text" placeholder="Type and press enter" style="width:190px;" readonly="readonly"/>
                        </td>
                        @*<td style="width:80px;">
                            <a id="btnRefreshMeetingSummary" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                        </td>*@
                    </tr>
                </table>
            </div>
            <div style="border-top:2px;border-top-style:solid">
                <table border="1">
                    <tr>
                        <td colspan="4">
                            <label>Summary Point :</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <textarea id="txtMeetingSummaryText" rows="1" cols="50" style="width:420px;height:50px; font-family:Tahoma;font-size:14px;"></textarea>
                        </td>
                        <td>
                            <table>
                                <tr>
                                    <td>
                                        <select id="cboRefType" style="float:right; width:100%" disabled="disabled"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <input type="text" style="width:100%" id="txtRefID" onkeyup="onKeyDwonPickRefID(event)" placeholder="Please Type Fabric Nunber" readonly="readonly" />
                                        @*<button id="RefIDCancel" onclick="ClearRefID()" style="width:25px">C</button>
                                        <button id="RefIDPick" onclick="PickRefID()" style="width:25px">P</button>*@
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table>
                                <tr>
                                    <td>
                                        <select id="cboCurrency" style="float:right; width:60px" hidden="hidden"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <input type="text" class="number" id="txtPrice" style="width:60px" placeholder="Price" hidden="hidden" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <button id="btnAddMeetingSummary" style="width:60px; height:50px">Add</button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="border-top:2px;border-top-style:solid;">

            <div id="ListMeetingSummary" style="width:645px; height:400px; overflow-y: scroll;">

            </div>

        </div>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnMeetingSummary" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Meeting Summary</a>
            <a id="btnCloseMeetingSummary" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    @*end*@
</body>

<style type="text/css">
    .tdInputChk {
        width: 100%;
    }
    .tdInputChk ul{
        padding: 0;
        margin: 0;
    }
    .tdInputChk ul li{
        display: inline;
        list-style-type: none;
        margin:0 9px 0 0;   
    }
    /*.tdInputChk ul li input{
        margin: 0 2px 0 0;
    }*/
    .tdInput input {
        width: 96%;
    }
    .tdInputC input {
        width: 96%;
    }
    .tdInput select {
        width: 96%;
    }

    #winAdvSearchFabric {
        width: 776px;
    }
    .btnResetSearch input[type="button"] {
        width: 20%;
    }

    #winAdvSearchFabric .actionfieldsetstyle {
        margin: 0 5px 2px 5px;
    }

    #winFabricAttachment {
        width: 800px;
    }
    .tblASWrapper td {
        text-align:right;
    }
    .advIssDate {
        text-align:right;
    }
    .alignLeft {
        text-align:left !important;
    }
    .lblStar {
        color: red;
        font-weight: bold;
    }
</style>

<script type="text/javascript">
    var _sBaseAddress = "";
    var _oFabric = null;
    var _oFabrics = [];
    var _oFabricSticker=null;
    var _oFinishTypes = [];
    var _oCompareOperators = [];
    var _oMktPersons = [];
    var _oPriorityLevels = [];
    var _oSwatchTypes = [];
    var _oProcessTypes=[];
    var _oFabricWeaves=[];
    var _oFabricDesigns=[];
    var _oLightSources=[];
    var _oFabricOrders=[];
    var _oPrintFabricOrders=[];
    var _nCurrentUserID=0;
    var _nBUID = 0;
    var _nSelectedRowIndex = -1;
    var _oProducts=[];
    var _oFabricOrderSetups=[];
    var _oBaseMKTPerson = 0;
    var _nMKTPersonID = 0;
    var _nMarketingScheduleID = 0;
    var _sLocationTime = "";
    var _oMeetingSummarys = [];

    $(document).ready(function() {
        _sBaseAddress = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oFabrics = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _oFinishTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FinishTypes));
        _oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
        _oMktPersons = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MktPersons));
        _oPriorityLevels = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.PriorityLevels));
        _oSwatchTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.SwatchTypes));
        _oProcessTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ProcessTypes));
        _oFabricWeaves = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricWeaves));
        _oFabricDesigns = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricDesigns));
        _oLightSources = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.LightSources));
        _nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        _nCurrentUserID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CurrentUserID));
        var oFabricPOSetup = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricPOSetup));
        _oFabricOrders= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricOrderSetup));
        _oProducts= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Products));
        _oFabricOrderSetups= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FabricOrderSetups));
        var _oCurrencys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.Currencys));
        var _oRefTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.RefTypes));

        sessionStorage.setItem("BUID", _nBUID);
        var nIndex=-1;

        if(sessionStorage.getItem("Fabrics")!=null && sessionStorage.getItem("Fabrics").length>0)
        {
            _oFabrics= jQuery.parseJSON(sessionStorage.getItem('Fabrics'));
            nIndex= sessionStorage.getItem('SelectedRowIndex');
        }
        DynamicRefreshListForMultipleSelection(_oFabrics, "tblFabrics");
        if(nIndex>-1)
        {
            $('#tblFabrics').datagrid('selectRow',nIndex);
        }
        InitializeFabricEvents();
        InitializeFabricsEvents();
        InitializeAdvSearchFabricEvents();
        InitializeFNLabdipDetailEvents();
        RefreshSetup(oFabricPOSetup);
        $("#cboCurrency").icsLoadCombo({List: _oCurrencys,OptionValue: "CurrencyID",DisplayText: "Symbol",InitialValue : "Currency",});
        $("#cboRefType").icsLoadCombo({List: _oRefTypes,OptionValue: "id",DisplayText: "Value",InitialValue : "Ref Type",});
        $('#cboRefType').val(1);     // for selection Fabric ID
        //$('#cboCurrency').val(2);     // for selecting the doller
    });


    function RefreshSetup(oFabricPOSetup)
    {
        $('#lblFabricNoTwo,#lblFabricNo,#lblFabricNoAdv').html(oFabricPOSetup.FabricCode);
        $("#txtSearchbyFabricNo").attr("placeholder","Search by "+oFabricPOSetup.NoCode+" No");
        $("#txtP").attr("placeholder",oFabricPOSetup.NoCode);
        $('#lblHLRefNo').html("Lab Ref No:");
        if(oFabricPOSetup.IsLDApply==false)
        {
            $('#lblHLRefNo').html("H/L No:");
            $('#btnAddFNLabdipDetail,#btnPrintFabricOrder').hide();
        }

    }

    $("#btnPrintFabricOrder").click(function ()
    {
        var oFabrics = $("#tblFabrics").datagrid("getChecked");
        if (oFabrics == null || oFabrics.length == 0) {
            alert("Please Select At Least One Item And Try Again.");
            return false;
        }
        debugger;
        var BuyerID = oFabrics[0].BuyerID;
        for (var i = 1; i < oFabrics.length; i++) { console.log(BuyerID+'---'+oFabrics[i].BuyerID);
            if(oFabrics[i].BuyerID!=BuyerID)
            {
                alert("Please Select Items For Same Buyer.");
                return false;
            }
        }
        var nFabricOrderTypeInt = oFabrics[0].FabricOrderTypeInt;
        for (var i = 1; i < oFabrics.length; i++) {
            if(parseInt(oFabrics[i].FabricOrderTypeInt)!=parseInt(nFabricOrderTypeInt))
            {
                alert("Please Select Items For Same Buyer.");
                return false;
            }
        }

        _oPrintFabricOrders=oFabrics;
        $("#cboFabricOrder").icsLoadCombo({
            List: _oFabricOrders,
            OptionValue: "FabricOrderSetupID",
            DisplayText: "OrderName"
        });

        $("#cboFabricOrder").val(0);
        $("#cboFabricOrder").focus();
        $("#winPrintFabricOrder").icsWindow("open", "Fabric Order");
        $("#winPrintFabricOrder").focus();
    });

    $("#btnCloseFabricOrder").click(function () {
        $("#winPrintFabricOrder").icsWindow("close");
    });

    $("#btnOkFabricOrder").click(function () {
        FabricOrderPrint();
    });

    function FabricOrderPrint() {
        debugger;
        if ($("#cboFabricOrder").val() <= 0)
        {
            $("#cboFabricOrder").focus();
            $("#cboFabricOrder").addClass("errorFieldBorder");
            alert("Please Select Fabric Order");
            return false;
        } else
        {
            $("#cboFabricOrder").removeClass("errorFieldBorder");
        }

        $("#winPrintFabricOrder").icsWindow("close");

        var sIds = "";
        for (var i = 0; i < _oPrintFabricOrders.length; i++) {
            sIds = _oPrintFabricOrders[i].FabricID + "," + sIds;
        }
        sIds = sIds.substring(0, sIds.length - 1);

        var nts = ((new Date()).getTime()) / 1000;
        window.open(_sBaseAddress + '/Fabric/PrintFabricOrder?sParams=' + sIds +"&FOType="+$("#cboFabricOrder").val()+ "&nts=" + nts, "_blank");
    }

    function updateProgress() {
        var value =$('#progressbar').progressbar('getValue');
        if (value < 96){
            value += Math.floor(Math.random() * 10);
            $('#progressbar').progressbar('setValue', value);
        }
    }

    function hideShow(miliseconds) {
        $("#progressbarParent").hide();
    }

    $(document).keydown(function (e) { if (e.keyCode === 27) { $("div").icsWindow("close")}});

    function FormatIsTrue(value) {
        if (value) {
            var s = '<img src="@Url.Content("~/Content/CSS/icons/ok.png")"  style="width:15px;height:18px;"/>';
            return s;
        } else {
            return "";
        }
    }
    $('.only-number').keydown(function (e) {

        if ((e.which >= 48 && e.which <= 57) || (e.which >= 96 && e.which <= 105)|| e.which==9 || e.which==38 || e.which==40 || e.which==8 || e.which==37 || e.which==39 || e.which==46) {
            return true;
        }
        else {
            return false
        }
    });
    function isValidFabric()
    {
        _oFabrics = $("#tblFabrics").datagrid("getRows");
        if (_oFabrics.length <= 0) {
            alert("Empty List");
            return false;
        }
        else
        {
            var sFabricIDs="";
            for(var i=0;i<_oFabrics.length;i++)
            {
                sFabricIDs = _oFabrics[i].FabricID + "," + sFabricIDs;
            }
            sFabricIDs = sFabricIDs.substring(0, sFabricIDs.length - 1);
            $("#txtFabricCollectionList").val(sFabricIDs);
        }
    }


    //Fabric History

    $('#btnFabricHistory, #btnShowHistory').click(function(e){

        var row = $('#tblFabrics').datagrid('getSelected');

        if(row==null || row.FabricID<=0){
            alert("Select an item from list");
            return false;
        }

        $.ajax({
            type: "POST",
            url: _sBaseAddress + "/Fabric/GetsFabricHistory",
            traditional: true,
            data: JSON.stringify({FabricID:row.FabricID}),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                var results = jQuery.parseJSON(data);
                if(results!=null  && results.any())
                {
                    $("#winFabricHistory").icsWindow("open");
                    DynamicRefreshList(results,'tblFabricHistory');
                }
            }
        });



    });
  
    $('#btnCloseFabricHistory').click(function(e){
        $('#winFabricHistory').icsWindow('close');
    });

    $("#btnPrintAnalysis").click(function () {

        var oFabric= $('#tblFabrics').datagrid('getSelected');
        if(oFabric==null || oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
        window.open(_sBaseAddress + '/Fabric/PrintFabricAnalysis?nFabricID=' + oFabric.FabricID+"&buid="+_nBUID, "_blank");
    });
    $("#btnMeetingSummary").click(function () {

        var oFabric= $('#tblFabrics').datagrid('getSelected');
        if(oFabric==null || oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
        window.open(_sBaseAddress + '/Fabric/MeetingSummaryPrint?nFabricID=' + oFabric.FabricID +"&nRefType=1&buid="+_nBUID, "_blank");
    });
    $('#btnSchedule').click(function(){
        var oFabric= $('#tblFabrics').datagrid('getSelected');
        if(oFabric==null || oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
        _oFabric = oFabric;
        _nMKTPersonID = oFabric.MKTPersonID;
        $('#winMarketingSummarys').icsWindow('open');
        RefreshMeetingpicker(oFabric);
        GetMeetingSummaryList(oFabric);
        //GetSchedule(oFabric);
        
    });
    function GetSchedule(oFabric)
    {
        var oMeetingSummary = {
            ErrorMessage : oFabric.FabricID + '~' + _nMKTPersonID + '~' + oFabric.BuyerID
        }
        $.ajax({
            type: "POST",
            url: _sBaseAddress + "/MeetingSummary/GetScheduleByFabricID",
            traditional: true,
            data: JSON.stringify(oMeetingSummary),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                var oList = jQuery.parseJSON(data);
                _nMarketingScheduleID = oList.MarketingScheduleID;
                $('#txtRefID').val(oFabric.FabricNo);
                _sLocationTime = oList.MeetingLocationAndTime;

                GetMeetingSummaryList(oFabric);
            }
        });

    }
    function GetMeetingSummaryList(oFabric) {
        debugger;
        var oMeetingSummary = {
            //RefID : oFabric.FabricID,
            RefID : oFabric.FabricID,
            RefType : 1
        }
        $.ajax({
            type: "POST",
            url: _sBaseAddress + "/MeetingSummary/GetsMeetingSummaryByFabricID",
            traditional: true,
            data: JSON.stringify(oMeetingSummary),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                var oList = jQuery.parseJSON(data);
                _oMeetingSummarys = oList;
                RefreshMeetingSummaryList(oList);
            }
        });
    }
    $('#btnCloseMeetingSummary').click(function(){
        $('#winMarketingSummarys').icsWindow('close');
        $("#txtMeetingSummaryText").val("");
    });
    function RefreshMeetingSummaryList(oMeetingSummarys)
    {
        debugger;
        $('#ListMeetingSummary').empty();
        if (oMeetingSummarys.length <= 0) { return; }

        for (var i = 0; i < oMeetingSummarys.length; i++) {

            var sMKTPersonName = '';
            var sText = '';
            var sDateTime = "  Date: (" + oMeetingSummarys[i].DBServerDateTimeInString + ")   ";

            sMKTPersonName = oMeetingSummarys[i].MeetingSummarizeByName + ' :';
            var summ = oMeetingSummarys[i].MeetingSummaryText;
            if ($.trim(summ).length > 150) {
                sText = sText + summ.substring(0, 146) + '....<b class="easyui-tooltip" title="'+oMeetingSummarys[i].MeetingSummaryText+'">more</b>';
            }
            else {
                sText = sText + summ;
            }

            var string1 = "";
            var string2 = "";

            if ($('#cboRefType').val > 0 && $('#txtRefID').val != "")
            {
                string1 = 'Ref Type' + $("#cboRefType :selected").text() + ', RefID ' + $('#txtRefID').val();
            }
            if ($('#cboCurrency').val() > 0 && $('#txtPrice').val() == "")
            {
                string2 = 'Price :' + $('#txtPrice').val() + ' '+ $("#cboCurrency :selected").text();
            }


            var sSummaryDiv = '<div class="meetingsummary">'
                + '<p><b style="text-decoration:underline;">' + sMKTPersonName + '</b><button type="button" style="float:right" class="btn btn-danger btn-sm" aria-label=" left align" onclick="RemoveSummary('+oMeetingSummarys[i].MeetingSummaryID+')"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button><label style="float:right">'+sDateTime+'</label></p>'
                + '<p>' + sText + '</p>'
                + '<p>' + string1 + '</p>'
                + '<p>' + string2 + '</p>'
                //+ '<p><b>' + _sLocationTime + '</b> <input type="button" style="background-color:red; color:white" value="Delete Summary" /></p>'
                + '<p><b>' + _sLocationTime + '</b> </p>'

                //+ '<p><input type="button" value="Add"/></p>'
                + '</div>';

            $('#ListMeetingSummary').append(sSummaryDiv);
        }
    }
    function RefreshMeetingpicker(oFabric)
    {
        $('#txtBuyerMeetingSummary').val(oFabric.BuyerName);
        $('#txtMKTPersonMeetingSummary').val(oFabric.MKTPersonName);
        //_nMKTPersonID = oFabric.MKTPersonID;
        $('#txtRefID').val(oFabric.FabricNo);
        $('#txtPrice').val("");

    }
    $("#btnFNPlanning").click(function () {

        var oFabric= $('#tblFabrics').datagrid('getSelected');
        if(oFabric==null || oFabric.FabricID<=0){
            alert("Please select an item from list.");
            return false;
        }
        window.open(_sBaseAddress + '/Fabric/ViewFabricPlanning?id=' + oFabric.FabricID, "_blank");
    });
    function GetMktPersons_Base(sName) {

        var oMarketingAccount_BU = {
            Name: sName,
            BUID: _nBUID
        };
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oMarketingAccount_BU,
            ControllerName: "MarketingAccount",
            ActionName: "MarketingAccountSearchByName",
            IsWinClose: false
        };
        $("#progressbar").progressbar({ value: 0 });
        $("#progressbarParent").show();
        var intervalID = setInterval(updateProgress, 250);
        $.icsDataGets(obj, function (response) {
            clearInterval(intervalID);
            $("#progressbarParent").hide();
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].MarketingAccountID > 0) {
                    debugger;
                    var tblColums = [];
                    var oColumn = { field: "MarketingAccountID", title: "Code", width: 50, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Name", title: "Name", width: 180, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "GroupName", title: "Group Name", width: 120, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Phone", title: "Phone", width: 100, align: "left" }; tblColums.push(oColumn);

                    var oPickerParam = {
                        winid: 'winMktAccount_Base',
                        winclass: 'clsMktPersonPicker',
                        winwidth: 460,
                        winheight: 460,
                        tableid: 'tblMktPersonPicker',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'MKT Person List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbuttonMarketing(oPickerParam);//multiplereturn, winclassName
                }
                else { alert(response.objs[0].ErrorMessage); }
            }
            else {
                alert("No marketing person found.");
            }
        });


    }
    $("#btnPickMKTPerson").click(function () {
        debugger;
        var sName = $.trim($("#txtMKTPersonMeetingSummary").val());
        GetMktPersons_Base(sName);
    });
    $("#txtMKTPersonMeetingSummary").keydown(function (e) {
        var nkeyCode = e.keyCode || e.which;
        if (nkeyCode == 13) {
            var sName = $.trim($("#txtMKTPersonMeetingSummary").val());
            //if($('#txtMKTPerson').val()==null || $('#txtMKTPerson').val()=="")
            //{
            //    alert("Please Type Name or part Name and Press Enter.");
            //    $('#txtMKTPerson').focus();
            //    return;
            //}
            GetMktPersons_Base(sName);
        }
        else if (nkeyCode == 8) {
            $("#txtMKTPersonMeetingSummary").val("");
            _nMKTPersonID = 0;
        }
    });
    $("#btnCancelMKTPerson").click(function () {
        _oBaseMKTPerson = { MarketingAccountID: 0 };
        $("#txtMKTPersonMeetingSummary").val('');
        $("#btnPickMKTPerson").removeClass("fontColorOfPickItem");
        _nMKTPersonID = 0;

    });
    function IntializePickerbuttonMarketing(oPickerobj) {
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            SetPickerValueAssignMarketing(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which === 13) {
                SetPickerValueAssignMarketing(oPickerobj);
            }
        });
    }
    function SetPickerValueAssignMarketing(oPickerobj) {
        var oreturnObj = null, oreturnObjs = [];
        if (oPickerobj.multiplereturn) {
            oreturnObjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
        }
        if (oPickerobj.winid == 'winMktAccount_Base') {
            debugger;

            if (oreturnObj != null && parseInt(oreturnObj.MarketingAccountID) > 0) {
                var txtMKTPersonMeetingSummary = document.getElementById("txtMKTPersonMeetingSummary");
                txtMKTPersonMeetingSummary.style.color = "blue";
                txtMKTPersonMeetingSummary.style.fontWeight = "bold";
                $('#txtMKTPersonMeetingSummary').val(oreturnObj.Name);
                _nMKTPersonID = oreturnObj.MarketingAccountID;
            }
            else {
                alert("Data Not Found.");
            }
        }

        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();
    }
    $("#btnAddMeetingSummary").click(function () {
        debugger;

        if (!ValidateInputMeetingSummary()) return;
        var oMeetingSummary = RefreshObjectMeetingSummary();

        var defaultSettings = {
            BaseAddress: _sBaseAddress,
            Object: oMeetingSummary,
            ObjectId: 0,
            ControllerName: "MeetingSummary",
            ActionName: "SaveFromFabric",
            TableId: "tblMeetingSummarys",
            IsWinClose: false
        };
        $.ajax({
            type: "POST",
            dataType: "json",
            url: defaultSettings.BaseAddress + "/" + defaultSettings.ControllerName + "/" + defaultSettings.ActionName,
            traditional: true,
            data: JSON.stringify(defaultSettings.Object),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                var obj = jQuery.parseJSON(data);
                if (obj != null) {
                    if (obj.ErrorMessage!="" || obj.ErrorMessage!=null) {
                        alert("Save Successfully.");

                        debugger;

                        var oMeetingSummarys = [];
                        oMeetingSummarys.push(obj);
                        if (_oMeetingSummarys.length > 0) {
                            for (var i = 0; i < _oMeetingSummarys.length; i++) {
                                oMeetingSummarys.push(_oMeetingSummarys[i]);
                            }
                        }
                        _oMeetingSummarys = [];
                        _oMeetingSummarys = oMeetingSummarys;
                        RefreshListMeetingSummarys(_oMeetingSummarys);
                        $('#txtMeetingSummaryText').val('');
                        $('#txtPrice').val("");
                        $('#cboCurrency').val(0);
                        ClearRefID();

                    }
                    else { alert(obj.ErrorMessage); }
                }
                else { alert("Operation Unsuccessful."); }
                if (defaultSettings.IsWinClose) { IcsWindowClose(oActiveWindows); };

            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });

    });
    function ValidateInputMeetingSummary() {

        debugger;
        if (!$.trim($("#txtMeetingSummaryText").val()).length)
        {
            alert("Please enter Summary Point!");
            $('#txtMeetingSummaryText').val("");
            $('#txtMeetingSummaryText').focus();
            $('#txtMeetingSummaryText').css("border", "1px solid #c00");
            return false;
        } else {
            $('#txtMeetingSummaryText').css("border", "");
        }
        if ($('#cboCurrency').val() > 0 && $('#txtPrice').val() == "") {
            alert("Please Enter The Price");
            $('#txtPrice').focus();
            return false;
        }
        if ($('#cboCurrency').val() == 0 && $('#txtPrice').val() != "") {
            alert("Please Select the Currency");
            $('#cboCurrency').focus();
            return false;
        }
        return true;
    }
    function RefreshObjectMeetingSummary() {
        //var nMeetingSummaryId = (_oMeetingSummary == null ? 0 : (_oMeetingSummary.MeetingSummaryID == null) ? 0 : _oMeetingSummary.MeetingSummaryID);
        debugger;
        var s1 = "";
        var s2 = "";
        if ($('#cboRefType').val() > 0)
        {
            s1 = ',  ' + $("#cboRefType :selected").text() + ' : ' + $('#txtRefID').val();
        }
        if ($('#cboCurrency').val() > 0 && $('#cboRefType').val() == 0)
        {
            alert("Please Select Fabric First");
            $('#cboRefType').focus();
            return;
        }
        if ($('#cboCurrency').val() > 0 && $('#cboRefType').val() > 0) {
            s2 = ',  ' + $("#cboCurrency :selected").text() + ' ' + $('#txtPrice').val();
        }
        if(_nMKTPersonID==0)
        {
            alert("Please Select Any Marketing Person !!");
            return false;
        }
        var oMeetingSummary = {
            MeetingSummaryID: 0,
            MarketingScheduleID: _nMarketingScheduleID,
            MeetingSummarizeBy: _nCurrentUserID,
            RefID: _oFabric.FabricID,
            RefType: $('#cboRefType').val(),
            CurrencyID: $('#cboCurrency').val(),
            Price: $('#txtPrice').val(),
            ErrorMessage : _nMKTPersonID + '~' + _oFabric.BuyerID,
            MeetingSummaryText: $.trim($("#txtMeetingSummaryText").val()) +s1 + s2
        };
        return oMeetingSummary;
    }

    function RefreshListMeetingSummarys(oMeetingSummarys)
    {
        debugger;
        $('#ListMeetingSummary').empty();
        if (oMeetingSummarys.length <= 0) { return; }
    
        for (var i = 0; i < oMeetingSummarys.length; i++) {
        
            var sMKTPersonName = '';
            var sText = '';
            var sLocationTime = '';
            var sDateTime = "  Date: (" + oMeetingSummarys[i].DBServerDateTimeInString + ")   ";

            sMKTPersonName = oMeetingSummarys[i].MeetingSummarizeByName + ' :';
            var summ = oMeetingSummarys[i].MeetingSummaryText;
            if ($.trim(summ).length > 150) {
                sText = sText + summ.substring(0, 146) + '....<b class="easyui-tooltip" title="'+oMeetingSummarys[i].MeetingSummaryText+'">more</b>';
            }
            else {
                sText = sText + summ;
            }
            @*var loc = _oMarketingSchedule.MeetingLocation;
            if ($.trim(loc).length > 15) {
                sLocationTime = sLocationTime + loc.substring(0, 11) + '....@' + oMeetingSummarys[i].DBServerDateTimeInString;
            }
            else {
                sLocationTime = sLocationTime + loc + '@' + oMeetingSummarys[i].DBServerDateTimeInString;
            }*@
            var string1 = "";
            var string2 = "";

            if ($('#cboRefType').val > 0 && $('#txtRefID').val != "")
            {
                string1 = 'Ref Type' + $("#cboRefType :selected").text() + ', RefID ' + $('#txtRefID').val();
            }
            if ($('#cboCurrency').val() > 0 && $('#txtPrice').val() == "")
            {
                string2 = 'Price :' + $('#txtPrice').val() + ' '+ $("#cboCurrency :selected").text();
            }
            var sSummaryDiv = '<div class="meetingsummary">'
                + '<p><b style="text-decoration:underline;">' + sMKTPersonName + '</b><button type="button" style="float:right" class="btn btn-danger btn-sm" aria-label=" left align" onclick="RemoveSummary('+oMeetingSummarys[i].MeetingSummaryID+')"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button><label style="float:right">'+sDateTime+'</label></p>'
                + '<p>' + sText + '</p>'
                + '<p>' + string1 + '</p>'
                + '<p>' + string2 + '</p>'
                //+ '<p><b>' + sLocationTime + '</b></p>'
                + '</div>';

            $('#ListMeetingSummary').append(sSummaryDiv);
        }
    }
    $("#btnLabInfo").click(function () {
        var oFabric = $("#tblFabrics").datagrid("getSelected");
        if (oFabric == null || parseInt(oFabric.FabricID) <= 0) { alert("Please select an item from list!"); return; }
        var oFabrics= $('#tblFabrics').datagrid('getRows');
        sessionStorage.setItem("Operation", "Edit");
        sessionStorage.setItem("Fabrics", JSON.stringify(oFabrics));
        var SelectedRowIndex=$('#tblFabrics').datagrid('getRowIndex',oFabric);
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        sessionStorage.setItem("FabricHeader", "Edit Export L/C");
        sessionStorage.setItem("BUID", _nBUID);
        sessionStorage.setItem("BackLink", window.location.href);
        window.location.href = _sBaseAddress+ "/Fabric/ViewFabric?id="+parseInt(oFabric.FabricID)+"&buid="+_nBUID;
       

    });
    function RemoveSummary(nId)
    {
        debugger;
        var oMeetingSummary = {
            MeetingSummaryID:nId
        }
        if (!confirm("Confirm to Delete?")) return ;
        $.ajax({
            type: "POST",
            url: _sBaseAddress + "/MeetingSummary/DeleteMeetingSummaryByID",
            traditional: true,
            data: JSON.stringify(oMeetingSummary),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                debugger;
                var obj = jQuery.parseJSON(data);
                if(obj.ErrorMessage=="Deleted")
                {
                    alert("Delete Successfully");
                    var tempMeetingSummarys = _oMeetingSummarys;
                    _oMeetingSummarys = [];
                    for(var i=0; i<tempMeetingSummarys.length; i++)
                    {
                        if(tempMeetingSummarys[i].MeetingSummaryID!=nId)
                        {
                            _oMeetingSummarys.push(tempMeetingSummarys[i]);
                        }
                    }
                    RefreshMeetingSummaryList([]);
                    RefreshMeetingSummaryList(_oMeetingSummarys);
                }
                else
                {
                    alert(obj.ErrorMessage);
                }
                
            }
        });
    }

</script>