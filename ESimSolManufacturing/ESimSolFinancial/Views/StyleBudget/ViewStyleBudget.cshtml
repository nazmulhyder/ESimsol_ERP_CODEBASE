<html>
@{
    if (ViewBag.StyleBudgetType == 1)
    {
        ViewBag.Title = "Pre Budget";
    }
    else
    {
        ViewBag.Title = "Post Budget";
    }
}
<body>

    @model ESimSol.BusinessObjects.StyleBudget
    <div class="menuMainCollectionTable" id="divCS">
        <div id="tabStyleBudget" class="easyui-tabs" style="height:90%;">
            <div id="divStyleBudgetInfo" title="Budget Info" style="font-size:12px;padding:0px;font-style:normal;height:100%;">
                <div style="overflow-y:auto;height:470px;width:100%;padding:0px;">
                    <fieldset style="width:100%;">
                        <legend>Sheet Info :</legend>
                        <table border="0" cellpadding="2" cellspacing="2" style="width:100%">
                            <tr>
                                <td style="width:12%;text-align:right;"><a id="btnPickStyle" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="false" onclick="PickStyle()">Pick</a></td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtStyleNo" placeholder="Type Style Name & Press Enter" /> </td>
                                <td style="width:13%;text-align:right;">Budget Title:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtBudgetTitle" /> </td>
                                <td style="width:12%;text-align:right;">Costing Date:</td>
                                <td style="width:21%"><input id="txtCostingDateInString" type="text" class="easyui-datebox" style="width:250px;" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                            </tr>
                            <tr>
                                <td style="width:12%;text-align:right;">Buyer Name:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtBuyerName" disabled /> </td>
                                <td style="width:13%;text-align:right;">Qty(Approx):</td>
                                <td style="width:21%">
                                    <table border="0" cellpadding="0" cellspacing="0" style="width:100%;">
                                        <tr>
                                            <td style="width:50%"><input type="text" style="width:100%;" id="txtApproxQty" /> </td>
                                            <td style="width:50%"><select id="cboCountUnit" style="width:100%;height:23px;"></select> </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="width:12%;text-align:right;">Shipment Date:</td>
                                <td style="width:21%"><input id="txtShipmentDateInString" type="text" class="easyui-datebox" style="width:250px;" data-options="formatter:icsdateformat,parser:icsdateparser" /></td>
                            </tr>
                            <tr>
                                <td style="width:12%;text-align:right;">Knitting:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtKnittingPatternName" disabled /> </td>
                                <td style="width:13%;text-align:right;">Style Description:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtStyleDescription" /> </td>
                                <td style="width:12%;text-align:right;">GG:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtGG" /> </td>
                            </tr>
                            <tr>
                                <td style="width:12%;text-align:right;">Size Range:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtSizeRange" disabled /> </td>
                                <td style="width:13%;text-align:right;">Color Range:</td>
                                <td colspan="3" style="width:54%"><input type="text" style="width:100%;" id="txtColorRange" disabled /> </td>
                            </tr>
                            <tr>
                                <td style="width:12%;text-align:right;">Merchandiser:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtMerchandiserName" placeholder="Type Merchandiser Name & Press Enter" /> </td>
                                <td style="width:13%;text-align:right;">Fabric Description:</td>
                                <td style="width:21%"><input type="text" style="width:100%;" id="txtFabricDescription" /> </td>
                                <td style="width:12%;text-align:right;">Cost Currency:</td>
                                <td style="width:21%"><select id="cboCostCurrency" style="width:100%;height:23px;"></select>  </td>
                            </tr>
                        </table>
                    </fieldset>
                    <table id="tblFabric" title="Fabric Details" class="easyui-datagrid" style="height:230px; width:100%;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" showfooter="true" autorowheight="false" toolbar="#toolbarFabric" data-options="onClickRow: onClickRowYarnDetail">
                        <thead>
                            <tr>
                                <th field="ProductCode" width="10%" align="left">Code</th>
                                <th field="ProductName" width="15%" align="left">Fabric Name</th>
                                <th width="7%" align="left" field="Description">Description</th>
                                <th width="5%" align="center" field="Sequence">Seq.</th>
                                <th width="5%" align="left" field="Width">Width</th>
                                <th width="5%" align="left" field="UnitName">Unit</th>

                                @*<th width="10%" align="right" data-options="field:'MaterialMarketPrice',editor:{type:'numberbox',options:{precision:4}}">Yarn</th>
                                <th width="6%" align="right" data-options="field:'KnittingCost',editor:{type:'numberbox',options:{precision:4}}">Knitting</th>
                                <th width="6%" align="right" data-options="field:'DyeingCost',editor:{type:'numberbox',options:{precision:4}}">Dyeing</th>
                                <th width="6%" align="right" data-options="field:'LycraCost',editor:{type:'numberbox',options:{precision:4}}">Lycra</th>
                                <th width="6%" align="right" data-options="field:'AOPCost',editor:{type:'numberbox',options:{precision:4}}">AOP</th>
                                <th width="6%" align="right" data-options="field:'WashCost',editor:{type:'numberbox',options:{precision:4}}">Wash</th>
                                <th width="6%" align="right" data-options="field:'YarnDyeingCost',editor:{type:'numberbox',options:{precision:4}}">Y/D</th>
                                <th width="6%" align="right" data-options="field:'SuedeCost',editor:{type:'numberbox',options:{precision:4}}">Sueded</th>
                                <th width="6%" align="right" data-options="field:'FinishingCost',editor:{type:'numberbox',options:{precision:4}}">Finish</th>
                                <th width="6%" align="right" data-options="field:'BrushingCost',editor:{type:'numberbox',options:{precision:4}}">Brash</th>
                                <th width="6%" align="right" data-options="field:'FabricCost',editor:{type:'numberbox',options:{precision:4}}">Fabric Cost</th>
                                <th width="8%" align="right" data-options="field:'Consumption',editor:{type:'numberbox',options:{precision:4}}">Con/Dz</th>*@

                                <th width="10%" align="right" data-options="field:'MaterialMarketPrice'" formatter="formatPrice4digit">Yarn</th>
                                <th width="6%" align="right" data-options="field:'KnittingCost'" formatter="formatPrice4digit">Knitting</th>
                                <th width="6%" align="right" data-options="field:'DyeingCost'" formatter="formatPrice4digit">Dyeing</th>
                                <th width="6%" align="right" data-options="field:'LycraCost'" formatter="formatPrice4digit">Lycra</th>
                                <th width="6%" align="right" data-options="field:'AOPCost'" formatter="formatPrice4digit">AOP</th>
                                <th width="6%" align="right" data-options="field:'WashCost'" formatter="formatPrice4digit">Wash</th>
                                <th width="6%" align="right" data-options="field:'YarnDyeingCost'" formatter="formatPrice4digit">Y/D</th>
                                <th width="6%" align="right" data-options="field:'SuedeCost'" formatter="formatPrice4digit">Sueded</th>
                                <th width="6%" align="right" data-options="field:'FinishingCost'" formatter="formatPrice4digit">Finish</th>
                                <th width="6%" align="right" data-options="field:'BrushingCost'" formatter="formatPrice4digit">Brash</th>
                                <th width="6%" align="right" data-options="field:'FabricCost'" formatter="formatPrice4digit">Fabric Cost</th>
                                <th width="8%" align="right" data-options="field:'Consumption',editor:{type:'numberbox',options:{precision:4}}">Con/Dz</th>

                                <th field="ConsumptionPerPc" width="8%" align="right" formatter="formatPrice4digit">Con/Pc</th>
                                <th field="CostPerPcs" width="8%" align="right" formatter="formatPrice4digit">Cost/Pc</th>
                                <th field="EstimatedCost" width="8%" align="right" formatter="formatPrice4digit">Cost/Dz</th>
                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarFabric">
                        Fabric:<input type="text" id="txtFabricName" style="width:150px;" placeholder="Type Fabric Name & press Enter" />
                        <select style="width:120px;" id="cboYarnUnit"></select>
                        <a id="btnAddYarnORFabric" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="AddYarnORFabric()">Add</a>
                        <a id="btnRemoveYarn" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="false" onclick="RemoveYarn()">Remove</a>
                        <a id="btnYarnUp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-up" plain="false" onclick="YarnUP()">UP</a>
                        <a id="btnYarnDown" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-down" plain="false" onclick="YarnDown()">Down</a>
                        <a id="btnRefreshYarnDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false" onclick="RefreshYarnDetail()">Refresh</a>
                    </div>

                    <table id="tblAccessories" title="Accessories Details" class="easyui-datagrid" style="height:400px; width:100%;" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarAccessories" data-options="onClickRow: onClickRowAccessoriesDetail">
                        <thead>
                            <tr>
                                <th field="ProductCode" width="7%" align="left">Code</th>
                                <th field="ProductName" width="15%" align="left">Accssories Name</th>
                                <th width="6%" align="left" field="Description">Description</th>
                                <th width="5%" align="left" field="Sequence">Seq.</th>
                                <th width="5%" align="left" field="UnitName">Unit</th>
                                
                                @*<th width="6%" align="right" data-options="field:'RateUnit',editor:{type:'numberbox',options:{precision:0}}">Rate Unit</th>
                                <th width="6%" align="right" data-options="field:'MaterialMarketPrice',editor:{type:'numberbox',options:{precision:6}}">Price</th>*@
                                
                                <th width="6%" align="right" data-options="field:'RateUnit'">Rate Unit</th>
                                <th width="6%" align="right" data-options="field:'MaterialMarketPrice'" formatter="formatPrice6digit">Price</th>

                                <th width="6%" align="right" data-options="field:'Consumption',editor:{type:'numberbox',options:{precision:6}}">Con/Dz</th>
                                <th width="6%" align="right" field="CostPerDzn" formatter="formatPrice6digit">Cost/Dz</th>
                                <th width="6%" align="right" field="CostPerPcs" formatter="formatPrice6digit">Cost/Pcs</th>
                                <th width="6%" align="right" data-options="field:'UsePercentage',editor:{type:'numberbox',options:{precision:2}}">Addition(%)</th>
                                <th width="10%" align="right" field="EstimatedCost" formatter="formatPrice6digit">Cost/Dz(Include)</th>
                                <th width="10%" align="right" field="EstimatedCostPerPc" formatter="formatPrice6digit">Cost/Pc(Include)</th>
                            </tr>
                        </thead>
                    </table>
                    <div id="toolbarAccessories">
                        Accessories:<input type="text" id="txtAccessoriesName" style="width:150px;" placeholder="Type Accessories Name & press Enter" />
                        <select style="width:120px;" id="cboACUnit"></select>
                        <a id="btnAddAccssories" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="AddAccessories()">Add</a>
                        <a id="btnRemoveAccssories" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="false" onclick="DeleteAccssories()">Remove</a>
                        <a id="btnAccessoriesUp" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-up" plain="false" onclick="AccessoriesUP()">UP</a>
                        <a id="btnAccessoriesDown" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-down" plain="false" onclick="AccessoriesDown()">Down</a>
                        <a id="btnRefreshAccssories" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false" onclick="RefreshAccessories()">Refresh</a>
                    </div>

                    <div style="height:170px; width:100%;">
                        <table id="tblStyleBudgetCM" title="CM Calculation" class="easyui-datagrid" style="height:170px;width:100%;" fitcolumns="false" showfooter="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarStyleBudgetCM" data-options="onClickRow: onClickRowStyleBudgetCM">
                            <thead>
                                <tr>
                                    <th field="CSQtySt" width="10%" align="right">Oder Qty</th>
                                    <th width="8%" align="left" data-options="field:'CMPart',editor:{type:'text'}">Part Name</th>
                                    <th width="7%" align="right" data-options="field:'NumberOfMachine',editor:{type:'numberbox',options:{precision:0}}">No.MC</th>
                                    <th width="8%" align="right" data-options="field:'MachineCost',editor:{type:'numberbox',options:{precision:2}}">MC Cost(<label id="lblMCCurrencySymbol"></label>)</th>
                                    <th width="10%" align="right" data-options="field:'ProductionPerDay',editor:{type:'numberbox',options:{precision:0}}">Prod/day</th>
                                    <th width="7%" align="right" data-options="field:'BufferDays',editor:{type:'numberbox',options:{precision:0}}">Buffer days</th>
                                    <th field="TotalRequiredDays" width="10%" align="left" formatter="formatPrice">Total days Req.</th>
                                    <th field="CMPerPc" width="8%" align="right" formatter="formatPrice">CM/pc(<label id="lblCMCurrencySymbol"></label>)</th>
                                    <th width="10%" align="right" data-options="field:'CMAdditionalPerent',editor:{type:'numberbox',options:{precision:2}}">Considering (%)</th>
                                    <th field="CMWithAddition" width="10%" align="right" formatter="formatPrice">Final CM(<label id="lblFinalCMCurrencySymbol"></label>)</th>
                                    <th field="CMPerDozen" width="10%" align="right" formatter="formatPrice">CM/Dz(<label id="lblFinalCMCurrencySymbolDzn"></label>)</th>
                                </tr>
                            </thead>
                        </table>
                        <div id="toolbarStyleBudgetCM">
                            <a id="btnAddStyleBudgetCM" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="AddStyleBudgetCM()">Add</a>
                            <a id="btnRemoveStyleBudgetCM" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="false" onclick="DeleteStyleBudgetCM()">Remove</a>
                            <a id="btnRefreshStyleBudgetCM" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false" onclick="RefreshStyleBudgetCM()">Refresh</a>
                        </div>
                    </div>
                    <fieldset>
                        <legend><label id="lblSummery">Pre Budget</label> Summery Info:</legend>
                        <table style="width:100%">
                            <tr>
                                <td style="width:40%" id="tdCSRecap">
                                    <table id="tblStyleBudgetRecap" title="PO List" class="easyui-datagrid" style="height:270px;width:100%;" fitcolumns="false" showfooter="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarStyleBudgetRecap" data-options="onClickRow: onClickRowStyleBudgetRecap">
                                        <thead>
                                            <tr>
                                                <th field="RefTypeSt" width="15%">Ref Type</th>
                                                <th field="RefNo" width="25%">Ref No</th>
                                                <th field="UnitSymbol" width="8%">Unit</th>
                                                <th width="12%" formatter="formatPrice" align="right" data-options="field:'UnitPrice',editor:{type:'numberbox',options:{precision:2}}">Price</th>
                                                <th width="20%" align="right" formatter="formatPricewithoutdecimal" data-options="field:'Quantity',editor:{type:'numberbox',options:{precision:0}}">Quantity</th>
                                                <th field="Amount" width="20%" align="right" formatter="formatPrice">Amount</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div id="toolbarStyleBudgetRecap">
                                        <a id="btnAddPAM" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="AddPAM()">PAM Pick</a>
                                        <a id="btnAddPO" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="AddPO()">PO Pick</a>
                                        <a id="btnRemoveStyleBudgetRecap" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="false" onclick="DeleteStyleBudgetRecap()">Remove</a>
                                        <a id="btnRefreshStyleBudgetRecap" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="false" onclick="RefreshStyleBudgetRecap()">Refresh</a>
                                    </div>
                                </td>
                                <td style="width:60%;text-align:right">
                                    <table border="0" cellpadding="1" cellspacing="1" style="width:100%; text-align:right;font-weight:bold;">
                                        <tr>
                                            <td style="text-align:right;width:50%;">Total Fabric Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtFabricCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtFabricCostPerDozen" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtFabricCostPerPcs" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Total Accessories Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtAccessoriesCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtAccessoriesCostPerDozen" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtAccessoriesCostPerPcs" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Print Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtPrintCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtPrintPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtPrintCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Embrodary Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtEmbrodaryCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtEmbrodaryPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtEmbrodaryCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Test Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtTestCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtTestPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtTestCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>

                                        <tr>
                                            <td style="text-align:right;width:50%;"><input id="txtCourierCaption" placeholder="Courier" style="width:15%;text-align:right;" />:</td>
                                            <td style="text-align:left;width:6%;"><input type="text" style="width:100%;text-align:right;" id="txtCourierCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtCourierPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input type="text" style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtCourierCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;"><input id="txtOthersCaption" placeholder="Others" style="width:15%;text-align:right;" />:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtOthersCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtOthersPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtOthersCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">CM Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtCMCostCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtCMCostPerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtCMCostPerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Commission:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" value="(%)" disabled /> </td>
                                            <td style="text-align:left;width:44%;" colspan="4"><input type="text" id="txtBuyingCommission" style="width:100%;text-align:right;" /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Banking Cost:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" value="(%)" disabled /> </td>
                                            <td style="text-align:left;width:44%;" colspan="4"><input type="text" id="txtBankingCost" style="width:100%;text-align:right;" /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">FOB Price:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtFOBPriceCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtFOBPricePerDozen" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtFOBPricePerPcs" style="width:100%;text-align:right;" disabled /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>

                                        <tr>
                                            <td style="text-align:right;width:50%;">Offer Price:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtOfferPriceCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtOfferPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtOfferPricePerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:right;width:50%;">Confirm Price:</td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;text-align:right;" id="txtConfirmPriceCurrency" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtConfirmPricePerDozen" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Dozen" disabled /> </td>
                                            <td style="text-align:left;width:16%;"><input type="text" id="txtConfirmPricePerPcs" style="width:100%;text-align:right;" /> </td>
                                            <td style="text-align:left;width:6%;"><input style="width:100%;" value="/Pcs" disabled /> </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        
                    </fieldset>
                </div>
            </div>
            <div title="Style Image" style="padding:10px; font-size:12px; font-style:normal;width:100%;">
                <table border="0" cellpadding="0" cellspacing="0" style="width:100%;">
                    <tr>
                        <td style="width:50%;">
                            <fieldset>
                                <legend>Style Front Image</legend>
                                <div>
                                    <img id="imgFrontImage" src="" alt="Photo" style="width:100%; height:350px" />
                                </div>
                            </fieldset>
                        </td>
                        <td style="width:50%;">
                            <fieldset>
                                <legend>Style Back Image</legend>
                                <div class="col-md-12">
                                    <img id="imgBackImage" src="" alt="Photo" style="width:100%; height:350px" />
                                </div>
                            </fieldset>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <fieldset style="height:10%;">
            <legend>Action</legend>
            <div class="col-md-12 text-right">
                <a id="btnApprove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="false" onclick="Approve()">Approve</a>
                <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="false" onclick="Save()"><label id="lblSave">Save</label></a>
                <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="false" onclick="Close()">Close</a>
            </div>
        </fieldset>
    </div>
</body>
</html>
<style>
    td, tr {
        height: 1px;
    }
</style>
<script type="text/javascript">
    var _sBaseAddress='';
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oStyleBudget =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        var oCurrencies =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.Currencies));
        var oCountUnits =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.CountUnits));
        var oStyleBudgetCMs = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.StyleBudgetCMs));
        var oStyleBudgetRecaps = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.StyleBudgetRecaps));
        var oTempStyleBudgetFabricDetails = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.StyleBudgetYarnDetails));
        var oStyleBudgetAccessoriesDetails = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.StyleBudgetAccessoriesDetails));

        var nStyleBudgetType = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.StyleBudgetType));
        var nCostSheetID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CostSheetID));
        var oAuthorizationRolesMapping =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.AuthorizationRolesMapping]));
        if(nStyleBudgetType==2)//Budget
        {
            var tab = $('#tabStyleBudget').tabs('getSelected');  // get selected panel
            $('#tabStyleBudget').tabs('update', {tab: tab,options: {title: 'Post Budget Information'}});
            $('#tabStyleBudget').tabs('select',0);
            $('#lblSummery').text('Post Budget');

        }
        $('#tabStyleBudget').data('StyleBudget',oStyleBudget);
        $('#tabStyleBudget').data('Currencies',oCurrencies);
        $('#tabStyleBudget').data('CountUnits',oCountUnits);


        $('#tabStyleBudget').data('StyleBudgetYarnDetails',oTempStyleBudgetFabricDetails);
        $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails',oStyleBudgetAccessoriesDetails);
        $('#tabStyleBudget').data('StyleBudgetCMs',oStyleBudgetCMs );
        $('#tabStyleBudget').data('StyleBudgetRecaps',oStyleBudgetRecaps );

        $('#tabStyleBudget').data('StyleBudgetType',nStyleBudgetType);
        $('#tabStyleBudget').data('RefCostSheetID',nCostSheetID);
        
        RefreshControl();
        RefreshVisibility();
        $('#AppMainLayout').layout('collapse', 'west');
        $('#AppMainLayout').layout('expand', 'west');
        $('#AppMainLayout').layout('collapse', 'west');
    });

    function RefreshControl()
    {
        $('#txtApproxQty,#txtNumberOfMachine,#txtSecNumberOfMachine,#txtProductionPerDay,#txtSecProductionPerDay,#txtBufferDays,#txtSecBufferDays,#txtTotalRequiredDays,#txtSecTotalRequiredDays').icsCurrencyBox(null, null, 0);
        $('#txtMachineCost,#txtSecMachineCost,#txtCMPerPc,#txtSecCMPerPc,#txtCMCost,#txtSecCMCost,#txtCMAdditionalPerent,#txtSecCMAdditionalPerent, #txtFinalCMPerPcwithConsidering,#txtSecFinalCMPerPcwithConsidering,#txtBuyingCommission,#txtBankingCost').icsCurrencyBox(null, null, 2);
        $('#txtFabricCostPerDozen,#txtFabricCostPerPcs,#txtAccessoriesCostPerDozen,#txtAccessoriesCostPerPcs,#txtPrintPricePerDozen,#txtPrintCostPerPcs,#txtEmbrodaryPricePerDozen,#txtEmbrodaryCostPerPcs,#txtTestPricePerDozen,#txtTestostPerPcs,  #txtCourierPricePerDozen,#txtCourierCostPerPcs,#txtOthersPricePerDozen,#txtOthersCostPerPcs,#txtCMCostPerDozen,#txtCMCostPerPcs,#txtFOBPricePerDozen,#txtFOBPricePerPcs,#txtOfferPricePerDozen,#txtOfferPricePerPcs,#txtConfirmPricePerDozen,#txtConfirmPricePerPcs').icsCurrencyBox(null, null,5);
        var oStyleBudget = $('#tabStyleBudget').data('StyleBudget');
        $("#txtStyleNo").val(oStyleBudget.StyleNo);

        $("#txtBudgetTitle").val(oStyleBudget.BudgetTitle);
        $('#txtCostingDateInString').datebox('setValue',oStyleBudget.CostingDateInString);
        $("#txtBuyerName").val(oStyleBudget.BuyerName);

        $('#txtApproxQty').val(icsFormatPrice(parseFloat(oStyleBudget.ApproxQty), null,0));
        var oCountUnits = $('#tabStyleBudget').data('CountUnits');
        $("#cboCountUnit").icsLoadCombo({List: oCountUnits,OptionValue: "MeasurementUnitID",DisplayText: "Symbol"});
        $("#cboCountUnit").val(oStyleBudget.UnitID);
        $('#txtShipmentDateInString').datebox('setValue',oStyleBudget.ShipmentDateInString);
        $("#txtKnittingPatternName").val(oStyleBudget.KnittingPatternName);
        $("#txtStyleDescription").val(oStyleBudget.StyleDescription);
        $("#txtGG").val(oStyleBudget.GG);
        $("#txtSizeRange").val(oStyleBudget.SizeRange);
        $("#txtColorRange").val(oStyleBudget.ColorRange);
        $("#txtMerchandiserName").val(oStyleBudget.MerchandiserName);
        $("#txtFabricDescription").val(oStyleBudget.FabricDescription);
        var oCurrencies = $('#tabStyleBudget').data('Currencies');
        $("#cboCostCurrency").icsLoadCombo({List: oCurrencies,OptionValue: "CurrencyID",DisplayText: "Symbol"});
        $("#cboCostCurrency").val(oStyleBudget.CurrencyID);
        var oFabricDetails =  $('#tabStyleBudget').data('StyleBudgetYarnDetails');
        if(oFabricDetails!=null && oFabricDetails.length>0){DynamicRefreshList(oFabricDetails,'tblFabric');}

        var oAccessoriesDetails =  $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails');
        if(oAccessoriesDetails!=null && oAccessoriesDetails.length>0){DynamicRefreshList(oAccessoriesDetails,'tblAccessories');}

        var oStyleBudgetCMs =  $('#tabStyleBudget').data('StyleBudgetCMs');
        if(oStyleBudgetCMs!=null && oStyleBudgetCMs.length>0){DynamicRefreshList(oStyleBudgetCMs,'tblStyleBudgetCM');RefreshCMFooter();}

        var oStyleBudgetRecaps = $('#tabStyleBudget').data('StyleBudgetRecaps');
        if(oStyleBudgetRecaps.length>0){DynamicRefreshList(oStyleBudgetRecaps,'tblStyleBudgetRecap');RefReshRecapFooter(); }


        $('#txtFabricCostPerDozen').val(icsFormatPrice(parseFloat(oStyleBudget.FabricCostPerDozen), null,5));
        $('#txtFabricCostPerPcs').val(icsFormatPrice(oStyleBudget.FabricCostPerPcs, null,5));

        $('#txtAccessoriesCostPerDozen').val(icsFormatPrice(parseFloat(oStyleBudget.AccessoriesCostPerDozen), null,5));
        $('#txtAccessoriesCostPerPcs').val(icsFormatPrice(oStyleBudget.AccessoriesCostPerPcs, null,5));


        $('#txtPrintPricePerDozen').val(icsFormatPrice(oStyleBudget.PrintPricePerDozen, null,5));
        $('#txtPrintCostPerPcs').val(icsFormatPrice(oStyleBudget.PrintPricePerPcs, null,5));


        $('#txtEmbrodaryPricePerDozen').val(icsFormatPrice(oStyleBudget.EmbrodaryPricePerDozen, null,5));
        $('#txtEmbrodaryCostPerPcs').val(icsFormatPrice(oStyleBudget.EmbrodaryPricePerPcs, null,5));


        $('#txtTestPricePerDozen').val(icsFormatPrice(oStyleBudget.TestPricePerDozen, null,5));
        $('#txtTestCostPerPcs').val(icsFormatPrice(oStyleBudget.TestPricePerPcs, null,5));



        $('#txtOthersPricePerDozen').val(icsFormatPrice(oStyleBudget.OthersPricePerDozen, null,5));
        $('#txtOthersCostPerPcs').val(icsFormatPrice(oStyleBudget.OthersPricePerPcs, null,5));


        $('#txtCourierPricePerDozen').val(icsFormatPrice(oStyleBudget.CourierPricePerDozen, null,5));
        $('#txtCourierCostPerPcs').val(icsFormatPrice(oStyleBudget.CourierPricePerPcs, null,5));

        $('#txtCourierCaption').val(oStyleBudget.CourierCaption );
        $('#txtOthersCaption').val(oStyleBudget.OthersCaption);

        $('#txtCMCostPerDozen').val(icsFormatPrice(parseFloat(oStyleBudget.CMCost), null,5));
        $('#txtCMCostPerPcs').val(icsFormatPrice(oStyleBudget.CMCostPerPcs, null,3));

        $('#txtBuyingCommission').val(icsFormatPrice(parseFloat(oStyleBudget.BuyingCommission), null,2));
        $('#txtBankingCost').val(icsFormatPrice(parseFloat(oStyleBudget.BankingCost), null,2));



        $('#txtFOBPricePerDozen').val(icsFormatPrice(oStyleBudget.FOBPricePerDozen, null,5));
        $('#txtFOBPricePerPcs').val(icsFormatPrice(oStyleBudget.FOBPricePerPcs, null,5));


        $('#txtOfferPricePerDozen').val(icsFormatPrice(oStyleBudget.OfferPricePerDozen, null,5));
        $('#txtOfferPricePerPcs').val(icsFormatPrice(oStyleBudget.OfferPricePerPcs, null,5));


        $('#txtConfirmPricePerDozen').val(icsFormatPrice(oStyleBudget.ConfirmPricePerDozen, null,5));
        $('#txtConfirmPricePerPcs').val(icsFormatPrice(oStyleBudget.ConfirmPricePerPcs, null,5));


        if(parseInt(oStyleBudget.StyleBudgetID)>0)
        {
            //SummeryCalculation();
            StyleImage(oStyleBudget.TechnicalSheetID, true);
            StyleImage(oStyleBudget.TechnicalSheetID, false);
        }
        CurrencySet();
    }
    function RefreshVisibility()
    {
        $('#btnApprove').hide();
        if(sessionStorage.getItem("StyleBudgetHeader")=="Approve Budget" || sessionStorage.getItem("StyleBudgetHeader")=="Approve Budget")
        {
            $('#btnApprove').show();
            $('#btnSave').hide();
        }
        if(sessionStorage.getItem("StyleBudgetHeader")=="Budget Revise" || sessionStorage.getItem("StyleBudgetHeader")=="Budget Revise")
        {
            $('#lblSave').text('Commit');
        }
        if(sessionStorage.getItem("StyleBudgetHeader")=="Copy Budget" || sessionStorage.getItem("StyleBudgetHeader")=="Copy Budget" || sessionStorage.getItem("StyleBudgetHeader")=="Add Budget")
        {
            if(sessionStorage.getItem("StyleBudgetHeader")!="Add Budget")
            {
                $('#lblSave').text("Paste");
            }
            var oStyleBudget = $('#tabStyleBudget').data('StyleBudget');
            if(sessionStorage.getItem("StyleBudgetHeader")=="Add Budget" )//add and Budget type
            {
                var nRefObjectID = oStyleBudget.StyleBudgetID;
                oStyleBudget.RefObjectID  = nRefObjectID;//set RefObject
                oStyleBudget.StatusInInt = 1;//initalize
                oStyleBudget.ApprovedBy = 0;
            }
            oStyleBudget.StyleBudgetID = 0;
            var oStyleBudget = $('#tabStyleBudget').data('StyleBudget',oStyleBudget);
            var oTempStyleBudgetFabricDetails =  $('#tabStyleBudget').data('StyleBudgetYarnDetails');
            for(var i = 0;i<oTempStyleBudgetFabricDetails.length;i++)
            {
                oTempStyleBudgetFabricDetails[i].StyleBudgetDetailID =0;
                oTempStyleBudgetFabricDetails[i].StyleBudgetID =0;
            }
            DynamicRefreshList(oTempStyleBudgetFabricDetails,'tblFabric');
            var oAccessoriesDetails =  $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails');
            for(var i = 0;i<oAccessoriesDetails.length;i++)
            {
                oAccessoriesDetails[i].StyleBudgetDetailID =0;
                oAccessoriesDetails[i].StyleBudgetID =0;
            }
            DynamicRefreshList(oAccessoriesDetails,'tblAccessories');

        }
        if(sessionStorage.getItem("StyleBudgetHeader")=="View Budget" || sessionStorage.getItem("StyleBudgetHeader")=="View Budget")
        {
            $("#divCS :input").prop('disabled', true);
            $('#btnSave').hide();
        }

    }
    function RefreshCMFooter()
    {
        var oStyleBudgetCMs = $('#tblStyleBudgetCM').datagrid('getRows');
        var nCMCostPerDozen = ICS_TotalCalculation(oStyleBudgetCMs,'CMPerDozen');
        var oFooterObject = {
            CSQtySt:'Total:',
            TotalRequiredDays:'-',
            CMPerPc:'-',
            CMWithAddition:formatPrice(ICS_TotalCalculation(oStyleBudgetCMs,'CMWithAddition')),
            CMPerDozen:formatPrice(nCMCostPerDozen)
        };
        $('#tblStyleBudgetCM').datagrid('reloadFooter',[oFooterObject]);

        //effect on CM
        $('#txtCMCostPerDozen').val(icsFormatPrice(nCMCostPerDozen, null,5));
        var nCMPricePerPcs  =(parseFloat(nCMCostPerDozen)/12);
        $('#txtCMCostPerPcs').val(icsFormatPrice(nCMPricePerPcs, null,5));
    }
    function RefReshRecapFooter()
    {
        var oStyleBudgetRecaps = $('#tblStyleBudgetRecap').datagrid('getRows');
        var  nTotalQuantity = ICS_TotalCalculation(oStyleBudgetRecaps,'Quantity');
        var oFooterObject = {
            RefNo:'Total:',
            Quantity:nTotalQuantity,
            Amount:ICS_TotalCalculation(oStyleBudgetRecaps,'Amount')
        };
        $('#tblStyleBudgetRecap').datagrid('reloadFooter',[oFooterObject]);
        $('#txtApproxQty').val(icsFormatPrice(parseFloat(nTotalQuantity), null,0));
    }
    $("#txtApproxQty").keyup(function(){
        debugger;
        var nApproxQty = parseFloat(icsRemoveComma($("#txtApproxQty").val()));
        var oStyleBudgetCMs = $('#tblStyleBudgetCM').datagrid('getRows');
        for(var i=0;i<oStyleBudgetCMs.length;i++)
        {
            oStyleBudgetCMs[i].CSQty = nApproxQty;
            oStyleBudgetCMs[i].CSQtySt = nApproxQty.toFixed(0);
            //if(oStyleBudgetCMs[i].CSQty>0 && oStyleBudgetCMs[i].NumberOfMachine>0 && oStyleBudgetCMs[i].MachineCost>0 && oStyleBudgetCMs[i].ProductionPerDay>0  && oStyleBudgetCMs[i].BufferDays>0   )
            if(oStyleBudgetCMs[i].CSQty>0 )
            {

                oStyleBudgetCMs[i].TotalRequiredDays = (Math.round((parseInt(oStyleBudgetCMs[i].CSQty/oStyleBudgetCMs[i].ProductionPerDay)) +parseInt(oStyleBudgetCMs[i].BufferDays))).toFixed(0);
                oStyleBudgetCMs[i].CMPerPc =((oStyleBudgetCMs[i].NumberOfMachine * oStyleBudgetCMs[i].MachineCost * oStyleBudgetCMs[i].TotalRequiredDays) / oStyleBudgetCMs[i].CSQty).toFixed(2);
                oStyleBudgetCMs[i].CMWithAddition = (parseFloat(oStyleBudgetCMs[i].CMPerPc)+parseFloat(oStyleBudgetCMs[i].CMPerPc *((oStyleBudgetCMs[i].CMAdditionalPerent)/100))).toFixed(2);//15% increase default
                oStyleBudgetCMs[i].CMPerDozen = (parseFloat(oStyleBudgetCMs[i].CMWithAddition)*parseFloat(12))
            }else{
                oStyleBudgetCMs[i].CMPerPc = 0;oStyleBudgetCMs[i].CMWithAddition = 0;oStyleBudgetCMs[i].CMPerDozen = 0;
            }
        }
        DynamicRefreshList(oStyleBudgetCMs,'tblStyleBudgetCM');
        RefreshCMFooter();
        SummeryCalculation();
    });
    function CalculateCM()
    {
        var nApproxQty = parseFloat(icsRemoveComma($("#txtApproxQty").val()));
        var nNumberOfMachine = parseFloat(icsRemoveComma($("#txtNumberOfMachine").val()));
        var nMachineCost = parseFloat(icsRemoveComma($("#txtMachineCost").val()));
        var nProductionPerDay = parseFloat(icsRemoveComma($("#txtProductionPerDay").val()));
        var nBufferDays= parseFloat(icsRemoveComma($("#txtBufferDays").val()));
        var nCMAdditionalPerent= parseFloat(icsRemoveComma($("#txtCMAdditionalPerent").val()));
        if(nApproxQty>0 && nNumberOfMachine>0 && nMachineCost>0 && nProductionPerDay>0  && nBufferDays>0   )
        {
            var nTotalRequiredDays =(Math.round((parseInt(nApproxQty/nProductionPerDay)) +parseInt(nBufferDays))).toFixed(0);
            $('#txtTotalRequiredDays').val(icsFormatPrice(parseFloat(nTotalRequiredDays), null,0));

            var nCMPerPc =((nNumberOfMachine * nMachineCost * nTotalRequiredDays) / nApproxQty).toFixed(2);
            $('#txtCMPerPc').val(icsFormatPrice(parseFloat(nTotalRequiredDays), null,2));

            var  nFinalCMPerPcwithConsidering =(parseFloat(nCMPerPc)+parseFloat(nCMPerPc *((nCMAdditionalPerent)/100))).toFixed(2);//15% increase default
            $('#txtFinalCMPerPcwithConsidering').val(icsFormatPrice(parseFloat(nFinalCMPerPcwithConsidering), null,2));

            var nCMCost = (parseFloat(nFinalCMPerPcwithConsidering)*parseFloat(12)).toFixed(2);
            $('#txtCMCost').val(icsFormatPrice(parseFloat(nCMCost), null,2));
        }else{
            $('#txtCMPerPc,#txtFinalCMPerPcwithConsidering, #txtCMCost').val(0);
        }

        //Bottom Part
        //debugger;
        var nSecApproxQty = nApproxQty;//parseFloat(icsRemoveComma($("#txtSecApproxQty").val()));
        var nSecNumberOfMachine = parseFloat(icsRemoveComma($("#txtSecNumberOfMachine").val()));
        var nSecMachineCost = parseFloat(icsRemoveComma($("#txtSecMachineCost").val()));
        var nSecProductionPerDay = parseFloat(icsRemoveComma($("#txtSecProductionPerDay").val()));
        var nSecBufferDays= parseFloat(icsRemoveComma($("#txtSecBufferDays").val()));
        var nSecCMAdditionalPerent= parseFloat(icsRemoveComma($("#txtSecCMAdditionalPerent").val()));
        if(nSecApproxQty>0 && nSecNumberOfMachine>0 && nSecMachineCost>0 && nSecProductionPerDay>0  && nSecBufferDays>0   )
        {
            var nSecTotalRequiredDays =(Math.round((parseInt(nSecApproxQty/nSecProductionPerDay)) +parseInt(nSecBufferDays))).toFixed(0);
            $('#txtSecTotalRequiredDays').val(icsFormatPrice(parseFloat(nSecTotalRequiredDays), null,0));

            var nSecCMPerPc =((nSecNumberOfMachine * nSecMachineCost * nSecTotalRequiredDays) / nSecApproxQty).toFixed(2);
            $('#txtSecCMPerPc').val(icsFormatPrice(parseFloat(nSecTotalRequiredDays), null,2));

            var  nSecFinalCMPerPcwithConsidering =(parseFloat(nSecCMPerPc)+parseFloat(nSecCMPerPc *((nSecCMAdditionalPerent)/100))).toFixed(2);//15% increase default
            $('#txtSecFinalCMPerPcwithConsidering').val(icsFormatPrice(parseFloat(nSecFinalCMPerPcwithConsidering), null,2));

            var nSecCMCost = (parseFloat(nSecFinalCMPerPcwithConsidering)*parseFloat(12)).toFixed(2);
            $('#txtSecCMCost').val(icsFormatPrice(parseFloat(nSecCMCost), null,2));
        }else{
            $('#txtSecCMPerPc,#txtSecFinalCMPerPcwithConsidering, #txtSecCMCost').val(0);
        }
        var nCMCostPerDozen = parseFloat(icsRemoveComma($("#txtCMCost").val())) +parseFloat(icsRemoveComma($("#txtSecCMCost").val()));
        $('#txtCMCostPerDozen').val(icsFormatPrice(nCMCostPerDozen, null,5));
        var nCMPricePerPcs  =(parseFloat(nCMCostPerDozen)/12);
        $('#txtCMCostPerPcs').val(icsFormatPrice(nCMPricePerPcs, null,5));
        SummeryCalculation();
    }
    $('#cboCostCurrency').change(function(){
        CurrencySet();
    });
    $('#txtPrintPricePerDozen,#txtEmbrodaryPricePerDozen,#txtTestPricePerDozen,#txtCourierPricePerDozen,#txtOthersPricePerDozen,#txtCMCostPerDozen,#txtBuyingCommission,#txtBankingCost').keyup(function(){
        debugger;
        var nPrintPricePerDozen = parseFloat(icsRemoveComma($("#txtPrintPricePerDozen").val()));
        var nPrintPricePerPcs  =(parseFloat(nPrintPricePerDozen)/12);
        $('#txtPrintCostPerPcs').val(icsFormatPrice(nPrintPricePerPcs, null,5));

        var nEmbrodaryPricePerDozen = parseFloat(icsRemoveComma($("#txtEmbrodaryPricePerDozen").val()));
        var nEmbrodaryPricePerPcs  =(parseFloat(nEmbrodaryPricePerDozen)/12);
        $('#txtEmbrodaryCostPerPcs').val(icsFormatPrice(nEmbrodaryPricePerPcs, null,5));

        var nTestPricePerDozen = parseFloat(icsRemoveComma($("#txtTestPricePerDozen").val()));
        var nTestPricePerPcs  =(parseFloat(nTestPricePerDozen)/12);
        $('#txtTestCostPerPcs').val(icsFormatPrice(nTestPricePerPcs, null,5));

        var nCourierPricePerDozen = parseFloat(icsRemoveComma($("#txtCourierPricePerDozen").val()));
        var nCourierPricePerPcs  =(parseFloat(nCourierPricePerDozen)/12);
        $('#txtCourierCostPerPcs').val(icsFormatPrice(nCourierPricePerPcs, null,5));

        var nOthersPricePerDozen = parseFloat(icsRemoveComma($("#txtOthersPricePerDozen").val()));
        var nOthersPricePerPcs  =(parseFloat(nOthersPricePerDozen)/12);
        $('#txtOthersCostPerPcs').val(icsFormatPrice(nOthersPricePerPcs, null,5));

        var nCMPricePerDzn = parseFloat(icsRemoveComma($("#txtCMCostPerDozen").val()));
        var nCMPricePerPcs  =(parseFloat(nCMPricePerDzn)/12);
        $('#txtCMCostPerPcs').val(icsFormatPrice(nCMPricePerPcs, null,5));
        SummeryCalculation();
    });
    $('#txtPrintCostPerPcs,#txtEmbrodaryCostPerPcs,#txtTestCostPerPcs,#txtCourierCostPerPcs,#txtOthersCostPerPcs,#txtCMCostPerPcs').keyup(function(){

        var nPrintPricePerPcs = parseFloat(icsRemoveComma($("#txtPrintCostPerPcs").val()));
        var nPrintPricePerDozen   =(parseFloat(nPrintPricePerPcs)*12);
        $('#txtPrintPricePerDozen').val(icsFormatPrice(nPrintPricePerDozen, null,5));

        var nEmbrodaryPricePerPcs = parseFloat(icsRemoveComma($("#txtEmbrodaryCostPerPcs").val()));
        var nEmbrodaryPricePerDozen   =(parseFloat(nEmbrodaryPricePerPcs)*12);
        $('#txtEmbrodaryPricePerDozen').val(icsFormatPrice(nEmbrodaryPricePerDozen, null,5));

        var nTestPricePerPcs = parseFloat(icsRemoveComma($("#txtTestCostPerPcs").val()));
        var nTestPricePerDozen   =(parseFloat(nTestPricePerPcs)*12);
        $('#txtTestPricePerDozen').val(icsFormatPrice(nTestPricePerDozen, null,5));

        var nCourierPricePerPcs = parseFloat(icsRemoveComma($("#txtCourierCostPerPcs").val()));
        var nCourierPricePerDozen   =(parseFloat(nCourierPricePerPcs)*12);
        $('#txtCourierPricePerDozen').val(icsFormatPrice(nCourierPricePerDozen, null,5));

        var nOthersPricePerPcs = parseFloat(icsRemoveComma($("#txtOthersCostPerPcs").val()));
        var nOthersPricePerDozen   =(parseFloat(nOthersPricePerPcs)*12);
        $('#txtOthersPricePerDozen').val(icsFormatPrice(nOthersPricePerDozen, null,5));

        var nCMPricePerPcs = parseFloat(icsRemoveComma($("#txtCMCostPerPcs").val()));
        var nCMPricePerDzn   =(parseFloat(nCMPricePerPcs)*12);
        $('#txtCMCostPerDozen').val(icsFormatPrice(nCMPricePerDzn, null,5));
        SummeryCalculation();
    });

    $('#txtOfferPricePerDozen,#txtConfirmPricePerDozen').keyup(function(){

        var nOfferPricePerDozen = parseFloat(icsRemoveComma($("#txtOfferPricePerDozen").val()));
        var nOfferPricePerPcs  =(parseFloat(nOfferPricePerDozen)/12);
        $('#txtOfferPricePerPcs').val(icsFormatPrice(nOfferPricePerPcs, null,5));

        var nConfirmPricePerDozen = parseFloat(icsRemoveComma($("#txtConfirmPricePerDozen").val()));
        var nConfirmPricePerPcs  =(parseFloat(nConfirmPricePerDozen)/12);
        $('#txtConfirmPricePerPcs').val(icsFormatPrice(nConfirmPricePerPcs, null,5));
    });
    $('#txtOfferPricePerPcs,#txtConfirmPricePerPcs').keyup(function(){

        var nOfferPricePerPcs = parseFloat(icsRemoveComma($("#txtOfferPricePerPcs").val()));
        var nOfferPricePerDozen   =(parseFloat(nOfferPricePerPcs)*12);
        $('#txtOfferPricePerDozen').val(icsFormatPrice(nOfferPricePerDozen, null,5));

        var nConfirmPricePerPcs = parseFloat(icsRemoveComma($("#txtConfirmPricePerPcs").val()));
        var nConfirmPricePerDozen   =(parseFloat(nConfirmPricePerPcs)*12);
        $('#txtConfirmPricePerDozen').val(icsFormatPrice(nConfirmPricePerDozen, null,5));
    });
    var editIndex = undefined;
    function endEditingYarn(){
        if (editIndex == undefined){return true}
        if ($('#tblFabric').datagrid('validateRow', editIndex)){
            $('#tblFabric').datagrid('endEdit', editIndex);
            $('#tblFabric').datagrid('selectRow',editIndex);
            var oYarn=$('#tblFabric').datagrid('getSelected');
            if(oYarn==null){return;}
            //debugger;

            oYarn.FabricCost=parseFloat(parseFloat(parseFloat(oYarn.MaterialMarketPrice)+parseFloat(oYarn.KnittingCost)+parseFloat(oYarn.DyeingCost)+parseFloat(oYarn.LycraCost)+parseFloat(oYarn.AOPCost)+parseFloat(oYarn.WashCost)+parseFloat(oYarn.YarnDyeingCost)+parseFloat(oYarn.SuedeCost)+parseFloat(oYarn.FinishingCost)+parseFloat(oYarn.BrushingCost)));
            oYarn.ConsumptionPerPc=parseFloat(parseFloat(oYarn.Consumption)/12);
            oYarn.EstimatedCost=parseFloat(parseFloat(oYarn.FabricCost)* parseFloat(oYarn.Consumption));
            oYarn.CostPerPcs=parseFloat(parseFloat(oYarn.EstimatedCost)/12);
            $('#tblFabric').datagrid('updateRow',{index: editIndex,	row: oYarn});
            RefreshFooter();
            SummeryCalculation();
            editIndex  = undefined;
            return true;
        }
        else
        {
            return false;
        }
    }
    function onClickRowYarnDetail(index){
        if (editIndex != index){
            if (endEditingYarn())
            {
                $('#tblFabric').datagrid('selectRow', index).datagrid('beginEdit', index);
                editIndex  = index;
            }
            else
            {
                $('#tblFabric').datagrid('selectRow', editIndex);
            }
        }
    }


    var editIndexAccessories = undefined;
    function endEditingAccessories(){
        if (editIndexAccessories == undefined){return true}
        if ($('#tblAccessories').datagrid('validateRow', editIndexAccessories)){
            $('#tblAccessories').datagrid('endEdit', editIndexAccessories);
            $('#tblAccessories').datagrid('selectRow',editIndexAccessories);
            var oAccessories=$('#tblAccessories').datagrid('getSelected');
            if(oAccessories==null){return;}
            if(oAccessories.RateUnit<=0){alert("Sorry, Rate Unit Minimum Value is 1. For Accessories ["+oAccessories.ProductName+"]");oAccessories.RateUnit=1;}

            oAccessories.CostPerDzn=parseFloat(parseFloat(oAccessories.Consumption) * (parseFloat(oAccessories.MaterialMarketPrice)/oAccessories.RateUnit));
            oAccessories.CostPerPcs=parseFloat(parseFloat(oAccessories.CostPerDzn)/12);
            var nAdditionPercent = ((100.00 - parseFloat(oAccessories.UsePercentage)) / 100.00);
            if(nAdditionPercent<=0)
            {
                nAdditionPercent = 1.00;
            }
            oAccessories.EstimatedCost= parseFloat((parseFloat(oAccessories.CostPerDzn) /nAdditionPercent));
            //oAccessories.EstimatedCost=parseFloat((parseFloat(oAccessories.CostPerDzn) * parseFloat(oAccessories.UsePercentage)/100)+parseFloat(oAccessories.CostPerDzn));
            oAccessories.EstimatedCostPerPc = oAccessories.EstimatedCost/12;
            $('#tblAccessories').datagrid('updateRow',{index: editIndexAccessories,	row: oAccessories});
            SummeryCalculation();
            editIndexAccessories  = undefined;
            return true;
        }
        else
        {
            return false;
        }
    }
    function onClickRowAccessoriesDetail(index){
        if (editIndexAccessories != index){
            if (endEditingAccessories())
            {
                $('#tblAccessories').datagrid('selectRow', index).datagrid('beginEdit', index);
                editIndexAccessories  = index;
            }
            else
            {
                $('#tblAccessories').datagrid('selectRow', editIndexAccessories);
            }
        }
    }



    var editIndexStyleBudgetCM = undefined;
    function endEditingStyleBudgetCM(){
        if (editIndexStyleBudgetCM == undefined){return true}
        if ($('#tblStyleBudgetCM').datagrid('validateRow', editIndexStyleBudgetCM)){
            $('#tblStyleBudgetCM').datagrid('endEdit', editIndexStyleBudgetCM);
            $('#tblStyleBudgetCM').datagrid('selectRow',editIndexStyleBudgetCM);
            var oStyleBudgetCM=$('#tblStyleBudgetCM').datagrid('getSelected');
            if(oStyleBudgetCM==null){return;}
            var nApproxQty = parseFloat(icsRemoveComma($("#txtApproxQty").val()));
            oStyleBudgetCM.CSQty = nApproxQty;
            if(nApproxQty>0 && oStyleBudgetCM.NumberOfMachine>0 && oStyleBudgetCM.MachineCost>0 && oStyleBudgetCM.ProductionPerDay>0  && oStyleBudgetCM.BufferDays>0   )
            {
                oStyleBudgetCM.TotalRequiredDays = (Math.round((parseInt(oStyleBudgetCM.CSQty/oStyleBudgetCM.ProductionPerDay)) +parseInt(oStyleBudgetCM.BufferDays))).toFixed(0);
                oStyleBudgetCM.CMPerPc =((oStyleBudgetCM.NumberOfMachine * oStyleBudgetCM.MachineCost * oStyleBudgetCM.TotalRequiredDays) / oStyleBudgetCM.CSQty).toFixed(2);
                
                //oStyleBudgetCM.CMWithAddition = (parseFloat(oStyleBudgetCM.CMPerPc)+parseFloat(oStyleBudgetCM.CMPerPc *((oStyleBudgetCM.CMAdditionalPerent)/100))).toFixed(2);//15% increase default
                var nAdditionPercent = ((100.00 - parseFloat(oStyleBudgetCM.CMAdditionalPerent)) / 100.00);
                if(nAdditionPercent<=0)
                {
                    nAdditionPercent = 1.00;
                }
                oStyleBudgetCM.CMWithAddition = (parseFloat(oStyleBudgetCM.CMPerPc)/nAdditionPercent).toFixed(2);//15% increase default
                oStyleBudgetCM.CMPerDozen = (parseFloat(oStyleBudgetCM.CMWithAddition)*parseFloat(12))
            }
            else
            {
                oStyleBudgetCM.CMPerPc = 0;oStyleBudgetCM.CMWithAddition = 0;oStyleBudgetCM.CMPerDozen = 0;
            }
            $('#tblStyleBudgetCM').datagrid('updateRow',{index: editIndexStyleBudgetCM,	row: oStyleBudgetCM});
            RefreshCMFooter();
            SummeryCalculation();
            editIndexStyleBudgetCM  = undefined;
            return true;
        }
        else
        {
            return false;
        }
    }
    function onClickRowStyleBudgetCM(index){
        if (editIndexStyleBudgetCM != index){
            if (endEditingStyleBudgetCM())
            {
                $('#tblStyleBudgetCM').datagrid('selectRow', index).datagrid('beginEdit', index);
                editIndexStyleBudgetCM  = index;
            }
            else
            {
                $('#tblStyleBudgetCM').datagrid('selectRow', editIndexStyleBudgetCM);
            }
        }
    }

    //Style Budget Recap
    var editIndexStyleBudgetRecap = undefined;
    function endEditingStyleBudgetRecap(){
        if (editIndexStyleBudgetRecap == undefined){return true}
        if ($('#tblStyleBudgetRecap').datagrid('validateRow', editIndexStyleBudgetRecap)){
            $('#tblStyleBudgetRecap').datagrid('endEdit', editIndexStyleBudgetRecap);
            $('#tblStyleBudgetRecap').datagrid('selectRow',editIndexStyleBudgetRecap);
            debugger;
            var oStyleBudgetRecap=$('#tblStyleBudgetRecap').datagrid('getSelected');
            if(oStyleBudgetRecap==null){return;}
            oStyleBudgetRecap.Amount=parseFloat(parseFloat(oStyleBudgetRecap.UnitPrice) * parseFloat(oStyleBudgetRecap.Quantity));
            $('#tblStyleBudgetRecap').datagrid('updateRow',{index: editIndexStyleBudgetRecap,	row:oStyleBudgetRecap});
            RefReshRecapFooter();
            SummeryCalculation();
            editIndexStyleBudgetRecap  = undefined;
            return true;
        }
        else
        {
            return false;
        }
    }
    function onClickRowStyleBudgetRecap(index){
        if (editIndexStyleBudgetRecap != index){
            if (endEditingStyleBudgetRecap())
            {
                $('#tblStyleBudgetRecap').datagrid('selectRow', index).datagrid('beginEdit', index);
                editIndexStyleBudgetRecap  = index;
            }
            else
            {
                $('#tblStyleBudgetRecap').datagrid('selectRow', editIndexStyleBudgetRecap);
            }
        }
    }


    //Yarn add , edit & Delete start
    function AddYarnORFabric()
    {
        //debugger;
        var oStyleBudgetDetail = $('#divCS').data('StyleBudgetDetail');
        if(oStyleBudgetDetail==null || parseInt(oStyleBudgetDetail.MaterialID)<=0 )
        {
            alert("Please Pick Yarn ");
            return;
        }
        var oPriviousList =   $('#tblFabric').datagrid('getRows');
        if(ICS_IsExist(oPriviousList,'MaterialID',oStyleBudgetDetail.MaterialID))
        {
            alert("Already Exist");
            return;
        }
        if(parseInt($('#cboYarnUnit').val()) <=0)
        {
            alert("Please Select Unit.");
            return;
        }
        oStyleBudgetDetail.UnitID = parseInt($('#cboYarnUnit').val()) ;
        oStyleBudgetDetail.UnitName = $("#cboYarnUnit option:selected").text();
        $('#tblFabric').datagrid('appendRow',oStyleBudgetDetail);
        $('#txtFabricName').val('');
        $('#divCS').data('StyleBudgetDetail',null);
        SummeryCalculation();

    }
    function RemoveYarn()
    {
        var oYarnDetail =$('#tblFabric').datagrid('getSelected');
        if(oYarnDetail==null || oYarnDetail.MaterialID<=0)
        {
            alert("Select At least One item !");
            return;
        }

        if (!confirm("Confirm to Delete?")) return ;
        var nIndex= $('#tblFabric').datagrid('getRowIndex',oYarnDetail);
        $('#tblFabric').datagrid('deleteRow',nIndex);
        RefreshYarnDetail();
        SummeryCalculation();

    }
    function RefreshYarnDetail()
    {
        debugger;
        endEditingYarn();
        var oFabricDetails =$('#tblFabric').datagrid('getRows');
        if(oFabricDetails !=null)
        {
            DynamicRefreshList(oFabricDetails,'tblFabric');
            SummeryCalculation();
        }
    }
    //Yarn End

    //Accessories  Add, Edit & Delete Start
    function AddAccessories()
    {
        //debugger;
        var oAccessoriesDetail = $('#divCS').data('AccessoriesDetail');
        if(oAccessoriesDetail==null || parseInt(oAccessoriesDetail.MaterialID)<=0 )
        {
            alert("Please Pick Accessories ");
            return;
        }
        var oPriviousList =   $('#tblAccessories').datagrid('getRows');
        if(ICS_IsExist(oAccessoriesDetail,'MaterialID',oAccessoriesDetail.MaterialID))
        {
            alert("Already Exist");
            return;
        }
        if(parseInt($('#cboACUnit').val()) <=0)
        {
            alert("Please Select Unit.");
            return;
        }

        oAccessoriesDetail.UnitID = parseInt($('#cboACUnit').val());
        oAccessoriesDetail.UnitName = $("#cboACUnit option:selected").text();
        $('#tblAccessories').datagrid('appendRow',oAccessoriesDetail);
        $('#txtAccessoriesName').val('');

        $('#divCS').data('AccessoriesDetail',null);
        SummeryCalculation();
    }
    function DeleteAccssories()
    {
        var oAccessoriesDetail = $('#tblAccessories').datagrid('getSelected');
        if(oAccessoriesDetail==null)
        {
            alert("Select At least One item !");
            return;
        }
        if (!confirm("Confirm to Delete?")) return ;
        var nIndex= $('#tblAccessories').datagrid('getRowIndex',oAccessoriesDetail);
        $('#tblAccessories').datagrid('deleteRow',nIndex);
        SummeryCalculation();
    }
    function RefreshAccessories()
    {
        endEditingAccessories();
        var oAccessoriesDetails =$('#tblAccessories').datagrid('getRows');
        if(oAccessoriesDetails !=null)
        {
            DynamicRefreshList(oAccessoriesDetails,'tblAccessories');
            SummeryCalculation();
        }
    }


    //StyleBudgetCM  Add, Edit & Delete Start
    function AddStyleBudgetCM()
    {
        //debugger;
        var oStyleBudget = $('#tabStyleBudget').data('StyleBudget');
        if(parseInt(oStyleBudget.TechnicalSheetID)<=0 )
        {
            alert("Please Pick Style ");
            return;
        }
        var nApproxQty = parseFloat(icsRemoveComma($("#txtApproxQty").val()));
        if(parseFloat(nApproxQty)<=0 )
        {
            alert("Approximate Qty Should be Greater than 0;");
            return;
        }

        var oStyleBudgetCM ={
            StyleBudgetCMID :0,
            StyleBudgetID  :0,
            CMPart:'',
            NumberOfMachine  :0,
            MachineCost  :0,
            ProductionPerDay  :0,
            BufferDays : 2,//detail
            TotalRequiredDays  :0,
            CMAdditionalPerent :15, //default
            CSQty  :nApproxQty,
            CSQtySt:(nApproxQty).toFixed(0),
            CMPerPc:0,
            CMWithAddition:0,
            CMPerDozen:0
        };

        $('#tblStyleBudgetCM').datagrid('appendRow',oStyleBudgetCM);
        RefreshCMFooter();
        $('#btnAddStyleBudgetCM').focus();
    }
    function DeleteStyleBudgetCM()
    {
        var oStyleBudgetCM = $('#tblStyleBudgetCM').datagrid('getSelected');
        if(oStyleBudgetCM==null)
        {
            alert("Select At least One item !");
            return;
        }
        if (!confirm("Confirm to Delete?")) return ;
        var nIndex= $('#tblStyleBudgetCM').datagrid('getRowIndex',oStyleBudgetCM);
        $('#tblStyleBudgetCM').datagrid('deleteRow',nIndex);
        RefreshCMFooter();
        SummeryCalculation();
    }
    function RefreshStyleBudgetCM()
    {
        endEditingStyleBudgetCM();
        var oStyleBudgetCMs =$('#tblStyleBudgetCM').datagrid('getRows');
        if(oStyleBudgetCMs !=null)
        {
            DynamicRefreshList(oStyleBudgetCMs,'tblStyleBudgetCM');
            SummeryCalculation();
        }
    }


    //StyleBudgetRecap  Add, Edit & Delete Start
    function AddPO()
    {
        //debugger;
        var oStyleBudget = $('#tabStyleBudget').data('StyleBudget');
        if(parseInt(oStyleBudget.TechnicalSheetID)<=0 )
        {
            alert("Please Pick Style ");
            return;
        }
        var oOrderRecap = {
            TechnicalSheetID:parseInt(oStyleBudget.TechnicalSheetID),
            BUID:sessionStorage.getItem('BUID')
        };
        var obj = {
            BaseAddress:_sBaseAddress,
            Object: oOrderRecap,
            ControllerName: "OrderRecap",
            ActionName: "GetOrderRecaps",
            IsWinClose: false
        };
        $.icsProgressBar(true);
        $.icsDataGets(obj, function (response) {
            //debugger;
            $.icsProgressBar(false);
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].OrderRecapID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "OrderRecapNo", title: "Order No", width:200, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "UnitName", title: "Unit", width:50, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "UnitPriceInString", title: "Price", width:100, align: "right" }; tblColums.push(oColumn);
                    oColumn = { field: "TotalQuantityInString", title: "Qty", width:150, align: "right" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winRecap',
                        winclass: 'clsRecap',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblRecap',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'OrderRecapNo',
                        windowTittle: 'Recap List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }

            } else{
                alert("Data Not Found.");
                return;
            }
        });


    }
    function AddPAM()
    {
        //debugger;
        var oStyleBudget = $('#tabStyleBudget').data('StyleBudget');
        if(parseInt(oStyleBudget.TechnicalSheetID)<=0 )
        {
            alert("Please Pick Style ");
            return;
        }
        var oPAM = {
            StyleID:parseInt(oStyleBudget.TechnicalSheetID)
        };
        var obj = {
            BaseAddress:_sBaseAddress,
            Object: oPAM,
            ControllerName: "PAM",
            ActionName: "GetPAMs",
            IsWinClose: false
        };
        $.icsProgressBar(true);
        $.icsDataGets(obj, function (response) {
            //debugger;
            $.icsProgressBar(false);
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].PAMID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "PAMNo", title: "Order No", width:200, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "UnitSymbol", title: "Unit", width:50, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "TotalQuantitySt", title: "Qty", width:150, align: "right" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winPAM',
                        winclass: 'clsPAM',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblPAM',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'PAMNo',
                        windowTittle: 'PAM List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }

            } else{
                alert("Data Not Found.");
                return;
            }
        });


    }
    function DeleteStyleBudgetRecap()
    {
        var oStyleBudgetRecap = $('#tblStyleBudgetRecap').datagrid('getSelected');
        if(oStyleBudgetRecap==null)
        {
            alert("Select At least One item !");
            return;
        }
        if (!confirm("Confirm to Delete?")) return ;
        var nIndex= $('#tblStyleBudgetRecap').datagrid('getRowIndex',oStyleBudgetRecap);
        $('#tblStyleBudgetRecap').datagrid('deleteRow',nIndex);
        RefReshRecapFooter();
        SummeryCalculation();
    }
    function RefreshStyleBudgetRecap()
    {
        endEditingStyleBudgetRecap();
        var oStyleBudgetRecaps =$('#tblStyleBudgetRecap').datagrid('getRows');
        if(oStyleBudgetRecaps !=null)
        {
            DynamicRefreshList(oStyleBudgetRecaps,'tblStyleBudgetRecap');
            RefReshRecapFooter();
            SummeryCalculation();
        }
    }
    //Accessoreis End
    function SummeryCalculation()
    {
        debugger;
        //Yarn Part Start
        var oFabricDetails = $('#tblFabric').datagrid('getRows');
        var  nTotalYarnEstimatedCost = ICS_TotalCalculation(oFabricDetails,'EstimatedCost');
        $('#txtFabricCostPerDozen').val(icsFormatPrice(parseFloat(nTotalYarnEstimatedCost), null,5));
        var nFabricCostPerPcs =(parseFloat(nTotalYarnEstimatedCost)/12);
        $('#txtFabricCostPerPcs').val(icsFormatPrice(nFabricCostPerPcs, null,5));

        

        //Accessories Part start
        var oAccessoriesDetails = $('#tblAccessories').datagrid('getRows');
        var nAccessoriesCostPerDozen = ICS_TotalCalculation(oAccessoriesDetails,'EstimatedCost');
        $('#txtAccessoriesCostPerDozen').val(icsFormatPrice(parseFloat(nAccessoriesCostPerDozen), null,5));
        var nAccessoriesCostPerPcs =(parseFloat(nAccessoriesCostPerDozen)/12);
        $('#txtAccessoriesCostPerPcs').val(icsFormatPrice(nAccessoriesCostPerPcs, null,5));

        var nBuyingCommission = parseFloat(icsRemoveComma($("#txtBuyingCommission").val()));
        if(parseFloat(nBuyingCommission)>100)
        {
            alert("Buyeing Commission Should be Less than 100 %");
        }
        var nFabricCostPerDozen = parseFloat(icsRemoveComma($("#txtFabricCostPerDozen").val()));
        var nCMCost = parseFloat(icsRemoveComma($("#txtCMCostPerDozen").val()));
        var nPrintPricePerDozen  = parseFloat(icsRemoveComma($("#txtPrintPricePerDozen").val()));
        var nEmbrodaryPricePerDozen = parseFloat(icsRemoveComma($("#txtEmbrodaryPricePerDozen").val()));
        var nTestPricePerDozen    = parseFloat(icsRemoveComma($("#txtTestPricePerDozen").val()));
        var nOthersPricePerDozen  = parseFloat(icsRemoveComma($("#txtOthersPricePerDozen").val()));
        var nCourierPricePerDozen = parseFloat(icsRemoveComma($("#txtCourierPricePerDozen").val()));
        var nBankingCost = parseFloat(icsRemoveComma($("#txtBankingCost").val()));

        //debugger;
        var nTotalCostPerPcs = parseFloat(parseFloat(nFabricCostPerDozen)+parseFloat(nPrintPricePerDozen+nEmbrodaryPricePerDozen+nTestPricePerDozen+nOthersPricePerDozen+nCourierPricePerDozen)+parseFloat(nAccessoriesCostPerDozen)+ parseFloat(nCMCost))/12;
        var ntxtByiengCommissionPercentValue = parseFloat(parseFloat(nTotalCostPerPcs) * parseFloat(nBuyingCommission/parseFloat(100)));
        var nBankCommissionPercentValue = parseFloat(parseFloat(nTotalCostPerPcs) * parseFloat(parseFloat(nBankingCost)/parseFloat(100)));
        var nFOBPricePerPcs = parseFloat(nTotalCostPerPcs)  + parseFloat(ntxtByiengCommissionPercentValue) + parseFloat(nBankCommissionPercentValue);

        var nFOBPricePerDozen =(parseFloat(nFOBPricePerPcs)*12);
        $('#txtFOBPricePerDozen').val(icsFormatPrice(nFOBPricePerDozen, null,5));
        $('#txtFOBPricePerPcs').val(icsFormatPrice(nFOBPricePerPcs, null,5));

        //CurrencySet();
        // Accessoreis Part End
        RefreshFooter();
    }
    function RefreshFooter()
    {
        var oFabricDetails = $('#tblFabric').datagrid('getRows');
        var oFooterObject = {
            ProductCode:'Total:',
            DyeingCost:formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'DyeingCost')),
            LycraCost:formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'LycraCost')),
            AOPCost	:formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'AOPCost')),
            KnittingCost	: formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'KnittingCost')),
            WashCost : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'WashCost')),
            YarnDyeingCost : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'YarnDyeingCost')),
            SuedeCost  : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'SuedeCost')),
            FinishingCost : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'FinishingCost')),
            BrushingCost : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'BrushingCost')),
            FabricCost :formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'FabricCost')),
            Consumption : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'Consumption')),
            ConsumptionPerPc : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'ConsumptionPerPc')),
            CostPerPcs : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'CostPerPcs')),
            EstimatedCost : formatPrice4digit(ICS_TotalCalculation(oFabricDetails,'EstimatedCost'))
        };
        $('#tblFabric').datagrid('reloadFooter',[oFooterObject]);
    }
    function CurrencySet()
    {
        //Currency Symbol Change
        var sSymbol = parseInt($('#cboCostCurrency').val())>0?$('#cboCostCurrency option:selected').text():"";
        $('#txtFabricCostCurrency,#txtAccessoriesCostCurrency,#txtPrintCostCurrency,#txtEmbrodaryCostCurrency,#txtTestCostCurrency,#txtCourierCostCurrency,#txtOthersCostCurrency,#txtCMCostCurrency,#txtFOBPriceCurrency,#txtOfferPriceCurrency,#txtConfirmPriceCurrency').val(sSymbol);

        document.getElementById('lblMCCurrencySymbol').innerHTML= sSymbol;
        document.getElementById('lblCMCurrencySymbol').innerHTML= sSymbol;
        document.getElementById('lblFinalCMCurrencySymbol').innerHTML= sSymbol;
        document.getElementById('lblFinalCMCurrencySymbolDzn').innerHTML= sSymbol;
    }

    function StyleImage (nTSID,bIsFronImage)
    {
        //debugger;
        var oTechnicalSheet = {TechnicalSheetID:nTSID, IsFronImage:bIsFronImage};
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+  "/StyleBudget/GetStyleImageInBase64",
            traditional: true,
            data:  JSON.stringify(oTechnicalSheet),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                if(bIsFronImage == true)
                {
                    $('#imgFrontImage').attr('src', "data:image/jpg;base64," + data.base64imgage );
                }else
                {
                    $('#imgBackImage').attr('src', "data:image/jpg;base64," + data.base64imgage );
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });


        //var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
        //$http.post(_sBaseAddress+'/StyleBudget/GetStyleImageInBase64',$.param(oTechnicalSheet), config).then(
        //                    function (response)
        //                    {
        //                        if(bIsFronImage == true)
        //                        {
        //                            $('#imgFrontImage').attr('src', "data:image/jpg;base64," + response.data.base64imgage );
        //                        }else
        //                        {
        //                            $('#imgBackImage').attr('src', "data:image/jpg;base64," + response.data.base64imgage );
        //                        }
        //                    },
        //                      function (response) { alert(jQuery.parseJSON(response.data).Message);}
        //                );



    }
    function PickStyle()
    {
        var oTechnicalSheet = {
            StyleNo:$.trim($('#txtStyleNo').val()),
            BUID:sessionStorage.getItem('BUID')
        };
        var obj = {
            BaseAddress:_sBaseAddress,
            Object: oTechnicalSheet,
            ControllerName: "TechnicalSheet",
            ActionName: "StyleSearch",
            IsWinClose: false
        };
        $.icsProgressBar(true);
        $.icsDataGets(obj, function (response) {
            //debugger;
            $.icsProgressBar(false);
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].TechnicalSheetID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "StyleNo", title: "Style No", width:200, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "BuyerName", title: "Buyer", width:150, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winStyle',
                        winclass: 'clsStyle',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblStyle',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'NameCode',
                        windowTittle: 'Style List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }

            } else{
                alert("Data Not Found.");
                return;
            }
        });

    }
    $('#txtStyleNo').keydown(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)
        {
            if($("#txtStyleNo").val()!="")
            {
                PickStyle();
            }
        }else if (code == 8) //backspace=8
        {
            //debugger;
            $("#txtStyleNo").val('');
            $("#txtStyleNo").removeClass('fontColorOfPickItem');
            $('#tabStyleBudget').data('StyleBudget').TechnicalSheetID=  0;
            $("#txtBuyerName").val( '');
            $("#txtKnittingPatternName").val('');

            $("#txtGG").val('');
            $("#txtSizeRange").val('');
            $("#txtColorRange").val( '');
            $("#txtStyleDescription").val('');
            $("#cboCountUnit").val(0);
            StyleImage(0,true);
            StyleImage(0,false);
        }
    });
    function LoadExistCostingInfo(nTechnicalSheetID)
    {
        var oTechnicalSheet = {TechnicalSheetID:nTechnicalSheetID};
        $.ajax ({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/StyleBudget/LoadCostingInfo",
            data:  JSON.stringify(oTechnicalSheet),
            contentType: "application/json; charset=utf-8",
            success: function (data) {

                var oStyleBudget=jQuery.parseJSON(response.data);
                if(oStyleBudget!=null && oStyleBudget.TechnicalSheetID>0)
                {

                    $('#tabStyleBudget').data('StyleBudget',oStyleBudget);
                    DynamicRefreshList(oStyleBudget.StyleBudgetYarnDetails,'tblFabric');
                    DynamicRefreshList(oStyleBudget.StyleBudgetAccessoriesDetails,'tblAccessories');


                    $('#tabStyleBudget').data('StyleBudgetYarnDetails',oStyleBudget.StyleBudgetYarnDetails);
                    $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails',oStyleBudget.StyleBudgetAccessoriesDetails);


                }else
                {
                    alert(oStyleBudget.ErrorMessage);return;
                }

            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });


    }

    $('#txtMerchandiserName').keydown(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)
        {

            if($.trim($('#txtMerchandiserName').val())!="")
            {
                var oEmployee = {Name:$('#txtMerchandiserName').val()};


                var obj = {
                    BaseAddress: _sBaseAddress,
                    Object: oEmployee,
                    ControllerName: "StyleBudget",
                    ActionName: "GetEmployees",
                    IsWinClose: false
                };
                $.icsDataGets(obj, function (response) {
                    //debugger;
                    if (response.status && response.objs.length > 0) {
                        if (response.objs[0].EmployeeID > 0) {
                            var tblColums = [];
                            var oColumn = { field: 'Code', title: 'Code',width:200, align: "left"  };tblColums.push(oColumn);
                            oColumn = { field: 'Name', title: 'Employee',width:200, align: "left" };tblColums.push(oColumn);

                            var oPickerParam = {
                                winid: 'winMerchandiser',
                                winclass: 'clsMerchandiser',
                                winwidth: 600,
                                winheight: 460,
                                tableid: 'tblMerchandiser',
                                tablecolumns: tblColums,
                                datalist: response.objs,
                                multiplereturn: false,
                                searchingbyfieldName: 'Name',
                                windowTittle: 'Merchandiser List'
                            };
                            $.icsPicker(oPickerParam);
                            IntializePickerbutton(oPickerParam);
                        }
                        else {
                            alert(response.objs[0].ErrorMessage);
                        }

                    } else{
                        alert("Data Not Found.");
                        return;
                    }
                });


            }
        }else if (code == 8) //backspace=8
        {
            //debugger;
            $('#tabStyleBudget').data('StyleBudget').MerchandiserID = 0;
            $("#txtMerchandiserName").val('');
            $("#txtMerchandiserName").removeClass('fontColorOfPickItem');
        }
    });
    $('#txtFabricName').keydown(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)
        {
            debugger;
            if($.trim($("#txtFabricName").val())!="")
            {
                var oProduct = {
                    ProductName:$.trim($("#txtFabricName").val()),
                    ModuleNameInInt:108,//EnumModuleName : StyleBudget =108
                    ProductUsagesInInt:5,//EnumProductUsages : Yarn/fabric = 5
                    BUID:sessionStorage.getItem('BUID')
                };

                $.icsProgressBar(true);
                var obj = {
                    BaseAddress: _sBaseAddress,
                    Object: oProduct,
                    ControllerName: "Product",
                    ActionName: "GetProductsByBUModuleWithProductUse",
                    IsWinClose: false
                };
                $.icsDataGets(obj, function (response) {
                    //debugger;
                    $.icsProgressBar(false);
                    if (response.status && response.objs.length > 0)
                    {
                        if (response.objs[0].ProductID > 0) {
                            var tblColums = [];
                            var oColumn = { field: 'ProductCode', title: 'Code', width: 100, align: "left"  };tblColums.push(oColumn);
                            oColumn = { field: 'ProductName', title: 'Product', width: 300, align: "left"  };tblColums.push(oColumn);
                            var oPickerParam = {
                                winid: 'winProductPicker',
                                winclass: 'clsProductPicker',
                                winwidth: 600,
                                winheight: 460,
                                tableid: 'tblProductPicker',
                                tablecolumns: tblColums,
                                datalist: response.objs,
                                multiplereturn: false,
                                searchingbyfieldName: 'ProductName',
                                windowTittle: 'Product List'
                            };
                            $.icsPicker(oPickerParam);
                            IntializePickerbutton(oPickerParam);
                        }
                        else {
                            alert(response.objs[0].ErrorMessage);
                        }

                    } else{
                        alert("Data Not Found.");
                        return;
                    }
                });

            }else if (code == 8) //backspace=8
            {
                //debugger;
                $('#divCS').data('StyleBudgetDetail',null);

                $("#txtFabricName").removeClass('fontColorOfPickItem');
                LoadUnits(0,true);
            }
        }
    });
    $('#txtAccessoriesName').keydown(function (e)
    {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)
        {
            if($.trim($("#txtAccessoriesName").val())!="")
            {
                PickProduct();
            }
        }else if (code == 8) //backspace=8
        {
            //debugger;
            $('#divCS').data('AccessoriesDetail',null);
            $("#txtAccessoriesName").removeClass('fontColorOfPickItem');
            LoadUnits(0,false);
        }
    });
    function PickProduct()
    {
        var oProduct = {
            ProductName:$.trim($("#txtAccessoriesName").val()),
            ModuleNameInInt:108,//EnumModuleName : StyleBudget =108
            ProductUsagesInInt:6,//EnumProductUsages : Accessoreis = 5
            BUID:sessionStorage.getItem('BUID')
        };
        $.icsProgressBar(true);
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oProduct,
            ControllerName: "Product",
            ActionName: "GetProductsByBUModuleWithProductUse",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {
            //debugger;
            $.icsProgressBar(false);
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ProductID > 0) {
                    var tblColums = [];
                    var oColumn = { field: 'ProductCode', title: 'Code', width: 100, align: "left"  };tblColums.push(oColumn);
                    oColumn = { field: 'ProductName', title: 'Product', width: 300, align: "left"  };tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winAccessoriesPicker',
                        winclass: 'clsAccessoriesPicker',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblAccessoriesPicker',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'ProductName',
                        windowTittle: 'Accessories List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }

            } else{
                alert("Data Not Found.");
                return;
            }
        });

    }
    function LoadUnits(nUnitType,bIsYarnUnit)
    {
        //debugger;
        if(bIsYarnUnit)
        {
            $("#cboYarnUnit").icsLoadCombo({List: [],OptionValue: "MeasurementUnitID",DisplayText: "Symbol"});
        }else{

            $("#cboACUnit").icsLoadCombo({List: [],OptionValue: "MeasurementUnitID",DisplayText: "Symbol"});
        }
        if (parseInt(nUnitType)>0)
        {
            var oMeasurementUnit = {UnitTypeInInt:nUnitType};

            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/MeasurementUnit/GetbyUnitType",
                traditional: true,
                data:  JSON.stringify(oMeasurementUnit),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var oMeasurementUnits=jQuery.parseJSON(data);
                    if(oMeasurementUnits.length>0)
                    {
                        if(bIsYarnUnit==true){
                            $("#cboYarnUnit").icsLoadCombo({List:oMeasurementUnits,OptionValue: "MeasurementUnitID",DisplayText: "Symbol"});
                        }
                        else{$("#cboACUnit").icsLoadCombo({List: oMeasurementUnits,OptionValue: "MeasurementUnitID",DisplayText: "Symbol"});}
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

        }
    }

    function IntializePickerbutton(oPickerobj) {
        //debugger;
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            debugger;
            //for Single Select
            SetPickerValueAssign(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which == 13)//enter=13
            {
                SetPickerValueAssign(oPickerobj);
            }
        });
    }
    function SetPickerValueAssign(oPickerobj)
    {
        var oreturnObj = null, oreturnobjs = [];
        if (oPickerobj.multiplereturn)
        {
            oreturnobjs = $('#'+oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
        }
        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();
        if (oPickerobj.winid == 'winStyle')
        {
            if (oreturnObj != null && oreturnObj.TechnicalSheetID> 0)
            {
                //debugger;
                $("#txtStyleNo").val(oreturnObj.StyleNo);
                $('#tabStyleBudget').data('StyleBudget').TechnicalSheetID=  oreturnObj.TechnicalSheetID;
                $("#txtBuyerName").val( oreturnObj.BuyerName);
                $("#txtKnittingPatternName").val( oreturnObj.KnittingPatternName);
                $('#txtApproxQty').val(icsFormatPrice(parseFloat(oreturnObj.ApproxQty), null,0));
                $("#txtGG").val( oreturnObj.GG);
                $("#txtSizeRange").val(oreturnObj.SizeRange);
                $("#txtColorRange").val( oreturnObj.ColorRange);
                $("#txtStyleDescription").val( oreturnObj.StyleDescription);
                $("#txtFabricDescription").val( oreturnObj.FabricDescription);
                $("#cboCountUnit").val( oreturnObj.MeasurementUnitID);
                $("#txtMerchandiserName").val( oreturnObj.MerchandiserName);
                $('#tabStyleBudget').data('StyleBudget').MerchandiserID=  oreturnObj.MerchandiserID;
                $("#txtStyleNo,#txtMerchandiserName").addClass('fontColorOfPickItem');
                if(parseFloat(oreturnObj.ApproxQty)>0)
                {
                    DynamicRefreshList([],'tblStyleBudgetCM');
                    AddStyleBudgetCM();//Add
                }
               
                StyleImage($('#tabStyleBudget').data('StyleBudget').TechnicalSheetID,true);
                StyleImage($('#tabStyleBudget').data('StyleBudget').TechnicalSheetID,false);
                $('#txtStyleNo').focus();
            }
        }else   if (oPickerobj.winid == 'winMerchandiser')
        {
            if(parseInt(oreturnObj.EmployeeID)>0)
            {
                $('#tabStyleBudget').data('StyleBudget').MerchandiserID = oreturnObj.EmployeeID;
                $("#txtMerchandiserName").val( oreturnObj.Name);
                $("#txtMerchandiserName").addClass('fontColorOfPickItem');
            }
        }else   if (oPickerobj.winid == 'winProductPicker')
        {
            if(parseInt(oreturnObj.ProductID)>0)
            {

                $("#txtFabricName").val( oreturnObj.ProductName);
                $("#txtFabricName").addClass('fontColorOfPickItem');
                var oStyleBudgetDetail = {
                    StyleBudgetDetailID:0,
                    StyleBudgetID: $('#tabStyleBudget').data('StyleBudget').StyleBudgetID,
                    MaterialTypeInInt: 1, // 1 = yarn : 2 = Accessories
                    MaterialID:oreturnObj.ProductID,
                    ProductCode :oreturnObj.ProductCode,
                    ProductName :oreturnObj.ProductName,
                    Sequence:parseInt($('#tblFabric').datagrid('getRows').length)+1,
                    Description : "",
                    Width:"",
                    UnitName:'',
                    Consumption:0,
                    MaterialMarketPrice : 0,
                    DyeingCost: 0,
                    LycraCost: 0,
                    AOPCost:0,
                    KnittingCost:0,
                    WashCost:0,
                    YarnDyeingCost:0,
                    SuedeCost:0,
                    FinishingCost:0,
                    BrushingCost:0,
                    FabricCost:0,
                    ConsumptionPerPc:0,
                    CostPerPcs:0,
                    EstimatedCost :0,
                    EstimatedCostPerPc:0
                };

                $('#divCS').data('StyleBudgetDetail',oStyleBudgetDetail);
                LoadUnits(oreturnObj.UnitType,true);
                $('#txtFabricName').focus();
            }
        }else   if (oPickerobj.winid == 'winAccessoriesPicker')
        {
            if(parseInt(oreturnObj.ProductID)>0)
            {
                $("#txtAccessoriesName").val( oreturnObj.ProductName);
                $("#txtAccessoriesName").addClass('fontColorOfPickItem');
                var oAccessoriesDetail = {
                    StyleBudgetDetailID:0,
                    StyleBudgetID: $('#tabStyleBudget').data('StyleBudget').StyleBudgetID,
                    MaterialTypeInInt: 2, // 1 = yarn : 2 = Accessories
                    MaterialID:oreturnObj.ProductID,
                    ProductCode :oreturnObj.ProductCode,
                    ProductName :oreturnObj.ProductName,
                    Sequence: parseInt($('#tblAccessories').datagrid('getRows').length)+1,
                    Description:"",
                    Width : "",
                    RateUnit:1,
                    Consumption : 0,
                    UnitID:0,
                    UnitName :'',
                    UsePercentage:0,
                    MaterialMarketPrice:0,
                    EstimatedCost :0,
                    EstimatedCostInString:'0.0/Dozen'
                };
                $('#divCS').data('AccessoriesDetail',oAccessoriesDetail);
                LoadUnits(oreturnObj.UnitType,false);
                $('#txtAccessoriesName').focus();
            }
        }else if (oPickerobj.winid == 'winRecap')
        {
            if(oreturnobjs!=null && oreturnobjs.length>0)
            {
                for(var i =0;i<oreturnobjs.length;i++)
                {
                    if(!ICS_IsExistForTwoProperty($('#tblStyleBudgetRecap').datagrid('getRows'),'RefID',oreturnobjs[i].OrderRecapID,'RefType',2))
                    {
                        var oStyleBudgetRecap ={
                            StyleBudgetRecapID :0,
                            StyleBudgetID  :$('#tabStyleBudget').data('StyleBudget').StyleBudgetID,
                            RefID:oreturnobjs[i].OrderRecapID,
                            Note:oreturnobjs[i].Note,
                            RefNo :oreturnobjs[i].OrderRecapNo,
                            RefType:2,
                            RefTypeSt:'OrderRecap',
                            UnitPrice :oreturnobjs[i].UnitPrice,
                            UnitPriceSt :formatPrice(oreturnobjs[i].UnitPrice),
                            Quantity :oreturnobjs[i].TotalQuantity,
                            Amount :oreturnobjs[i].Amount,
                            UnitSymbol :oreturnobjs[i].UnitName
                        };
                        $('#tblStyleBudgetRecap').datagrid('appendRow',oStyleBudgetRecap);
                    }
                }
            }
            RefReshRecapFooter();
            SummeryCalculation();
            $('#btnAddPO').focus();
        }else if (oPickerobj.winid == 'winPAM')
        {
            if(oreturnobjs!=null && oreturnobjs.length>0)
            {
                for(var i =0;i<oreturnobjs.length;i++)
                {
                    if(!ICS_IsExistForTwoProperty($('#tblStyleBudgetRecap').datagrid('getRows'),'RefID',oreturnobjs[i].PAMID,'RefType',1))
                    {
                        var oStyleBudgetRecap ={
                            StyleBudgetRecapID :0,
                            StyleBudgetID  :$('#tabStyleBudget').data('StyleBudget').StyleBudgetID,
                            RefID:oreturnobjs[i].PAMID,
                            Note:oreturnobjs[i].Note,
                            RefNo :oreturnobjs[i].PAMNo,
                            RefType:1,
                            RefTypeSt:'PAM',
                            UnitPrice :0,// oreturnobjs[i].UnitPrice,
                            UnitPriceSt :'',//formatPrice(oreturnobjs[i].UnitPrice),
                            Quantity :oreturnobjs[i].TotalQuantity,
                            Amount :0,//oreturnobjs[i].Amount,
                            UnitSymbol :oreturnobjs[i].UnitSymbol
                        };
                        $('#tblStyleBudgetRecap').datagrid('appendRow',oStyleBudgetRecap);
                    }
                }
            }
        
            RefReshRecapFooter();
            SummeryCalculation();
            $('#btnAddPO').focus();
        }
    }

    function YarnUP()
    {
        //debugger;
        var oTempStyleBudgetFabricDetails =  $('#tblFabric').datagrid('getRows');
        var oStyleBudgetDetail = $('#tblFabric').datagrid('getSelected');
        if(oStyleBudgetDetail==null || parseInt(oStyleBudgetDetail.MaterialID)<=0)
        {
            alert("Please select Budget");
            return;
        }
        var SelectedRowIndex=$('#tblFabric').datagrid('getRowIndex',oStyleBudgetDetail);
        if(SelectedRowIndex==0)return;
        var oStyleBudgetYarnDetails=[];
        oStyleBudgetYarnDetail=oTempStyleBudgetFabricDetails;
        oTempStyleBudgetFabricDetails=[];
        for(var i=0; i<oStyleBudgetYarnDetail.length; i++)
        {
            if(i==(SelectedRowIndex-1))
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i+1];
            }
            else if(i==SelectedRowIndex)
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i-1];
            }
            else
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i];
            }
            oTempStyleBudgetFabricDetails[i].Sequence=i+1;
        }
        $('#tabStyleBudget').data('StyleBudgetYarnDetails',oTempStyleBudgetFabricDetails);
        data = oTempStyleBudgetFabricDetails;
        data={"total":""+data.length+"","rows":data};
        $('#tblFabric').datagrid('loadData',data);
        var newSelectedRowIndex=SelectedRowIndex-1;
        $('#tblFabric').datagrid('selectRow',newSelectedRowIndex);
    }
    function YarnDown()
    {
        //debugger;
        var oTempStyleBudgetFabricDetails =  $('#tblFabric').datagrid('getRows');
        var oStyleBudgetDetail = $('#tblFabric').datagrid('getSelected');
        if(oStyleBudgetDetail==null || parseInt(oStyleBudgetDetail.MaterialID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblFabric').datagrid('getRowIndex',oStyleBudgetDetail);
        if(SelectedRowIndex==(oTempStyleBudgetFabricDetails.length-1))return;
        var oStyleBudgetYarnDetail=[];
        oStyleBudgetYarnDetail=oTempStyleBudgetFabricDetails;
        oTempStyleBudgetFabricDetails=[];
        for(var i=0; i<oStyleBudgetYarnDetail.length; i++)
        {
            if(i==(SelectedRowIndex+1))
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i-1];
            }
            else if(i==SelectedRowIndex)
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i+1];
            }
            else
            {
                oTempStyleBudgetFabricDetails[i]=oStyleBudgetYarnDetail[i];
            }
            oTempStyleBudgetFabricDetails[i].Sequence=i+1;
        }
        $('#tabStyleBudget').data('StyleBudgetYarnDetails',oTempStyleBudgetFabricDetails);
        data = oTempStyleBudgetFabricDetails;
        data={"total":""+data.length+"","rows":data};
        $('#tblFabric').datagrid('loadData',data);
        var newSelectedRowIndex=SelectedRowIndex+1;
        $('#tblFabric').datagrid('selectRow',newSelectedRowIndex);

    }
    function AccessoriesUP()
    {
        //debugger;
        var oTempStyleBudgetAccessoriesDetails = $('#tblAccessories').datagrid('getRows');
        var oStyleBudgetDetail = $('#tblAccessories').datagrid('getSelected');
        if(oStyleBudgetDetail==null || parseInt(oStyleBudgetDetail.MaterialID)<=0)
        {
            alert("Please select Budget");
            return;
        }
        var SelectedRowIndex=$('#tblAccessories').datagrid('getRowIndex',oStyleBudgetDetail);
        if(SelectedRowIndex==0)return;
        var oStyleBudgetAccessoriesDetails=[];
        oStyleBudgetAccessoriesDetails= oTempStyleBudgetAccessoriesDetails;
        oTempStyleBudgetAccessoriesDetails=[];
        for(var i=0; i<oStyleBudgetAccessoriesDetails.length; i++)
        {
            if(i==(SelectedRowIndex-1))
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i+1];
            }
            else if(i==SelectedRowIndex)
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i-1];
            }
            else
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i];
            }
            oTempStyleBudgetAccessoriesDetails[i].Sequence=i+1;
        }
        $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails',oTempStyleBudgetAccessoriesDetails);
        data = oTempStyleBudgetAccessoriesDetails;
        data={"total":""+data.length+"","rows":data};
        $('#tblAccessories').datagrid('loadData',data);
        var newSelectedRowIndex=SelectedRowIndex-1;
        $('#tblAccessories').datagrid('selectRow',newSelectedRowIndex);

    }
    function AccessoriesDown()
    {
        //debugger;
        var oTempStyleBudgetAccessoriesDetails = $('#tblAccessories').datagrid('getRows');
        var oStyleBudgetDetail = $('#tblAccessories').datagrid('getSelected');
        if(oStyleBudgetDetail==null || parseInt(oStyleBudgetDetail.MaterialID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var SelectedRowIndex=$('#tblAccessories').datagrid('getRowIndex',oStyleBudgetDetail);
        if(SelectedRowIndex==(oTempStyleBudgetAccessoriesDetails.length-1))return;
        var oStyleBudgetAccessoriesDetails=[];
        oStyleBudgetAccessoriesDetails=oTempStyleBudgetAccessoriesDetails;
        oTempStyleBudgetAccessoriesDetails=[];
        for(var i=0; i<oStyleBudgetAccessoriesDetails.length; i++)
        {
            if(i==(SelectedRowIndex+1))
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i-1];
            }
            else if(i==SelectedRowIndex)
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i+1];
            }
            else
            {
                oTempStyleBudgetAccessoriesDetails[i]=oStyleBudgetAccessoriesDetails[i];
            }
            oTempStyleBudgetAccessoriesDetails[i].Sequence=i+1;
        }
        $('#tabStyleBudget').data('StyleBudgetAccessoriesDetails',oTempStyleBudgetAccessoriesDetails);
        data = oTempStyleBudgetAccessoriesDetails;
        data={"total":""+data.length+"","rows":data};
        $('#tblAccessories').datagrid('loadData',data);
        var newSelectedRowIndex=SelectedRowIndex+1;
        $('#tblAccessories').datagrid('selectRow',newSelectedRowIndex);
    }


    function Save()
    {
        //debugger;
        endEditingYarn();
        endEditingAccessories();
        endEditingStyleBudgetCM();
        endEditingStyleBudgetRecap();
        if(!ValidateInput()) return;
        var oStyleBudget = StyleBudgetRefreshObject();
        var sActionName = "Save";
        if(sessionStorage.getItem("StyleBudgetHeader")=="Budget Revise")
        {
            sActionName = "AcceptStyleBudgetRevise";
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/StyleBudget/"+sActionName,
            traditional: true,
            data:  JSON.stringify(oStyleBudget),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                //debugger;
                var oStyleBudget= jQuery.parseJSON(data);
                if (oStyleBudget.ErrorMessage=="" || oStyleBudget.ErrorMessage==null)
                {
                    alert("Data Save Successfully!!");
                    var oStyleBudgets =sessionStorage.getItem("StyleBudgets");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    if (oStyleBudgets != null)
                    {
                        oStyleBudgets = jQuery.parseJSON(oStyleBudgets);
                    }
                    else {
                        oStyleBudgets = [];
                    }
                    if (nIndex != -1)
                    {
                        oStyleBudgets[nIndex] = oStyleBudget;
                    }
                    else {
                        sessionStorage.setItem("SelectedRowIndex", oStyleBudgets.length);
                        oStyleBudgets.push(oStyleBudget);
                    }
                    sessionStorage.setItem("StyleBudgets", JSON.stringify(oStyleBudgets));
                    window.location.href = sessionStorage.getItem("BackLink");
                }
                else
                {
                    alert(oStyleBudget.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });

    }
    function Approve ()
    {
        if(!ValidateInput()) return;
        var oStyleBudget=StyleBudgetRefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url : _sBaseAddress+"/StyleBudget/Approve",
            traditional: true,
            data:  JSON.stringify(oStyleBudget),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                //debugger;
                var oStyleBudget= jQuery.parseJSON(data);
                if (oStyleBudget.ErrorMessage=="" || oStyleBudget.ErrorMessage==null)
                {
                    alert("Successfully Approved ");
                    var oStyleBudgets = $('#tabStyleBudget').data('StyleBudgetType')==1?sessionStorage.getItem("StyleBudgets"):sessionStorage.getItem("Budgets");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    if (oStyleBudgets != null) {
                        oStyleBudgets = jQuery.parseJSON(oStyleBudgets);
                    }
                    else {
                        oStyleBudgets = [];
                    }
                    if (nIndex != -1) {
                        oStyleBudgets[nIndex] = oStyleBudget;
                    }
                    else {
                        sessionStorage.setItem("SelectedRowIndex", oStyleBudgets.length);
                        oStyleBudgets.push(oStyleBudget);
                    }
                    if($('#tabStyleBudget').data('StyleBudgetType')==1){sessionStorage.setItem("StyleBudgets", JSON.stringify(oStyleBudgets));}else{sessionStorage.setItem("Budgets", JSON.stringify(oStyleBudgets));}
                    window.location.href = sessionStorage.getItem("BackLink");
                }
                else
                {
                    alert(oStyleBudget.ErrorMessage);
                }
            },
            error: function (xhr, status, error)
            {
                alert(error);
            }
        });
    }
    function ValidateInput ()
    {
        //debugger;
        var oStyleBudget =  $('#tabStyleBudget').data('StyleBudget');
        if(parseInt(oStyleBudget.TechnicalSheetID) <=0) { alert("Please Pick Style!"); return false; }
        var nApproxQty = parseFloat(icsRemoveComma($("#txtApproxQty").val()));
        if(parseFloat(nApproxQty)<=0) { alert("Approximat Quantity Should be Greater than 0"); return false; }
        var oBudgetRecaps =  $('#tblStyleBudgetRecap').datagrid('getRows');
        var nTotalRecapQty = ICS_TotalCalculation(oBudgetRecaps,'Quantity');
        if(parseInt(nApproxQty)!=parseInt(nTotalRecapQty))
        {
            alert("Recap Qty & Approximate Qty Should be Equal."); $("#txtApproxQty").focus(); return false;
        }
        if(parseInt($("#cboCountUnit").val()) ==0) { alert("Please select Unit of Approximat Qty"); return false; }
        if(parseInt($("#cboCostCurrency").val())==0) { alert("Please select Currency"); return false; }
        if(parseInt(oStyleBudget.MerchandiserID)<=0) { alert("Please Pick Merchandiser"); return false; }
        //if(parseFloat($scope.StyleBudget.ProductionCostPerDozen) <=0) { alert("Print/Emb/Others Cost Should be Greater than 0"); return false; }

        var oFabricDetails = $('#tblFabric').datagrid('getRows');
        if(oFabricDetails.length <=0){alert("Please Add at least single Yarn");  return false;}
        for(var i = 0;i<oFabricDetails.length;i++)
        {
            if(parseFloat(oFabricDetails[i].MaterialMarketPrice)<=0)
            {
                alert("Product Price Should be Greater than 0 for "+oFabricDetails[i].ProductName);
                $('#tblFabric').focus();
                return false;
            }
        }

        var oAccessoriesDetails =$('#tblAccessories').datagrid('getRows');
        if(oAccessoriesDetails.length <=0){alert("Please Add at least single Accessories");  return false;}
        for(var i = 0;i<oAccessoriesDetails.length;i++)
        {
            if(parseFloat(oAccessoriesDetails[i].EstimatedCost)<=0)
            {
                alert("Product Estimated Cost Should be Greater than 0 for "+oAccessoriesDetails[i].ProductName);
                $('#tblAccessories').focus();
                return false;
            }
        }
        var oStyleBudgetCMs = $('#tblStyleBudgetCM').datagrid('getRows');
        if(oStyleBudgetCMs.length>0)
        {
            for(var i=0;i<oStyleBudgetCMs.length;i++)
            {
                if(parseFloat(oStyleBudgetCMs[i].CMPerDozen)<=0)
                {
                    alert("CM Should be Greater than 0 in CM Part Calculation.");
                    $('#tblStyleBudgetCM').focus();
                    return false;
                }
            }
        }

        return true;
    }
    function StyleBudgetRefreshObject ()
    {
        //debugger;

        var oStyleBudget = {
            StyleBudgetID: $('#tabStyleBudget').data('StyleBudget').StyleBudgetID,
            StyleBudgetTypeInInt:$('#tabStyleBudget').data('StyleBudgetType'),
            StyleBudgetType:$('#tabStyleBudget').data('StyleBudgetType'),
            BUID:sessionStorage.getItem('BUID'),
            BudgetTitle:$('#txtBudgetTitle').val(),
            CostSheetID: $('#tabStyleBudget').data('RefCostSheetID'),
            TechnicalSheetID: $('#tabStyleBudget').data('StyleBudget').TechnicalSheetID,
            MerchandiserID: $('#tabStyleBudget').data('StyleBudget').MerchandiserID,
            StatusInInt:$('#tabStyleBudget').data('StyleBudget').StatusInInt,
            CostingDate :$('#txtCostingDateInString').datebox('getValue'),
            ShipmentDate :$('#txtShipmentDateInString').datebox('getValue'),
            ApproxQty:parseFloat(icsRemoveComma($("#txtApproxQty").val())),
            UnitID:parseInt($("#cboCountUnit").val()),
            GG:$("#txtGG").val(),
            FabricDescription:$("#txtFabricDescription").val(),
            StyleDescription:$("#txtStyleDescription").val(),
            CurrencyID:parseInt($("#cboCostCurrency").val()),
            StyleBudgetType:$('#tabStyleBudget').data('StyleBudgetType'),
            FabricUnitPrice:ICS_TotalCalculation($('#tblFabric').datagrid('getRows'),'EstimatedCost'),
            FabricCostPerDozen:parseFloat(icsRemoveComma($("#txtFabricCostPerDozen").val())),
            AccessoriesCostPerDozen:parseFloat(icsRemoveComma($("#txtAccessoriesCostPerDozen").val())),
            PrintPricePerPcs:parseFloat(icsRemoveComma($("#txtPrintCostPerPcs").val())),
            EmbrodaryPricePerPcs:parseFloat(icsRemoveComma($("#txtEmbrodaryCostPerPcs").val())),
            TestPricePerPcs:parseFloat(icsRemoveComma($("#txtTestCostPerPcs").val())),
            OthersPricePerPcs:parseFloat(icsRemoveComma($("#txtOthersCostPerPcs").val())),
            CourierPricePerPcs:parseFloat(icsRemoveComma($("#txtCourierCostPerPcs").val())),
            OthersCaption: $('#txtOthersCaption').val(),
            CourierCaption: $('#txtCourierCaption').val(),
            CMCost:parseFloat(icsRemoveComma($("#txtCMCostPerDozen").val())),
            BuyingCommission:parseFloat(icsRemoveComma($("#txtBuyingCommission").val())),
            BankingCost:parseFloat(icsRemoveComma($("#txtBankingCost").val())),
            FOBPricePerPcs:parseFloat(icsRemoveComma($("#txtFOBPricePerPcs").val())),
            OfferPricePerPcs:parseFloat(icsRemoveComma($("#txtOfferPricePerPcs").val())),
            ConfirmPricePerPcs:parseFloat(icsRemoveComma($("#txtConfirmPricePerPcs").val())),

            FabricCostPerPcs	:	parseFloat(icsRemoveComma($("#txtFabricCostPerPcs").val())),
            AccessoriesCostPerPcs	:	parseFloat(icsRemoveComma($("#txtAccessoriesCostPerPcs").val())),
            CMCostPerPcs	:	parseFloat(icsRemoveComma($("#txtCMCostPerPcs").val())),
            FOBPricePerDozen	:	parseFloat(icsRemoveComma($("#txtFOBPricePerDozen").val())),
            OfferPricePerDozen	:	parseFloat(icsRemoveComma($("#txtOfferPricePerDozen").val())),
            ConfirmPricePerDozen	:	parseFloat(icsRemoveComma($("#txtConfirmPricePerDozen").val())),
            PrintPricePerDozen	:	parseFloat(icsRemoveComma($("#txtPrintPricePerDozen").val())),
            EmbrodaryPricePerDozen	:	parseFloat(icsRemoveComma($("#txtEmbrodaryPricePerDozen").val())),
            TestPricePerDozen	:	parseFloat(icsRemoveComma($("#txtTestPricePerDozen").val())),
            OthersPricePerDozen	:	parseFloat(icsRemoveComma($("#txtOthersPricePerDozen").val())),
            CourierPricePerDozen	:	parseFloat(icsRemoveComma($("#txtCourierPricePerDozen").val())),

            RefObjectID: $('#tabStyleBudget').data('StyleBudget').RefObjectID,
            StyleBudgetYarnDetails:$('#tblFabric').datagrid('getRows'),
            StyleBudgetAccessoriesDetails:$('#tblAccessories').datagrid('getRows'),
            StyleBudgetCMs:$('#tblStyleBudgetCM').datagrid('getRows'),
            StyleBudgetRecaps:$('#tblStyleBudgetRecap').datagrid('getRows')

        };

        return oStyleBudget;
    }


    $('#txtPrintPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtEmbrodaryPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtPrintCostPerPcs').focus();return;
        }
    });
    $('#txtEmbrodaryPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtTestPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtEmbrodaryCostPerPcs').focus();return;
        }
    });
    $('#txtTestPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtCourierPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtTestCostPerPcs').focus();return;
        }
    });
    $('#txtCourierPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtOthersPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtCourierCostPerPcs').focus();return;
        }
    });
    $('#txtOthersPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtCMCostPerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtOthersCostPerPcs').focus();return;
        }
    });

    $('#txtCMCostPerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtBuyingCommission').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtCMCostPerPcs').focus();return;
        }
    });
    $('#txtBuyingCommission').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtBankingCost').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtBuyingCommission').focus();return;
        }
    });
    $('#txtBankingCost').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtOfferPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtFOBPricePerPcs').focus();return;
        }
    });
    $('#txtOfferPricePerDozen,#txtConfirmPricePerDozen').keydown(function (e)
    {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13)//enter of tab
        {
            $('#txtConfirmPricePerDozen').focus();return;
        }
        if (code === 9)//enter of tab
        {
            $('#txtOfferPricePerPcs').focus();return;
        }
    });

    function Close()
    {
        if(sessionStorage.getItem("BackLink")==null || sessionStorage.getItem("BackLink")=="")
        {
            window.close();
        }else{
            window.location.href = sessionStorage.getItem("BackLink");
        }
    };

</script>
