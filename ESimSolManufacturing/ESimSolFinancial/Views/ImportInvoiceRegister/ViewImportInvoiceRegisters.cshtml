<html>
@{
    ViewBag.Title = "Import Invoice Registers";
}
<body>
    @model ESimSol.BusinessObjects.ImportInvoiceRegister
    <div id="progbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progbar" style="width:100%;height:37px;"></div>
        </div>
    </div>
    <div class="menuMainCollectionTable">
        <div class="easyui-panel" title="Import Invoice Registers" style="font-family:Tahoma; text-align:center; height:88%;">
            <fieldset style="height:95%; text-align:center;">
                <legend style="font-weight:bold"> Serching Criteria   : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold; text-align:center; width:100%">
                    <tr>
                        <td colspan="5" style="height:20px;"></td>                        
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right">Invoice No :</td>
                        <td style="width:30%;text-align:left"> 
                            <input type="text" style="width:100%" id="txtInvoiceNo" />
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right"> Invoice Date :</td>
                        <td style="width:38%;text-align:right">
                            <table border="0" cellpadding="1" cellspacing="1" width="100%">
                                <tr>
                                    <td style="width:30%; text-align:center">
                                        <select id="cboInvoiceIssueDate" style="width:100%"> </select>
                                    </td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceIssueDateStart" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                    <td style="width:10%; text-align:center">to</td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceIssueDateEnd" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                </tr>
                            </table> 
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right"> Supplier :</td>
                        <td style="width:30%;text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:70%; text-align:left">
                                        <input type="text" style="width:98%" id="txtSupplier" placeholder="Press enter with supplier name" />
                                    </td>
                                    <td style="width:30%; text-align:right">
                                        <input type="button" value="C" style="width:30%" id="btnClearSupplier" />
                                        <input type="button" value="Pick" style="width:65%" id="btnPickSupplier" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right"> Acceptance Date:</td>
                        <td style="width:38%;text-align:right">
                            <table border="0" cellpadding="1" cellspacing="1" width="100%">
                                <tr>
                                    <td style="width:30%; text-align:center">
                                        <select id="cboInvoiceAcceptanceDate" style="width:100%"> </select>
                                    </td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceAcceptanceDateStart" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                    <td style="width:10%; text-align:center">to</td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceAcceptanceDateEnd" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right"> Product :</td>
                        <td style="width:30%;text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:70%; text-align:left">
                                        <input type="text" style="width:98%" id="txtProduct" placeholder="Press enter with product name" />
                                    </td>
                                    <td style="width:30%; text-align:right">
                                        <input type="button" value="C" style="width:30%" id="btnClearProduct" />
                                        <input type="button" value="Pick" style="width:65%" id="btnPickProduct" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right"> Application Date:</td>
                        <td style="width:38%;text-align:right">
                            <table border="0" cellpadding="1" cellspacing="1" width="100%">
                                <tr>
                                    <td style="width:30%; text-align:center">
                                        <select id="cboDateofApplication" style="width:100%"> </select>
                                    </td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtDateofApplicationStart" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                    <td style="width:10%; text-align:center">to</td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtDateofApplicationEnd" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right"> Maturity Date :</td>
                        <td style="width:30%;text-align:left">
                            <table border="0" cellpadding="1" cellspacing="1" width="100%">
                                <tr>
                                    <td style="width:30%; text-align:center">
                                        <select id="cboDateofMaturity" style="width:100%"> </select>
                                    </td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtDateofMaturityStart" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                    <td style="width:10%; text-align:center">to</td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtDateofMaturityEnd" type="text" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" style=" width:100%;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right">Invoice Amount :</td>
                        <td style="width:38%;text-align:right">
                            <table border="0" cellpadding="1" cellspacing="1" width="100%">
                                <tr>
                                    <td style="width:30%; text-align:center">
                                        <select id="cboInvoiceAmount" style="width:100%"> </select>
                                    </td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceAmountStart" type="text" style=" width:95%;" />
                                    </td>
                                    <td style="width:10%; text-align:center">to</td>
                                    <td style="width:30%; text-align:center">
                                        <input id="txtInvoiceAmountEnd" type="text" style=" width:95%;" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right"> Approved By :</td>
                        <td style="width:30%;text-align:left">
                            <select id="cboApprovedBy" style="width:100%">  </select>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right"> Invoice Status :</td>
                        <td style="width:38%;text-align:right">
                            <select id="cboInvoiceStatus" style="width:100%">  </select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right">Invoice Type:</td>
                        <td style="width:30%;text-align:left">
                            <select id="cboInvoiceType" style="width:100%">  </select>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right"> Remarks :</td>
                        <td style="width:38%;text-align:right">
                            <input type="text" id="txtRemarks" style="width:99%"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right">Import LC No :</td>
                        <td style="width:30%;text-align:left">
                            <input type="text" id="txtImportLCNo" style="width:100%" />
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right">Import Invoice No :</td>
                        <td style="width:38%;text-align:right">
                            <input type="text" id="txtImportInvoiceNo" style="width:99%" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right">Product Type :</td>
                        <td style="width:30%;text-align:left">
                            <select id="cboImportProducts" style="width:100%"></select>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right">Bank Status :</td>
                        <td style="width:38%;text-align:left;padding-left:8px;">
                            <input id="cboBankStatusAdv" class="easyui-combobox" data-options="valueField: 'id',textField: 'text',multiple:true" style="width:93%" />
                            <input type="button" value="C" id="btnClearBankStatus" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%;text-align:right">PI Type :</td>
                        <td style="width:30%;text-align:left">
                            <select id="cboImportPIType" style="width:100%"></select>
                        </td>
                        <td style="width:5%;text-align:right"></td>
                        <td style="width:12%;text-align:right">Wthout Cancel? :</td>
                        <td style="width:38%;text-align:left;padding-left:8px;"><input type="checkbox" id="chkWthoutCancel" /></td>
                    </tr>
                    <tr>
                        <td style="width: 65%; text-align: left; font-weight: bold" rowspan="2" colspan="3">
                            <fieldset style="width:465px;">
                                <legend style="font-weight: bold">Criteria : </legend>
                                <table id="tblDateType">
                                    <tr>
                                        <td style="font-size:12px;text-align:right;">
                                            <label>Date Type :</label>
                                        </td>
                                        <td>
                                            <select id="cboDateCriteria" style="width: 352px;">
                                                <option value="None">--Select One--</option>

                                                <option value="DateofApplication">Application Date</option>
                                                <option value="ImportLCDate">LC Date</option>
                                                <option value="DateofReceive">Invoice Receive Date</option>
                                                <option value="DateOfTakeOutDoc">Doc Release Date</option>
                                                <option value="DateofBankInfo">Letter Issue Date</option>
                                                <option value="BLDate">BL Date</option>
                                                <option value="DateofPayment">Payment Date</option>
                                                <option value="CnFSendDate">CnF Send Date</option>
                                                <option value="DeliveryDate">Delivery Date</option>
                                                <option value="PackDate">Packing Date</option>
                                                <option value="ETADate">ETA Date</option>
                                                <option value="ShipmentDate">Shipment Date</option>
                                                <option value="PositionJTDate">Position on JT</option>
                                                <option value="PositionOuterDate">Position on Outer</option>
                                                <option value="NotingDate">Noting Date</option>
                                                <option value="BillofEntryDate">Bill of Entry</option>
                                                <option value="AssesmentDate">Assesment Date</option>
                                                <option value="ExamineDate">Examine Date</option>
                                                <option value="DOReceiveFromDate">Indent for Delivery</option>
                                                <option value="DeliveryNoticeDate">Delivery Notice Date</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="font-size:12px;text-align:right;width:100px;">
                                            <label>Date :</label>
                                        </td>
                                        <td>
                                            <select id="cboImportDate" onchange="DateActions_Import()" style="width:100px;font-size:12px;"></select>
                                            <input id="txtImportDateStart" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                            To
                                            <input id="txtImportDateEnd" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                        </td>
                                    </tr>
                                </table>
                            </fieldset>
                        </td>
                        @*<td style="width:5%;text-align:right"></td>*@
                        <td style="width:12%;text-align:right"></td>
                        <td style="width:38%;text-align:right"></td>
                    </tr>
                </table>
            </fieldset>
        </div>
        <fieldset>
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold; width:100%;">
                <tr>
                    <td style="width:40%;text-align:right">
                    </td>
                    <td style="width:60%;text-align:right">
                        Report Layout :<select id="cboReportLayout" style="width:30%"></select> 
                        <a id="btnPreview" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                        <a id="btnExportToExcel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">Export to Excel</a>
                        <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>
</body>
</html>
<script type="text/javascript">
    $(document).ready(function () {
        var nBUID =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        var oApprovalUsers = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ApprovalUsers));
        var oReportLayouts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ReportLayouts));
        var oCompareOperators = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CompareOperators));
        var oImportInvoiceStates = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ImportInvoiceStates));
        var oImportInvoiceTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ImportInvoiceTypes));
        var oImportProducts = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ImportProducts));
        var oImportPITypes= @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ImportPITypeObj));
        var oInvoiceBankStatusObjs = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.InvoiceBankStatusObjs));
        LoadBankStatusAdv(oInvoiceBankStatusObjs);
        $("#progbar").progressbar({ value: 0 });
        $("#progbarParent").hide();
        $('#txtInvoiceAmountStart,#txtInvoiceAmountEnd').icsCurrencyBox();
        $("#cboInvoiceIssueDate,#cboInvoiceAcceptanceDate,#cboDateofApplication,#cboDateofMaturity,#cboImportDate").icsLoadCombo({ List: oCompareOperators, OptionValue: "id", DisplayText: "Value" });
        $("#cboInvoiceAmount").icsLoadCombo({ List: oCompareOperators, OptionValue: "id", DisplayText: "Value" });
        $("#cboApprovedBy").icsLoadCombo({ List: oApprovalUsers, OptionValue: "UserID", DisplayText: "UserName" });
        $("#cboInvoiceStatus").icsLoadCombo({ List: oImportInvoiceStates, OptionValue: "id", DisplayText: "Value" });
        $("#cboInvoiceType").icsLoadCombo({ List: oImportInvoiceTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboReportLayout").icsLoadCombo({ List: oReportLayouts, OptionValue:"id", DisplayText:"Value"});
        $("#cboImportProducts").icsLoadCombo({ List: oImportProducts, OptionValue: "ProductTypeInt", DisplayText: "Name" });
        $("#cboImportPIType").icsLoadCombo({List: oImportPITypes,OptionValue: "id",DisplayText: "Value"});
        $('#txtInvoiceIssueDateStart,#txtInvoiceIssueDateEnd').datebox({ disabled : true });
        $('#txtInvoiceAcceptanceDateStart,#txtInvoiceAcceptanceDateEnd').datebox({ disabled : true });
        $('#txtDateofApplicationStart,#txtDateofApplicationEnd').datebox({ disabled : true });
        $('#txtImportDateStart,#txtImportDateEnd').datebox({ disabled : true });

        $('#txtDateofMaturityStart,#txtDateofMaturityEnd').datebox({ disabled : true });
        $('#txtInvoiceAmountStart,#txtInvoiceAmountEnd').prop("disabled", true);
        $('#txtInvoiceIssueDateStart,#txtInvoiceIssueDateEnd').datebox('setValue', icsdateformat(new Date()));
        $('#txtInvoiceAcceptanceDateStart,#txtInvoiceAcceptanceDateEnd').datebox('setValue', icsdateformat(new Date()));
        $('#txtDateofApplicationStart,#txtDateofApplicationEnd').datebox('setValue', icsdateformat(new Date()));
        $('#txtImportDateStart,#txtImportDateEnd').datebox('setValue', icsdateformat(new Date()));
        $('#txtDateofMaturityStart,#txtDateofMaturityEnd').datebox('setValue', icsdateformat(new Date()));
        $('#txtInvoiceAmountStart,#txtInvoiceAmountEnd').val('0.00');
        $('#txtSupplier').data('Suppliers', []);
        $('#txtProduct').data('Products', []);
    });

    function LoadBankStatusAdv(oInvoiceBankStatusObjs)
    {
        var oStyleTypes = [];
        for(var i = 0;i<oInvoiceBankStatusObjs.length;i++)
        {
            var oStyleType = {id:''+oInvoiceBankStatusObjs[i].id, text:''+oInvoiceBankStatusObjs[i].Value};
            oStyleTypes.push(oStyleType);
        }
        $('#cboBankStatusAdv').combobox('loadData',oStyleTypes);
    }
    $('#btnClearBankStatus').click(function(e){
        $('#cboBankStatusAdv').combobox('reset');
    });

    function ValidateSearch(nParam)
    {
        var nInvoiceIssueDate = parseInt($('#cboInvoiceIssueDate').val());
        if(nInvoiceIssueDate===1 || nInvoiceIssueDate===2 || nInvoiceIssueDate===3 || nInvoiceIssueDate===4)
        {
            var sInvoiceIssueDateStart   = $('#txtInvoiceIssueDateStart').datebox('getValue');
            if(sInvoiceIssueDateStart===null || sInvoiceIssueDateStart==="")
            {
                alert("Please select PI start date!");
                $('#txtInvoiceIssueDateStart').focus();
                return false;
            }
        }
        if(nInvoiceIssueDate===5 || nInvoiceIssueDate===6)
        {
            var sInvoiceIssueDateStart   = $('#txtInvoiceIssueDateStart').datebox('getValue');
            var sInvoiceIssueDateEnd   = $('#txtInvoiceIssueDateEnd').datebox('getValue');
            if(sInvoiceIssueDateStart===null || sInvoiceIssueDateStart==="")
            {
                alert("Please select PI start date!");
                $('#txtInvoiceIssueDateStart').focus();
                return false;
            }
            if(sInvoiceIssueDateEnd===null || sInvoiceIssueDateEnd==="")
            {
                alert("Please select PI end date!");
                $('#txtInvoiceIssueDateEnd').focus();
                return false;
            }
            if(new Date(sInvoiceIssueDateStart) > new Date(sInvoiceIssueDateEnd))
            {
                alert("Start date must be smallar than or equal end date!");
                $('#txtInvoiceIssueDateStart').focus();
                return false;
            }
        }

        var nInvoiceAcceptanceDate = parseInt($('#cboInvoiceAcceptanceDate').val());
        if(nInvoiceAcceptanceDate===1 || nInvoiceAcceptanceDate===2 || nInvoiceAcceptanceDate===3 || nInvoiceAcceptanceDate===4)
        {
            var sInvoiceAcceptanceDateStart   = $('#txtInvoiceAcceptanceDateStart').datebox('getValue');
            if(sInvoiceAcceptanceDateStart===null || sInvoiceAcceptanceDateStart==="")
            {
                alert("Please select validity start date!");
                $('#txtInvoiceAcceptanceDateStart').focus();
                return false;
            }
        }
        if(nInvoiceAcceptanceDate===5 || nInvoiceAcceptanceDate===6)
        {
            var sInvoiceAcceptanceDateStart   = $('#txtInvoiceAcceptanceDateStart').datebox('getValue');
            var sInvoiceAcceptanceDateEnd   = $('#txtInvoiceAcceptanceDateEnd').datebox('getValue');
            if(sInvoiceAcceptanceDateStart===null || sInvoiceAcceptanceDateStart==="")
            {
                alert("Please select validity start date!");
                $('#txtInvoiceAcceptanceDateStart').focus();
                return false;
            }
            if(sInvoiceAcceptanceDateEnd===null || sInvoiceAcceptanceDateEnd==="")
            {
                alert("Please select validity end date!");
                $('#txtInvoiceAcceptanceDateEnd').focus();
                return false;
            }
            if(new Date(sInvoiceAcceptanceDateStart) > new Date(sInvoiceAcceptanceDateEnd))
            {
                alert("Start date must be smallar than or equal end date!");
                $('#txtInvoiceAcceptanceDateStart').focus();
                return false;
            }
        }

        var nDateofApplication = parseInt($('#cboDateofApplication').val());
        if(nDateofApplication===1 || nDateofApplication===2 || nDateofApplication===3 || nDateofApplication===4)
        {
            var sDateofApplicationStart   = $('#txtDateofApplicationStart').datebox('getValue');
            if(sDateofApplicationStart===null || sDateofApplicationStart==="")
            {
                alert("Please select approved start date!");
                $('#txtDateofApplicationStart').focus();
                return false;
            }
        }

        if(nDateofApplication===5 || nDateofApplication===6)
        {
            var sDateofApplicationStart   = $('#txtDateofApplicationStart').datebox('getValue');
            var sDateofApplicationEnd   = $('#txtDateofApplicationEnd').datebox('getValue');
            if(sDateofApplicationStart===null || sDateofApplicationStart==="")
            {
                alert("Please select approved start date!");
                $('#txtDateofApplicationStart').focus();
                return false;
            }
            if(sDateofApplicationEnd===null || sDateofApplicationEnd==="")
            {
                alert("Please select approved end date!");
                $('#txtDateofApplicationEnd').focus();
                return false;
            }
            if(new Date(sDateofApplicationStart) > new Date(sDateofApplicationEnd))
            {
                alert("Start date must be smallar than or equal end date!");
                $('#txtDateofApplicationStart').focus();
                return false;
            }
        }

        var nImportDate = parseInt($('#cboImportDate').val());
        if(nImportDate===1 || nImportDate===2 || nImportDate===3 || nImportDate===4)
        {
            var sImportDateStart   = $('#txtImportDateStart').datebox('getValue');
            if(sImportDateStart===null || sImportDateStart==="")
            {
                alert("Please select import start date!");
                $('#txtImportDateStart').focus();
                return false;
            }
        }
        if(nImportDate===5 || nImportDate===6)
        {
            var sImportDateStart   = $('#txtImportDateStart').datebox('getValue');
            var sImportDateEnd   = $('#txtImportDateEnd').datebox('getValue');
            if(sImportDateStart===null || sImportDateStart==="")
            {
                alert("Please select approved start date!");
                $('#txtImportDateStart').focus();
                return false;
            }
            if(sImportDateEnd===null || sImportDateEnd==="")
            {
                alert("Please select approved end date!");
                $('#txtImportDateEnd').focus();
                return false;
            }
            if(new Date(sImportDateStart) > new Date(sImportDateEnd))
            {
                alert("Start date must be smallar than or equal end date!");
                $('#txtImportDateStart').focus();
                return false;
            }
        }
        var nDateofMaturity = parseInt($('#cboDateofMaturity').val());
        if(nDateofMaturity===1 || nDateofMaturity===2 || nDateofMaturity===3 || nDateofMaturity===4)
        {
            var sDateofMaturityStart   = $('#txtDateofMaturityStart').datebox('getValue');
            if(sDateofMaturityStart===null || sDateofMaturityStart==="")
            {
                alert("Please select Maturity start date!");
                $('#txtDateofMaturityStart').focus();
                return false;
            }
        }
        if(nDateofMaturity===5 || nDateofMaturity===6)
        {
            var sDateofMaturityStart   = $('#txtDateofMaturityStart').datebox('getValue');
            var sDateofMaturityEnd   = $('#txtDateofMaturityEnd').datebox('getValue');
            if(sDateofMaturityStart===null || sDateofMaturityStart==="")
            {
                alert("Please select Maturity start date!");
                $('#txtDateofMaturityStart').focus();
                return false;
            }
            if(sDateofMaturityEnd===null || sDateofMaturityEnd==="")
            {
                alert("Please select Maturity end date!");
                $('#txtDateofMaturityEnd').focus();
                return false;
            }
            if(new Date(sDateofMaturityStart) > new Date(sDateofMaturityEnd))
            {
                alert("Start date must be smallar than or equal end date!");
                $('#txtDateofMaturityStart').focus();
                return false;
            }
        }


        var nInvoiceAmount = parseInt($('#cboInvoiceAmount').val());
        if(nInvoiceAmount===1 || nInvoiceAmount===2 || nInvoiceAmount===3 || nInvoiceAmount===4)
        {
            var sInvoiceAmountStart   = $.trim($('#txtInvoiceAmountStart').val());
            if(sInvoiceAmountStart===null || sInvoiceAmountStart==="")
            {
                alert("Please enter invoice start Amount!");
                $('#txtInvoiceAmountStart').focus();
                return false;
            }
            if(icsRemoveComma(sInvoiceAmountStart)<=0)
            {
                alert("Please enter PI start Amount!");
                $('#txtInvoiceAmountStart').focus();
                return false;
            }
        }
        if(nInvoiceAmount===5 || nInvoiceAmount===6)
        {
            var sInvoiceAmountStart = $.trim($('#txtInvoiceAmountStart').val());
            if(sInvoiceAmountStart===null || sInvoiceAmountStart==="")
            {
                alert("Please enter PI start Amount!");
                $('#txtInvoiceAmountStart').focus();
                return false;
            }
            if(icsRemoveComma(sInvoiceAmountStart)<=0)
            {
                alert("Please enter PI start Amount!");
                $('#txtInvoiceAmountStart').focus();
                return false;
            }

            var sInvoiceAmountEnd = $.trim($('#txtInvoiceAmountEnd').val());
            if(sInvoiceAmountEnd===null || sInvoiceAmountEnd==="")
            {
                alert("Please enter PI end Amount!");
                $('#txtInvoiceAmountEnd').focus();
                return false;
            }
            if(icsRemoveComma(sInvoiceAmountEnd)<=0)
            {
                alert("Please enter invoice end Amount!");
                $('#txtInvoiceAmountEnd').focus();
                return false;
            }
            if(icsRemoveComma(sInvoiceAmountStart) >= icsRemoveComma(sInvoiceAmountEnd))
            {
                alert("Start amount must be smallar than end amount!");
                $('#txtInvoiceAmountStart').focus();
                return false;
            }
        }

        var nReportLayout = parseInt($('#cboReportLayout').val());
        if(nReportLayout<=0 && nParam==0)
        {
            alert("Please select an Report Layout!");
            return;
        }

        if(nParam==1)
            nReportLayout=6; //ProductWise

        var sInvoiceNo =$.trim($('#txtInvoiceNo').val());
        var nApprovedBy = parseInt($('#cboApprovedBy').val());
        var nInvoiceStatus = parseInt($('#cboInvoiceStatus').val());
        var nInvoiceType = parseInt($('#cboInvoiceType').val());
        var sRemarks =$.trim($('#txtRemarks').val());
        var sImportLCNo =$.trim($('#txtImportLCNo').val());
        var sImportInvoiceNo =$.trim($('#txtImportInvoiceNo').val());
        var oSuppliers = $('#txtSupplier').data('Suppliers');
        var oProducts = $('#txtProduct').data('Products');
        var ncboImportProduct = parseInt($('#cboImportProducts').val());
        var bIsWthoutCancel = false;
        if($('#chkWthoutCancel').attr("checked"))
        {
            bIsWthoutCancel=true;
        }
        var oBankStatus = $('#cboBankStatusAdv').combobox('getValues');
       
        if(nInvoiceIssueDate === 0 && nInvoiceAcceptanceDate === 0 && nDateofApplication === 0 && nImportDate === 0 && nDateofMaturity===0 && nInvoiceAmount === 0 && sInvoiceNo === "" && nApprovedBy === 0 && nInvoiceStatus === 0 && nInvoiceType === 0  && sRemarks === "" && sImportLCNo === "" && sImportInvoiceNo === ""   && oSuppliers.length<=0 && oProducts.length<=0 && ncboImportProduct<=0 && bIsWthoutCancel == false && $('#cboImportPIType').val() == 0 && oBankStatus.length <= 0)
        {
            alert("Please select atleast one searching criteriea!");
            return false;
        }
        return true;
    }

    function RefreshObject()
    {
        var oSuppliers = $('#txtSupplier').data('Suppliers');
        var oProducts = $('#txtProduct').data('Products');
        var nInvoiceIssueDate = parseInt($('#cboInvoiceIssueDate').val());
        var sInvoiceIssueDateStart   = $('#txtInvoiceIssueDateStart').datebox('getValue');
        var sInvoiceIssueDateEnd   = $('#txtInvoiceIssueDateEnd').datebox('getValue');

        var nInvoiceAcceptanceDate = parseInt($('#cboInvoiceAcceptanceDate').val());
        var sInvoiceAcceptanceDateStart = $('#txtInvoiceAcceptanceDateStart').datebox('getValue');
        var sInvoiceAcceptanceDateEnd = $('#txtInvoiceAcceptanceDateEnd').datebox('getValue');

        var nDateofApplication = parseInt($('#cboDateofApplication').val());
        var sDateofApplicationStart  = $('#txtDateofApplicationStart').datebox('getValue');
        var sDateofApplicationEnd  = $('#txtDateofApplicationEnd').datebox('getValue');

        var scboDateCriteria = $('#cboDateCriteria').val();
        var nImportDate = parseInt($('#cboImportDate').val());
        var sImportDateStart  = $('#txtImportDateStart').datebox('getValue');
        var sImportDateEnd  = $('#txtImportDateEnd').datebox('getValue');

        var nDateofMaturity = parseInt($('#cboDateofMaturity').val());
        var sDateofMaturityStart  = $('#txtDateofMaturityStart').datebox('getValue');
        var sDateofMaturityEnd  = $('#txtDateofMaturityEnd').datebox('getValue');

        var nInvoiceAmount = parseInt($('#cboInvoiceAmount').val());
        var nInvoiceAmountStart = icsRemoveComma($.trim($('#txtInvoiceAmountStart').val()));
        var nInvoiceAmountEnd = icsRemoveComma($.trim($('#txtInvoiceAmountEnd').val()));

        var sImportLCNo = $.trim($('#txtImportLCNo').val());
        var sImportInvoiceNo = $.trim($('#txtImportInvoiceNo').val());

        //if(scboDateCriteria != undefined || scboDateCriteria.length > 0)
        //{
        //    if(nImportDate<=0)
        //    {
        //        alert("Please select a date & search again!");
        //        return;
        //    }
        //}
        var bIsWthoutCancel = false;
        if($('#chkWthoutCancel').attr("checked"))
        {
            bIsWthoutCancel=true;
        }

        var sBankStatusIDs = "";
        var oBankStatus = $('#cboBankStatusAdv').combobox('getValues');
        if(oBankStatus.length > 0){
            for(var i= 0;i<oBankStatus.length;i++){
                if(oBankStatus[i] != "" && oBankStatus[i] != null){
                    sBankStatusIDs += oBankStatus[i] + ",";
                }
            }
            if(sBankStatusIDs.length > 0)
                sBankStatusIDs = sBankStatusIDs.substring(0,sBankStatusIDs.length-1);
        }


        var sSearchingData  =  nInvoiceIssueDate+'~';
        sSearchingData = sSearchingData + sInvoiceIssueDateStart+'~';
        sSearchingData = sSearchingData + sInvoiceIssueDateEnd+'~';
        sSearchingData = sSearchingData + nInvoiceAcceptanceDate+'~';
        sSearchingData = sSearchingData + sInvoiceAcceptanceDateStart+'~';
        sSearchingData = sSearchingData + sInvoiceAcceptanceDateEnd+'~';
        sSearchingData = sSearchingData + nDateofApplication+'~';
        sSearchingData = sSearchingData + sDateofApplicationStart+'~';
        sSearchingData = sSearchingData + sDateofApplicationEnd+'~';

        sSearchingData = sSearchingData + nDateofMaturity+'~';
        sSearchingData = sSearchingData + sDateofMaturityStart+'~';
        sSearchingData = sSearchingData + sDateofMaturityEnd+'~';

        sSearchingData = sSearchingData + nInvoiceAmount +'~';
        sSearchingData = sSearchingData + nInvoiceAmountStart +'~';
        sSearchingData = sSearchingData + nInvoiceAmountEnd +'~';
        sSearchingData = sSearchingData + sImportLCNo +'~';
        sSearchingData = sSearchingData + sImportInvoiceNo + '~'

        sSearchingData = sSearchingData + scboDateCriteria +'~';
        sSearchingData = sSearchingData + nImportDate +'~';
        sSearchingData = sSearchingData + sImportDateStart +'~';
        sSearchingData = sSearchingData + sImportDateEnd +'~';
        sSearchingData = sSearchingData + bIsWthoutCancel+'~';
        sSearchingData = sSearchingData + $('#cboImportPIType').val()+'~';
        sSearchingData = sSearchingData + sBankStatusIDs;

        var oImportInvoiceRegister = {
            BUID : parseInt(sessionStorage.getItem("BUID")),
            ImportInvoiceNo : $.trim($('#txtInvoiceNo').val()),
            ApprovedBy : parseInt($('#cboApprovedBy').val()),
            InvoiceStatus : parseInt($('#cboInvoiceStatus').val()),
            InvoiceType : parseInt($('#cboInvoiceType').val()),
            ProductType : parseInt($('#cboImportProducts').val()),
            Remarks : $.trim($('#txtRemarks').val()),
            SupplierName : ICS_PropertyConcatation(oSuppliers, 'ContractorID'),
            ProductName : ICS_PropertyConcatation(oProducts, 'ProductID'),
            ReportLayout : parseInt($('#cboReportLayout').val()),
            SearchingData : sSearchingData
        };
        return oImportInvoiceRegister;
    }

    $('#btnPreview').click(function(e){
        debugger;
        if(!ValidateSearch(0)) return;
        var oImportInvoiceRegister = RefreshObject();
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/ImportInvoiceRegister/SetSessionSearchCriteria",
                traditional: true,
                data:  JSON.stringify(oImportInvoiceRegister),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var sFeedBackMessage = jQuery.parseJSON(data);
                    if (sFeedBackMessage==="Successful") {
                        var tsv=((new Date()).getTime())/1000;

                        var nLCType =parseInt($('#cboImportPIType').val());
                        window.open(_sBaseAddress+'/ImportInvoiceRegister/PrintImportInvoiceRegister?ts='+tsv+'&nLCType='+nLCType,"_blank");
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

    });

    $('#btnExportToExcel').click(function(e){
        if(!ValidateSearch(1)) return;
        var oImportInvoiceRegister = RefreshObject();
            $.ajax({
                type: "POST",
                dataType: "json",
                url : _sBaseAddress+  "/ImportInvoiceRegister/SetSessionSearchCriteria",
                traditional: true,
                data:  JSON.stringify(oImportInvoiceRegister),
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    var sFeedBackMessage = jQuery.parseJSON(data);
                    if (sFeedBackMessage==="Successful") {
                        var tsv=((new Date()).getTime())/1000;
                        var nLCType =parseInt($('#cboImportPIType').val());
                        window.open(_sBaseAddress+'/ImportInvoiceRegister/ExportToExcelImportInvoiceRegister?ts='+tsv+'&nLCType='+nLCType,"_blank");
                    }
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

    });

    $('#cboInvoiceIssueDate').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboInvoiceIssueDate').val());
        if(nCompareOperator===0)
        {
            $('#txtInvoiceIssueDateStart').datebox({ disabled : true });
            $('#txtInvoiceIssueDateEnd').datebox({ disabled : true });
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtInvoiceIssueDateStart').datebox({ disabled : false });
            $('#txtInvoiceIssueDateEnd').datebox({ disabled : true });
        }
        else
        {
            $('#txtInvoiceIssueDateStart').datebox({ disabled : false });
            $('#txtInvoiceIssueDateEnd').datebox({ disabled : false });
        }
        $('#txtInvoiceIssueDateStart').datebox('setValue', icsdateformat(new Date()));
        $('#txtInvoiceIssueDateEnd').datebox('setValue', icsdateformat(new Date()));
    });

    $('#cboInvoiceAcceptanceDate').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboInvoiceAcceptanceDate').val());
        if(nCompareOperator===0)
        {
            $('#txtInvoiceAcceptanceDateStart').datebox({ disabled : true });
            $('#txtInvoiceAcceptanceDateEnd').datebox({ disabled : true });
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtInvoiceAcceptanceDateStart').datebox({ disabled : false });
            $('#txtInvoiceAcceptanceDateEnd').datebox({ disabled : true });
        }
        else
        {
            $('#txtInvoiceAcceptanceDateStart').datebox({ disabled : false });
            $('#txtInvoiceAcceptanceDateEnd').datebox({ disabled : false });
        }
        $('#txtInvoiceAcceptanceDateStart').datebox('setValue', icsdateformat(new Date()));
        $('#txtInvoiceAcceptanceDateEnd').datebox('setValue', icsdateformat(new Date()));
    });

    $('#cboDateofApplication').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboDateofApplication').val());
        if(nCompareOperator===0)
        {
            $('#txtDateofApplicationStart').datebox({ disabled : true });
            $('#txtDateofApplicationEnd').datebox({ disabled : true });
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtDateofApplicationStart').datebox({ disabled : false });
            $('#txtDateofApplicationEnd').datebox({ disabled : true });
        }
        else
        {
            $('#txtDateofApplicationStart').datebox({ disabled : false });
            $('#txtDateofApplicationEnd').datebox({ disabled : false });
        }
        $('#txtDateofApplicationStart').datebox('setValue', icsdateformat(new Date()));
        $('#txtDateofApplicationEnd').datebox('setValue', icsdateformat(new Date()));
    });

    $('#cboImportDate').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboImportDate').val());
        if(nCompareOperator===0)
        {
            $('#txtImportDateStart').datebox({ disabled : true });
            $('#txtImportDateEnd').datebox({ disabled : true });
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtImportDateStart').datebox({ disabled : false });
            $('#txtImportDateEnd').datebox({ disabled : true });
        }
        else
        {
            $('#txtImportDateStart').datebox({ disabled : false });
            $('#txtImportDateEnd').datebox({ disabled : false });
        }
        $('#txtImportDateStart').datebox('setValue', icsdateformat(new Date()));
        $('#txtImportDateEnd').datebox('setValue', icsdateformat(new Date()));
    });

    $('#cboDateofMaturity').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboDateofMaturity').val());
        if(nCompareOperator===0)
        {
            $('#txtDateofMaturityStart').datebox({ disabled : true });
            $('#txtDateofMaturityEnd').datebox({ disabled : true });
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtDateofMaturityStart').datebox({ disabled : false });
            $('#txtDateofMaturityEnd').datebox({ disabled : true });
        }
        else
        {
            $('#txtDateofMaturityStart').datebox({ disabled : false });
            $('#txtDateofMaturityEnd').datebox({ disabled : false });
        }
        $('#txtDateofMaturityStart').datebox('setValue', icsdateformat(new Date()));
        $('#txtDateofMaturityEnd').datebox('setValue', icsdateformat(new Date()));
    });

    $('#cboInvoiceAmount').change(function(e){
        //EqualTo = 1, NotEqualTo = 2, GreaterThen = 3, SmallerThen = 4, Between = 5, NotBetween = 6
        var nCompareOperator =   parseInt($('#cboInvoiceAmount').val());
        if(nCompareOperator===0)
        {
            $('#txtInvoiceAmountStart').prop("disabled", true);
            $('#txtInvoiceAmountEnd').prop("disabled", true);
        }
        else if (nCompareOperator===1 || nCompareOperator===2 || nCompareOperator===3 || nCompareOperator===4)
        {
            $('#txtInvoiceAmountStart').prop("disabled", false);
            $('#txtInvoiceAmountEnd').prop("disabled", true);
        }
        else
        {
            $('#txtInvoiceAmountStart').prop("disabled", false);
            $('#txtInvoiceAmountEnd').prop("disabled", false);
        }
        $('#txtInvoiceAmountStart').val('0.00');
        $('#txtInvoiceAmountEnd').val('0.00');
    });

    $('#btnClose').click(function (e) {
        window.location.href = window.location.href;
    });

    ///Supplier Pick
    function PickSupplier()
    {
        var nBUID = parseInt(sessionStorage.getItem("BUID"));
        var oContractor = { Params: 1 + '~' + $.trim($('#txtSupplier').val())+'~'+ nBUID };//here 1 is Supplier
        var obj = {
            BaseAddress: sessionStorage.getItem("BaseAddress"),
            Object: oContractor,
            ControllerName: "Contractor",
            ActionName: "ContractorSearchByNameType",
            IsWinClose: false
        };
        $("#progbar").progressbar({ value: 0 });
        $("#progbarParent").show();
        var intervalID = setInterval(updateProgress, 250);
        $.icsDataGets(obj, function (response) {
            clearInterval(intervalID);
            $("#progbarParent").hide();
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ContractorID > 0) {
                    var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 200, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Address", title: "Address", width: 120, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Email", title: "Email", width: 90, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ShortName", title: "Short Name", width: 90, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winSuppliers',
                        winclass: 'clsSuppliers',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblSuppliers',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Supplier List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }else{
                alert("Data Not Found.");
                return;
            }
        });
    }
    $("#txtSupplier").keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            if($.trim($('#txtSupplier').val())===null || $.trim($('#txtSupplier').val())==="")
            {
                alert("Press enter with supplier name");
                return;
            }
            PickSupplier();
        }
    });
    $("#btnPickSupplier").click(function () {
        $('#txtSupplier').val('');
        PickSupplier();
    });
    $('#txtSupplier').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            $("#txtSupplier").removeClass("fontColorOfPickItem");
            $('#txtSupplier').data('Suppliers', []);
        }
    });
    $('#btnClearSupplier').click(function(e){
        $("#txtSupplier").val("");
        $('#txtSupplier').data('Suppliers', []);
        $("#txtSupplier").removeClass("fontColorOfPickItem");
    });
    //End Supplier Picker

    //Product Pick
    function PickProduct()
    {
        var nBUID = parseInt(sessionStorage.getItem("BUID"));
        var oProduct = {
            BUID : nBUID,
            ProductName : $.trim($('#txtProduct').val())
        };
        var obj = {
            BaseAddress: sessionStorage.getItem("BaseAddress"),
            Object: oProduct,
            ControllerName: "Product",
            ActionName: "SearchByProductBUWise",
            IsWinClose: false
        };
        $("#progbar").progressbar({ value: 0 });
        $("#progbarParent").show();
        var intervalID = setInterval(updateProgress, 250);
        $.icsDataGets(obj, function (response) {
            clearInterval(intervalID);
            $("#progbarParent").hide();
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ProductID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "ProductCode", title: "Product Code", width: 80, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ProductName", title: "Product Name", width: 300, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ShortName", title: "Short Name", width: 100, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ProductCategoryName", title: "Category", width: 100, align: "left" }; tblColums.push(oColumn)
                    var oPickerParam = {
                        winid: 'winProducts',
                        winclass: 'clsProducts',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblProducts',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'ProductName',
                        windowTittle: 'Product List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }else{
                alert("Data Not Found.");
                return;
            }
        });
    }
    $("#txtProduct").keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            if($.trim($('#txtProduct').val())===null || $.trim($('#txtProduct').val())==="")
            {
                alert("Press enter with product name");
                return;
            }
            PickProduct();
        }
    });
    $("#btnPickProduct").click(function () {
        $('#txtProduct').val('');
        PickProduct();
    });
    $('#txtProduct').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            $("#txtProduct").removeClass("fontColorOfPickItem");
            $('#txtProduct').data('Products', []);
        }
    });
    $('#btnClearProduct').click(function(e){
        $("#txtProduct").val("");
        $('#txtProduct').data('Products', []);
        $("#txtProduct").removeClass("fontColorOfPickItem");
    });
    //End Product Picker


    //End Product Picker
    function IntializePickerbutton(oPickerobj) {
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            //for Single Select
            SetPickerValueAssign(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which == 13)//enter=13
            {
                SetPickerValueAssign(oPickerobj);
            }
        });
    }

    function SetPickerValueAssign(oPickerobj) {
        var oreturnObj = null, oreturnobjs = [];
        if (oPickerobj.multiplereturn) {
            oreturnobjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
        }
        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();

        if (oPickerobj.winid === 'winSuppliers')
        {
            if (oreturnobjs != null && oreturnobjs.length > 0) {
                $('#txtSupplier').val(oreturnobjs.length+"'s Suppliers seleted");
                $('#txtSupplier').addClass('fontColorOfPickItem');
                $('#txtSupplier').data('Suppliers', oreturnobjs);
                $('#txtSupplier').focus();
            }
        }
        else if (oPickerobj.winid === 'winProducts')
        {
            if (oreturnobjs != null && oreturnobjs.length > 0) {
                $('#txtProduct').val(oreturnobjs.length+"'s Products seleted");
                $('#txtProduct').addClass('fontColorOfPickItem');
                $('#txtProduct').data('Products', oreturnobjs);
                $('#txtProduct').focus();
            }
        }
        else if (oPickerobj.winid === 'winBankBranchs')
        {
            if (oreturnobjs != null && oreturnobjs.length > 0) {
                $('#txtBankBranch').val(oreturnobjs.length+"'s Bank Branchs seleted");
                $('#txtBankBranch').addClass('fontColorOfPickItem');
                $('#txtBankBranch').data('BankBranchs', oreturnobjs);
                $('#txtBankBranch').focus();
            }
        }
    }

    function updateProgress() {
        var value =$('#progbar').progressbar('getValue');
        if (value < 96){
            value += Math.floor(Math.random() * 10);
            $('#progbar').progressbar('setValue', value);
        }
    }

    function hideShow(miliseconds) {
        $("#progbarParent").hide();
    }
</script>