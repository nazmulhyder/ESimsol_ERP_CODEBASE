@{
    ViewBag.Title = "SalesReport List";
}
@model IEnumerable<ESimSol.BusinessObjects.SalesReport>
    <div class="menuMainCollectionTable" style="height:99%">
        <table id="tblSalesReports" title="List Of Sales Report Parameter" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="true" singleselect="true" autorowheight="false" toolbar="#toolbar">
            <thead>
                <tr>
                    <th field="Name" width="20%">Name</th>
                    <th field="PrintName" width="20%">Print Name</th>
                    <th field="BUType" width="10%">Business Unit</th>
                    <th field="ActivityInString" width="10%">Activity</th>
                    <th field="IsDoubleInString" width="10%">Single/Double</th>
                    <th field="LastUpdateByName" width="10%">Last Update By</th>
                    <th field="LastUpdateDateTimeInString" width="10%">Last Update Date</th>
                  
                </tr>
            </thead>
        </table>
        <div id="toolbar">
            <a id="btnAdd" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Add" iconcls="icon-add" plain="true">Add</a>
            <a id="btnEdit" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Edit" iconcls="icon-edit" plain="true">Edit</a>
            <a id="btnView" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="View" iconcls="icon-details" plain="true">View</a>
            <a id="btnDelete" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Delete" iconcls="icon-remove" plain="true">Delete</a>
            <a id="btnActive" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Delete" iconcls="icon-ok" plain="true">Active</a>
            <a id="btnInActive" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Delete" iconcls="icon-undo" plain="true">InActive</a>
        </div>
    </div>
    <div id="winSalesReport" class="easyui-window winstyle" title="Add Sales Report Parameter" style=" height:auto;width:60%" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="overflow:hidden;display:block;">
            <fieldset style="height:10%">
                <legend style="font-weight: bold">Sales Report Parameter</legend>
                <div style="overflow:hidden;display:block">
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Name :
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtName" type="text" style="float:left;width:100%" placeholder="Report Format"/>
                        </div>
                    </div>
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                           Print Name:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtPrintName" type="text" style="float:left;width:100%" placeholder="Write Print Header Name"/>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:100%">
                        <div style="overflow:hidden;float:left;width:15%;text-align:right">
                            Query :
                        </div>
                        <div style="overflow:hidden;float:left;width:83%">
                            <textarea id="txtQuery" cols="100" rows="3" placeholder="SELECT * FROM X ..." style="width:100%"></textarea>
                        </div>
                    </div>            
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Report Type:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtReportType" type="text" style="float:left;width:100%" />
                        </div>
                    </div>
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Business Unit:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <select id="cboBUID" style="float:left;width:100%"></select>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            IDs~Date:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtID_Date" type="text" style="float:left;width:100%"  placeholder="format : MktPerson ~ Year(date)"/>
                        </div>
                    </div>
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Grp By:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtGrpBy" type="text" style="float:left;width:100%" placeholder="Group By X,Y,Z"/>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                           IsDouble:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <select id="cboIsDouble" style="width:100%">
                                <option value="0" selected>Select</option>
                                <option value="1" >Single</option>
                                <option value="2">Double</option>
                            </select>
                        </div>
                    </div>
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Receive From:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <select id="cboParent"  style="width:100%"></select>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Allocation Header:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtAllocatonHeader" type="text" style="float:left;width:100%"  placeholder="Dispo~Send~Receive"/>
                        </div>
                    </div>
                    <div style="overflow:hidden;float:left; width:49%">
                        <div style="overflow:hidden;float:left;width:30%;text-align:right">
                            Target Query:
                        </div>
                        <div style="overflow:hidden;float:left;width:70%">
                            <input id="txtTargetQuery" type="text" style="float:left;width:100%" />
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:100%">
                        <div style="overflow:hidden;float:left;width:15%;text-align:right">
                            Query Lay2 :
                        </div>
                        <div style="overflow:hidden;float:left;width:83%">
                            <textarea id="txtQueryL2" cols="100" rows="3" placeholder="SELECT * FROM X ..." style="width:100%"></textarea>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:100%">
                        <div style="overflow:hidden;float:left;width:15%;text-align:right">
                            Query Lay3 :
                        </div>
                        <div style="overflow:hidden;float:left;width:83%">
                            <textarea id="txtQueryL3" cols="100" rows="3" placeholder="SELECT * FROM X ..." style="width:100%"></textarea>
                        </div>
                    </div>
                </div>
                <div style="overflow:hidden;display:block;margin-top:5px">
                    <div style="overflow:hidden;float:left; width:100%">
                        <div style="overflow:hidden;float:left;width:15%;text-align:right">
                            Note :
                        </div>
                        <div style="overflow:hidden;float:left;width:83%">
                            <input id="txtNote" type="text" style="width:100%">
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div style="display:block;overflow:hidden;">
            <fieldset style="height:10%">
                <legend style="font-weight: bold">Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold; width:100%">
                    <tr>
                        <td style="width:60%; text-align:right"></td>
                        <td style="width:40%;text-align:right;">
                            <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                            <a id="btnSaveCopy" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-copy" plain="true">Copy</a>
                            <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>

    <script type="text/javascript">
    $(document).ready(function (){
        debugger;
        var  oSalesReports  = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        var sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oBusinessUnits = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
        var SalesReports = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.SalesReports));
        $("#cboParent").icsLoadCombo({
            List: SalesReports,
            OptionValue: "SalesReportID",
            DisplayText: "Name",
            InitialValue:"-Select-" 
        });
        $("#cboBUID").icsLoadCombo({
            List: oBusinessUnits,
            OptionValue: "BusinessUnitID",
            DisplayText: "BUTypeSt"
        });
        $('#tblSalesReports').data('BaseAddress', sBaseAddress);
        $('#tblSalesReports').data('SalesReport', oSalesReports);
        var oTempSalesReports =sessionStorage.getItem("oSalesReports");
        if(oTempSalesReports!=null)
        {
            oSalesReports = jQuery.parseJSON(oTempSalesReports);
        }
        RefreshList(oSalesReports);
    });


    function RefreshObject(){
        debugger;           
        var oSalesReport={
            SalesReportID : parseInt($('#tblSalesReports').data('SalesReport')),
            Name : $("#txtName").val(),
            PrintName : $("#txtPrintName").val(),
            Query : $("#txtQuery").val(),
            ReportType : parseInt($("#txtReportType").val()),
            BUID : parseInt($("#cboBUID").val()),
            IDs : $("#txtID_Date").val(),
            GrpByQ : $("#txtGrpBy").val(),
            ParentID : parseInt($("#cboParent").val()),
            IsDouble :  parseInt($("#cboIsDouble").val()),
            AllocationHeader : $("#txtAllocatonHeader").val(),
            DispoTargetQuery :$("#txtTargetQuery").val(),
            QueryLayerTwo :$("#txtQueryL2").val(),
            QueryLayerThree :$("#txtQueryL3").val(),
            Note : $("#txtNote").val()
        };
        return oSalesReport;
    }

    $("#btnAdd").click(function(){
        debugger;
        FormEnabled();
        RefreshConsumption();
        sessionStorage.setItem("SelectedRowIndex", -1);
        sessionStorage.setItem("SalesReportHeader", "Add SalesReport");
        $("#winSalesReport").icsWindow('open', "Add Sales Report Parameter");
    });

    function RefreshConsumption(){
        $('#tblSalesReports').data('SalesReport',0);
        $('#txtName').val("");
        $('#txtPrintName').val("");
        $('#txtQuery').val("");
        $('#txtReportType').val("");
        $('#cboBUID').val(0);
        $('#txtID_Date').val("");
        $('#txtGrpBy').val("");
        $("#cboIsDouble").val(0);
        $("#cboParent").val(0);
        $('#txtAllocatonHeader').val("");
        $('#txtTargetQuery').val("");
        $('#txtQueryL2').val("");
        $('#txtQueryL3').val("");
        $('#txtNote').val("");
    }

    function FormEnabled(){
        $('#txtName').attr('disabled',false);
        $('#txtPrintName').attr('disabled',false);
        $('#txtQuery').attr('disabled',false);
        $('#txtReportType').attr('disabled',false);
        $('#cboBUID').attr('disabled',false);
        $('#txtID_Date').attr('disabled',false);
        $('#txtGrpBy').attr('disabled',false);
        $('#cboIsDouble').attr('disabled',false);
        $('#cboParent').attr('disabled',false);
        $('#txtAllocatonHeader').attr('disabled',false);
        $('#txtTargetQuery').attr('disabled',false);
        $('#txtQueryL2').attr('disabled',false);
        $('#txtQueryL3').attr('disabled',false);
        $('#txtNote').attr('disabled',false);
        $('#btnSave').show();
    }

    $("#btnClose").click(function(){
        $("#winSalesReport").icsWindow('close');
    })

    $("#btnEdit").click(function(){
        debugger;
        FormEnabled();
        var oSalesReport= $('#tblSalesReports').datagrid('getSelected');
        var SelectedRowIndex=$('#tblSalesReports').datagrid('getRowIndex',oSalesReport);
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        oSalesReport.ErrorMessage = "Edit SalesReport";
        RefreshControl(oSalesReport);
        sessionStorage.setItem("SalesReportHeader", "Edit SalesReport");
        $("#winSalesReport").icsWindow('open', "Edit Sales Report Parameter");

    });

    $("#btnView").click(function(){
        debugger;
        var oSalesReport= $('#tblSalesReports').datagrid('getSelected');
        var SelectedRowIndex=$('#tblSalesReports').datagrid('getRowIndex',oSalesReport);
        sessionStorage.setItem("SelectedRowIndex", SelectedRowIndex);
        oSalesReport.ErrorMessage = "View SalesReport";
        RefreshControl(oSalesReport);
        sessionStorage.setItem("SalesReportHeader", "View SalesReport");
        $("#winSalesReport").icsWindow('open', "View Sales Report Parameter");

    });

    function RefreshControl(oSalesReport){
        debugger;
        if(oSalesReport.ErrorMessage == "Edit SalesReport"){
            $('#tblSalesReports').data('SalesReport', parseInt(oSalesReport.SalesReportID)),
            $('#txtName').val(oSalesReport.Name);
            $('#txtPrintName').val(oSalesReport.PrintName);
            $('#txtQuery').val(oSalesReport.Query);
            $('#txtReportType').val(oSalesReport.ReportType);
            $('#cboBUID').val(parseInt(oSalesReport.BUID));
            $('#txtID_Date').val(oSalesReport.IDs);
            $('#txtGrpBy').val(oSalesReport.GrpByQ);
            $('#cboIsDouble').val(parseInt(oSalesReport.IsDouble));
            $('#cboParent').val(parseInt(oSalesReport.ParentID));
            $('#txtAllocatonHeader').val(oSalesReport.AllocationHeader);
            $('#txtTargetQuery').val(oSalesReport.DispoTargetQuery);
            $('#txtQueryL2').val(oSalesReport.QueryLayerTwo);
            $('#txtQueryL3').val(oSalesReport.QueryLayerThree);
            $('#txtNote').val(oSalesReport.Note);

        }
        if(oSalesReport.ErrorMessage == "View SalesReport"){
            $('#tblSalesReports').data('SalesReport', parseInt(oSalesReport.SalesReportID)),
            $('#txtName').val(oSalesReport.Name);
            $('#txtPrintName').val(oSalesReport.PrintName);
            $('#txtQuery').val(oSalesReport.Query);
            $('#txtReportType').val(oSalesReport.ReportType);
            $('#cboBUID').val(parseInt(oSalesReport.BUID));
            $('#txtID_Date').val(oSalesReport.IDs);
            $('#txtGrpBy').val(oSalesReport.GrpByQ);
            $('#cboIsDouble').val(parseInt(oSalesReport.IsDouble));
            $('#cboParent').val(parseInt(oSalesReport.ParentID));
            $('#txtAllocatonHeader').val(oSalesReport.AllocationHeader);
            $('#txtTargetQuery').val(oSalesReport.DispoTargetQuery);
            $('#txtQueryL2').val(oSalesReport.QueryLayerTwo);
            $('#txtQueryL3').val(oSalesReport.QueryLayerThree);
            $('#txtNote').val(oSalesReport.Note);
            $('#btnSave').hide();
            $('#txtName').attr('disabled','disabled');
            $('#txtPrintName').attr('disabled','disabled');
            $('#txtQuery').attr('disabled','disabled');
            $('#txtReportType').attr('disabled','disabled');
            $('#cboBUID').attr('disabled','disabled');
            $('#txtID_Date').attr('disabled','disabled');
            $('#txtGrpBy').attr('disabled','disabled');
            $('#cboIsDouble').attr('disabled','disabled');
            $('#cboParent').attr('disabled','disabled');
            $('#txtAllocatonHeader').attr('disabled','disabled');
            $('#txtTargetQuery').attr('disabled','disabled');
            $('#txtQueryL2').attr('disabled','disabled');
            $('#txtQueryL3').attr('disabled','disabled');
            $('#txtNote').attr('disabled','disabled');
        }

    }
    function ValidateInput(){
        debugger;
        var oName = $('#txtName').val();
        if(oName == "" || oName==undefined){
            alert("Please Enter Name.")
            $('#txtName').focus();
            return false;
        }
        var oPrintName = $('#txtPrintName').val();
        if(oPrintName == "" || oPrintName==undefined){
            alert("Please Enter Print Name.")
            $('#txtPrintName').focus();
            return false;
        }
        var oQuery= $('#txtQuery').val();
        if(oQuery == "" || oQuery==undefined){
            alert("Please Enter Query.")
            $('#txtQuery').focus();
            return false;
        }
        var oID_Date= $('#txtID_Date').val();
        if(oID_Date == "" || oID_Date==undefined){
            alert("Please Enter IDs and Date.")
            $('#txtID_Date').focus();
            return false;
        }
        var oGrpByQ= $('#txtGrpBy').val();
        if(oGrpByQ == "" || oGrpByQ==undefined){
            alert("Please Write Group By.")
            $('#GrpByQ').focus();
            return false;
        }
        //var oBUID= parseInt($('#cboBUID').val());
        //if(oBUID == "" || oBUID==undefined){
        //    alert("Please select Business Unit");
        //    $('#cboBUID').focus();
        //    return false;
        //}
        return true;
    }

    $('#btnSaveCopy').click(function(){
        debugger;
        if(!ValidateInput()) return;
        var oSalesReport=RefreshObject();
        oSalesReport.SalesReportID=0;
        $.ajax({
            type: "POST",
            dataType: "json",
            url :  $('#tblSalesReports').data('BaseAddress')+ "/SalesReport/Save",
            traditional: true,
            data:  JSON.stringify(oSalesReport),
            contentType: "application/json; charset=utf-8",
            success: function (data)
            {
                debugger;
                oSalesReport = jQuery.parseJSON(data);
                if (oSalesReport.ErrorMessage=="" || oSalesReport.ErrorMessage==null)
                {
                    alert("Data Saved sucessfully");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    if(sessionStorage.getItem("SalesReportHeader") == "Add SalesReport")
                    {
                        $('#tblSalesReports').datagrid('appendRow',oSalesReport);
                        var oData = $('#tblSalesReports').datagrid('getRows');
                        $('#tblSalesReports').datagrid('selectRow',oData.length-1);

                    }
                    if(sessionStorage.getItem("SalesReportHeader") == "Edit SalesReport")
                    {
                        $('#tblSalesReports').datagrid('updateRow',{index : nIndex, row:oSalesReport});
                    }

                    $("#winSalesReport").icsWindow('close');
                }
                else
                {
                    alert(oSalesReport.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }

        });
    });
    $('#btnSave').click(function(){
        debugger;
        if(!ValidateInput()) return;
        var oSalesReport=RefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url :  $('#tblSalesReports').data('BaseAddress')+ "/SalesReport/Save",
            traditional: true,
            data:  JSON.stringify(oSalesReport),
            contentType: "application/json; charset=utf-8",
            success: function (data)
            {
                debugger;
                oSalesReport = jQuery.parseJSON(data);
                if (oSalesReport.ErrorMessage=="" || oSalesReport.ErrorMessage==null)
                {
                    alert("Data Saved sucessfully");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedRowIndex"));
                    if(sessionStorage.getItem("SalesReportHeader") == "Add SalesReport")
                    {
                        $('#tblSalesReports').datagrid('appendRow',oSalesReport);
                        var oData = $('#tblSalesReports').datagrid('getRows');
                        $('#tblSalesReports').datagrid('selectRow',oData.length-1);

                    }
                    if(sessionStorage.getItem("SalesReportHeader") == "Edit SalesReport")
                    {
                        $('#tblSalesReports').datagrid('updateRow',{index : nIndex, row:oSalesReport});
                    }

                    $("#winSalesReport").icsWindow('close');
                }
                else
                {
                    alert(oSalesReport.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }

        });
    });
    $('#btnDelete').click(function(){
        debugger;
        var oSalesReport= $('#tblSalesReports').datagrid('getSelected');

        if (!confirm("Confirm to Delete?")) return ;

        if(oSalesReport==null || oSalesReport.SalesReportID<=0)
        {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        var SelectedRowIndex=$('#tblSalesReports').datagrid('getRowIndex',oSalesReport);
        if (oSalesReport.SalesReportID > 0)
        {
            $.ajax ({
                type: "GET",
                dataType: "json",
                url : $('#tblSalesReports').data('BaseAddress')+ "/SalesReport/Delete",
                data: {id: oSalesReport.SalesReportID},
                contentType:"application/json; charset=utf-8",
                success: function (data) {
                    //debugger;
                    feedbackmessage = jQuery.parseJSON(data);
                    if (feedbackmessage == "Deleted")
                    {
                        alert("Delete sucessfully");
                        $('#tblSalesReports').datagrid('deleteRow',SelectedRowIndex);

                    }
                    else
                    {
                        alert(feedbackmessage);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }

            });
        }
    });
    function RefreshList(oSalesReports) {
        debugger;
        data={"total":""+oSalesReports.length+"","rows":oSalesReports};
        $('#tblSalesReports').datagrid('loadData',data);
        var nSelectedRowIndex =parseInt(sessionStorage.getItem("SelectedRowIndex"));
        if(nSelectedRowIndex!=-1)
        {
            $('#tblSalesReport').datagrid('selectRow', nSelectedRowIndex);
        }
    }

    $('#btnActive').click(function(){
        debugger;
        var oSalesReport= $('#tblSalesReports').datagrid('getSelected');
        if(oSalesReport==null || parseInt(oSalesReport.SalesReportID)<=0)
        {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        if(oSalesReport.Activity==true)
        {
            alert("Your Selected Request Already Active!");
            return false;
        }
        if (!confirm("Confirm to Active?")) return ;
        var SelectedRowIndex=$('#tblSalesReports').datagrid('getRowIndex', oSalesReport);
        if (parseInt(oSalesReport.SalesReportID) > 0)
        {
            $.ajax
            ({
                type: "POST",
                dataType: "json",
                url :$('#tblSalesReports').data('BaseAddress')+ "/SalesReport/Activate",
                data: JSON.stringify(oSalesReport),
                contentType:"application/json; charset=utf-8",
                success: function (data) {
                    var oSalesReport = jQuery.parseJSON(data);
                    if (oSalesReport != null && oSalesReport.ErrorMessage == "")
                    {
                        alert(" Activate sucessfully");
                        $('#tblSalesReports').datagrid('updateRow',{ index: SelectedRowIndex, row: oSalesReport });
                    }
                    else
                    {
                        alert(oSalesReport.ErrorMessage);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }

            });
        }
    });
    $('#btnInActive').click(function(){
        debugger;
        var oSalesReport= $('#tblSalesReports').datagrid('getSelected');
        if(oSalesReport==null || parseInt(oSalesReport.SalesReportID)<=0)
        {
            alert("Invalid Field!!! please select a valid Field!");
            return false;
        }
        if(oSalesReport.Activity==false)
        {
            alert("Your Selected Request Already InActive!");
            return false;
        }
        if (!confirm("Confirm to InActive?")) return ;
        var SelectedRowIndex=$('#tblSalesReports').datagrid('getRowIndex', oSalesReport);
        if (parseInt(oSalesReport.SalesReportID) > 0)
        {
            $.ajax
            ({
                type: "POST",
                dataType: "json",
                url :$('#tblSalesReports').data('BaseAddress')+ "/SalesReport/InActivate",
                data: JSON.stringify(oSalesReport),
                contentType:"application/json; charset=utf-8",
                success: function (data) {
                    var oSalesReport = jQuery.parseJSON(data);
                    if (oSalesReport != null && oSalesReport.ErrorMessage == "")
                    {
                        alert(" InActivate sucessfully");
                        $('#tblSalesReports').datagrid('updateRow',{ index: SelectedRowIndex, row: oSalesReport });
                    }
                    else
                    {
                        alert(oSalesReport.ErrorMessage);
                    }
                },
                error: function (xhr, status, error)
                {
                    alert(error);
                }

            });
        }
    });
    </script>
