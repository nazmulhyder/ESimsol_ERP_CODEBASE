@{
    ViewBag.Title = "Production Plans";
}

@model IEnumerable<ESimSol.BusinessObjects.SUProductionPlan>
    <head>
        <title></title>
        <link href="@Url.Content("~/Content/CSS/MeetingSummary.css")" rel="stylesheet" type="text/css" />
        <script src="@Url.Content("~/Views/SUProductionPlan/SUProductionPlan.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/SUProductionPlan/SUProductionPlanMonitor.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/SUProductionPlan/SUProductionPlanDetails.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Views/ProductCategory/ProductPicker.js")" type="text/javascript"></script>
    </head>
    <body>
        <div id="winPrintFormat1" style="width:200px;" class="easyui-window winstyle" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset>
                <legend>Qty Fromat : </legend>
                <table style="width:100%;">
                    <tr>
                        <td>
                            <input id="chkInKg1" type="checkbox" checked /> In KG
                        </td>
                        <td>
                            <input id="chkInLBS1" type="checkbox" /> In LBS
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                @using (Html.BeginForm("PrintSUProductionPlans", "SUProductionPlan", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank", @class = "PrintForm" }))
                {
                    <input type="text" name="txtCollectionPrintText" id="txtCollectionPrintText" hidden="hidden" />
                    <input type="submit" id="btnOkPrintFormat1" value="     Print List" class="icon-print PrintList" />
                }
                <a id="btnClosePrintFormat1" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
            </fieldset>
        </div>
        <div id="winProductPickerByName" class="easyui-window" title="Product Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div id="divProductPickerByName" tabindex="-1">
                <table id="tblProductPicker" class="easyui-datagrid" style="width: 400px; height: 350px; margin: 0;"
                       data-options="singleSelect: true,fitColumns:false, rownumbers:true, pagination:false, autoRowHeight:false, toolbar: '#toolbarProductPickerByName' ">
                    <thead>
                        <tr>
                            <th field="ProductCode" width="20%" align="left">Code</th>
                            <th field="ShortName" width="30%" align="left">Count/Product</th>
                            <th field="ProductName" width="50%" align="left">Product Description</th>
                        </tr>
                    </thead>
                </table>
                <div id="toolbarProductPickerByName">
                    <input id="txtSearchByProductNamePicker" class="txtPickerSearchInputField" type="text" placeholder="Search by Description" />
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <a id="btnOkProductPickerByName" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-ok" plain="true">Ok</a>
                <a id="btnCloseProductPicker" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-closed" plain="true">Close</a>
            </fieldset>
        </div>

        <div id="winDetailsSUPP" class="easyui-window winstyle" title="Production Plan Supporting Informations" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <div class="easyui-tabs" style="width:700px;height:450px">
                <div title="Stock">
                    <div style="height:380px">
                        <table id="tblLotsSUPP" style="width:700px; height:350px;" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarLotsSUPP"></table>
                        <div id="toolbarLotsSUPP">
                            <a id="btnRefreshLotsSUPP" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                        </div>
                    </div>
                    <div style="height:30px">
                        <table border="0">
                            <tr>
                                <td style="width:44%;"></td>
                                <td id="tdTotalCaption" style="text-align: right; font-size: 12px; font-weight:bold"> Total : </td>
                                <td style="width: 25%; text-align: right; font-size: 12px">
                                    <label id="lblLotsTotalKGQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                                </td>
                                <td style="width: 25%; text-align: right; font-size: 12px">
                                    <label id="lblLotsTotalLBSQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                                </td>

                            </tr>
                        </table>
                    </div>
                </div>
                <div title="Export PI">
                    <div style="height:380px">
                        <table id="tblExportPISUPP" style="width:700px; height:350px;" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarExportPISUPP"></table>
                        <div id="toolbarExportPISUPP">
                            <a id="btnRefreshExportPISUPP" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                        </div>
                    </div>
                    <div style="height:30px">
                        <table border="0">
                            <tr>
                                <td style="width:79%;"></td>
                                <td id="tdTotalCaption" style="text-align: right; font-size: 12px; font-weight:bold"> Total : </td>

                                <td style="width: 15%; text-align: right; font-size: 12px">
                                    <label id="lblExPITotalKGQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div title="Advanced Order">
                    <div style="height:380px">
                        <table id="tblAdvOrderSUPP" style="width:700px; height:350px;" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarAdvOrderSUPP"></table>
                        <div id="toolbarAdvOrderSUPP">
                            <a id="btnRefreshAdvOrderSUPP" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                        </div>
                    </div>
                    <div style="height:30px">
                        <table border="0">
                            <tr>
                                <td style="width:74%;"></td>
                                <td id="tdTotalCaption" style="text-align: right; font-size: 12px; font-weight:bold"> Total : </td>

                                <td style="width: 20%; text-align: right; font-size: 12px">
                                    <label id="lblAdvSUDOTotalKGQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div title="Regular Order">
                    <div style="height:380px">
                        <table id="tblRegularOrderSUPP" style="width:700px; height:350px;" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarRegularOrderSUPP"></table>
                        <div id="toolbarRegularOrderSUPP">
                            <a id="btnRefreshRegularOrderSUPP" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                        </div>
                    </div>
                    <div style="height:30px">
                        <table border="0">
                            <tr>
                                <td style="width:74%;"></td>
                                <td id="tdTotalCaption" style="text-align: right; font-size: 12px; font-weight:bold"> Total : </td>

                                <td style="width: 20%; text-align: right; font-size: 12px">
                                    <label id="lblRegularSudoTotalKGQty" style="text-align: right; font-size:12px; float: right; font-weight:bold">0.00</label>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <table>
                    <tr>
                        <td style="width:565px; text-align:right"></td>
                        <td style="width:100px; text-align:right;">
                            <a id="btnCloseDetailsSUPP" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-closed" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>

        <div id="winSUProductionPlan" class="easyui-window winstyle" title="SUProductionPlan Informations" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
            <fieldset>
                <legend>Informations :</legend>
                <table>
                    <tr>

                        <td style="width:140px;" align="right">
                            <label>Yarn Count :</label>
                        </td>
                        <td style="width:250px;" colspan="2">
                            <input id="txtProductSUProductionPlan" type="text" style="width:163px;" placeholder="Type & Press Enter" />
                            <a id="btnClrProductSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Clear Selection" iconcls="icon-clear" plain="true">C</a>
                            <a id="btnPicProductSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Pick Product" iconcls="icon-pick" plain="true">P</a>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:140px;" align="right">
                            <label>No. of Machine :</label>
                        </td>
                        <td style="width:125px;">
                            <select id="cboMachineQty" style="width:120px;"></select>
                        </td>
                        <td style="width:125px;">
                            <input id="txtAvailableMachineQty" type="text" style="width:115px;" disabled="disabled" />
                        </td>

                    </tr>
                    <tr>
                        <td style="width:140px;" align="right">
                            <label>Capacity(/Machine/Day) :</label>
                        </td>
                        <td style="width:125px;">
                            <input id="txtCapacityPerDay" type="text" class="number" style="width:120px;" />
                        </td>
                        <td style="width:125px;">
                            <select id="cboMeasurementUnitTypes" style="width:121px;"></select>
                        </td>

                    </tr>
                    <tr>
                        <td style="width:140px;" align="right">
                            <label>Remarks :</label>
                        </td>
                        <td style="width:250px;" colspan="2">
                            <input id="txtRemarks" type="text" style="width:245px;" />
                        </td>
                    </tr>
                </table>

            </fieldset>
            <fieldset class="actionfieldsetstyle">
                <legend>Actions : </legend>
                <table>
                    <tr>
                        <td style="width:290px; text-align:right"></td>
                        <td style="width:50px; text-align:right;">
                            <a id="btnSaveSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        </td>
                        <td style="width:50px; text-align:right;">
                            <a id="btnCloseSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-closed" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>

        <div class="menuMainCollectionTable">
            <table id="tblSUProductionPlans" title="Spinning Unit Production Plan List" class="easyui-datagrid" fit="true" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarSUProductionPlan" data-options="onClickRow: onClickRow, rowStyler: function(index,row){
                if(row.MachineQty > 0){
                    return 'background-color:gray;color:white;cursor:pointer;';
                }
            }"></table>
            <div id="toolbarSUProductionPlan">
                <table>
                    <tr>
                        <td>
                            <input id="txtYarnCountSUProductionPlan" type="text" style="width:160px" placeholder="Search by Count/Product" />
                            <a id="btnRefreshSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Refresh" iconcls="icon-reload" plain="true">Refresh</a>
                            <a id="btnNewSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="New" iconcls="icon-add" plain="true">New</a>
                            <a id="btnEditSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Edit" iconcls="icon-edit" plain="true">Edit</a>
                            <a id="btnViewSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Details" iconcls="icon-details" plain="true">Details</a>
                            <a id="btnActiveSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Active/In-Active" iconcls="icon-active" plain="true">Active/In-Active</a>
                            <a id="btnInformationsSUProductionPlan" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="View Supporting Informations" iconcls="icon-details" plain="true">Informations</a>
                            <a id="btnPrintList" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" title="Preview" iconcls="icon-print" plain="true">Print List</a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </body>
    <script type="text/javascript">
        var _oSUProductionPlan = {ErrorMessage:"",MKTPersonID:0,SUProductionPlanDateTime:''};
        var _oBaseSUProductionPlan = {ErrorMessage:"",MKTPersonID:0,SUProductionPlanDateTime:''};
        var _oSUProductionPlans = [];
        var _oDBSUProductionPlans = [];
        var _sBaseAddress = "";
        var _oCurrentUser={};
        var _oProduct={};
        var _otblColumns=[];
        var _nbtnIDNo =0;
        var _nAvailableMachines=0;
        var _oMUs=[];

        $(document).ready(function() {
            _sBaseAddress = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            _oCurrentUser=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.CurrentUser]));
            _oDBSUProductionPlans = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _oMUs=@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MUs));
            InitializeSUProductionPlansEvents();
            InitializeSUProductionPlanEvents();
            InitializeProductPickerEvents();
            InitializeSUProductionPlanDetailsEvents();
            $("#txtYarnCountSUProductionPlan").focus();
        });
        $(document).keydown(function (e) { if (e.keyCode === 27) { $('div').icsWindow("close")}});

        function onClickRow(index){
            $("#tblSUProductionPlans").datagrid("selectRow", index);
        }
    </script>
