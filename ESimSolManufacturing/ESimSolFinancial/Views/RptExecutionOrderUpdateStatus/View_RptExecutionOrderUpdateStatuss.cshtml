
@{
    ViewBag.Title = "Execution Order Update Status";
}
@model IEnumerable<ESimSol.BusinessObjects.RptExecutionOrderUpdateStatus>
<html>
<head>
    <title>Execution Order Update Status</title>
</head>
<body>
    <div id="winDetails" style="width:500px;" class="easyui-window" title="Detail" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <table>
            <tr>
                <td style="text-align:right; width:18%;">
                    <label>Buyer Name : </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblBuyerName"></label>
                </td>
                <td style="text-align:right; width:18%;">
                    <label>Order No : </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblOrderNo"></label>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width:18%;">
                    <label>Order Qty : </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblOrderQty"></label>
                </td>
                <td style="text-align:right; width:18%;">
                    <label>Process Type: </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblProcessType"></label>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width:18%;">
                    <label>FDO Qty : </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblFDOQty"></label>
                </td>
                <td style="text-align:right; width:18%;">
                    <label>DEO Qty: </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblDEOQty"></label>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width:18%;">
                    <label>YTO Qty : </label>
                </td>
                <td class="tdLbl" style="width: 28%;">
                    <label id="lblYTOQty"></label>
                </td>
                <td style="text-align:right; width:18%;"></td>
                <td class="tdLbl" style="width: 28%;"></td>
            </tr>
        </table>
        <table id="tblDetail" class="easyui-datagrid" style="height:280px;width:100%" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false">
            <thead>
                <tr>
                    <th field="BuyerName" width="60%">Qty Type</th>
                    <th field="OrderQtySt" width="38%" align="right">Qty</th>
                </tr>
            </thead>
        </table>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnCloseDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <div id="winAdvSearchFEO" style="width:800px;" class="easyui-window" title="Adv. Search" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <fieldset style="margin-bottom: 0px;">
            <legend>Searching Criteria</legend>
            <div style="width:48%;margin-right:5px;float:left;">
                <table>
                    <tr>
                        <td style="text-align:right; width:25%;">
                            <label>Order Type :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <select id="cboOrderTypeAdvSearch" style="margin-right: 19px;width:100%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Process Type :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <select id="cboProcessTypeAdvSearch" style="margin-right: 19px;width:100%;"></select>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Buyer :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtBuyerAdvSearch" type="text" style="width:98%;" placeholder="Type Name and Press Enter" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Buyer Ref :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtBuyerRefAdvSearch" type="text" style="width:98%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Style No :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtStyleNoAdvSearch" type="text" style="width:98%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Construction :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtConstructionAdvSearch" type="text" style="width:98%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Garments :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtGarmentsAdvSearch" type="text" style="width:98%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Color :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtColorAdvSearch" type="text" style="width:98%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Mkt Person :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <select id="cboMktPersonAdvSearch" style="width:100%;"> </select>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;width:25%;">
                            <label>Order Qty :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtFromQtyAdvSearch" class="number" type="text" style="width:44%;" />To
                            <input id="txtToQtyAdvSearch" class="number" type="text" style="width:44%;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">
                            <label>Prepare By :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtPrepareByAdvSearch" type="text" style="width:98%; " placeholder="Search FEO Prepare By" />
                        </td>
                    </tr>
                    <tr id="regionWarpBalance">
                        <td style="text-align:right;width:25%;">
                            <label>Warp Balance :</label>
                        </td>
                        <td colspan="3" style="width: 73%;">
                            <input id="txtFromWarpBalanceAdvSearch" class="number" type="text" style="width:44%;" />To
                            <input id="txtToWarpBalanceAdvSearch" class="number" type="text" style="width:44%;" />
                        </td>
                    </tr>
                </table>
            </div>
            <div style="width:48%;margin-right:5px;float:left;">
                <table>
                    <tr>
                        <td style="text-align:right;">
                            <label>Order Ref :</label>
                        </td>
                        <td colspan="3">
                            <input id="txtOrderRefAdvSearch" type="text" style="width:98%;margin-left: 4px;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">
                            <label>Fabric ID :</label>
                        </td>
                        <td colspan="3">
                            <input id="txtFabricNoAdvSearch" type="text" style="width:98%;margin-left: 4px;" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">
                            <label>Order Date :</label>
                        </td>
                        <td colspan="3">
                            <input type="checkBox" id="chkOrderDateAdvSearch" />
                            <input id="txtFromOrderDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToOrderDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">
                            <label>Del Start Date :</label>
                        </td>
                        <td colspan="3">
                            <input type="checkBox" id="chkDelStartDateAdvSearch" />
                            <input id="txtFromDelStartDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDelStartDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">
                            <label>Del End Date :</label>
                        </td>
                        <td colspan="3">
                            <input type="checkBox" id="chkDelEndDateAdvSearch" />
                            <input id="txtFromDelEndDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />To
                            <input id="txtToDelEndDateAdvSearch" type="text" style="width: 110px;" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;"></td>
                        <td>
                            <input id="chkApproveAdvSearch" type="checkbox" />
                            <label>Approve</label>
                        </td>
                        <td colspan="2">
                            <input id="chkUnapproveAdvSearch" type="checkbox" />
                            <label>Unapprove</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;"></td>
                        <td>
                            <input id="chkYetToYTOAdvSearch" type="checkbox" />
                            <label>Yet To YTO</label>
                        </td>
                        <td colspan="2">
                            <input id="chkHasSpecification" type="checkbox" />
                            <label>Has specification</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;"></td>
                        <td>
                            <input id="chkHasFabricPattern" type="checkbox" />
                            <label>Has fabric pattern</label>
                        </td>
                        <td colspan="2">
                            <input id="chkYetToSpecification" type="checkbox" />
                            <label>Yet to specification</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;"></td>
                        <td>
                            <input id="chkSWC" type="checkbox" />
                            <label>SCW</label>
                        </td>
                        <td colspan="2">
                            <input id="chkExe" type="checkbox" />
                            <label>EXE</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:right;"><label>Exe Status :</label> </td>
                        <td colspan="3">
                            <select id="cboExeStauts" style="width:95%; margin-left: 4px;">
                                <option value="0">-- Select Status --</option>
                                <option value="1">Yet To Dyeing Program</option>
                                <option value="2">Yet To Yarn Receive</option>
                                <option value="3">Yet To Warping Plan</option>
                                <option value="4">Yet To Warping</option>
                                <option value="5">Yet To Sizing</option>
                                <option value="6">Yet To Loom</option>
                                <option value="7">Yet To QC</option>
                                <option value="8">Yet To Recv Weaving Del Store</option>
                                <option value="9">Yet To Transfer Finishing</option>
                                <option value="10">Yet To Finishing Receive</option>
                            </select>
                        </td>
                    </tr>
                    

                </table>
            </div>
        </fieldset>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <label class="lblLoadingMessage" style="float: left;">Loading Please Wait...</label>
            <a id="btnResetAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Reset</a>
            <a id="btnSearchAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Search</a>
            <a id="btnCloseAdvSearch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <div id="winFabricBatch" style="width:900px;" class="easyui-window" title="Fabric Batch Detail" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <table id="tblFabricBatch" class="easyui-datagrid" style="height:280px;width:100%" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false">
            <thead>
                <tr>
                    <th field="BatchNo" width="10%">Batch No</th>
                    <th field="Qty" width="10%" formatter="formatPrice" align="right">Qty</th>
                    <th field="StatusSt" width="15%">Status</th>
                    <th field="WarpingStartTimeStr" width="15%">Warping Date</th>
                    <th field="SizingStartTimeStr" width="15%">Sizing Date</th>
                    <th field="DrawingStartTimeStr" width="15%">Drawing Date</th>
                    <th field="LoomStartTimeStr" width="15%">Loom Date</th>
                </tr>
            </thead>
        </table>
        <fieldset class="actionfieldsetstyle">
            <legend>Actions : </legend>
            <a id="btnCloseFabricBatch" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
        </fieldset>
    </div>
    <div class="menuMainCollectionTable">
        <table id="tblEOUStatus" title="Execution Order Update Status" style="height:100%;" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarEOUStatus">
            <thead frozen="true">
                <tr>
                    <th field="OrderNo" width="13%" frozen>Order No</th>
                    <th field="Construction" width="12%" frozen>Construction</th>
                    <th field="OrderQty" width="8%" align="right" formatter="formatPrice">Order Qty (Y)</th>
                    <th field="BuyerName" width="15%" frozen>Buyer Name</th>
                </tr>
            </thead>
            <thead>
                <tr>
                    <th field="ProcessTypeName" width="10%" frozen>Process Type</th>
                    <th field="OrderDateSt" width="10%" align="center">Issue Date</th>
                    <th field="StartDateSt" width="12%" frozen>Del Start Date</th>
                    <th field="ExpDelEndDateSt" width="12%" frozen>Del End Date</th>
                    <th field="PPSampleDateSt" width="12%" frozen>PP Sample Date</th>
                    <th field="ExecutionStatus" width="12%" frozen>Status</th>
                    <th field="YTOCount" width="15%">YTO Count</th>
                    @*<th field="YTOQty" width="10%" align="right" formatter="formatPrice">YTO Qty</th>*@

                    <th field="DUYarnReceiveQty" width="10%" align="right" formatter="formatPrice">DU Yarn Recv</th>
                    <th field="DEOCount" width="15%" align="center">DEO Count</th>

                    <th field="Color" width="15%" align="center">Color</th>
                    @*<th field="DEOQty" width="10%" align="right" formatter="formatPrice">DEO Qty</th>*@

                    <th field="WarpingPlanQty" width="10%" align="right" formatter="formatPrice">Warping Plan Qty</th>
                    <th field="WarpingConsumeQty" width="12%" align="right" formatter="formatPrice">Warping Consume Qty</th>
                    <th field="WarpingDoneQty" width="10%" align="right" formatter="formatPrice">Warping Done Qty</th>
                    <th field="WarpingDate" width="30%" align="center">Warping Date</th>

                    <th field="SizingDoneQty" width="10%" align="right" formatter="formatPrice">Sizing Done Qty</th>
                    <th field="SizingDate" width="30%" align="center">Sizing Date</th>

                    <th field="LoomDoneQty" width="10%" align="right" formatter="formatPrice">Loom Done Qty</th>
                    <th field="LoomDate" width="30%" align="center">Loom Date</th>

                    <th field="QcAndInspectionQty" width="10%" align="right" formatter="formatPrice">Inspected Qty</th>
                    <th field="InspectionDate" width="30%" align="center">Inspected Date</th>

                    <th field="ReadyToDelivery" width="12%" align="right" formatter="formatPrice">Ready To Del. Qty</th>
                    <th field="DeliverdToFU" width="12%" align="right" formatter="formatPrice">Finshing Trans. Qty</th>
                    <th field="TransferDate" width="30%" align="center">Transfer Date</th>

                    <th field="FNReceiveQty" width="12%" align="right" formatter="formatPrice">Finshing Recv. Qty</th>
                    <th field="FNReceiveDate" width="30%" align="center">Finishing Recv. Date</th>

                    <th field="DeliveryQty" width="12%" align="right" formatter="formatPrice">Delivered Qty</th>
                    <th field="DeliveryDate" width="30%" align="center">Delivery Date</th>
                </tr>
            </thead>
        </table>
        <div id="toolbarEOUStatus">
            <table id="tblSearch">
                <tr>
                    <td>
                        <select id="cboIsInHouses">
                            <option value="1">EXE</option>
                            <option value="0">SCW</option>
                        </select>
                        <input id="txtOrderNoFEO" style="width:55px;" placeholder="Order No" type="text" class="number"/>
                        <input id="txtYear" style="width:20px;" type="text" class="number" maxlength="2"/>
                        <a id="btnAdvSearchFEO" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-search" plain="true">Adv. Search</a>
                        <a id="btnExeDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Detail</a>
                        @using (Html.BeginForm("PrintEOUS", "RptExecutionOrderUpdateStatus", FormMethod.Post, new { enctype = "multipart/form-data", target = "_blank", @class = "PrintForm" }))
                        {
                            <input type="text" name="txtFOUS" id="txtFOUS" hidden="hidden" />
                            <input type="submit" id="btnPrintEOUS" value="   Print List" class="icon-print PrintList" onclick=" return isValidEOUS() " />
                        }
                        <a id="btnExcel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">Excel</a>
                        <a id="btnDetailFEO" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-details" plain="true">Production Detail</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html>
    <style type="text/css">
        .tdLbl {
            font-weight:bold;
            font-style: italic;
        }
    </style>
<script type="text/javascript">
    var _sBaseAddress = "";
    var _oFDOTypes=[];
    var _oProcessTypes=[];
    var _oMktPersons=[];
    var _sBuyerIDsAdvSearch="";
    $(document).ready(function() {
        _sBaseAddress = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));

        _oFDOTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.FDOTypes));
        _oProcessTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ProcessTypes));
        _oMktPersons = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.MktPersons));
        var oEOUStatuss = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));

        $('#btnPrintEOUS, #btnDetailFEO').hide();
        GetCommaSeparatedString(oEOUStatuss);
        DynamicRefreshList(oEOUStatuss,"tblEOUStatus");
        LoadAdvSearchFields();
        $("#txtYear").val(new Date().getFullYear().toString().slice(-2));
        $('#regionWarpBalance').hide();_
    });

    $(document).keydown(function (e) { if (e.keyCode == 27) { $('div').icsWindow('close'); } });

    //function CommaSeparatedValue(sValue){

    //    return (isNaN(sValue))? "" : formatPrice(sValue);

    //}

    $('#btnExeDetail').click(function(){
        var oFEO = $("#tblEOUStatus").datagrid("getSelected");
        if(oFEO == null || oFEO.FEOID <= 0)
        {
            alert("Select an item from list.");
            return false;
        }
        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: {FEOID:oFEO.FEOID},
            ControllerName: "FabricBatch",
            ActionName: "GetsFabricBatches",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {
            if (response.status && response.objs != null) {
                if (response.objs.length > 0) {
                    if(response.objs[0].FBID>0)
                    {
                        $("#winFabricBatch").icsWindow("open","Fabric Batch: "+ response.objs[0].FEONo +", Qty: "+ formatPrice(response.objs[0].ExecutionOrderQty));
                        DynamicRefreshList(response.objs,"tblFabricBatch");
                    }
                    else{
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("Data not found.");
                }
            }
        });

    });

    $('#btnCloseFabricBatch').click(function(){
        $("#winFabricBatch").icsWindow("close");
    });

    $("#btnDetailFEO").click(function(){
        var oFEO = $("#tblEOUStatus").datagrid("getSelected");
        if(oFEO == null || oFEO.FEOID <= 0)
        {
            alert("Select an item from list.");
            return false;
        }
        var oList = MakeRows(oFEO);
        DynamicRefreshList(oList,"tblDetail");

        $("#lblBuyerName").text(oFEO.BuyerName);
        $("#lblOrderNo").text(oFEO.OrderNo);
        $("#lblOrderQty").text(oFEO.OrderQtySt);
        $("#lblProcessType").text(oFEO.ProcessTypeName);
        $("#lblYTOQty").text(oFEO.YTOQtySt);
        $("#lblDEOQty").text(oFEO.DEOQtySt);
        $("#lblFDOQty").text(oFEO.FDOQtySt);
        $("#winDetails").icsWindow("open","Detail");
    });

    function MakeRows(oFEO)
    {
        var oList = [];
        for(var i=0;i<9;i++)
        {
            var oNewObj = {
                BuyerName:"",
                OrderQtySt : ""
            };

            if(i==0)      {oNewObj.BuyerName = "Yarn Receive Qty";    oNewObj.OrderQtySt = oFEO.YarnReceiveQtySt; }
            else if(i==1) {oNewObj.BuyerName = "Warping Plan Qty";    oNewObj.OrderQtySt = oFEO.WarpingPlanQtySt; }
            else if(i==2) {oNewObj.BuyerName = "Warping Qty";         oNewObj.OrderQtySt = oFEO.WarpingDoneQtySt; }
            else if(i==3) {oNewObj.BuyerName = "Sizing Qty";          oNewObj.OrderQtySt = oFEO.SizingDoneQtySt; }
            else if(i==4) {oNewObj.BuyerName = "Loom Qty";            oNewObj.OrderQtySt = oFEO.LoomDoneQtySt; }
            else if(i==5) {oNewObj.BuyerName = "QC & Inspection Qty"; oNewObj.OrderQtySt = oFEO.QcAndInspectionQtySt; }
            else if(i==6) {oNewObj.BuyerName = "Ready to Delivery";   oNewObj.OrderQtySt = oFEO.ReadyToDeliverySt; }
            else if(i==7) {oNewObj.BuyerName = "Deliverd To FU";      oNewObj.OrderQtySt = oFEO.DeliverdToFuSt; }
            else if(i==8) {oNewObj.BuyerName = "Deliverd Qty";        oNewObj.OrderQtySt = oFEO.DeliverdQtySt; }

            if($.trim(oNewObj.BuyerName) != ""){
                oList.push(oNewObj);
            }
        }
        return oList;
    }

    $("#btnCloseDetail").click(function(){
        $("#winDetails").icsWindow("close");
    });

    $("#btnExcel").click(function(){
        if($("#tblEOUStatus").datagrid("getRows").length == 0)
        {
            alert("No list found.");
            return false;
        }

        window.open(_sBaseAddress + '/RptExecutionOrderUpdateStatus/Excel?sFEOIDs=' + $('#txtFOUS').data("FEOIDs"), "_blank");
    });



    function GetCommaSeparatedString(oFEOs){
        var sFEOIDs="";
        if(oFEOs.length>0){
            for(var i=0;i<oFEOs.length;i++){

                sFEOIDs=sFEOIDs+oFEOs[i].FEOID+",";
            }
        }
        sFEOIDs=sFEOIDs.substring(0,sFEOIDs.length-1);
        $('#txtFOUS').data("FEOIDs",sFEOIDs);
    }

    function GetExecutionOrderUpdateStatus()
    {

        var oFEO={
            Params: $('#txtFOUS').data("FEOIDs"),
        }

        var obj =
        {
            BaseAddress: _sBaseAddress,
            Object: oFEO,
            ControllerName: "RptExecutionOrderUpdateStatus",
            ActionName: "GetsExecutionOrderUpdateStatus",
            IsWinClose: false
        };

        $.icsDataGets(obj, function (response) {
            if (response.status && response.objs != null) {
                if (response.objs.length > 0) {
                    if(response.objs[0].FEOID>0)
                    {
                        DynamicRefreshList(response.objs,"tblEOUStatus");
                    }
                    else{
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("Data found.");
                }
            }
        });
    }


    $("#txtOrderNoFEO,#txtYear").keydown(function (e) {
        if (e.keyCode == 13) // Enter Press
        {
            if($.trim($("#txtOrderNoFEO").val()) == "")
            {
                alert("Give Order No.");
                $("#txtOrderNoFEO").focus();
                $("#txtOrderNoFEO").addClass("errorFieldBorder");
                return false;
            }else{
                $("#txtOrderNoFEO").removeClass("errorFieldBorder");
            }

            if($.trim($("#txtYear").val()) == "")
            {
                alert("Give Year.");
                $("#txtYear").focus();
                $("#txtYear").addClass("errorFieldBorder");
                return false;
            }else{
                $("#txtYear").removeClass("errorFieldBorder");
            }

            var sFEONo = AddExtraZerosBeforeNumber(parseInt($.trim($("#txtOrderNoFEO").val())), 4);
            $("#txtOrderNoFEO").val(sFEONo);

            var oFEO = {
                Params: parseInt($("#cboIsInHouses").val()) + "~" + sFEONo + "~" + $.trim($("#txtYear").val())
            };
            var obj =
            {
                BaseAddress: _sBaseAddress,
                Object: oFEO,
                ControllerName: "FabricExecutionOrder",
                ActionName: "GetByFEONo",
                IsWinClose: false
            };

            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs != null) {
                    if (response.objs.length > 0 && response.objs[0].FEOID>0) {
                        debugger;
                        GetCommaSeparatedString(response.objs);
                        GetExecutionOrderUpdateStatus();
                    }
                    else {
                        DynamicRefreshList([], "tblEOUStatus");
                        alert("No item found.");
                    }
                }
            });
        }
    });

    function isValidEOUS()
    {
        if ($("#tblEOUStatus").datagrid("getRows").length <= 0) {
            alert("Empty List");
            return false;
        }
        return true;
    }

    function LoadAdvSearchFields()
    {
        $("#cboOrderTypeAdvSearch").icsLoadCombo({
            List: _oFDOTypes,
            OptionValue: "id",
            DisplayText: "Value"
        });

        $("#cboProcessTypeAdvSearch").icsLoadCombo({
            List: _oProcessTypes,
            OptionValue: "FabricProcessID",
            DisplayText: "Name"
        });

        $("#cboMktPerson,#cboMktPersonAdvSearch").icsLoadCombo({
            List: _oMktPersons,
            OptionValue: "EmployeeID",
            DisplayText: "Name"
        });

        $("#chkOrderDateAdvSearch").change(function() {
            if(this.checked) {
                $("#txtFromOrderDateAdvSearch,#txtToOrderDateAdvSearch").datebox({ disabled: false });
            }
            else{
                $("#txtFromOrderDateAdvSearch,#txtToOrderDateAdvSearch").datebox({ disabled: true });
            }
            $("#txtFromOrderDateAdvSearch,#txtToOrderDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        });

        $("#chkDelStartDateAdvSearch").change(function() {
            if(this.checked) {
                $("#txtFromDelStartDateAdvSearch,#txtToDelStartDateAdvSearch").datebox({ disabled: false });
            }
            else{
                $("#txtFromDelStartDateAdvSearch,#txtToDelStartDateAdvSearch").datebox({ disabled: true });
            }
            $("#txtFromDelStartDateAdvSearch,#txtToDelStartDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        });

        $("#chkDelEndDateAdvSearch").change(function() {
            if(this.checked) {
                $("#txtFromDelEndDateAdvSearch,#txtToDelEndDateAdvSearch").datebox({ disabled: false });
            }
            else{
                $("#txtFromDelEndDateAdvSearch,#txtToDelEndDateAdvSearch").datebox({ disabled: true });
            }
            $("#txtFromDelEndDateAdvSearch,#txtToDelEndDateAdvSearch").datebox("setValue", icsdateformat(new Date()));
        });
    }

    $("#btnAdvSearchFEO").click(function(){
        $(".lblLoadingMessage").hide();
        ResetAdvSearch();
        $("#winAdvSearchFEO").icsWindow("open","Advance Search");
    });

    $("#btnCloseAdvSearch").click(function(){
        $("#winAdvSearchFEO").icsWindow("close");
    });

    $("#btnResetAdvSearch").click(function(){
        ResetAdvSearch();
    });

    function ResetAdvSearch()
    {
        $("#winAdvSearchFEO").find("input").val("");
        $("#winAdvSearchFEO").find("input[type=checkbox]").prop('checked', false);
        $("#winAdvSearchFEO").find(".easyui-datebox").datebox({ disabled: true });
        $("#winAdvSearchFEO").find(".easyui-datebox").datebox("setValue", icsdateformat(new Date()));
        $("#winAdvSearchFEO").find("select").val(0);
        $("#winAdvSearchFEO").find("input,select").removeClass("errorFieldBorder");
        $("#winAdvSearchFEO").find("input,select").removeClass("fontColorOfPickItem");
        $("#txtPrepareByAdvSearch").data("PrepareByID","");
    }

    $("#txtBuyerAdvSearch").keydown(function(e){
        if(e.keyCode === 13)
        {
            var oContractor = {
                Params : 2 + "~" + $.trim($(this).val()) //Buyer
            };

            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oContractor,
                ControllerName: "Contractor",
                ActionName: "ContractorSearchByNameType",
                IsWinClose: false
            };

            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    if (response.objs[0].ContractorID > 0) {
                        var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 200, align: "left" }; tblColums.push(oColumn);
                        oColumn = { field: "ContractorTypeInString", title: "Type", width: 150, align: "left" }; tblColums.push(oColumn);
                        var oPickerParam = {
                            winid: 'winBuyers',
                            winclass: 'clsBuyer',
                            winwidth: 400,
                            winheight: 460,
                            tableid: 'tblBuyers',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName: 'Name',
                            windowTittle: 'Buyer List'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbuttonFEO(oPickerParam);
                    }
                    else {
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("Sorry, No Buyer Found.");
                }
            });
        }
        else if(e.keyCode === 8)
        {
            $("#txtBuyerAdvSearch").val("");
            _sBuyerIDsAdvSearch="";
        }
    });

    
    $("#txtPrepareByAdvSearch").keydown(function(e){
        if(e.keyCode === 13)
        {
            var oFEO = {
                Params : $.trim($('#txtPrepareByAdvSearch').val())
            };

            var obj = {
                BaseAddress: _sBaseAddress,
                Object: oFEO,
                ControllerName: "FabricExecutionOrder",
                ActionName: "GetsFEOPrepareBy",
                IsWinClose: false
            };

            $.icsDataGets(obj, function (response) {
                if (response.status && response.objs.length > 0) {
                    debugger;
                    if (response.objs[0].UserID > 0) {
                        var tblColums = []; var oColumn = { field: "UserName", title: "Name", width: 250, align: "left" }; tblColums.push(oColumn);
                       
                        var oPickerParam = {
                            winid: 'winPrepareBy',
                            winclass: 'clsPrepareBy',
                            winwidth: 330,
                            winheight: 460,
                            tableid: 'tblPrepareBy',
                            tablecolumns: tblColums,
                            datalist: response.objs,
                            multiplereturn: true,
                            searchingbyfieldName: 'UserName',
                            windowTittle: 'Prepare By'
                        };
                        $.icsPicker(oPickerParam);
                        IntializePickerbuttonFEO(oPickerParam);
                    }
                    else {
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("No data found.");
                }
            });
        }
        else if(e.keyCode === 8)
        {
            $("#txtPrepareByAdvSearch").val("");
            $("#txtPrepareByAdvSearch").data("PrepareByID","");
        }
    });

    function IntializePickerbuttonFEO(oPickerObj) {
        $("#" + oPickerObj.winid).find("#btnOk").click(function () {
            SetPickerValueAssignFEO(oPickerObj);
        });
        $(document).find('.' + oPickerObj.winclass).keydown(function (e) {
            if (e.which === 13) {
                SetPickerValueAssignFEO(oPickerObj);
            }
        });
    }

    function SetPickerValueAssignFEO(oPickerObj) {
        var oreturnObj = null, oreturnObjs = [];
        if (oPickerObj.multiplereturn) {
            oreturnObjs = $('#' + oPickerObj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#' + oPickerObj.tableid).datagrid('getSelected');
        }

        if (oPickerObj.winid == 'winBuyers') {
            if(oreturnObjs.length > 0)
            {
                _sBuyerIDsAdvSearch = "";
                var oContractors = oreturnObjs;
                for(var i=0;i<oContractors.length;i++)
                {
                    _sBuyerIDsAdvSearch = oContractors[i].ContractorID + "," + _sBuyerIDsAdvSearch;
                }
                _sBuyerIDsAdvSearch = _sBuyerIDsAdvSearch.substring(0,_sBuyerIDsAdvSearch.length-1);
                var split = _sBuyerIDsAdvSearch.split(",");
                $("#txtBuyerAdvSearch").val(split.length + " Buyer(s) Selected");
                $("#txtBuyerAdvSearch").focus();
            }
            else
            {
                alert("Select minimum one buyer from list.");
                return false;
            }
        }
        if (oPickerObj.winid == 'winPrepareBy') {
            $("#txtPrepareByAdvSearch").data("PrepareByID","");
            if(oreturnObjs.length > 0 && oreturnObjs.first().UserID>0)
            {
                $("#txtPrepareByAdvSearch").data("PrepareByID",oreturnObjs.select('UserID').separator());
                $("#txtPrepareByAdvSearch").val(oreturnObjs.length + " 's prepare by selected");
            }
            else
            {
                alert("Select at least one item");
                return false;
            }
        }
        $("#" + oPickerObj.winid).icsWindow("close");
        $("#" + oPickerObj.winid).remove();
    }



    $("#btnSearchAdvSearch").click(function(){
        $(".lblLoadingMessage").show();
        var nOrderType = $("#cboOrderTypeAdvSearch").val();
        var nProcessType = $("#cboProcessTypeAdvSearch").val();
        var sBuyerRef = $.trim($("#txtBuyerRefAdvSearch").val());
        var sStyleNo = $.trim($("#txtStyleNoAdvSearch").val());
        var sConstruction = $.trim($("#txtConstructionAdvSearch").val());

        var bIsDelStartDate = $("#chkDelStartDateAdvSearch").is(':checked');
        var dFromDelStartDate = $('#txtFromDelStartDateAdvSearch').datebox('getValue');
        var dToDelStartDate = $('#txtToDelStartDateAdvSearch').datebox('getValue');

        var bIsDelEndDate = $("#chkDelEndDateAdvSearch").is(':checked');
        var dFromDelEndDate = $('#txtFromDelEndDateAdvSearch').datebox('getValue');
        var dToDelEndDate = $('#txtToDelEndDateAdvSearch').datebox('getValue');

        var bIsOrderDate = $("#chkOrderDateAdvSearch").is(':checked');
        var dFromOrderDateDate = $('#txtFromOrderDateAdvSearch').datebox('getValue');
        var dToOrderDateDate = $('#txtToOrderDateAdvSearch').datebox('getValue');

        var bIsApproved = $("#chkApproveAdvSearch").is(':checked');
        var bIsUnapproved = $("#chkUnapproveAdvSearch").is(':checked');
        var bIsYetToYTO = $("#chkYetToYTOAdvSearch").is(':checked');

        debugger;
        var sFactory = $.trim($("#txtGarmentsAdvSearch").val());
        var sColor = $.trim($("#txtColorAdvSearch").val());
        var nMktPersonId = $("#cboMktPersonAdvSearch").val();

        var bYetToSpecification = $("#chkYetToSpecification").is(':checked');
        var bHasFabricPattern = $("#chkHasFabricPattern").is(':checked');
        var bHasSpecification = $("#chkHasSpecification").is(':checked');

        var nFromQtyAdvSearch=0;
        var nToQtyAdvSearch=0;
        if($.trim($("#txtFromQtyAdvSearch").val()) != "" && $("#txtFromQtyAdvSearch").val() != "." && parseFloat($("#txtFromQtyAdvSearch").val()) != 0)
        {
            nFromQtyAdvSearch = parseFloat($("#txtFromQtyAdvSearch").val());

            if($.trim($("#txtToQtyAdvSearch").val()) != "" && $("#txtToQtyAdvSearch").val() != "." && parseFloat($("#txtToQtyAdvSearch").val()) != 0)
            {
                nToQtyAdvSearch = nFromQtyAdvSearch;
                $("#txtToQtyAdvSearch").val(nToQtyAdvSearch);
            }
            else
            {
                nFromQtyAdvSearch = parseFloat($("#txtToQtyAdvSearch").val());
            }
        }

        var nFromWarpBalance=0;
        var nToWarpBalance=0;
        if($.trim($("#txtFromWarpBalanceAdvSearch").val()) != "" && $("#txtFromWarpBalanceAdvSearch").val() != "." && parseFloat($("#txtFromWarpBalanceAdvSearch").val()) != 0)
        {
            nFromWarpBalance = parseFloat($("#txtFromWarpBalanceAdvSearch").val());

            if($.trim($("#txtToWarpBalanceAdvSearch").val()) != "" && $("#txtToWarpBalanceAdvSearch").val() != "." && parseFloat($("#txtToWarpBalanceAdvSearch").val()) != 0)
            {
                nToWarpBalance = nFromWarpBalance;
                $("#txtToWarpBalanceAdvSearch").val(nToWarpBalance);
            }
            else
            {
                nFromWarpBalance = parseFloat($("#txtToWarpBalanceAdvSearch").val());
            }
        }

        var sOrderRefAdvSearch = $.trim($("#txtOrderRefAdvSearch").val());
        var sFabricNoAdvSearch = $.trim($("#txtFabricNoAdvSearch").val());


        var sParams = nOrderType + "~"
                    + nProcessType + "~"
                    + _sBuyerIDsAdvSearch + "~"
                    + sBuyerRef + "~"
                    + sStyleNo + "~"
                    + sConstruction + "~"
                    + bIsDelStartDate + "~"
                    + dFromDelStartDate + "~"
                    + dToDelStartDate + "~"
                    + bIsDelEndDate + "~"
                    + dFromDelEndDate + "~"
                    + dToDelEndDate + "~"
                    + bIsOrderDate + "~"
                    + dFromOrderDateDate + "~"
                    + dToOrderDateDate + "~"
                    + bIsApproved + "~"
                    + bIsUnapproved + "~"
                    + bIsYetToYTO + "~"
                    + sFactory + "~"
                    + sColor + "~"
                    + nMktPersonId + "~"
                    + bYetToSpecification + "~"
                    + bHasFabricPattern + "~"
                    + bHasSpecification + "~"
                    + nFromQtyAdvSearch + "~"
                    + nToQtyAdvSearch + "~"
                    + sOrderRefAdvSearch + "~"
                    + sFabricNoAdvSearch + "~"
                    + $('#cboExeStauts').val()+'~'
                    +$('#chkSWC').is(':checked')+'~'
                    +$('#chkExe').is(':checked')+'~'
                    +$("#txtPrepareByAdvSearch").data("PrepareByID");


        var oFEO = {
            Params: sParams
        };
        var obj =
       {
           BaseAddress: _sBaseAddress,
           Object: oFEO,
           ControllerName: "FabricExecutionOrder",
           ActionName: "GetsAdvSearch",
           IsWinClose: false
       };

        $.icsMaxDataGets(obj, function (response) {
            if (response.status && response.objs != null) {
                if (response.objs.length > 0) {
                    if(response.objs[0].FEOID>0)
                    {
                        GetCommaSeparatedString(response.objs);
                        GetExecutionOrderUpdateStatus();
                        $("#winAdvSearchFEO").icsWindow("close");
                    }
                    else{
                        alert(response.objs[0].ErrorMessage);
                    }
                }
                else
                {
                    alert("No List Found.");
                }
            }
            $(".lblLoadingMessage").hide();
        });
    });


</script>
