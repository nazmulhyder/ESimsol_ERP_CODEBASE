@using ESimSol.BusinessObjects;
@model BalanceSheet 
           
@{
var nComponentID = 0;
var sAccountingSession = ViewBag.msg;
double nTotalAmount = 0;
bool bFlag = false;
string sTemp = "";
double nTotalLabilityandOwnerEquity = 0;
double nTotalAssets = 0;
string sHeaderName = "";
}
           
           

<br />
<br />
<table>     
        <tr style="height:200px; vertical-align:bottom">
            <td width="100%"   style="text-align: center; font-size:12px; font-weight:bold">
                <u></u>
            </td>
        </tr>
</table>

 <table border="0">
            <tr style="height:30px">
                <td>
                    <table >
                        <tr>
                            <td style="width:900px; text-align:center">
                                <h3>Balance Sheet</h3>
                            </td>                            
                        </tr>
                        <tr>                            
                            <td style="width:900px; text-align:center">
                                <h5><u>Accounting Session : @sAccountingSession</u></h5>
                            </td> 
                        </tr>
                    </table>
                </td>
            </tr>
            <tr style="height:350px">
                <td>
                    <div style="height:300px; overflow:auto">
                        <table id="tblBalanceSheet" border="0" cellpadding="0" cellspacing="0">   
                          @foreach (BalanceSheet oBalanceSheet in Model.BalanceSheetlist)
                          {
                              if (nComponentID != oBalanceSheet.ComponentID)
                              {
                                  if (bFlag)
                                  {
                                     <tr>        
                                        <th colspan="3" style="width:800px; text-align:right"> @sTemp = @String.Format("{0:F}", nTotalAmount)</th>                                        
                                    </tr>
                                  }
                                  if (oBalanceSheet.ComponentID == 2) { sHeaderName = "Asset:"; }
                                  else if (oBalanceSheet.ComponentID == 3) { sHeaderName = "Liability:"; }
                                  else if (oBalanceSheet.ComponentID == 4) { sHeaderName = "Owners Equity"; }
                                  else if (oBalanceSheet.ComponentID == 5) { sHeaderName = "Income"; }
                                  else if (oBalanceSheet.ComponentID == 6) { sHeaderName = "Expenditure"; }
                                 <tr style="height:30px; vertical-align:bottom">        
                                    <th colspan="3" style="width:800px; text-align:left; text-decoration:underline"> @sHeaderName</th>
                                </tr>                    
                                <tr>        
                                    <th style="width:200px; text-align:left"> Account Code</th>
                                    <th style="width:400px; text-align:left"> Account Name</th>
                                    <th style="width:200px; text-align:right"> Balance</th> 
                                </tr>
                                  nTotalAmount = oBalanceSheet.ClosingBalance;

                                  if (oBalanceSheet.ComponentID == 2) { nTotalAssets = oBalanceSheet.ClosingBalance; }
                                  else if (oBalanceSheet.ComponentID == 6) { nTotalLabilityandOwnerEquity = nTotalLabilityandOwnerEquity - oBalanceSheet.ClosingBalance; }
                                  else { nTotalLabilityandOwnerEquity = nTotalLabilityandOwnerEquity + oBalanceSheet.ClosingBalance; }

                                  if (oBalanceSheet.ComponentID == 2) { sTemp = "Total Asset "; }
                                  else if (oBalanceSheet.ComponentID == 3) { sTemp = "Total Liability"; }
                                  else if (oBalanceSheet.ComponentID == 4) { sTemp = "Total Owners Equity"; }
                                  else if (oBalanceSheet.ComponentID == 5) { sTemp = "Total Income"; }
                                  else if (oBalanceSheet.ComponentID == 6) { sTemp = "Total Expenditure"; }
                              }
                                                            
                              <tr style="border:1px">
                                    <td style="width:200px">@Html.DisplayFor(modelItem => oBalanceSheet.AccountCode)</td>
                                    <td style="width:400px">@Html.DisplayFor(modelItem => oBalanceSheet.AccountHeadName)</td>
                                    <td style="width:200px; text-align:right">@String.Format("{0:F}", oBalanceSheet.ClosingBalance) </td>                                   
                              </tr>
                                    nComponentID = oBalanceSheet.ComponentID;
                                    bFlag = true;
                          }      
                            <tr style="height:80px; vertical-align:top">        
                                <th colspan="3" style="width:800px; text-align:right"> @sTemp= @String.Format("{0:F}", nTotalAmount)</th>                                        
                            </tr>    
                            <tr>        
                                <th colspan="3" style="width:800px; text-align:left"> Total Assets = @String.Format("{0:F}", nTotalAssets)</th>
                            </tr> 
                            <tr>        
                                <th colspan="3" style="width:800px; text-align:left"> Total Liability & Owners Equity = @String.Format("{0:F}", nTotalLabilityandOwnerEquity)</th>
                            </tr> 
                         </table>
                    </div>
                    
                </td>
            </tr>
            <tr style="height:auto">
                <td>
                    <table>
                        <tr>
                            <td style ="width:748px;text-align:right"><input type="button" value="Print" id="btnPrint" style="width:60px"/> </td>
                            <td><input type="button" value="Close" id="btnClose"/> </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
<br />
<br />
<br />
<br />
<table border="0" cellpadding="3" cellspacing="3">
    <tr>
        <td width="33%"  style="text-align: left; font-size:9px">
        __________________ 
        </td>
        <td width="34%"  style="text-align: center; font-size:9px">
        __________________        
        </td>
        <td width="33%"  style="text-align: right; font-size:9px">
        __________________         
        </td>
    </tr>
    <tr>
        <td width="33%"  style="text-align: left; font-size:9px">       
           Prepare by
        </td>
        <td width="34%"  style="text-align: center; font-size:9px">       
           Checked By
        </td>
        <td width="33%"  style="text-align: right; font-size:9px">       
           Approved By 
        </td>
    </tr>
    <tr></tr>
</table>