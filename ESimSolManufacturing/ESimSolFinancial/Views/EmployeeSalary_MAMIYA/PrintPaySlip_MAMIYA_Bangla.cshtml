<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link href="@Url.Content("~/Content/CSS/icon.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/easyui.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/Pikerstyle.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.ics.customize.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.easyui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script>
</head>
<body>
    @model ESimSol.BusinessObjects.EmployeeSalary_MAMIYA
    <div style="font-family: Tahoma; margin-top:-1%; width:92% ">
        @functions
        {
            int _nCount = 0;
            public string NumberInBan(string num)
            {
                string[] Numbers = { "০", "১", "২", "৩", "৪", "৫", "৬", "৭", "৮", "৯", ",", "." };
                var nlength1 = 0;
                var nlength2 = 1;
                var NumberInBangla = "";
                var number = "";
                number = num;

                for (var i = 0; i < number.Length; i++)
                {
                    if (number.Substring(nlength1, nlength2) == "0")
                    {
                        NumberInBangla += Numbers[0];
                    }
                    else if (number.Substring(nlength1, nlength2) == "1")
                    {
                        NumberInBangla += Numbers[1];
                    }
                    else if (number.Substring(nlength1, nlength2) == "2")
                    {
                        NumberInBangla += Numbers[2];
                    }
                    else if (number.Substring(nlength1, nlength2) == "3")
                    {
                        NumberInBangla += Numbers[3];
                    }
                    else if (number.Substring(nlength1, nlength2) == "4")
                    {
                        NumberInBangla += Numbers[4];
                    }
                    else if (number.Substring(nlength1, nlength2) == "5")
                    {
                        NumberInBangla += Numbers[5];
                    }
                    else if (number.Substring(nlength1, nlength2) == "6")
                    {
                        NumberInBangla += Numbers[6];
                    }
                    else if (number.Substring(nlength1, nlength2) == "7")
                    {
                        NumberInBangla += Numbers[7];
                    }
                    else if (number.Substring(nlength1, nlength2) == "8")
                    {
                        NumberInBangla += Numbers[8];
                    }
                    else if (number.Substring(nlength1, nlength2) == "9")
                    {
                        NumberInBangla += Numbers[9];
                    }
                    else if (number.Substring(nlength1, nlength2) == ",")
                    {
                        NumberInBangla += Numbers[10];
                    }
                    else if (number.Substring(nlength1, nlength2) == "/" || number.Substring(nlength1, nlength2) == ".")
                    {
                        NumberInBangla += Numbers[11];
                    }

                    nlength1++;
                    //nlength2++;
                }
                return NumberInBangla;
            }
        }

        @foreach (ESimSol.BusinessObjects.EmployeeSalary_MAMIYA oItem in Model.EmployeeSalary_MAMIYAs)
        {
            _nCount++;
            DateTime dDateFrom = DateTime.Now;
            DateTime dDateTo = DateTime.Now;

            dDateFrom = Convert.ToDateTime(Model.ErrorMessage.Split(',')[0]);
            dDateTo = Convert.ToDateTime(Model.ErrorMessage.Split(',')[1]);

            TimeSpan diff = dDateTo - dDateFrom;
            int nDays = diff.Days + 1;

            string sDateFrom = "";
            string sDateTo = "";
            //sDateFrom = Model.ErrorMessage.Split(',')[0];
            //sDateTo = Model.ErrorMessage.Split(',')[1];
            sDateFrom = dDateFrom.ToString("dd") + "/" + dDateFrom.ToString("MM") + "/" + dDateFrom.ToString("yy");
            sDateTo = dDateTo.ToString("dd") + "/" + dDateTo.ToString("MM") + "/" + dDateTo.ToString("yy");
            
            <table border="0" style="margin-left:5%; width:100%;margin-top:5px;">
                <tr style="width:100%;">
                    <td style="width:100%; text-align: center; font-size:30px;font-weight:bold">
                        <label style="margin-left:-5%">
                            <img id="imgPhotoIcon" src="@Url.Action("GetCompanyLogoForHTMLPrint", "Employee", new { nid = 0})" alt="Photo" style="width:150px; height:38px; margin-bottom:-10px;margin-right:-10px;" /> @*width: 200px*@
                            @Model.Company.Name
                        </label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 100%; text-align: center;">
                        <label style="font-size:16px;">@Model.Company.Address</label>
                    </td>
                </tr>
            </table>

            <table id="toptable">
            <tr>
                <td colspan="4" style="text-align:center;font-size:20px; font-weight:bold">
                    Pay Slip No - @oItem.EmployeeSalaryID.ToString()
                </td>
            </tr>
            <tr>
                @*<td class="td_Caption1">
                    Division(বিভাগ):@oItem.DepartmentName
                </td>
                <td class="td_Value1">
                    Section (সেকশন):@oItem.DepartmentName
                </td>
                <td class="td_Caption2">
                    পে-স্লিপ:@NumberInBan(sDateFrom)  হতে @NumberInBan(sDateTo)
                </td>
                <td class="td_Value2">
                    Calender Days (ক্যালেন্ডার দিন):@NumberInBan(nDays.ToString())
                </td>*@
                <td class="td_Caption1" colspan="4" style="font-size: 17px;">
                    Div(বিভাগ):@oItem.DepartmentName
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Sec(সেকশন):@oItem.DepartmentName
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    পে-স্লিপ:@NumberInBan(sDateFrom)  হতে @NumberInBan(sDateTo)
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Calender(ক্যালেন্ডার দিন):@NumberInBan(nDays.ToString())
                </td>
            </tr>
        </table>
            <table id="maintable">
                <tr style="width:100%">
                    <td colspan="4" style="width:100%">
                        <table border="0" style="width:100%">
                            <tr>
                                <td class="td_Caption1">
                                    Name(নাম):
                                </td>
                                <td class="td_Value01">
                                    @oItem.EmployeeName
                                </td>
                                <td class="td_Caption2">
                                    Present Days(উপস্থিতি দিন):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.TotalPresent.ToString())
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Code No.(কোড নং.):
                                </td>
                                <td class="td_Value01">
                                    @oItem.EmployeeCode
                                </td>
                                <td class="td_Caption2">
                                    C. Leave(সি. এল):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.CasualLeave.ToString())
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Designation(পদবী):
                                </td>
                                <td class="td_Value01">
                                    @oItem.DesignationName
                                </td>
                                <td class="td_Caption2">
                                    E. Leave(ই. এল):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.EarnLeave.ToString())
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Joining Date(যোগদানের তাং.):
                                </td>
                                <td class="td_Value01">
                                    @oItem.DateOfJoinInString
                                </td>
                                <td class="td_Caption2">
                                    S. Leave(এস. এল):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.AbsentHr_Sick.ToString())
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Total Wages(মোট বেতন):
                                </td>
                                <td class="td_Value01">
                                    @NumberInBan(@oItem.GrossSalary.ToString("#,###,##0"))

                                </td>
                                <td class="td_Caption2">
                                    L.W.P(অনুপস্থিত  দিন):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(ICS.Core.Utility.Global.MillionFormat(@oItem.AbsentHr_WOPay))
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Basic(মূল বেতন):
                                </td>
                                <td class="td_Value01">
                                    @NumberInBan(@oItem.Basic.ToString("#,###,##0"))
                                </td>
                                <td class="td_Caption2">
                                    OT Hrs.(ওটি ঘন্টা):
                                </td>
                                <td class="td_Value2" style="font-size:16px;">
                                    H-@NumberInBan(ICS.Core.Utility.Global.MillionFormat(@oItem.OT_HHR)),
                                    N-@NumberInBan(ICS.Core.Utility.Global.MillionFormat(@oItem.OT_NHR)),
                                    F-@NumberInBan(ICS.Core.Utility.Global.MillionFormat(@oItem.FHOT))
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Allowance(অনান্য ভাতা):
                                </td>
                                <td class="td_Value01">
                                    @NumberInBan(@oItem.Allowance.ToString("#,###,##0"))
                                </td>
                                <td class="td_Caption2">
                                    Friday(শুক্রবার):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.FriDay.ToString())
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    Account no.(অ্যাকাউন্ট নং.):
                                </td>
                                <td class="td_Value01">
                                    @oItem.BankAccountNo
                                </td>
                                <td class="td_Caption2">
                                    Holiday(ছুটির দিন):
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.HoliDay.ToString())
                                </td>
                            </tr>
                        </table>

                        <table id="tbl1" cellpadding="0" cellspacing="0" style="font-size:16px;">
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Payble Basic(প্রদেয় মূল):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.Basic > 0)
                                    { @NumberInBan(@oItem.Basic.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>

                                <td class="td_Caption2">
                                    &nbsp;P/F Profit(ই. পি. এফ. লভ্যাংশ):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.PFProfit > 0)
                                    { @NumberInBan(@oItem.PFProfit.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;House Rent(বাড়ি ভাড়া):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.HRent > 0)
                                    { @NumberInBan(@oItem.HRent.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;P/Fund(ই. পি. এফ.):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.PF > 0)
                                    { @NumberInBan(@oItem.PF.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                
                            </tr>
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Medical Allow.(চিকিৎসা ভাতা):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.Med > 0)
                                    { @NumberInBan(@oItem.Med.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;Loan Amnt.(ঋণের পরিমাণ):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.LoanBalance > 0)
                                    { @NumberInBan(@oItem.LoanBalance.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Conveyance(যাতায়াত ভাতা):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.Conveyance > 0)
                                    { @NumberInBan(@oItem.Conveyance.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;Interest Amnt.(সুদের পরিমাণ):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.InterestAmt > 0)
                                    { @NumberInBan(@oItem.InterestAmt.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>

                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Other Allow.(অনান্য):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.OtherAll > 0)
                                    { @NumberInBan(@oItem.OtherAll.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;Installment Amnt.(কিস্তির পরিমাণ):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.InstallmentAmt > 0)
                                    { @NumberInBan(@oItem.InstallmentAmt.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;OT Allow.(ওটি  ভাতা):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.OTAmount > 0)
                                    { @NumberInBan(@oItem.OTAmount.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                
                                <td class="td_Caption2">
                                    &nbsp;Absent Deb.(অনুপস্থিত কর্তন):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.TotalAbsentAmount > 0)
                                    { @NumberInBan(@oItem.TotalAbsentAmount.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Shift Allow.(শিফট ভাতা):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.ShiftAmount > 0)
                                    { @NumberInBan(@oItem.ShiftAmount.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                
                                <td class="td_Caption2">
                                    &nbsp;Advance(অগ্রিম):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.ADV > 0)
                                    { @NumberInBan(@oItem.ADV.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>

                            </tr>
                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Attn. Bonus(উপস্থিতি বোনাস):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.AttendanceBonus > 0)
                                    { @NumberInBan(@oItem.AttendanceBonus.ToString("#,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                
                                <td class="td_Caption2">
                                    &nbsp;Transport(যাতায়াত):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.TRNS > 0)
                                    { @NumberInBan(@oItem.TRNS.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Festival Bonus(উৎসব বোনাস):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.FB > 0)
                                    { @NumberInBan(@oItem.FB.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>

                                <td class="td_Caption2">
                                    &nbsp;Income Tax(আয়কর):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.IncomeTax > 0)
                                    { @NumberInBan(@oItem.IncomeTax.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;ADJCR(ক্রেডিট সমন্বয়):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.ADJCR > 0)
                                    { @NumberInBan(@oItem.ADJCR.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;ADJDR(ডেবিট সমন্বয়):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.ADJDR > 0)
                                    { @NumberInBan(@oItem.ADJDR.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Mob. Bill(মোবাইল বিল):
                                </td>
                                <td class="td_Value1">
                                    @if (@oItem.MobileBill > 0)
                                    { @NumberInBan(@oItem.MobileBill.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                                <td class="td_Caption2">
                                    &nbsp;Stamp(ষ্ট্যাম্প):
                                </td>
                                <td class="td_Value2">
                                    @if (@oItem.RS > 0)
                                    { @NumberInBan(@oItem.RS.ToString("#,###,##0"))}
                                    else
                                    {<label>-</label>}
                                </td>
                            </tr>

                            <tr>
                                <td class="td_Caption1">
                                    &nbsp;Holiday All.(হলিডে কাজের ভাতা):
                                </td>
                                <td class="td_Value1">@if (@oItem.HolidayAll > 0)
                                { @NumberInBan(@oItem.HolidayAll.ToString("#,###,##0"))}
                                else
                                {<label>-</label>}</td>
                                <td class="td_Caption2">
                                    &nbsp;Other Deb.(অনান্য):
                                </td>
                                <td class="td_Value2">
                                    
                                </td>
                            </tr>
                        </table>

                        <table border="0" style="width:100%;">
                            <tr>
                                <td class="td_Caption1">
                                    Total Earning(মোট উপার্জন):
                                </td>
                                <td class="td_Value1">
                                    @NumberInBan(@oItem.EarningsTotal.ToString("#,###,##0"))
                                </td>
                                <td class="td_Caption2">
                                    Total Deduction	(মোট কর্তন)
                                </td>
                                <td class="td_Value2">
                                    @NumberInBan(@oItem.DeductionTotal.ToString("#,###,##0"))
                                </td>
                            </tr>
                            <tr style="height:40px;">
                                <td class="td_Caption1" style="font-weight:bold">
                                    Net Payable	(নেট প্রদেয়):
                                </td>
                                <td class="td_Value1" style="font-weight:bold">
                                    @NumberInBan((@oItem.EarningsTotal - @oItem.DeductionTotal).ToString("#,###,##0"))
                                </td>
                                <td class="td_Caption2" colspan="2" style="font-size:15px;">
                                    In Word:
                                    @ICS.Core.Utility.Global.TakaWords(@oItem.EarningsTotal - @oItem.DeductionTotal)
                                </td>
                            </tr>
                        </table>

                        <table border="0" style="font-size:16px;">
                            <tr style="height:75px">
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <td style="text-align:left; width: 400px; ">
                                    <div style="margin-top:-40px;">
                                        <div>
                                            <img id="imgPhotoIcon" src="@Url.Action("GetAuthSignatureHTMLPrint", "Employee", new { nid = 0})" alt="Photo" style="width:80px; height:60px; margin-bottom:-20px; margin-left:-5px;" />
                                        </div>
                                        <div>
                                            _____________
                                            <br />
                                            কর্তৃপক্ষের স্বাক্ষর
                                        </div>
                                    </div>
                                </td>
                                <td style="text-align:right;  width: 800px;">
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    __________
                                    <br />
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    কর্মীর স্বাক্ষর
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align:center;  width: 1250px; font-size:13px;">
                                    @*বিঃ দ্রঃ মজুরী ভুল হলে, কর্তৃপক্ষকে অবগত করার জন্য অনুরোধ করা গেল ।*@
                                    <!--বিঃ দ্রঃ- মজুরী ভুল হলে, মজুরী প্রাপ্তির পরবর্তী ১০ (দশ) কর্ম দিবসের মধ্যে কতৃপক্ষকে অবগত করার জন্য অনুরোধ করা গেল।-->
                                    বিঃ দ্রঃ- পে-স্লিপের কোন তথ্য ভুল হলে, পে-স্লিপ প্রপ্তির পরবর্তী ১০ (দশ) কর্ম দিবসের মধ্যে কতৃপক্ষকে অবগত করার জন্য অনুরোধ করা গেল। অন্যথায় উল্লেখিত সময়ের পরে কোন প্রকার অভিযোগ গ্রহণযোগ্য হবেনা।
                                </td>

                            </tr>
                        </table>

                    </td>
                </tr>
            </table>

            @*<div style="height:15px; width:100%"></div>*@

            <div style="width:100%;  margin-top:4%; margin-left:5%">
                @if (_nCount % 2 != 0)
                {
                     <hr style="width:100%" />
                }

             </div>

         }

            <table style="float:left; clear:both; width:1250px; text-align:right">
                @*FOOTER TABLE*@
                <tr>
                    <td>
                        <a id="btnCancel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print</a>

                    </td>
                </tr>
            </table>
</div>
</body>
</html>
<style>
     #tbl1 tr td 
     {
        border-bottom: 1px solid black;
        border-left: 1px solid black;
    }
    #tbl1
    {
        width:100%;
        border: 1px solid black;
        border-left: 0px solid black;
        border-bottom: 0px solid black;
    }
    #maintable,#toptable
    {
        border: 1px solid black;
        width:100%;
        margin-left:5%;
       
    }
    .td_Caption1
    {
        width: 240px;
        text-align: left; 
        font-size:17px;
    }
    .td_Caption2
    {
        width: 250px; 
        text-align: left; 
        font-size:17px;
    }
    .td_Value1
    {
        width: 240px; 
        text-align: center; 
        font-size:17px;
    }
    .td_Value2
    {
        width: 240px; 
        text-align: center; 
        font-size:17px;
    }
    .td_Value01
    {
        width: 240px;
        text-align: left; 
        font-size:17px;
    }
</style>
<script type="text/javascript">
    var _sBaseAddress ="";
    var _obj = null;

    $(document).ready(function ()
    {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _obj = window.dialogArguments;
    });

    $('#btnCancel').click(function ()
    {
        window.close();
    });

    $('#btnPrint').click(function ()
    {
        document.getElementById("btnPrint").style.display='none';
        document.getElementById("btnCancel").style.display='none';
        window.print();
        window.close();
    });

</script>