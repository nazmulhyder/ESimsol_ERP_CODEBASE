@model IEnumerable<ESimSol.BusinessObjects.NegativeLedger>
@{
    ViewBag.Title = "Negative Ledger";
}
<div style="margin-left: 0px; height: 100%; width:100%">
    <table id="tblNegativeLedger" title="Negative Ledger" class="easyui-datagrid" fit="true" fitcolumns="true" rownumbers="true" pagination="true" singleselect="true" , autorowheight="false" toolbar="#toolbar">
        <thead>
            <tr>
                <th field="AccountCode" width="90" align="left"> Account Code </th>
                <th field="AccountHeadName" width="150" align="left">Account Head Name</th>
                <th field="OpeningBalanceSt" width="100" align="right">Openning Balance</th>
                <th field="DebitAmountInString" width="100" align="right">Debit</th>
                <th field="CreditAmountInString" width="100" align="right">Credit</th>
                <th field="ClosingBalanceSt" width="100" align="right">Closing Balance</th>
            </tr>
        </thead>
    </table>
    <div id="toolbar">
        <table border="0" cellpadding="2" cellspacing="2">
            <tr>
                <td>
                    <a id="btnGeneralLedgerView" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Ledger View</a>
                    <a id="btnPrint" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Print Negative Ledger</a>
                    <a id="btnPrintXL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Export To XL</a>
                </td>
            </tr>
        </table>
    </div>
</div>
<script type="text/javascript">
    var _oNegativeLedgers=[];
    var _sBaseAddress="";
    var _nSessionCurrentCompanyID=0;
    $(document).ready(function () {
        _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        _oNegativeLedgers = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _nSessionCurrentCompanyID = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.CurrentCompanyID]));
        RefreshList(_oNegativeLedgers);
    });

    function RefreshList(oNegativeLedgers)
    {
        var data=oNegativeLedgers;
        data={"total":""+data.length+"","rows":data};
        $('#tblNegativeLedger').datagrid('loadData',data);
    }

    $("#btnGeneralLedgerView").click(function(){
        if(parseInt(_nSessionCurrentCompanyID) == 0)
        {
            alert("Invalid Company.");
            return
        }
        var oNL = $('#tblNegativeLedger').datagrid('getSelected');
        if(oNL==null)
        {
            alert("Please Select An Item From List");
            return;
        }
        var oParameter = new Object();
        oParameter.ObjectNL = oNL;
        oParameter.Name = "General Ledger";
        oParameter.AccountHeadID = oNL.AccountHeadID;
        oParameter.AccountHeadName = oNL.AccountHeadName;
        var url =_sBaseAddress+ "/NegativeLedger/ViewGeneralLedger";
        var oNegativeLedger = window.showModalDialog(url, oParameter, 'dialogHeight:500px;dialogWidth:1200px;dialogLeft:100;dialogTop:50;center:yes;resizable:no;status:no;scroll:no');
    });

    $("#btnPrintXL").click(function(){
        if(parseInt(_nSessionCurrentCompanyID) == 0)
        {
            alert("Invalid Company.");
            return
        }
        var sParams= "";
        window.open(_sBaseAddress+'/NegativeLedger/PrintNegativeLedgerInXL?sParams=' + sParams, "_blank");
    });

    $("#btnPrint").click(function(){
        if(parseInt(_nSessionCurrentCompanyID) == 0)
        {
            alert("Invalid Company.");
            return
        }
        var sParams= "";
        window.open(_sBaseAddress+'/NegativeLedger/PrintNegativeLedger?sParams=' + sParams, "_blank");
    });
</script>
