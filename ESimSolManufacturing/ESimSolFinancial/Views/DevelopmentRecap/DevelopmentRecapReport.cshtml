@{
    ViewBag.Title = "Development Recap Report";
}
@model IEnumerable<ESimSol.BusinessObjects.DevelopmentRecap>
 <div class="menuMainCollectionTable" id="divDR">
     <div class="easyui-panel" title="Development Recap Report" style="font-family:Tahoma;width:101%;height:88%;">
         <fieldset>
             <legend style="font-weight: bold; font-size: 12px">Searching Criteria : </legend>
             <table border="0" height="270" cellpadding="5" cellspacing="5" style="font-size: 12px">
                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Recap No:
                     </td>
                     <td style="width: 400px; text-align: left">
                         @Html.TextBox("txtRecapNo", "", new { style = "width: 300px", id = "txtRecapNo" })
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Style No:
                     </td>
                     <td style="width: 250px; text-align: left">
                         @Html.TextBox("txtStyleNo", "", new { style = "width: 244px", id = "txtStyleNo" })
                     </td>
                 </tr>

                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Buyer :
                     </td>
                     <td style="width: 400px; text-align: left">
                         @Html.TextBox("txtBuyerName", "", new { style = "width: 261px", id = "txtBuyerName" })<input type="button" style="width: 40px; font-size: 12px" id="btnBuyer" value="Pick" />
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Product Category :
                     </td>
                     <td style="width: 250px; text-align: left">
                         <select id="cboProductCategory" style="width:250px;"></select>
                     </td>
                 </tr>

                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Merchandiser:
                     </td>
                     <td style="width: 400px; text-align: left; font-size: 12px; height:35px;">
                         @Html.TextBox("txtMerchandiserName","", new { style = "width:261px", id = "txtMerchandiserName" })<input type="button" style="width: 40px; font-size: 12px" id="btnPickMerchandiser" value="Pick" />
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold;  height:30px;">
                         Session:
                     </td>
                     <td style="width: 250px; text-align: left; font-size: 12px; height:40px;"><select id="cboSession" style="width:250px;"></select></td>
                 </tr>

                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Inquery Receive Date:
                     </td>
                     <td style="width: 400px; text-align: left; font-size: 12px; height:35px;">
                         <table border="0" cellpadding="2" cellspacing="2" style="font-size: 12px">
                             <tr>
                                 <td style="width: 80px; font-size: 12px; text-align: left">
                                     @Html.DropDownList("cboInqueryRcvDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboInqueryRcvDate", style = "width: 80px;font-size:12px;text-align:left", @class = "_select_changeA" })
                                 </td>
                                 <td style="width: 98px; font-size: 12px">
                                     <input id="txtInqueryRcvStartDate" type="text" style="width: 98px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                                 <td style="width: 9px; font-size: 12px" id="enddateT">
                                     To
                                 </td>
                                 <td style="width: 97px; font-size: 12px" id="enddate">
                                     <input id="txtInqueryRcvEndDate" type="text" style="width: 97px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                             </tr>
                         </table>
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold;  height:30px;  vertical-align: bottom">
                         Status:
                     </td>
                     <td style="width: 250px; text-align: left; font-size: 12px; height:40px; vertical-align: top;" rowspan="5">
                         <table id="tblStatusLoad" title="" class="easyui-datagrid" style="width: 250px; height: 200px;font-size: 12px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="false" autorowheight="false">
                             <thead>
                                 <tr>
                                     <th data-options="field:'Selected',checkbox:true">
                                     </th>
                                     <th field="Value" width="170">
                                         Development Recap Status
                                     </th>
                                 </tr>
                             </thead>
                         </table>
                     </td>

                 </tr>
                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Sample Receive Date:
                     </td>
                     <td style="width: 400px; text-align: left; font-size: 12px; height:35px;">
                         <table border="0" style="font-size: 12px">
                             <tr>
                                 <td style="width: 85px; font-size: 12px; text-align: left">
                                     @Html.DropDownList("cboSampleRcvDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboSampleRcvDate", style = "width: 85px;font-size:12px;text-align:left", @class = "_select_changeB" })
                                 </td>
                                 <td style="width: 98px; font-size: 12px">
                                     <input id="txtSampleRcvStartDate" type="text" style="width: 98px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                                 <td style="width: 9px; font-size: 12px" id="SampleT">
                                     To
                                 </td>
                                 <td style="width: 97px; font-size: 12px" id="Sampleenddate">
                                     <input id="txtSampleRcvEndDate" type="text" style="width: 97px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                             </tr>
                         </table>
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold"></td>
                 </tr>
                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Sanding Date:
                     </td>
                     <td style="width: 400px; text-align: left;  height:35px; font-size: 12px">
                         <table border="0" style="font-size: 12px">
                             <tr>
                                 <td style="width: 85px; font-size: 12px; text-align: left">
                                     @Html.DropDownList("cboSandingRcvDate", new SelectList(Enum.GetValues(typeof(ESimSol.BusinessObjects.EnumCompareOperator))), new { id = "cboSandingRcvDate", style = "width: 85px;font-size:12px;text-align:left", @class = "_select_changeC" })
                                 </td>
                                 <td style="width: 98px; font-size: 12px">
                                     <input id="txtSandingStartDate" type="text" style="width: 98px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                                 <td style="width: 9px; font-size: 12px" id="SandingT">
                                     To
                                 </td>
                                 <td style="width: 97px; font-size: 12px" id="Sandingenddate">
                                     <input id="txtSandingEndDate" type="text" style="width: 97px;" class="easyui-datebox"
                                            required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                 </td>
                             </tr>
                         </table>
                     </td>
                 </tr>
                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold">
                         Development Type:
                     </td>
                     <td style="width: 400px;  height:35px; text-align: left">
                         <select id="cboDevelopmentType" style="width:310px;"></select>
                     </td>
                     <td style="width: 150px; text-align: right; font-weight: bold"></td>
                 </tr>

                 <tr>
                     <td style="width: 150px; text-align: right; font-weight: bold; vertical-align:bottom;">
                         <input type="button" value="Reset" id="btnReset" style="width: 70px; font-size: 12px" />
                     </td>
                     <td style="width: 400px;  height:35px; text-align: left"></td>

                 </tr>
             </table>
         </fieldset>
    </div>
    <fieldset style="height:60px;">
             <legend style="font-size: 12px; vertical-align:bottom; font-weight:bold;">Action </legend>
             <table border="0" cellpadding="0" cellspacing="0" style="height:20px; width:850px;">
                 <tr>
                     <td style="text-align:center; width:150px;  vertical-align:top; vertical-align: bottom; color:Purple; font-weight:bold;"><input type="checkbox" value="value" id="chk_FactoryWise" checked="false" onclick="if(this.checked){IsFactoryWise()}" />Factory Wise</td>
                     <td style="text-align:left;   width:150px;  vertical-align:bottom;color:Purple;font-weight:bold;"><input type="checkbox" value="value" id="chk_MerchandiserWise" checked="false" onclick="if(this.checked){IsMerchandiserWise()}" />Merchandiser Wise</td>
                     <td style="text-align:left;   width:170px;  vertical-align:bottom;color:Purple;font-weight:bold;"><input type="checkbox" value="value" id="chk_ProductCategoryWise" checked="false" onclick="if(this.checked){IsProductCategoryWise()}" />Product Catagory Wise</td>
                     <td style="text-align:left;   width:100px;  vertical-align:bottom;color:Purple;font-weight:bold;"><input type="checkbox" value="value" id="chk_BuyerWise" checked="false" onclick="if(this.checked){IsBuyerWise()}" />Buyer Wise</td>
                     <td style="text-align:left;   width:130px;  vertical-align:bottom;color:Purple;font-weight:bold;"><input type="checkbox" value="value" id="chk_YarnWise" checked="false" onclick="if(this.checked){IsYarnWise()}" />Yarn/Fabric Wise</td>
                     <td style="text-align:right; vertical-align:top; "><input type="button" value="Print" id="btnPrint" style="width: 70px; font-size: 12px" /></td>
                 </tr>
             </table>
         </fieldset>
 </div>
<script type="text/javascript">
    var _sBaseAddress="";
    $(document).ready(function () {
        debugger;
        var oDevelopmentRecaps =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
        var oDevelopmentTypes =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DevelopmentTypes));
        var oBusinessSessions =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessSessions));
        var nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
        var oDevelopmentRecapStatus = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.DevelopmentRecapStatus));
        var oProductCategories = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ProductCategories));
        $('#divDR').data('BuyerIDs',"");
        $('#divDR').data('MerchandiserIDs',"");
        $('#divDR').data('ReportFormat',0);
        
        sessionStorage.setItem("BUID",nBUID);
        $("#cboSession").icsLoadCombo({ List: oBusinessSessions, OptionValue: "BusinessSessionID", DisplayText: "SessionName" });
        $("#cboDevelopmentType").icsLoadCombo({ List: oDevelopmentTypes, OptionValue: "DevelopmentTypeID", DisplayText: "Name" });
        $("#cboProductCategory").icsLoadCombo({ List: oProductCategories, OptionValue: "ProductCategoryID", DisplayText: "ProductCategoryName" });
        SetTodayDate();
        RefreshStatusList(oDevelopmentRecapStatus);
        SetReportFormat();
    });


    function SetReportFormat()
    {
        document.getElementById("chk_FactoryWise").checked=false;
        document.getElementById("chk_MerchandiserWise").checked=false;
        document.getElementById("chk_ProductCategoryWise").checked=false;
        document.getElementById("chk_BuyerWise").checked=false;
        document.getElementById("chk_YarnWise").checked=false;
        $('#divDR').data('ReportFormat',0);
    }

    //EnumReportFormat{None = 0,Factory_wise = 1,Merchandiser_Wise = 2,ProductCatagory_Wise = 3,Buyer_Wise = 4,Yarn_Fabric_Wise = 5}

    function IsFactoryWise()
    {
        document.getElementById("chk_MerchandiserWise").checked=false;
        document.getElementById("chk_ProductCategoryWise").checked=false;
        document.getElementById("chk_BuyerWise").checked=false;
        document.getElementById("chk_YarnWise").checked=false;
        $('#divDR').data('ReportFormat',1);
    }


    function IsMerchandiserWise()
    {
        document.getElementById("chk_FactoryWise").checked=false;
        document.getElementById("chk_ProductCategoryWise").checked=false;
        document.getElementById("chk_BuyerWise").checked=false;
        document.getElementById("chk_YarnWise").checked=false;
        $('#divDR').data('ReportFormat',2);
    }

    function IsProductCategoryWise()
    {
        document.getElementById("chk_MerchandiserWise").checked=false;
        document.getElementById("chk_FactoryWise").checked=false;
        document.getElementById("chk_BuyerWise").checked=false;
        document.getElementById("chk_YarnWise").checked=false;
        $('#divDR').data('ReportFormat',3);
    }

    function IsBuyerWise()
    {
        document.getElementById("chk_MerchandiserWise").checked=false;
        document.getElementById("chk_ProductCategoryWise").checked=false;
        document.getElementById("chk_FactoryWise").checked=false;
        document.getElementById("chk_YarnWise").checked=false;
        $('#divDR').data('ReportFormat',4);
    }

    function IsYarnWise()
    {
        document.getElementById("chk_MerchandiserWise").checked=false;
        document.getElementById("chk_ProductCategoryWise").checked=false;
        document.getElementById("chk_FactoryWise").checked=false;
        document.getElementById("chk_BuyerWise").checked=false;
        $('#divDR').data('ReportFormat',5);

    }


    function SetTodayDate()
    {
        $('#txtInqueryRcvStartDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtInqueryRcvEndDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtSampleRcvStartDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtSampleRcvEndDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtSandingStartDate').datebox('setValue', icsdateformat(new Date()));
        $('#txtSandingEndDate').datebox('setValue', icsdateformat(new Date()));
    }


    $('._select_changeA').change(function () {
        //  debugger;
        var x = $("#cboInqueryRcvDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("enddate").style.display = 'none';
            document.getElementById("enddateT").style.display = 'none';
        }
        else {
            document.getElementById("enddate").style.display = '';
            document.getElementById("enddateT").style.display = '';
        }
    });

    $('._select_changeB').change(function () {
        // debugger;
        var x = $("#cboSampleRcvDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("Sampleenddate").style.display = 'none';
            document.getElementById("SampleT").style.display = 'none';
        }
        else {
            document.getElementById("Sampleenddate").style.display = '';
            document.getElementById("SampleT").style.display = '';
        }
    });

    $('._select_changeC').change(function () {
        //  debugger;
        var x = $("#cboSandingRcvDate").val();
        if (x == "EqualTo" || x == "NotEqualTo" || x == "GreaterThen" || x == "SmallerThen") {
            document.getElementById("Sandingenddate").style.display = 'none';
            document.getElementById("SandingT").style.display = 'none';
        }
        else {
            document.getElementById("Sandingenddate").style.display = '';
            document.getElementById("SandingT").style.display = '';
        }
    });

    function  icsdateformat(date)
    {
        //  debugger;
        var mthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
        var y = date.getFullYear();
        var m = date.getMonth();
        var d = date.getDate();
        //return m+'/'+d+'/'+y;
        var result= d +' '+ mthNames[m]+' '+ y;
        return result
    }

    function RefreshStatusList(oLoadDevelopmentRecapStatus)
    {
        data=oLoadDevelopmentRecapStatus;
        data={"total":""+data.length+"","rows":data};
        $('#tblStatusLoad').datagrid('loadData',data);
    }

 

    $('#btnPrint').click(function () {
       
        /* Inquery Receive Date*/
        var cboInqueryRcvDate = document.getElementById("cboInqueryRcvDate");
        var nInqueryDate=cboInqueryRcvDate.options[cboInqueryRcvDate.selectedIndex].index;
        var dInqueryRcvStartDate=$('#txtInqueryRcvStartDate').datebox('getValue');
        var dInqueryRcvEndDate=$('#txtInqueryRcvEndDate').datebox('getValue');

        /* Sample Recive Date*/
        var cboSampleRcvDate = document.getElementById("cboSampleRcvDate");
        var nSampleRcvDate=cboSampleRcvDate.options[cboSampleRcvDate.selectedIndex].index;
        var dSampleRcvStartDate=$('#txtSampleRcvStartDate').datebox('getValue');
        var dSampleRcvEndDate=$('#txtSampleRcvEndDate').datebox('getValue');
        /* Sanding Date*/
        var cboSendingDate = document.getElementById("cboSandingRcvDate");
        var nSendingDate=cboSendingDate.options[cboSendingDate.selectedIndex].index;
        var dSendingStartDate=$('#txtSandingStartDate').datebox('getValue');
        var dSandingEndDate=$('#txtSandingEndDate').datebox('getValue');

        /* Development Type*/
        var cboDevelopmentType = document.getElementById("cboDevelopmentType");
        var nDevelopmentTypeID=cboDevelopmentType.options[cboDevelopmentType.selectedIndex].index;

        var sRecapNo= $("#txtRecapNo").val();
        var sStyleNo= $("#txtStyleNo").val();
        var nBusinessSessionID = $('#cboSession').val();
        if(parseInt($('#divDR').data('ReportFormat'))==0)
        {
            alert("Please select Reporting Format");
            return;
        }

        var sStatus =  $('#tblStatusLoad').datagrid('getChecked');
        var chkResult = CheckEmpty();
        if(chkResult!=true)
        {
            alert("Please Select at least one Criteria !!");
            return;
        }
        var sMakStatsQry ="";
        if(sStatus.length>0)
        {
            sMakStatsQry = sMakeQuery(sStatus);

        }
        debugger;
        var sTempString =nInqueryDate+'~'+ dInqueryRcvStartDate+'~'+dInqueryRcvEndDate+'~'+nSampleRcvDate+'~'+dSampleRcvStartDate+'~'+dSampleRcvEndDate+'~'+nSendingDate+'~'+dSendingStartDate+'~'+dSandingEndDate+'~'+sRecapNo+'~'+sStyleNo+'~'+$('#divDR').data('BuyerIDs')+'~'+$('#cboProductCategory').val()+'~'+nDevelopmentTypeID +'~'+sMakStatsQry+'~'+$('#divDR').data('MerchandiserIDs')+'~'+nBusinessSessionID+'~'+sessionStorage.getItem("BUID");
        window.open(_sBaseAddress+ '/DevelopmentRecap/DevelopmentRecapManagementReport?sParam='+sTempString+'&ReportFormat='+parseInt($('#divDR').data('ReportFormat')));

    });

    function sMakeQuery(sStauses)
    {
        var sSatusRes="";
        for(var i =0;i<sStauses.length;i++)
        {
            var status=sStauses[i].id;
            sSatusRes=sSatusRes+status+',';
        }

        return sSatusRes.substring(0, sSatusRes.length - 1);
    }

    function RefreshList(oDevelopmentRecaps)
    {
        data =oDevelopmentRecaps;
        data={"total":""+data.length+"","rows":data};
        $('#tblDevelopmentRecap').datagrid('loadData',data);
    }

    $('#btnReset').click(function () {
        //  debugger;
        window.location.href = window.location.href;
    });


    function CheckEmpty()
    {

        var cboInqueryRcvDate = document.getElementById("cboInqueryRcvDate");
        var nInqueryDate=cboInqueryRcvDate.options[cboInqueryRcvDate.selectedIndex].index;

        var cboSampleRcvDate = document.getElementById("cboSampleRcvDate");
        var nSampleRcvDate=cboSampleRcvDate.options[cboSampleRcvDate.selectedIndex].index;

        var cboSendingDate = document.getElementById("cboSandingRcvDate");
        var nSendingDate=cboSendingDate.options[cboSendingDate.selectedIndex].index;
        var sRecapNo= document.getElementById("txtRecapNo").value;
        var sStyleNo= document.getElementById("txtStyleNo").value;
        var sStatus =  $('#tblStatusLoad').datagrid('getChecked');
        var nBusinessSessionID = $('#cboSession').val();
        if(nInqueryDate==0 && nSampleRcvDate==0 && nSendingDate==0 && parseInt($('#divDR').data('ReportFormat'))==0 && nBusinessSessionID==0)
        {
            if(sRecapNo=="" && $('#divDR').data('BuyerIDs')=="" && $('#divDR').data('MerchandiserIDs')=="" && sStyleNo=="" && $('#cboProductCategory').val() == 0 && sStatus=="")
            {
                return false;
            }
            return true;
        }

        return true;
    }




    function Close()
    {
        window.close();
    }

    function OkButtonClick()
    {
        //   debugger;
        var oDevelopmentRecaps=[];
        var oDevelopmentRecaps = $('#tblDevelopmentRecap').datagrid('getChecked');
        if(oDevelopmentRecaps.length<=0)
        {
            alert("please select atleast one item");
            return;
        }
        window.returnValue= oDevelopmentRecaps;
        window.close();
    }


    // Search Buyer Start
    $("#txtBuyerName").keydown(function (e) {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            if($.trim($('#txtBuyerName').val())==null || $.trim($('#txtBuyerName').val())=="")
            {
                alert("Type Buyer Name and Press Enter.");
                return;
            }
            GetBuyers();
        }if (code == 8) //backspace=8
        {
            //debugger;
            $("#txtBuyerName").removeClass('fontColorOfPickItem');
            $('#divDR').data('BuyerIDS',"");
        }
    });
    $("#btnBuyer").click(function () {
        GetBuyers();
    });
    function GetBuyers()
    {
        var oContractor = {
            Params: '2' + '~' + $.trim($('#txtBuyerName').val())+'~'+sessionStorage.getItem("BUID")
        };
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oContractor,
            ControllerName: "Contractor",
            ActionName: "ContractorSearchByNameType",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {
            debugger;
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].ContractorID > 0) {
                    debugger;
                    var tblColums = []; var oColumn = { field: "Name", title: "Name", width: 200, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Address", title: "Address", width: 120, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "Email", title: "Email", width: 90, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ShortName", title: "Short Name", width: 90, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winBuyers',
                        winclass: 'clsBuyer',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblBuyers',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Buyer List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }
            else{
                alert("Data Not Found.");
                return;
            }
        });
    }

    //Merchandiser Part
    $("#txtMerchandiserName").keydown(function (e) {
        debugger;
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            if($.trim($('#txtMerchandiserName').val())==null || $('#txtMerchandiserName').val()=="")
            {
                alert("Please Type Merchandiser Name and Press Enter.");
                $('#txtMerchandiserName').focus();
                return;
            }
            GetEmployees();
        }else if (code == 8) //backspace=8
        {
            //debugger;
            var txtMerchandiserName = document.getElementById("txtMerchandiserName");
            txtMerchandiserName.style.color = "black";
            txtMerchandiserName.style.fontWeight = "normal";
            $('#divDR').data('MerchandiserIDs',"");
        }
    });
    $("#btnPickMerchandiser").click(function () {
        GetEmployees();
    });

    function GetEmployees()
    {
        var oEmployee = { Params:$('#txtMerchandiserName').val()+"~23"};//for Development type : Merchandiser
        var obj = {
            BaseAddress: _sBaseAddress,
            Object: oEmployee,
            ControllerName: "Employee",
            ActionName: "GetsByEmployeeNameType",
            IsWinClose: false
        };
        $.icsDataGets(obj, function (response) {
            debugger;
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].EmployeeID > 0) {
                    var tblColums = []; var oColumn = { field: "Name", title: "Merchandiser Name", width: 150, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ContactNo", title: "Contact No", width: 100, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "PresentAddress", title: "Address", width: 150, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winMerchandiserPicker',
                        winclass: 'clsMerchandiser',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblMerchandisersPicker',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: true,
                        searchingbyfieldName: 'Name',
                        windowTittle: 'Merchandiser List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else {
                    alert(response.objs[0].ErrorMessage);
                }

            }
        });
    }



    function IntializePickerbutton(oPickerobj) {
        debugger;
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            debugger;
            //for Single Select
            SetPickerValueAssign(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which == 13)//enter=13
            {
                SetPickerValueAssign(oPickerobj);
            }
        });
    }

    function SetPickerValueAssign(oPickerobj)
    {
        var oreturnObj = null, oreturnobjs = [];
        if (oPickerobj.multiplereturn)
        {
            oreturnobjs = $('#'+oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#'+oPickerobj.tableid).datagrid('getSelected');
        }
        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();

        if (oPickerobj.winclass == 'clsBuyer')
        {
            var sBuyerIDs = "";
            if (oPickerobj.multiplereturn)
            {
                var ncount = 0;
                for (var i = 0; i <oreturnobjs.length; i++) {
                    var nBuyerID = oreturnobjs[i].ContractorID;
                    sBuyerIDs = sBuyerIDs + nBuyerID + ',';
                    ncount++;
                }
                if (ncount > 1)
                {
                    $('#txtBuyerName').val("Select " + ncount + " Buyer's");
                } else
                {
                    $('#txtBuyerName').val(oreturnobjs[0].Name);
                }
                sBuyerIDs = sBuyerIDs.substring(0, sBuyerIDs.length - 1);
            } else
            {
                $('#txtBuyerName').val(oreturnobj.Name);
                sBuyerIDs = "" + oreturnobj.ContractorID + "";
                $('#txtBuyerName').focus();
            }
            var txtBuyerName = document.getElementById("txtBuyerName");
            txtBuyerName.style.color = "blue";
            txtBuyerName.style.fontWeight = "bold";
            $('#divDR').data('BuyerIDs',sBuyerIDs);
        }else  if (oPickerobj.winclass == 'clsMerchandiser')
        {
            var sMerchandiserIDs = "";
            if (oPickerobj.multiplereturn)
            {
                var ncount = 0;
                for (var i = 0; i <oreturnobjs.length; i++) {
                    var nMerchandiserID = oreturnobjs[i].EmployeeID;
                    sMerchandiserIDs = sMerchandiserIDs + nMerchandiserID + ',';
                    ncount++;
                }
                if (ncount > 1)
                {
                    $('#txtMerchandiserName').val("Select " + ncount + " Merchandiser's");
                } else
                {
                    $('#txtMerchandiserName').val(oreturnobjs[0].Name);
                }
                sMerchandiserIDs = sMerchandiserIDs.substring(0, sMerchandiserIDs.length - 1);
            } else
            {
                $('#txtMerchandiserName').val(oreturnobj.Name);
                sMerchandiserIDs = "" + oreturnobj.EmployeeID + "";
                $('#txtMerchandiserName').focus();
            }
            var txtMerchandiserName = $("#txtMerchandiserName").val();
            txtMerchandiserName.style.color = "blue";
            txtMerchandiserName.style.fontWeight = "bold";
            $('#divDR').data('MerchandiserIDs',sMerchandiserIDs);
        }
    }


</script>
