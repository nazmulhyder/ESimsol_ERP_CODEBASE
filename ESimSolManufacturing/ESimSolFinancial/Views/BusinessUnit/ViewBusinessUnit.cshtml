@{
    ViewBag.Title = "Business Unit";
}
<html>

<body>
    @model ESimSol.BusinessObjects.BusinessUnit
    <div id="divBusinessUnit" class="easyui-panel" title="Add BusinessUnit" style="font-family:Tahoma; height:100%; width:100%">
        <div style="width:100%; height:88%; text-align:center">
            <fieldset class="bodyfieldsetstyle" style="height:97%">
                <legend style="text-align:left; font-weight:bold;"> BusinessUnit Informations : </legend>
                
                <div style="width:100%;height:100%;">
                    <div style="width:60%;height:100%; text-align:center; float:left;margin-right:10px;">
                        <div style="border-right:5px solid black;">
                            <table style="width: 100%;margin-top: 20px;">
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            BusinessUnit Code :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Code, new { id = "txtCode", disabled = "disabled", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            BusinessUnit Name :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Name, new { id = "txtName", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Short Name :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.ShortName, new { id = "txtShortName", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Registration No :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.RegistrationNo, new { id = "txtRegistrationNo", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            TIN No :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.TINNo, new { id = "txtTINNo", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Vat No :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.VatNo, new { id = "txtVatNo", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:right">
                                        Business Unit Type :
                                    </td>
                                    <td style="width:60%;text-align:left;"">
                                        @Html.DropDownListFor(model => model.BusinessUnitTypeInInt, Model.BusinessUnitTypeObjs.Select(x => new SelectListItem() { Text = x.Value, Value = x.id.ToString() }), new { id = "cboBusinessUnitType", style = "width:92%;" })
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:right">
                                        Business Nature :
                                    </td>
                                    <td style="width:60%;text-align:left;" ">
                                        @Html.DropDownListFor(model => model.BusinessNatureInInt, Model.BusinessNatures.Select(x => new SelectListItem() { Text = x.Value, Value = x.id.ToString() }), new { id = "cboBusinessNatures", style = "width:92%;" })
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:right">
                                        Legal Format :
                                    </td>
                                    <td style="width:60%;text-align:left;" ">
                                        @Html.DropDownListFor(model => model.LegalFormatInInt, Model.LegalFormats.Select(x => new SelectListItem() { Text = x.Value, Value = x.id.ToString() }), new { id = "cboLegalFormats", style = "width:92%;" })
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Address :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Address, new { id = "txtAddress", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Phone :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Phone, new { id = "txtPhone", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Email :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Email, new { id = "txtEmail", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Web Address :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.WebAddress, new { id = "txtWebAddress", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Note :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.Note, new { id = "txtNote", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Name In Bangla :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.NameInBangla, new { id = "txtNameInBangla", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Address In Bangla :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.AddressInBangla, new { id = "txtAddressInBangla", style = "width: 90%;" })
                                    </td>

                                </tr>
                                <tr>
                                    <td style="width:40%;text-align:right;">
                                        <label>
                                            Fax No. :
                                        </label>
                                    </td>
                                    <td style="width:60%;text-align:left;">
                                        @Html.TextBoxFor(model => model.FaxNo, new { id = "txtFaxNo", style = "width: 90%;" })
                                    </td>

                                </tr>
                            </table>
                        </div>
                    </div>
                    <div style="width:35%;height:100%; text-align:left; float:left;margin-bottom:2px;">
                        <table  style="width: 100%;margin-top: 20px;">
                        
                            <tr>
                                <td style="width:40%;text-align:right;"></td>
                                <td style="width:60%;text-align:left;">
                                    @Html.CheckBoxFor(model => model.IsAreaEffect, new { id = "chkIsAreaEffect" })<label for="chkIsAreaEffect">Area Effect</label>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:40%;text-align:right;"></td>
                                <td style="width:60%;text-align:left;">
                                    @Html.CheckBoxFor(model => model.IsZoneEffect, new { id = "chkIsZoneEffect" })<label for="chkIsZoneEffect">Zone Effect</label>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:40%;text-align:right;"></td>
                                <td style="width:60%;text-align:left;">
                                    @Html.CheckBoxFor(model => model.IsSiteEffect, new { id = "chkIsSiteEffect" })<label for="chkIsSiteEffect">Site Effect</label>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </fieldset>
        </div>
        <div style="width:100%; height:10%">
            <fieldset>
                <legend style="font-weight: bold">Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold; width:100%">
                    <tr>
                        <td style="width:80%; text-align:right"></td>
                        <td style="width: 10%">
                            <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="false">Save</a>
                        </td>
                        <td style="width: 10%">
                            <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="false">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
    </div>
</body>
</html>
<style>
    .avro {
        font-family: Kalpurush;
    }

    .bijoy {
        font-family: SutonnyMJ;
    }
</style>
<script type="text/javascript">
 var _oBusinessUnit=null;
 var _sBaseAddress="";
 var _sBusinessUnitHeader="";
 var _nMenuid=0;
 var _COS = null;
 $(document).ready(function () {
     debugger;
     _nMenuid = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.MenuID]));
    _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
     _oBusinessUnit =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
     _COS =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.COS));
    
     var el = document.getElementById('txtNameInBangla');
     var val = parseInt(el.innerText);
     var class_name;
        
     if(parseInt(_COS.Value) == 19) {
         class_name = 'bijoy';
     }
     else {
         class_name = 'avro';
     }
     el.className += ' ' + class_name;


     
     var elA = document.getElementById('txtAddressInBangla');
     var valA = parseInt(elA.innerText);
     var class_nameA;
        
     if(parseInt(_COS.Value) == 19) {
         class_nameA = 'bijoy';
     }
     else {
         class_nameA = 'avro';
     }
     elA.className += ' ' + class_nameA;

     _sBusinessUnitHeader=sessionStorage.getItem("BusinessUnitHeader");
     $('#divBusinessUnit').panel({ title:_sBusinessUnitHeader});
     if(_sBusinessUnitHeader=="View BusinessUnit")
     {
         $('#divBusinessUnit input,select').prop('disabled',true);
         document.getElementById('btnSave').style.display = 'none';
     }

   
    
 });
    
 function ValidateInput()
 {
     if ($.trim($("#txtName").val()) == "") {
         alert("Please enter Name.");
         $("#txtName").addClass("errorFieldBorder");
         $("#txtName").focus();
         return false;
     } else {
         $("#txtName").removeClass("errorFieldBorder");
     }
     if ($.trim($("#txtShortName").val()) == "") {
         alert("Please enter Short Name.");
         $("#txtShortName").addClass("errorFieldBorder");
         $("#txtShortName").focus();
         return false;
     } else {
         $("#txtShortName").removeClass("errorFieldBorder");
     }
     if ($.trim($("#txtRegistrationNo").val()) == "") {
         alert("Please enter Registration Number.");
         $("#txtRegistrationNo").addClass("errorFieldBorder");
         $("#txtRegistrationNo").focus();
         return false;
     } else {
         $("#txtRegistrationNo").removeClass("errorFieldBorder");
     }
     if (parseInt($.trim($("#cboBusinessUnitType").val())) === 0) {
         alert("Please select a Business Unit Type.");
         $("#cboBusinessUnitType").addClass("errorFieldBorder");
         $("#cboBusinessUnitType").focus();
         return false;
     } else {
         $("#cboBusinessUnitType").removeClass("errorFieldBorder");
     }

     if (parseInt($.trim($("#cboBusinessNatures").val())) === 0) {
         alert("Please select a Business Nature.");
         $("#cboBusinessNatures").addClass("errorFieldBorder");
         $("#cboBusinessNatures").focus();
         return false;
     } else {
         $("#cboBusinessNatures").removeClass("errorFieldBorder");
     }

     if (parseInt($.trim($("#cboLegalFormats").val())) === 0) {
         alert("Please select a Legal Format.");
         $("#cboLegalFormats").addClass("errorFieldBorder");
         $("#cboLegalFormats").focus();
         return false;
     } else {
         $("#cboLegalFormats").removeClass("errorFieldBorder");
     }
     if ($.trim($("#txtAddress").val()) == "") {
         alert("Please enter Address.");
         $("#txtAddress").addClass("errorFieldBorder");
         $("#txtAddress").focus();
         return false;
     } else {
         $("#txtAddress").removeClass("errorFieldBorder");
     }
     if ($.trim($("#txtPhone").val()) == "") {
         alert("Please enter Phone number.");
         $("#txtPhone").addClass("errorFieldBorder");
         $("#txtPhone").focus();
         return false;
     } else {
         $("#txtPhone").removeClass("errorFieldBorder");
     }


   
    
     return true;
 }

 function RefreshObject()
 {
    
     var oBusinessUnit= {
         BusinessUnitID :_oBusinessUnit==null?0: _oBusinessUnit.BusinessUnitID,
         Code : _oBusinessUnit==null?'':_oBusinessUnit.Code,
         Name : $.trim($("#txtName").val()),
         ShortName :$.trim($("#txtShortName").val()),
         RegistrationNo:$.trim($("#txtRegistrationNo").val()),
         TINNo:$.trim($("#txtTINNo").val()),
         VatNo:$.trim($("#txtVatNo").val()),
         BusinessUnitType:parseInt($.trim($("#cboBusinessUnitType").val())),
         BusinessNature:parseInt($.trim($("#cboBusinessNatures").val())),
         LegalFormat:parseInt($.trim($("#cboLegalFormats").val())),
         Address :$.trim($("#txtAddress").val()),
         Phone :$.trim($("#txtPhone").val()),
         Email :$.trim($("#txtEmail").val()),
         WebAddress :$.trim($("#txtWebAddress").val()),
         Note :$.trim($("#txtNote").val()),
         IsAreaEffect :$("#chkIsAreaEffect").is(':checked'),
         IsZoneEffect :$("#chkIsZoneEffect").is(':checked'),
         IsSiteEffect :$("#chkIsSiteEffect").is(':checked'),
         NameInBangla :$.trim($("#txtNameInBangla").val()),
         AddressInBangla :$.trim($("#txtAddressInBangla").val()),
         FaxNo :$.trim($("#txtFaxNo").val()),     
     };
     return oBusinessUnit;
 }

 $("#chkIsSiteEffect").change(function() {
     if(this.checked) {
         $("#chkIsZoneEffect").prop('checked', true);
         $("#chkIsAreaEffect").prop('checked', true);
     }
 });
 $("#chkIsZoneEffect").change(function() {
     if(this.checked) {
         $("#chkIsAreaEffect").prop('checked', true);
     }
     else{
         $("#chkIsSiteEffect").prop('checked', false);
     }
 });
 $("#chkIsAreaEffect").change(function() {
     if(!this.checked) {
         $("#chkIsZoneEffect").prop('checked', false);
         $("#chkIsSiteEffect").prop('checked', false);
     }
 });

 $("#btnSave").click(function(){
     if(!ValidateInput()) return;
     var oBusinessUnit=RefreshObject();

     $.icsSave({
         BaseAddress: _sBaseAddress,
         Object: oBusinessUnit,
         ObjectId: oBusinessUnit.BusinessUnitID,
         ControllerName: "BusinessUnit",
         ActionName: "Save",
         TableId: "",
         IsWinClose: false,
         Message: "Business Unit Saved Successfully."

     },function (response){
         if(response.status && response.obj!=null){
             if(response.obj.BusinessUnitID>0){
                 var oBusinessUnit =response.obj;
                 var oBusinessUnits =sessionStorage.getItem("BusinessUnits");
                 var nIndex= parseInt(sessionStorage.getItem("SelectedRowIndex"));
                 if(oBusinessUnits!=null)
                 {
                     oBusinessUnits = jQuery.parseJSON(oBusinessUnits);
                 }
                 else
                 {
                     oBusinessUnits=[];
                 }
                 if(nIndex!=-1)
                 {
                     oBusinessUnits[nIndex]=oBusinessUnit;
                 }
                 else
                 {
                     sessionStorage.setItem("SelectedRowIndex", oBusinessUnits.length);
                     oBusinessUnits.push(oBusinessUnit);
                 }
                 sessionStorage.setItem("BusinessUnits", JSON.stringify(oBusinessUnits));
                 window.location.href = _sBaseAddress+ "/BusinessUnit/ViewBusinessUnits?menuid="+_nMenuid;
             }
         }
     });

 });

 $("#btnClose").click(function(){
     window.location.href = _sBaseAddress+ "/BusinessUnit/ViewBusinessUnits?menuid="+_nMenuid;
 });

 $(document).keydown(function(e) {
     if(e.which == 27)//escape=27
     {
         window.location.href = _sBaseAddress+ "/BusinessUnit/ViewBusinessUnits?menuid="+_nMenuid;
     }
 });
</script>