@model ESimSol.BusinessObjects.ProductionSchedule
<link href="../../Content/CSS/AjaxLoader.css" rel="stylesheet" type="text/css" />
<html>
<head>
    <style type="text/css">
    
@*    #tblSchedule tr td:hover{ background-color:Highlight;}*@
@*    .tblPertdSchedules:hover
    {
     background-color:Highlight;
     }*@

@*     .dateSelection
     {
        position:fixed;
     }*@

@*
    .addSchedule
     {

        position: absolute;
        top: 0; 
        z-index: 10;
        vertical-align:bottom;
     }*@

</style>
</head>
<body>
    <div style="font-family: Tahoma">
        <table border="0" cellspacing="2" cellpadding="2">
            <tr>
                <td style="text-align: center; width: 925px; color: white; padding-top: 5px;">
                    <div style="width: 100%; background-color: #006633;">
                        <center>
                            <label id="lblHeaderName" style="font-size: 15px; color: Blue; font-weight: bold;
                                color: white">
                                Production Schedule
                            </label>
                        </center>
                    </div>
                </td>
            </tr>
        </table>
        <div id="divContent">
            <div style="font-family: Arial; font-size: 12px;">
                <div id="leftView" style="float: left; padding-left: 5px; padding-right: 5px; padding-top: 5px;
                    width: 240px;">
                    <div style="float: left;">
                        <fieldset style="height: 527px;">
                            <legend>Selection Criteria: </legend>
                            <table style="padding-top: 10px; font-size: 12px; width: 210px;">
                                <tr style="height: 15px;">
                                    <td>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <input type="text" id="txtStartDate" style="width: 210px;" readonly />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-top: 5px; padding-bottom: 5px;">
                                        <div>
                                            <span>Exe No</span><span>
                                                <input type="text" id="txtJobCode" value="Code" style="width: 30px; height: 18px;
                                                    font-size: 12px;" maxlength="2" onclick="ClearJobCodefield()" />
                                                <input type="text" id="txtJobNo" value="No" style="width: 43px; height: 18px; font-size: 12px;"
                                                    maxlength="5" onclick="ClearJobNofield()" />
                                                <input type="text" id="txtJobYear" value="Year" style="width: 17px; height: 18px;
                                                    font-size: 12px;" maxlength="2" onclick="ClearJobYearfield()" />
                                            </span><span>
                                                <input type="button" value="S" id="btnExeNoSearch" style="width: 23px;" /></span>
                                            <span>
                                                <input type="button" value="R" id="btnExeNoReset" style="width: 23px;" /></span>
                                        </div>
                                        <div id="divExeFound" style="padding-top: 5px;">
                                            <span>Total Exe Found:</span> <span>
                                                <label id="lblExeFound" />
                                            </span><span>
                                                <input type="button" id="btnExeFound" value="View" /></span>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            <table style="padding-top: 10px; font-size: 12px; width: 210px;">
                                <tr>
                                    <td>
                                        Location Name
                                        <select id="cboLocation" onchange="ChangeOnlaocation()" style="width: 120px;">
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-top: 5px;">
                                        <div>
                                            <div style="float: left;">
                                                @*Machine Type*@</div>
                                            <div style="float: left; padding-left: 12px;">
                                                <select id="cboMachineType" onchange="ChangeOnMachineType()" style="width: 120px">
                                                    <option value='0'>All</option>
                                                    <option value='1'>Cone</option>
                                                    <option value='2'>Hank</option>
                                                </select>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-bottom: 5px;">
                                        <div>
                                            <div style="float: left;">
                                                <div style="float: left;">
                                                    @*                                                    <input type="checkbox" id="ckboxAllSchedule" onclick="checkAllSchedule()" style="width: 25px" />Select
                                                    all schedule*@
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            @*
                             <div class="easyui-panel" style="overflow:scroll" >*@
                            <table id="tblMachineName" class="easyui-datagrid" style="width: 210px; height: 360px;
                                overflow: scroll;" fitcolumns="false" rownumbers="true" pagination="false" single="true"
                                autorowheight="false">
                                <thead>
                                    <tr>
                                        <th data-options="field:'Selected',checkbox:true">
                                        </th>
                                        <th field="MachineNoWithCapacity" width="150">
                                            Machine Name
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                            <table style="padding-top: 10px; font-size: 12px; width: 210px;">
                                <tr style="height: 15px;">
                                    <td>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-left: 8px; float: right">
                                        <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true"
                                            onclick="Refresh()">Refresh</a>
                                    </td>
                                </tr>
                                @*<tr>
                                    <td>
                                        <div>
                                            <div style="float: left; width: 50%">
                                                <div style="float: left; width: 20px; height: 15px; background: #006600">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    Complete</div>
                                            </div>
                                            <div style="float: left; width: 50%">
                                                <div style="float: left; width: 20px; height: 15px; background: #9900CC">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    InComplete</div>
                                            </div>
                                        </div>
                                        <div>
                                            <div style="float: left; width: 50%; padding-top: 5px;">
                                                <div style="float: left; width: 20px; height: 15px; background: #0000FF">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    Publish</div>
                                            </div>
                                            <div style="float: left; width: 50%; padding-top: 5px;">
                                                <div style="float: left; width: 20px; height: 15px; background: #000000">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    Finish</div>
                                            </div>
                                        </div>
                                        <div>
                                            <div style="float: left; width: 50%; padding-top: 5px;">
                                                <div style="float: left; width: 20px; height: 15px; background: #32CD32">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    Loaded</div>
                                            </div>
                                            <div style="float: left; width: 50%; padding-top: 5px;">
                                                <div style="float: left; width: 20px; height: 15px; background: #800000">
                                                </div>
                                                <div style="float: left; padding-left: 8px;">
                                                    Unloaded</div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>*@
                            </table>
                        </fieldset>
                    </div>
                </div>
                <div style="float: left; padding-right: 10px;">
                    <div>
                        <div style="padding-top: 13px;">
                            <div id="scheduleViewOption" style="padding-left: 5px; background-color: gray;">
                                <a href="javascript:void(0)" id="srchCriteria" class="easyui-linkbutton" iconcls="icon-search"
                                    plain="true" onclick="SearchCriteria()"></a><a href="javascript:void(0)" id="expandViewSchedule"
                                        class="easyui-linkbutton" iconcls="icon-remove" plain="true" onclick="Expand()">
                                    </a>
                                <label>
                                    <input type="button" value="<" style="width: 20px;" onclick="Prevoius()" />
                                </label>
                                <label id="dateHeader" style="font-size: 13px; padding-left: 0px; color: White; font-family: Verdana;">
                                </label>
                                <label>
                                    <input type="button" value=">" style="width: 20px;" onclick="Next()" />
                                </label>
                                <label>
                                    <input type="button" value="Refresh" style="width: 65px;" onclick="ToolbarRefresh()" />
                                </label>
                                <label>
                                    <input type="button" value="Today" style="width: 55px;" onclick="TodayView()" />
                                </label>
                                <label>
                                    <input type="button" value="Day" style="width: 45px;" onclick="DayView()" />
                                </label>
                                <label>
                                    <input type="button" value="Week" style="width: 55px;" onclick="WeekView()" />
                                </label>
                                <label>
                                    <input type="button" value="Month" style="width: 55px;" onclick="MonthView()" />
                                </label>
                                <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true"
                                    onclick="print()">Print</a> <span style="padding-top: 20px;">
                                        <input type="checkbox" id="chkboxUptoUnloadDyeMachine" onchange="RefreshForUnloadDyemachine()" />
                                    </span>
                            </div>
                        </div>
                        <div>
                            <p id="tblContent" style="width: 637px; height: 500px; overflow: scroll;">
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="divAjaxLoader" style=" width:500px;">
                <img src="../../Content/Images/Ajaxloader.GIF" class="ajax-loader" />
        </div>
    </div>
</body>
</html>
<script type="text/javascript">


 var _value ="";
 var _sBaseAddress="";
 var _oUnit=[];
 var _oProductionSchedule;
 var _oLocation=[] ;
 var _oDyeMachine=[];
 var _oDyemachines=[];
 var _activeMachines=[];
 var _oSelectedDyeMachine=[];
 var obj=window.dialogArguments;
 var nProductionScheduleID;
 var stableContents="";
 var _nfirstLoad=1;
 var mouseMoveFlag=1;
 var nflagWeekValue=0;
 var _nView=0;
 var _nFirstDatetimeLoad=0;
 var _nWeek=0;
 var _nContinuation=0;
 var _JobPerMonths=[];
 var _oPSSIDs=[];
 var _oPSIDs=[];




 $(document).ready(function ()
  {

       //debugger;   
         _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));                  
         _oProductionSchedule =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
         _oLocation=  @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.LocationList));
         _oDyeMachine=  @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model.DyeMachineList));
         document.getElementById("divAjaxLoader").style.display='none';
         document.getElementById("cboMachineType").style.display='none';
         document.getElementById("divExeFound").style.display='none';
         var sYear=(new Date()).getFullYear().toString();
         sYear=sYear.substring(2,sYear.length);
         $("#txtJobYear")[0].value=sYear;
  
       // start hide search criteria

        document.getElementById("expandViewSchedule").style.display='inline';
        document.getElementById("srchCriteria").style.display='none';

       // end hide search criteria
  
       $("#txtStartDate").datetimebox({required:true, showSeconds:false});
       var ocurrentdate=new Date();
       $('#txtStartDate').datetimebox('setValue','ocurrentdate');

       $("#cboLocation").empty();
       var listLocation="";
       if(_oLocation.length>0)
       {
            for (var i = 0; i < _oLocation.length; i++) 
            {
                       listLocation += "<option value='" + _oLocation[i].LocationID +"'>" + _oLocation[i].Name+"</option>";
            }
        }
       $("#cboLocation").html(listLocation);

       FindMachineName();
       TableColumnGeneration();
       TableGeneration();
 
 });


 function ClearJobCodefield()
{
        $("#txtJobCode")[0].value='';
}
function ClearJobNofield()
{
        $("#txtJobNo")[0].value='';
}
//function ClearJobYearfield()
//{ 
//        $("#txtJobYear")[0].value='';
//}

$('#btnExeNoReset').click(function(e)
{
    $("#txtJobCode")[0].value='Code';
    $("#txtJobNo")[0].value='No';

});

$('#btnExeNoSearch').click(function(e)
{

    var oPSDs=[];

    var sJobCode= document.getElementById('txtJobCode').value.trim();
    var sJobNo= document.getElementById('txtJobNo').value.trim();
    var sJobYear= document.getElementById('txtJobYear').value.trim();

    if(isNaN(sJobCode)==true && sJobCode!="Code")
    {
       alert("Please enter valid code.");
       return;
    } 
    else if(isNaN(sJobNo)==true && sJobNo!="No")
    {
       alert("Please enter valid no.");
       return;
    }
    else if(isNaN(sJobYear)==true)
    {
       alert("Please enter valid year.");
       return;
    }
    var sOrderNo=sJobCode+'~'+sJobNo+'~'+sJobYear;
    var oPSD={

         OrderNo: sOrderNo
    };
    oPSDs.push(oPSD);
    var nLocationID= document.getElementById("cboLocation").value;
//    var oMachines=$('#tblMachineName').datagrid('getChecked');
//    if(oMachines.length>0)
//    {
//        _oSelectedDyeMachine=[];
//        var PSSIDs="";
//        for(var i=0;i<oMachines.length;i++)
//        {
//        _oSelectedDyeMachine.push(oMachines[i]);
//        PSSIDs=PSSIDs + oMachines[i].PSSID+","; 
//        }
//        PSSIDs=PSSIDs.substring(0,PSSIDs.length-1);
//    }
//       
//    else
//    {
//        FindMachineName();
//    } 

//    _oProductionSchedule.PSSIDs=PSSIDs;
    _oProductionSchedule.sWeek= "Week"; //--------------
    _oProductionSchedule.LocationID=nLocationID;
    _oProductionSchedule.ProductionScheduleList=[];
    _oProductionSchedule.ProductionScheduleDetailList=[];
    _oProductionSchedule.ProductionScheduleDetailsList=oPSDs;
    _oProductionSchedule.DyeMachineList=[];
    _oProductionSchedule.LocationList=[];

        $.ajax({
        type: "POST",
        dataType: "json",            
        url : _sBaseAddress+  "/ProductionSchedule/SearchByJobNo",
        traditional: true,
        data:  JSON.stringify(_oProductionSchedule),
        contentType: "application/json; charset=utf-8",
        success: function (data)
        {
        //debugger;
        _oProductionSchedule = jQuery.parseJSON(data);
        if (_oProductionSchedule.ErrorMessage=="")
        {   //document.getElementById("dateHeader").innerHTML=Month[nDate.getMonth()] +" "+ nDate.getFullYear();

            if(_oProductionSchedule.ProductionScheduleList.length>0)
            {
               _nfirstLoad=0;
               _JobPerMonths= _oProductionSchedule.JobPerMonths;
               document.getElementById("divExeFound").style.display='';
               document.getElementById('lblExeFound').innerHTML=_oProductionSchedule.TotalJobCount;
               document.getElementById("dateHeader").innerHTML=_oProductionSchedule.ProductionScheduleList[0].StartTimeInPerfect.split(' ')[1]+" "+ _oProductionSchedule.ProductionScheduleList[0].StartTimeInPerfect.split(' ')[2];
            }
            TableColumnGeneration(); 
            TableGeneration();   
        }
        else
        {
            alert(_oProductionSchedule.ErrorMessage);
        }
        },
        error: function (xhr, status, error)
        {
            alert(error);
        }
                 

    });

});




$("#btnExeFound").click(function(e)
{
    var oParameter = new Object();
    oParameter.Operation="Add"; 
    oParameter.JobPerMonths= _JobPerMonths;      
    var url = _sBaseAddress +"/ProductionSchedule/ViewJobPerMonths";
    var oPGLs = window.showModalDialog(url, oParameter, 'dialogHeight:450px;dialogWidth:320px;dialogLeft:600;dialogTop:180;center:yes;resizable:no;status:no;scroll:no');
});

 //...............................................................Start Cell Selection..................................

//function cellValueGenerate(e)
//{ 
////    alert(e.target.innerText); //current cell
////    alert(e.target.parentNode.innerText); //Current row.
//alert("");
//}​

 //...............................................................End Cell Selection..................................

function SearchCriteria()
{
     document.getElementById("leftView").style.display='inline';
     document.getElementById("scheduleViewOption").style.width='632px';
     document.getElementById("tblContent").style.width='637px';
     document.getElementById("expandViewSchedule").style.display='inline';
     document.getElementById("srchCriteria").style.display='none';

}

function Expand()
{
     document.getElementById("leftView").style.display='none';
     document.getElementById("scheduleViewOption").style.width='882px';
     document.getElementById("tblContent").style.width='887px';
     document.getElementById("expandViewSchedule").style.display='none';
     document.getElementById("srchCriteria").style.display='inline';
}

//setTimeout(function()
//{
//    document.getElementById("leftView").style.display='none';
//    document.getElementById("scheduleViewOption").style.width='877px';
//    document.getElementById("tblContent").style.width='887px';
//    document.getElementById("expandViewSchedule").style.display='none';
//    document.getElementById("srchCriteria").style.display='inline';
//}, 5000);




document.mouseclick=function()
{
    //alert("aksd");
}
 

 //debugger;
 function ChangeOnlaocation()
 {  
   //debugger;
    $('#tblMachineName').datagrid({selectOnCheck:false, checkOnSelect:false})
    FindMachineName();

//    var ocurrentdate=new Date();
//    $('#txtStartDate').datetimebox('setValue',ocurrentdate);

    _activeMachines=[];
    _oSelectedDyeMachine=[];
    TableColumnGeneration();
    TableGeneration();
 }

function ChangeOnMachineType()
{
     FindMachineName();
}

 //debugger;
 function FindMachineName()
 {  
         _oSelectedDyeMachine=[];
         var locationId= document.getElementById("cboLocation").value;
         var machineType= document.getElementById("cboMachineType").value;

       //debugger;
 

        for(var i=0;i< _oDyeMachine.length;i++)
        {
            if(machineType>0)
            {
                //var machineTypeId=Number(machineType)-1;
           
                if(_oDyeMachine[i].LocationID==locationId && _oDyeMachine[i].IsActive==true && _oDyeMachine[i].MachineType==machineType)
                {
                   _oSelectedDyeMachine.push(_oDyeMachine[i]);
                }

            }

            else
            {

              if(_oDyeMachine[i].LocationID==locationId && _oDyeMachine[i].IsActive==true)
                {
                   _oSelectedDyeMachine.push(_oDyeMachine[i]);
                }

            }
        
          
           
        }
        //debugger;
        $('#tblMachineName').empty;
        data=_oSelectedDyeMachine;
        data={"total":""+data.length+"","rows":data};
        $('#tblMachineName').datagrid('loadData',data);
        $('#tblMachineName').datagrid({selectOnCheck:true, checkOnSelect:false});

 }


 function TableColumnGeneration()
 {
 debugger;
    _activeMachines=[];
    var unique={};
    for( var i=0;i<_oSelectedDyeMachine.length;i++)
    {

//          for(var j=0;j<_oProductionSchedule.ProductionScheduleList.length;j++)
//          {
//             if(_oProductionSchedule.ProductionScheduleList[j].PSSID==_oSelectedDyeMachine[i].PSSID)
//             {
//                  if( typeof(unique[_oProductionSchedule.ProductionScheduleList[j].PSSID]) == "undefined")
//                  {
//                     _activeMachines.push(_oProductionSchedule.ProductionScheduleList[j].PSSID);
//                  }
//                  unique[_oProductionSchedule.ProductionScheduleList[j].PSSID]=0;
//             }
//          }
          _activeMachines.push(_oSelectedDyeMachine[i].PSSID);

    }


 }


function TableGeneration()
{

 //debugger;
  //oSelectedDyeMachine
  document.getElementById("tblContent").innerHTML="";
  //document.getElementById("tblContent").style="overflow:scroll";
  _nView=2;
  var smessage=0;
  _oDyemachines=[];
  stableContents="";

  stableContents +="<table>";
  stableContents +="<thead >";
  stableContents += "<tr>";
  stableContents += "<th style='min-width:50px; text-align:center;'>";
  stableContents += "Date";
  stableContents += "</th>";


  for(var i=0; i<_activeMachines.length;i++)
   { 
     var MachineName="";
     var ProductionScheduleID; 
     stableContents +="<th style='min-width:130px; text-align:center;'>";
     for( var l=0;l<_oSelectedDyeMachine.length;l++)
     {
       if( _oSelectedDyeMachine[l].PSSID==_activeMachines[i])
       {
         MachineName= _oSelectedDyeMachine[l].MachineName;
         _oDyemachines.push(_oSelectedDyeMachine[l]);
         l= _oSelectedDyeMachine.length;
       }
      }
      stableContents += MachineName;
      stableContents +="</th>";             
     }
    stableContents += "</tr>";
    stableContents +="</thead>";

    stableContents +="<tbody >";
    stableContents += "<tr>";

   // stableContents += "<td style='min-width:60px;text-align:center;'>";
    //debugger;


    if(_nFirstDatetimeLoad==0)
    {
       var sDate=$('#txtStartDate').datetimebox('getValue');
       var startDate=new Date(sDate);
       _nFirstDatetimeLoad=1;
    }
    else
    {
        var returnValue=dateChange();
        var startDate=new Date(returnValue[0]);
    }
   
    var nYear=startDate.getFullYear();
    var nMonth=startDate.getMonth()+1;
    
    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var MonthName=Month[startDate.getMonth()];

    if(_nfirstLoad==1)
    {
       document.getElementById("dateHeader").innerHTML=MonthName +" "+ nYear;
    }

    var nTotalDay= new Date(nYear,nMonth,0).getDate();

    var nDate=1;
    var nA=0;
    stableContents += "<table id='tblSchedule'>";
    
    if(nMonth<10)
   {
       nMonth="0"+nMonth;
   }

    while(nDate <= nTotalDay)
    {



          if(nDate<10)
          {
            nDate="0"+Number(nDate);
          }

          var searchStartDate=nMonth+"/"+ nDate+"/"+ nYear+" "+ 00 +":"+ 00;
          var searchEndDate=nMonth+"/"+ nDate+"/"+ nYear+" "+ 23 +":"+ 59;


          var tdate=new Date(searchStartDate);
          var days=['Sun','Mon','Tue','Wed','Thr','Fri','Sat'];
          var dayName=days[tdate.getDay()];


          stableContents += "<tr>";

          //********************************************

          stableContents += "<td class='dateSelection' style='min-width:60px; height:80px; text-align:center; border-bottom:1px solid gray;'>";

          //stableContents += nDate +"<br/>"+ dayName;


          stableContents += "<a style='text-decoration:none;' href="+ "javascript:DailyProduction("+nMonth+","+nDate+","+nYear+")>"+ nDate +"<br/>"+ dayName +"</a>";
   
          stableContents += "</td>";
          //_oProductionSchedule.MaxValue

          
          //...............................................//
          for(var i=0; i<_activeMachines.length;i++)
          { 

             var flag=0;
             
             stableContents += "<td class='tblPertdSchedules' style='min-width:139px; height:80px; text-align:center;  border:1px solid gray;'>";
             stableContents += "<div><a title="+'Machine:'+_oSelectedDyeMachine[i].MachineName +',Date:'+ nDate +'-'+ MonthName +'-'+ nYear +" class="+'"easyui-tooltip"'+">";

             var oCurrentTime=new Date();
             if( (tdate.getDate()>= oCurrentTime.getDate() && tdate.getMonth()==oCurrentTime.getMonth())   ||  ( tdate.getMonth()>oCurrentTime.getMonth()) )

             {
               stableContents += "<div>"+"<center><input  style='top:0;'  type='button' value='Add Schedule' onClick='AddNewSchedule("+i+","+nDate+","+nMonth+","+nYear+","+startDate.getHours()+","+startDate.getMinutes()+","+_nView+")'/></center>"+"</div>";

             }
//             stableContents += "<div>";

             for(var j=0;j<_oProductionSchedule.ProductionScheduleList.length;j++)
             {
               // //debugger;

                  

                  if(_oProductionSchedule.ProductionScheduleList[j].PSSID == _activeMachines[i] && ((new Date( _oProductionSchedule.ProductionScheduleList[j].StartTimeInString)>= new Date(searchStartDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString)<= new Date(searchEndDate))  || (new Date( _oProductionSchedule.ProductionScheduleList[j].EndTimeInString)>= new Date(searchStartDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].EndTimeInString)<= new Date(searchEndDate)) ||  (new Date(_oProductionSchedule.ProductionScheduleList[j].EndTimeInString)>new Date(searchEndDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString)<new Date(searchStartDate))  ) )
                  {
                  
                     var s= _oProductionSchedule.ProductionScheduleList[j].StartTimeInString;
                     var st=new Date(s);
                     var e=_oProductionSchedule.ProductionScheduleList[j].EndTimeInString;
                     var et=new Date(e);


                     var shr=st.getHours();
                     if(shr<10)
                     {
                      shr="0"+shr;
                     }
                     var smin=st.getMinutes();
                     if(smin<10)
                     {
                      smin="0"+smin;
                     }

                     var ehr=et.getHours();
                     if(ehr<10)
                     {
                      ehr="0"+ehr;
                     }
                     var emin=et.getMinutes();
                     if(emin<10)
                     {
                      emin="0"+emin;
                     }

                     var nStartDay=st.getDate();
                     var nEndDay=et.getDate();




                     stableContents += "<table>";
                     stableContents += "<tr>";
                     if(flag==0)
                     {
//                       if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Publish')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#0000FF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>" ; //Color Blue for Publish
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Incomplete')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#9900CC; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";  // Color Purple for Incomple
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Complete')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#006600; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Green for Complete                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Loadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#32CD32; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color LimeGreen for Loadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='UnLoadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#800000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Maroon for Unloadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Finish')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#000000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Black for Finish                                                    
//                       }
                         stableContents += "<td height='40' width='140' style='background-color:#FFFFFF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   
                       flag=1;
                     } 
                     else
                     {
//                       if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Publish')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#0000FF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; //Color Blue for Publish
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Incomplete')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#9900CC; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; // Color Purple for Incomple
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Complete')
//                       {
//                        stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#006600; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";  // Color Green for Complete                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Loadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#32CD32; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color LimeGreen for Loadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='UnLoadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#800000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Maroon for Unloadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Finish')
//                       {
//                        stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#000000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Black for Finish                                                    
//                       }
                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#FFFFFF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";                                                  
                       
                     } 
                     
                     
                     
                     if(Number(nStartDay)<Number(nEndDay))
                     {
                         if(nDate==nStartDay)
                         {

                                stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'MonthView')"+">" + shr + ":" + smin + " - " + "Continue" + "<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+   
                                                   _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" +"Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); // + "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                         }

                         else if(Number(nEndDay)>nDate)
                         {
                                stableContents +="<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'MonthView')"+">" + "Continue" + "<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                                  _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                         }

                         else
                         {
                                stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'MonthView')"+">" + "Continue" + " - " + ehr + ":" + emin +"<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                                 _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";

                         }
                      
                     }

                     else
                     { 
                                            
                         stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'MonthView')"+">" + shr + ":" + smin + " - " + ehr + ":" + emin +"<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                            _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                     }

                     stableContents += "</td>";
                     stableContents += "</tr>";
                     stableContents += "</table>";
                     smessage=1;
                     flag=1;            
                  }

          
              }

              //.........................................//

              if(flag==0)
              {
                     stableContents += "<br/>";
              }
              stableContents +="</a></div>";
              stableContents += "</td>";
//              stableContents += "</div>";
            }


          //*********************************************

          stableContents += "</tr>";
          

          nDate=Number(nDate)+1;

      }
      
      stableContents += "</table>"; 



    stableContents += "</tr>";
    stableContents +="</tbody>";

   stableContents +="</table>";


   document.getElementById("tblContent").innerHTML=stableContents;

//  if(_activeMachines.length<=4)
//  {
//         document.getElementById("tblContent").style="overflow:hidden;overflow-y:scroll;";
//  }
//  if(smessage==0)
//  {
//         document.getElementById("tblContent").style="overflow:hidden";
//         document.getElementById("tblContent").innerHTML="<div style=' padding-top:200px; padding-left:200px;font-size:16px; font-weight:Bold;'>No Schedule Available</div>";

//  }

   
}


function DailyProduction(nMonth,nDate,nYear)
{
    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var currentDate=new Date(nMonth+"/"+ nDate+"/"+ nYear+" "+ 0 +":"+ 0);

    //alert(currentDate);

    document.getElementById("dateHeader").innerHTML= currentDate.getDate()+" "+ Month[currentDate.getMonth()] +" "+ currentDate.getFullYear();
    _oProductionSchedule.sDay= "Day";
    _oProductionSchedule.StartTime= currentDate;
    search();

} 


function AddNewSchedule(nPosition,nDate,nMonth,nYear,nHour,nMinute,nView)
{
 //nDate,nMonth,nYear,nHour,nMinute
 debugger;
  var oParameter=new Object();

  var oDyeMachine=
  {
      LocationID              :   _oDyemachines[nPosition].LocationID,
      PSSID                  :   _oDyemachines[nPosition].PSSID,
      MachineName            :   _oDyemachines[nPosition].MachineName,
      //UsesWeight           :   _oDyemachines[nPosition].MachineCapacity
      MachineCapacity           :   _oDyemachines[nPosition].MachineCapacity
//      UsesSpindleCount     :   _oDyemachines[nPosition].UsesSpindleCount,
//      UsesLiquorCapacity   :   _oDyemachines[nPosition].UsesLiquorCapacity
  }

  if(nView==1 || nView==2) // Week View && Month View
  {   
      var currentDate=new Date(); 
      currentDate.setMinutes(currentDate.getMinutes()+5);
      var newDate=nMonth+"/"+nDate+"/"+nYear+" "+currentDate.getHours()+":"+currentDate.getMinutes();
//      oParameter.DisableField="Add New Schedule From Day";
  }


  else if(nView==0) // day view
  {
       var newDate=nMonth+"/"+nDate+"/"+nYear+" "+nHour+":"+nMinute;
       oParameter.DisableField="Add New Schedule From Day";
  }


  oParameter.Name="Add New Schedule";
  oParameter.oDyeMachine=oDyeMachine;
  oParameter.StartDate=newDate;
  var url =_sBaseAddress+ "/ProductionSchedule/ViewProductionSchedule?sValue=0~"+oDyeMachine.PSSID;
  var oProductionSchedule=window.showModalDialog(url, oParameter,'dialogHeight:340px;dialogWidth:860px;dialogLeft:380;dialogTop:400;center:yes;resizable:no;status:no;scroll:yes');
  
  //_oProductionSchedule.ProductionScheduleList.push(oProductionSchedule);

     TableColumnGeneration();

    if(nView==0)
    {
        _oProductionSchedule.sDay= "Day";  
    }
    else if(nView==1)
    {
        _oProductionSchedule.sWeek= "Week";
    }
    else if(nView==2)
    {
        _oProductionSchedule.sMonth="Month";
    }
    search();
}

function Edit(pid,len,sView)
{ 


        //debugger; 
        var oParameter = new Object();        
        oParameter.Name = "Schedule Information";
        oParameter.oProductionSchedule =  _oProductionSchedule.ProductionScheduleList[len];

        var url =_sBaseAddress+ "/ProductionSchedule/ViewScheduleInformation?id="+pid;
        var sProductionSchedule = window.showModalDialog(url, oParameter,'dialogHeight:350px;dialogWidth:780px;dialogLeft:385;dialogTop:150;center:yes;resizable:no;status:no;scroll:yes');

        //debugger;
        if(sProductionSchedule=="Delete")
        {
           //window.location.reload(true);
           // _oProductionSchedule.ProductionScheduleList.splice(len,1);
        }

        else if(sProductionSchedule[1]=="Edit Machine")
        {

           
           _oProductionSchedule.ProductionScheduleList[len].StartTimeInString=sProductionSchedule[0].StartTimeInString;
           _oProductionSchedule.ProductionScheduleList[len].EndTimeInString=sProductionSchedule[0].EndTimeInString;
           _oProductionSchedule.ProductionScheduleList[len].PSSID=sProductionSchedule[0].PSSID;
           _oProductionSchedule.ProductionScheduleList[len].MachinNo=sProductionSchedule[0].MachinNo;
           _oProductionSchedule.ProductionScheduleList[len].LocationID=sProductionSchedule[0].LocationID;
           _oProductionSchedule.ProductionScheduleList[len].LocationName=sProductionSchedule[0].LocationName;
           _oProductionSchedule.ProductionScheduleList[len].ProductionQty=sProductionSchedule[0].ProductionQty;
           _oProductionSchedule.ProductionScheduleList[len].OrderDetail=sProductionSchedule[2];

           
        }

        
        else if(sProductionSchedule[0]=="Order Change")
        {
        
           _oProductionSchedule.ProductionScheduleList[len].ProductionQty=sProductionSchedule[2];
           _oProductionSchedule.ProductionScheduleList[len].OrderDetail=sProductionSchedule[5];


           for(var n=0;n<_oProductionSchedule.ProductionScheduleList.length;n++)
           {
              if(_oProductionSchedule.ProductionScheduleList[n].ProductionScheduleID==Number(sProductionSchedule[3]))
              {
                 _oProductionSchedule.ProductionScheduleList[n].ProductionQty=Number(sProductionSchedule[1]);
                 _oProductionSchedule.ProductionScheduleList[n].OrderDetail=sProductionSchedule[4];
                 n=_oProductionSchedule.ProductionScheduleList.length;
              }
           }
        }

        else if(sProductionSchedule.ScheduleStatusInString=='Publish')
        {
           _oProductionSchedule.ProductionScheduleList[len].ScheduleStatus=3;
           _oProductionSchedule.ProductionScheduleList[len].ScheduleStatusInString='Publish';


        }


        TableColumnGeneration();

        if(sView=='DayView')
        {
           _oProductionSchedule.sDay= "Day";
          // tableDay(); 
           
        }
        else if(sView=='WeekView')
        {
           _oProductionSchedule.sWeek= "Week";
          // tableWeek();
        }
        else if(sView=='MonthView')
        {
           _oProductionSchedule.sMonth="Month";
          // TableGeneration();
        }
        search();

} 

function setDateTime(startDate)
{
        var nYear=startDate.getFullYear();
        var nMonth=startDate.getMonth();
        var nDate=startDate.getDate();
        var nHour=startDate.getHours();
        var nMin=startDate.getMinutes();
//        if(nMonth<10 )
//        {
//           nMonth="0"+nMonth;
//        }
        if(nDate<10)
        {
           nDate="0"+nDate;
        }
        if(nHour<10)
        {
           nHour="0"+nHour;
        }
        if(nMin<10)
        {
           nMin="0"+nMin;
        }

       // var intervalMin=Number(nMin)+14;

        //var sDateTime= nMonth+"/"+nDate+"/"+nYear+" "+nHour+":"+nMin+" - "+nHour+":"+intervalMin;
        //var mthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        //var sDateTime= nDate+"/"+mthNames[Number(nMonth)]+"/"+nYear+" "+nHour+":"+nMin;

        var sDateTime= nHour+":"+nMin;              
        return sDateTime;
}

function Next()
{
     var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
     var dateString=document.getElementById("dateHeader").innerHTML;

     var returnValue=dateChange();

     var nDate= new Date(returnValue[0]);
     var cSpace= returnValue[1];
     var sDateView=returnValue[2];
     

     if( sDateView=="viewAsDateMonth")
     {
        if(Number(cSpace)==1)
        {
          _nfirstLoad=0;
          nDate.setMonth(Number(nDate.getMonth())+1);
          document.getElementById("dateHeader").innerHTML= Month[nDate.getMonth()] +" "+ nDate.getFullYear();
          _oProductionSchedule.sMonth="Month";
          _oProductionSchedule.StartTime= nDate;
         // search();

        }
        else if(Number(cSpace)==2)
        {
          nDate.setDate(Number(nDate.getDate())+1);
          document.getElementById("dateHeader").innerHTML= nDate.getDate()+" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
          _oProductionSchedule.sDay= "Day";
          _oProductionSchedule.StartTime= nDate;
         // search();
        }
     }

    else if(sDateView=="viewAsWeek")
    {                  
        var tempDate=new Date(returnValue[0]);
        nDate.setDate(nDate.getDate()+7);

        if(nDate.getFullYear()==tempDate.getFullYear())
        {  
           document.getElementById("dateHeader").innerHTML= (tempDate.getDate()+1)+" "+ Month[tempDate.getMonth()] +"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
        }
        else
        {
           //alert(tempDate.getDate()+1);
           tempDate.setDate(tempDate.getDate()+1);
           document.getElementById("dateHeader").innerHTML= (tempDate.getDate())+" "+ Month[tempDate.getMonth()] +" "+ tempDate.getFullYear()+" "+"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
        }

        _oProductionSchedule.sWeek= "Week";
        _oProductionSchedule.StartTime= tempDate;
        //search();
    }




} 

function Prevoius()
{

     var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
     var dateString=document.getElementById("dateHeader").innerHTML;

     var returnValue=dateChange();

     var nDate= new Date(returnValue[0]);
     var cSpace= returnValue[1];
     var sDateView=returnValue[2];  


     if( sDateView=="viewAsDateMonth")
     {
        if(Number(cSpace)==1)
        {
          _nfirstLoad=0;
          nDate.setMonth(Number(nDate.getMonth())-1);
          document.getElementById("dateHeader").innerHTML= Month[nDate.getMonth()] +" "+ nDate.getFullYear();
          _oProductionSchedule.sMonth="Month";
          _oProductionSchedule.StartTime= nDate;
         // search();

        }
        if(Number(cSpace)==2)
        {
          nDate.setDate(Number(nDate.getDate())-1);
          document.getElementById("dateHeader").innerHTML= nDate.getDate()+" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
          _oProductionSchedule.sDay= "Day";
          _oProductionSchedule.StartTime= nDate;
          //search();
        }  
     }
     else if(sDateView=="viewAsWeek")
     {                  
         var tempDate=new Date(returnValue[0]);
         
         tempDate.setDate(Number(tempDate.getDate())-13);
         nDate.setDate(Number(nDate.getDate())-7);
         if(nDate.getFullYear()==tempDate.getFullYear())
         {  
            document.getElementById("dateHeader").innerHTML= tempDate.getDate()+" "+ Month[tempDate.getMonth()] +"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
         }
         else
         {
            document.getElementById("dateHeader").innerHTML= tempDate.getDate()+" "+ Month[tempDate.getMonth()] +" "+ tempDate.getFullYear()+" "+"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
         }

         _oProductionSchedule.sWeek= "Week";
         _oProductionSchedule.StartTime= tempDate;
         //search();
     }

}


function dateChange()
{
     var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
     var dateString=document.getElementById("dateHeader").innerHTML;
     var flag=0;
     var countSpace=0;
     var tempDate="";
     var sMonth="";
     var temp=0;
     var dateFormat="";
     var sDateView="";
     for(var i=0; i<dateString.length;i++)
     {
         if(dateString[i]=='-')
         {
           flag=1;
         }
     }

     if(flag==0)
     {

         for(var i=0; i<dateString.length;i++)
         {
            nflagWeekValue=0;
            if(dateString[i]!=" ")
            {
                if(isNaN(dateString[i]))
                {
                    sMonth += dateString[i];
                    if(dateString[Number(i)+1]==" ")
                    {
                        for(var j=0;j<Month.length;j++)
                        {
                            if(Month[j]==sMonth)
                            {
                                temp=Number(j)+1;
                                j=Month.length;
                            }
                        }
                    } 
             
                }

                else
                {
                    tempDate +=dateString[i];
                }
           
            }
            if(dateString[i] ==" ")
            {
                countSpace=Number(countSpace)+1;
                tempDate +="/";
            }

         }

        if(tempDate.length>5)
        {
          dateFormat=temp+"/"+tempDate;
        }
        else
        {
          dateFormat=temp+"/"+"1"+"/"+tempDate;
        }

        sDateView="viewAsDateMonth";

     }

     else if(flag==1)
     {
         nflagWeekValue=1;
         var i=0;
         while(dateString[i]!='-')
         {
            i++;
         }

         i++;
         for(var j=i; i<dateString.length;i++)
         {

            if(dateString[i]!=" ")
            {
                if(isNaN(dateString[i]))
                {
                    sMonth += dateString[i];
                    if(dateString[Number(i)+1]==" ")
                    {
                        for(var j=0;j<Month.length;j++)
                        {
                            if(Month[j]==sMonth)
                            {
                                temp=Number(j)+1;
                                j=Month.length;
                            }
                        }
                    } 
             
                }

                else
                {
                    tempDate +=dateString[i];
                }
           
            }
            if(dateString[i] ==" ")
            {
                countSpace=Number(countSpace)+1;
                tempDate +="/";
            }

         }

        if(tempDate.length>5)
        {
        dateFormat=temp+"/"+tempDate;
        }
        else
        {
        dateFormat=temp+"/"+"1"+"/"+tempDate;
        }

        sDateView="viewAsWeek";

     }


    var newDate=new Date(dateFormat);
    return [newDate, countSpace,sDateView];
}


function TodayView()
{

    var currentDate=new Date();

    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    document.getElementById("dateHeader").innerHTML= currentDate.getDate()+" "+ Month[currentDate.getMonth()] +" "+ currentDate.getFullYear();
    _oProductionSchedule.sDay= "Day";
    _oProductionSchedule.sPrintView="viewAsDateMonth";
    _oProductionSchedule.StartTime= currentDate;
    search();
}


function DayView()
{
   
    var returnValue=dateChange();
    var nDate=new Date(returnValue[0]);
    if(nflagWeekValue==1)
    {
       nDate.setDate(nDate.getDate()-6);
    }


    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    document.getElementById("dateHeader").innerHTML= nDate.getDate()+" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
    _oProductionSchedule.sDay= "Day";
    _oProductionSchedule.sPrintView="viewAsDateMonth";
    _oProductionSchedule.StartTime= nDate;
    search();

}

function MonthView()
{
    var returnValue=dateChange();
    var nDate=new Date(returnValue[0]);

    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    document.getElementById("dateHeader").innerHTML=Month[nDate.getMonth()] +" "+ nDate.getFullYear();
    _oProductionSchedule.sMonth= "Month";
    _oProductionSchedule.sPrintView="viewAsDateMonth";
    _oProductionSchedule.StartTime= nDate;
    search();
}

function WeekView()
{

    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

    var returnValue=dateChange();
   
    var tempDate=new Date(returnValue[0]);
    var nDate=new Date(returnValue[0]);
  //  if(_nWeek==0)
    {
      nDate.setDate(nDate.getDate()+6);
      _nWeek=1;
    }
//    else
//    {
//      //nDate.setDate(nDate.getDate()-6);
//       tempDate.setDate(tempDate.getDate()-6);
//    }

    if(nDate.getFullYear()==tempDate.getFullYear())   
    {
        document.getElementById("dateHeader").innerHTML= tempDate.getDate()+" "+ Month[tempDate.getMonth()]+" "+"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
    }
    else
    {
        document.getElementById("dateHeader").innerHTML= tempDate.getDate()+" "+ Month[tempDate.getMonth()] +" "+ tempDate.getFullYear()+" "+"-"+" "+ nDate.getDate() +" "+ Month[nDate.getMonth()] +" "+ nDate.getFullYear();
    }

    _oProductionSchedule.sWeek= "Week";
    _oProductionSchedule.sPrintView="viewAsWeek";
    _oProductionSchedule.StartTime= tempDate;
    search();
}


function ToolbarRefresh()
{
     var returnValue=dateChange();
     var nDate= new Date(returnValue[0]);
     var cSpace= returnValue[1];
     var sDateView=returnValue[2];
     if(sDateView=="viewAsDateMonth")
     {
         if(Number(cSpace)==1)
         {
             _oProductionSchedule.sMonth="Month";
         }
         else if(Number(cSpace)==2)
         {
             _oProductionSchedule.sDay= "Day";
         }
         _oProductionSchedule.StartTime=nDate;
         
      }
      else if(sDateView=="viewAsWeek")
      {
         _oProductionSchedule.sWeek= "Week";
         _oProductionSchedule.StartTime=new Date(nDate.setDate(nDate.getDate()-6));
         
      }
      
      
     search();
    _oPSIDs=[];
    _oPSSIDs=[];
}

function Refresh()
{
    //debugger;
    document.getElementById("divExeFound").style.display='none';
    var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var sDate=$('#txtStartDate').datetimebox('getValue');
    var tempDate=new Date(sDate);                                    
    _oProductionSchedule.StartTime= tempDate;
    _oProductionSchedule.sDay= "Day";
    _oProductionSchedule.sPrintView="viewAsDateMonth";
    search();
    document.getElementById("dateHeader").innerHTML= tempDate.getDate()+" "+ Month[tempDate.getMonth()] +" "+ tempDate.getFullYear();
    _oPSIDs=[];
    _oPSSIDs=[];
 }

 function search()
 {
    //debugger;
    var oPSDs=[];

    var sJobCode= document.getElementById('txtJobCode').value;
    var sJobNo= document.getElementById('txtJobNo').value;
    var sJobYear= document.getElementById('txtJobYear').value;

    if(sJobCode =="Code" || sJobNo!="No")
    {
    
      document.getElementById("divExeFound").style.display='none';
    }
    if(isNaN(sJobCode)==true && sJobCode!="Code")
    {
       alert("Please enter valid code.");
       return;
    } 
    else if(isNaN(sJobNo)==true && sJobNo!="No")
    {
       alert("Please enter valid no.");
       return;
    }
    else if(isNaN(sJobYear)==true)
    {
       alert("Please enter valid year.");
       return;
    }
    var sOrderNo=sJobCode+'~'+sJobNo+'~'+sJobYear;
    var oPSD={

         OrderNo: sOrderNo
    };
    oPSDs.push(oPSD);
    var nLocationID= document.getElementById("cboLocation").value;
    var oMachines=$('#tblMachineName').datagrid('getChecked');
    if(oMachines.length>0)
    {
        _oSelectedDyeMachine=[];
        var PSSIDs="";
        for(var i=0;i<oMachines.length;i++)
        {
        _oSelectedDyeMachine.push(oMachines[i]);
        PSSIDs=PSSIDs + oMachines[i].PSSID+","; 
        }
        PSSIDs=PSSIDs.substring(0,PSSIDs.length-1);
    }
       
    else
    {
        FindMachineName();
    } 

    _oProductionSchedule.PSSIDs=PSSIDs;
    _oProductionSchedule.LocationID=nLocationID;
    _oProductionSchedule.ProductionScheduleList=[];
    _oProductionSchedule.ProductionScheduleDetailList=[];
    _oProductionSchedule.ProductionScheduleDetailsList=oPSDs;
   // _oProductionSchedule.ProductionScheduleDetailsList=[];
    _oProductionSchedule.DyeMachineList=[];
    _oProductionSchedule.LocationList=[];

    var bValue=true;
    if(document.getElementById('chkboxUptoUnloadDyeMachine').checked==true)
    {
       bValue=false;
    }

    document.getElementById("divContent").style.opacity=0.4;
    document.getElementById("divAjaxLoader").style.display='';

        $.ajax({
        type: "POST",
        dataType: "json",            
        url : _sBaseAddress+  "/ProductionSchedule/Refresh",
        traditional: true,
        data:  JSON.stringify({oProductionSchedule: _oProductionSchedule, bUptoLoadDyeMachine:bValue}),
        contentType: "application/json; charset=utf-8",
        success: function (data)
        {
        //debugger;
        _oProductionSchedule = jQuery.parseJSON(data);
        if (_oProductionSchedule.ErrorMessage=="")
        {   
              
            TableColumnGeneration(); 
            if(_oProductionSchedule.sDay=="Day")
            {
              _oProductionSchedule.sDay="";
              _oProductionSchedule.sWeek="";
              _oProductionSchedule.sMonth="";
              tableDay();

            }
            else if(_oProductionSchedule.sWeek=="Week")
            {
              _oProductionSchedule.sDay="";
              _oProductionSchedule.sWeek="";
              _oProductionSchedule.sMonth="";
              tableWeek();
            }
            else
            {
              TableGeneration();
            }
            document.getElementById("divContent").style.opacity=1;
            document.getElementById("divAjaxLoader").style.display='none';  
            
        }
        else
        {
            document.getElementById("divContent").style.opacity=1;
            document.getElementById("divAjaxLoader").style.display='none';  
            alert(_oProductionSchedule.ErrorMessage);
        }
        },
        error: function (xhr, status, error)
        {
            alert(error);
        }
                 

    });
 }



function print()
{
    //debugger;
     var returnValue=dateChange();
     var nDate = new Date(returnValue[0]);
     var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
     var currentDate=Month[nDate.getMonth()]+" "+ nDate.getDate() +" "+ nDate.getFullYear()+" "+0+":"+0;
     var cSpace= returnValue[1];
     var sPrintView= returnValue[2];
     var PSSIDs="";
     var ProductionScheduleIDs="";
     var nLocationID= document.getElementById("cboLocation").value;
     var oMachines=$('#tblMachineName').datagrid('getChecked');

     var bValue=true;
     if(document.getElementById('chkboxUptoUnloadDyeMachine').checked==true)
     {
       bValue=false;
     }
     /////////////////////////////////////
     if(_oPSIDs.length>0 && _oPSSIDs.length>0)
     {
        bValue=false;
        for(var i=0; i<_oPSIDs.length;i++)
        {
          ProductionScheduleIDs=ProductionScheduleIDs+_oPSIDs[i]+",";
        }
        ProductionScheduleIDs=ProductionScheduleIDs.substring(0,ProductionScheduleIDs.length-1);
        var oTempArr=[];
        oTempArr.push(_oPSSIDs[0]);
        PSSIDs=_oPSSIDs[0] +',';
        if(_oPSSIDs.length>1)
        {
          for(var i=1; i<_oPSSIDs.length;i++)
          {
              for(var j=0; j<oTempArr.length;j++)
              {
                 if(oTempArr[j]!=_oPSSIDs[i] )
                 {
                   
                   oTempArr.push(_oPSSIDs[i]);
                   PSSIDs=PSSIDs+ _oPSSIDs[i] +',';
                   break;
                 }
                 else
                 {
                   break;
                 }
              }
           }
         }
         PSSIDs=PSSIDs.substring(0,PSSIDs.length-1);
//         _oPSIDs=[];
//         _oPSSIDs=[];
     }
     else
     {
         if(oMachines.length>0)
         {
            _oSelectedDyeMachine=[];
        
            for(var i=0;i<oMachines.length;i++)
            {
            _oSelectedDyeMachine.push(oMachines[i]);
            PSSIDs=PSSIDs + oMachines[i].PSSID+","; 
            }
            PSSIDs=PSSIDs.substring(0,PSSIDs.length-1);
    //        if(oMachines.length>8)
    //        {
    //          alert("You can print maximum 8 machines schedule at a time.");
    //          return;
    //        }
          }

         else
         {
           for(var i=0;i<_oSelectedDyeMachine.length;i++)
           {
             PSSIDs=PSSIDs + _oSelectedDyeMachine[i].PSSID+","; 
           }

           PSSIDs=PSSIDs.substring(0,PSSIDs.length-1);
    //       if(_oSelectedDyeMachine.length>8)
    //       {
    //          alert("You can print maximum 8 machines schedule at a time.");
    //          return;
    //       }
         }
     }

     


     
     var psof=document.getElementById("dateHeader").innerHTML; 
     
     var newstring=cSpace+'~'+currentDate+'~'+nLocationID+'~'+PSSIDs+'~'+psof+'~'+sPrintView+'~'+ProductionScheduleIDs+'~'+bValue;

     //window.open(_sBaseAddress + '/ProductionSchedule/PrintProductionSchedule?cSpace='+cSpace + '&searchTime=' +nDate +'&LId='+locationID +'&DIds='+PSSIDs , '_blank');
    window.open(_sBaseAddress + '/ProductionSchedule/PrintProductionSchedule?newstring='+newstring, '_blank');
     
}


function tableDay()
{
   //debugger;
  //oSelectedDyeMachine
  document.getElementById("tblContent").empty;
  _oDyemachines=[];
  _nView=0;
  var ntemp=0;
  var count=0;
  stableContents="";

  stableContents +="<table>";
   //style='position:absolute;'
  stableContents +="<thead >";
  stableContents += "<tr>";
  stableContents +="<th style='min-width:50px; text-align:center;'>";
  stableContents +="Time";
  stableContents +="</th>";
  for(var i=0; i<_activeMachines.length;i++)
   { 
     var MachineName="";
     var ProductionScheduleID; 
     stableContents +="<th style='min-width:149px; text-align:center;'>";
     for( var l=0;l<_oSelectedDyeMachine.length;l++)
     {
       if( _oSelectedDyeMachine[l].PSSID==_activeMachines[i])
       {
         MachineName= _oSelectedDyeMachine[l].MachineName;
         _oDyemachines.push(_oSelectedDyeMachine[l]);
         l= _oSelectedDyeMachine.length;
       }
      }
      stableContents += MachineName;
      stableContents +="</th>";             
     }
    stableContents += "</tr>";
    stableContents +="</thead>";

    stableContents +="<tbody >";
    stableContents += "<tr>";
    stableContents += "<td style='width:60px; text-align:center;'>";
    //debugger;

       var returnValue=dateChange();
       var startDate=new Date(returnValue[0]);

       var tempDate=(Number(startDate.getMonth())+1)+"/"+startDate.getDate()+"/"+startDate.getFullYear()+" "+ 23+":"+59;
       var endDate=new Date(tempDate);

       var flag=0;
       var nx=startDate.getMinutes()%15;

       if( Number(nx) > 0 )
       {

            startDate.setMinutes(startDate.getMinutes() - Number(nx));
            endDate.setMinutes(endDate.getMinutes() - Number(nx));

       }

       var rowColor=0;

       while(startDate < endDate)
       {
          
          stableContents += "<table>"; 
          stableContents += "<tr>";

          if(Number(flag)==0)
          {
              stableContents += "<td style='min-width:60px; height:29px; text-align:center; border-top:1px solid gray; border-bottom:1px solid gray;'>";
              stableContents += setDateTime(startDate);
              startDate.setMinutes(startDate.getMinutes() + 15);
              flag=1;
              rowColor=1;
          }

          else
          {  
              rowColor++;
              if((rowColor%4)==0)
              {
//                stableContents += "<td style='min-width:60px; height:29px; text-align:center; border-bottom:1px solid gray; background-color:#E0E0E0 ;'>";
                  stableContents += "<td style='min-width:60px; height:29px; text-align:center; border-bottom:1px solid gray; background-color:#FFFFFF ;'>";
              }
              else
              {
                stableContents += "<td style='min-width:60px; height:29px; text-align:center; border-bottom:1px solid gray;'>";
              }
              stableContents += setDateTime(startDate);
              startDate.setMinutes(startDate.getMinutes() + 15);
          }

      
          stableContents += "</td>";
          stableContents += "</tr>";
          stableContents += "</table>"; 

        }

     stableContents += "</td>";


     stableContents += "<td style='max-width:157px;'>";
     stableContents += "<table>";
  

    for(var i=0; i<_activeMachines.length;i++)
    { 
       // //debugger;
       _nContinuation=0;
       stableContents += "<td style='text-align:center; min-width:140px;'>";
       stableContents +="<table  style='max-width:157px;'>";


       var returnValue=dateChange();
       var startDate=new Date(returnValue[0]);

       var tempDate=(Number(startDate.getMonth())+1)+"/"+startDate.getDate()+"/"+startDate.getFullYear()+" "+ 23+":"+59;
       var endDate=new Date(tempDate);


        var flag=0;
        var nx=startDate.getMinutes()%15;
        if( Number(nx) > 0 )
        {
           startDate.setMinutes(startDate.getMinutes() - Number(nx));
           endDate.setMinutes(endDate.getMinutes() - Number(nx));
        }

        for(var j=0;j<_oProductionSchedule.ProductionScheduleList.length;j++)
        {
          //debugger;

            if(_oProductionSchedule.ProductionScheduleList[j].PSSID == _activeMachines[i])
            {

              //.........................................................................................


              // while(startDate < sDate)
               {
                    var sDate=new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString);
                    var eDate=new Date(_oProductionSchedule.ProductionScheduleList[j].EndTimeInString);


                   if(startDate.getDate()<eDate.getDate() && startDate.getDate()>sDate.getDate())
                   {

                          sDate=startDate;
                          sDate.setHours(0);
                          sDate.setMinutes(0);

                          eDate=startDate;
                          eDate.setHours(23);
                          eDate.setMinutes(59);
                   }


                   
                   else if(startDate.getDate()>sDate.getDate())
                   {
                          sDate=startDate;
                          sDate.setHours(0);
                          sDate.setMinutes(0);

                   }

                   else if(sDate.getDate()<eDate.getDate())
                   {
                          eDate=new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString);
                          eDate.setHours(23);
                          eDate.setMinutes(59);

                   }

                    var sD=sDate.getMinutes()%15;
                    if( Number(sD) > 0 )
                    {
                        sDate.setMinutes(sDate.getMinutes() - Number(sD));
                    }
                    var eD=eDate.getMinutes()%15;
                    if( Number(eD) > 0 )
                    {
                        eD=15-eD;
                        eDate.setMinutes(eDate.getMinutes() + Number(eD));
                    }

                    while(startDate<sDate)

                    {
                           stableContents += "<tr style='border:1px solid gray;'>";
                           stableContents += "<td style='min-width:157px; height:29px; text-align:center;border-bottom:1px solid gray;'>";
                           //stableContents +=  "<br/>";

                           var oCurrentTime=new Date();

                           var nRemainder=((oCurrentTime.getMinutes())%15)
             
                           if(Number(nRemainder)>0)
                           {
                              oCurrentTime.setMinutes(Number(oCurrentTime.getMinutes())-Number(nRemainder));
                              oCurrentTime.setSeconds(0,0);
                              
                           }
                           if(startDate>= oCurrentTime)
                           {
                              stableContents += "<div>"+"<center><input  style='top:0;'  type='button' value='Add Schedule' onClick='AddNewSchedule("+i+","+startDate.getDate()+","+(startDate.getMonth()+1)+","+startDate.getFullYear()+","+startDate.getHours()+","+startDate.getMinutes()+","+_nView+")'/></center>"+"</div>";                                                       
                           }
                           stableContents += "</td>";
                           stableContents += "</tr>";
                           startDate.setMinutes(startDate.getMinutes() + 15);
                          // count++;
                    }

                
                        //debugger;
                        var diff=0;
                        diff = eDate.getTime()-sDate.getTime();

                        var ntemphour=0;
                        var ntemphour= Math.floor(diff/(1000*60*60));
              
                        var ntempMin= 0;
                        var ntempMin=Math.floor((diff-(Number(ntemphour) * 1000 * 60 * 60))/(1000*60));
                        if((ntempMin%15)==0)
                        {
                           ntempMin=ntempMin;
                        }
                        else
                        {
                           ntempMin=(ntempMin/15)*15 +15;
                           if(ntempMin==59)
                           {
                             ntempMin=60;
                            }
                         }


                         var nBorderHeight=0;
                         var nHeight=0;
                         if(ntemphour>0)
                         {
                            nBorderHeight=((Number(ntemphour)*4)/2);
                            nHeight=118*Number(ntemphour)+29*(Number(ntempMin)/15) + nBorderHeight;
                         }
                         else
                         {
                            nHeight=118*Number(ntemphour)+29*(Number(ntempMin)/15) + nBorderHeight;
                         }
                     
                    
                         stableContents += "<tr style='border:1px solid gray;'>";

//                         if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Publish')
//                         {
//                            stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#0000FF'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";  //Color Blue for Publish                                                      
//                         }
//                         else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Incomplete')
//                         {
//                            stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#9900CC'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Purple for Incomple                                                     
//                         }
//                         else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Complete')
//                         {
//                             stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#006600'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Green for Complete                                                    
//                         }
//                         else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Loadedin_Machine')
//                         {
//                             stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#32CD32'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color LimeGreen for Loadedin_Machine                                                    
//                         }
//                         else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='UnLoadedin_Machine')
//                         {
//                             stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#800000'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Maroon for Unloadedin_Machine                                                    
//                         }
//                         else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Finish')
//                         {
//                             stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#000000'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Black for Finish                                                    
//                         }

                         stableContents += "<td height='"+nHeight+"' width='157' style='text-align:center; font-size:11px; border:1px solid gray; background-color:#FFFFFF'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";                                                
                         stableContents += "<div><a title="+'Machine:'+_oSelectedDyeMachine[i].MachineName+" class="+'"easyui-tooltip"'+">";
                         stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'DayView')"+">" + "Schedule No: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo   +"<br/>"+ 
                         "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2)+ "</a>";
                         stableContents +="</a></div>";
                         stableContents += "</td>";
                         stableContents += "</tr>";

                         startDate.setMinutes(startDate.getMinutes()+ Number(ntempMin));
                         startDate.setHours(startDate.getHours()+ Number(ntemphour));
                    

               }

              //..........................................................................................

            }

          }

          //endDate.setMinutes(endDate.getMinutes() - 15);

          while(startDate<=endDate)
          {
             stableContents += "<tr style='border:1px solid gray;'>";
             stableContents += "<td style='min-width:157px; height:29px; text-align:center;border-bottom:1px solid gray;'>";
             //stableContents +=  "<br/>";
             var oCurrentTime=new Date();
             
             var nRemainder=((oCurrentTime.getMinutes())%15)
             
             if(Number(nRemainder)>0)
             {
                oCurrentTime.setMinutes(Number(oCurrentTime.getMinutes())-Number(nRemainder));

                oCurrentTime.setSeconds(0,0);

             }

             if(startDate>=oCurrentTime)
             {
               var ntempMinute=0;
               if(startDate.getMinutes()<10)
               {
                 ntempMinute='0'+startDate.getMinutes();
               }
               else
               {
                 ntempMinute=startDate.getMinutes();
               }
               stableContents += "<div><a title="+'Machine:'+_oSelectedDyeMachine[i].MachineName+',Time:'+ startDate.getHours() +':'+ ntempMinute +" class="+'"easyui-tooltip"'+">";
               stableContents += "<div>"+"<center><input  style='top:0;'  type='button' value='Add Schedule' onClick='AddNewSchedule("+i+","+startDate.getDate()+","+(startDate.getMonth()+1)+","+startDate.getFullYear()+","+startDate.getHours()+","+startDate.getMinutes()+","+_nView+")'/></center>"+"</div>";                                                        
               stableContents +="</a></div>";
             }                                                      
             stableContents += "</td>";
             stableContents += "</tr>";
             startDate.setMinutes(startDate.getMinutes() + 15);
           }
       

          stableContents +="</table>";
          stableContents += "</td>";
       }

     stableContents += "</table>";
     stableContents += "</td>";


    stableContents += "</tr>";
    stableContents +="</tbody>";

   stableContents +="</table>";


   document.getElementById("tblContent").innerHTML=stableContents;
}


function tableWeek() 
{
   //debugger;
  //oSelectedDyeMachine
  document.getElementById("tblContent").innerHTML="";
  var Month=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  //document.getElementById("tblContent").style="overflow:scroll";
  _nView=1;
  var smessage=0;
  _oDyemachines=[];
  stableContents="";

  stableContents +="<table>";
  stableContents +="<thead >";
  stableContents += "<tr>";
  stableContents += "<th style='min-width:50px; text-align:center;'>";
  stableContents += "Date";
  stableContents += "</th>";


  for(var i=0; i<_activeMachines.length;i++)
   { 
     var MachineName="";
     var ProductionScheduleID; 
     stableContents +="<th style='min-width:130px; text-align:center;'>";
     for( var l=0;l<_oSelectedDyeMachine.length;l++)
     {
       if( _oSelectedDyeMachine[l].PSSID==_activeMachines[i])
       {
         MachineName= _oSelectedDyeMachine[l].MachineName;
         _oDyemachines.push(_oSelectedDyeMachine[l]);
         l= _oSelectedDyeMachine.length;
       }
      }
      stableContents += MachineName;
      stableContents +="</th>";             
     }
    stableContents += "</tr>";
    stableContents +="</thead>";

    stableContents +="<tbody >";
    stableContents += "<tr>";

   // stableContents += "<td style='min-width:60px;text-align:center;'>";
    //debugger;

      
    var returnValue=dateChange();
    var startDate=new Date(returnValue[0]);
    var endDate=new Date(returnValue[0]);
    startDate.setDate(startDate.getDate()-6);
    stableContents += "<table>";
    
    while(startDate <= endDate)
    {

          var nDate="";

          if(startDate.getDate()<10)
          {
            nDate="0"+Number(startDate.getDate());
          }
          else
          {
            nDate=startDate.getDate();
          }

          var searchStartDate = (Number(startDate.getMonth())+1) +"/"+ startDate.getDate()+"/"+ startDate.getFullYear()+" "+ 00 +":"+ 00;
          var searchEndDate = (Number(startDate.getMonth())+1) +"/"+ startDate.getDate() +"/"+ startDate.getFullYear()+" "+ 23 +":"+ 59;


          var tdate=new Date(searchStartDate);
          var days=['Sun','Mon','Tue','Wed','Thr','Fri','Sat'];
          var dayName=days[tdate.getDay()];


          stableContents += "<tr>";

          //********************************************

          stableContents += "<td style='min-width:60px; height:80px; text-align:center; border-bottom:1px solid gray;'>";

          //stableContents += nDate +"<br/>"+ dayName;
          stableContents += "<a style='text-decoration:none;' href="+ "javascript:DailyProduction("+ (Number(startDate.getMonth())+1)  +","+startDate.getDate()+","+startDate.getFullYear()+")>"+ nDate +"<br/>"+ dayName +"</a>";
          stableContents += "</td>";

          //...............................................//
           for(var i=0; i<_activeMachines.length;i++)
          { 
            
             var flag=0;
             stableContents += "<td style='min-width:139px; height:80px; text-align:center; border:1px solid gray;'>";
             stableContents += "<div><a title="+'Machine:'+_oSelectedDyeMachine[i].MachineName +',Date:'+ nDate +'-'+ Month[startDate.getMonth()] +'-'+ startDate.getFullYear() +" class="+'"easyui-tooltip"'+">";

             var oCurrentTime=new Date();
             if(  ( tdate.getDate()>=oCurrentTime.getDate() && tdate.getMonth()>=oCurrentTime.getMonth() && tdate.getFullYear()>= oCurrentTime.getFullYear()) )
             {
                stableContents += "<div>"+"<center><input  style='top:0;'  type='button' value='Add Schedule' onClick='AddNewSchedule("+i+","+startDate.getDate()+","+(startDate.getMonth()+1)+","+startDate.getFullYear()+","+startDate.getHours()+","+startDate.getMinutes()+","+_nView+")'/></center>"+"</div>";
             }
             for(var j=0;j<_oProductionSchedule.ProductionScheduleList.length;j++)
             {
               // //debugger;

                  

                  if(_oProductionSchedule.ProductionScheduleList[j].PSSID == _activeMachines[i] && ((new Date( _oProductionSchedule.ProductionScheduleList[j].StartTimeInString)>= new Date(searchStartDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString)<= new Date(searchEndDate))  || (new Date( _oProductionSchedule.ProductionScheduleList[j].EndTimeInString)>= new Date(searchStartDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].EndTimeInString)<= new Date(searchEndDate)) ||  (new Date(_oProductionSchedule.ProductionScheduleList[j].EndTimeInString)>new Date(searchEndDate) && new Date(_oProductionSchedule.ProductionScheduleList[j].StartTimeInString)<new Date(searchStartDate))  ) )
                  {
                  
                     var s= _oProductionSchedule.ProductionScheduleList[j].StartTimeInString;
                     var st=new Date(s);
                     var e=_oProductionSchedule.ProductionScheduleList[j].EndTimeInString;
                     var et=new Date(e);

                     var shr=st.getHours();
                     if(shr<10)
                     {
                      shr="0"+shr;
                     }
                     var smin=st.getMinutes();
                     if(smin<10)
                     {
                      smin="0"+smin;
                     }

                     var ehr=et.getHours();
                     if(ehr<10)
                     {
                      ehr="0"+ehr;
                     }
                     var emin=et.getMinutes();
                     if(emin<10)
                     {
                      emin="0"+emin;
                     }

                     var nStartDay=st.getDate();
                     var nEndDay=et.getDate();

                     stableContents += "<table>";
                     stableContents += "<tr>";

                     if(flag==0)
                     {

//                       if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Publish')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#0000FF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; // Color Blue for Publish
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Incomplete')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#9900CC; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; // Color Purple for Incomple
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Complete')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#006600; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Green for Complete                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Loadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#32CD32; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color LimeGreen for Loadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='UnLoadedin_Machine')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#800000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Maroon for Unloadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Finish')
//                       {
//                        stableContents += "<td height='40' width='140' style='background-color:#000000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Black for Finish                                                    
//                       }
                         stableContents += "<td height='40' width='140' style='background-color:#FFFFFF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; 
                       flag=1;
                     } 
                     else
                     {
//                       if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Publish')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#0000FF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";  // Color Blue for Publish
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Incomplete')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#9900CC; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>"; // Color Purple for Incomple
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Complete')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#006600; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Green for Complete                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Loadedin_Machine')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#32CD32; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color LimeGreen for Loadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='UnLoadedin_Machine')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#800000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Maroon for Unloadedin_Machine                                                    
//                       }
//                       else if(_oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString=='Finish')
//                       {
//                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#000000; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";   // Color Black for Finish                                                    
//                       }
                         stableContents += "<td height='40' width='140' style='border-top:4px solid white; background-color:#FFFFFF; padding:5px;'>" +"<input id="+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+"   type='checkbox'  onChange='CheckBoxSelectionForPrint("+_oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+_oDyemachines[i].PSSID+")'/>";                                                     
                       
                     } 
                     
                     
                     if(Number(nStartDay)<Number(nEndDay))
                     {

                         if(nDate==nStartDay)
                         {
                                stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'WeekView')"+">" + shr + ":" + smin + " - " + "Continue" + "<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                      _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" +"Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                         }

                         else if(Number(nEndDay)>nDate)
                         {
                                stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'WeekView')"+">" + "Continue" + "<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                      _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                         }

                         else
                         {
                                stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'WeekView')"+">" + "Continue" + " - " + ehr + ":" + emin +"<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                      _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";

                         }
                      
                     }

                     else
                     { 
                                            
                         stableContents += "<a style='text-decoration:none; color:Black;' href="+ "javascript:Edit("+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleID+","+ j +",'WeekView')"+">" + shr + ":" + smin + " - " + ehr + ":" + emin +"<br/>" +"SNo: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionScheduleNo +"<br/>"+
                                      _oProductionSchedule.ProductionScheduleList[j].OrderDetail + "</br>" + "Quantity: "+ _oProductionSchedule.ProductionScheduleList[j].ProductionQty.toFixed(2); //+ "</br>"+ "Status: "+ _oProductionSchedule.ProductionScheduleList[j].ScheduleStatusInString  + "</a>";
                     }
                     stableContents += "</td>";
                     stableContents += "</tr>";
                     stableContents += "</table>";
                     smessage=1;
                     flag=1;          
                  }

          
              }

              //.........................................//

              if(flag==0)
              {
                     stableContents += "<br/>";
              }
              stableContents +='</a></div>';
              stableContents += "</td>";
  
            }


          //*********************************************

          stableContents += "</tr>";
          

          startDate.setDate(startDate.getDate()+1);


      }
      
      stableContents += "</table>"; 



    stableContents += "</tr>";
    stableContents +="</tbody>";

   stableContents +="</table>";


   document.getElementById("tblContent").innerHTML=stableContents;

//  if(_activeMachines.length<=4)
//  {
//         document.getElementById("tblContent").style="overflow:hidden;overflow-y:scroll;";
//  }
//  if(smessage==0)
//  {
//        // document.getElementById("tblContent").style="overflow:hidden";
//         document.getElementById("tblContent").innerHTML="<div style=' padding-top:200px; padding-left:200px;font-size:16px; font-weight:Bold;'>No Schedule Available</div>";

//  }

   
}


function CheckBoxSelectionForPrint(nProductionScheduleID, nPSSID)
{
     debugger;
//   _sProductionScheduleIDS=_sProductionScheduleID+nProductionScheduleID+',';
//   _sPSSIDS=_sPSSIDS+nPSSID+','
    if(document.getElementById(""+nProductionScheduleID+"").checked==true)
    {
       _oPSIDs.push(nProductionScheduleID);
       _oPSSIDs.push(nPSSID);
    }
    if(document.getElementById(""+nProductionScheduleID+"").checked==false)
    {
       var otempPSIDs=[];
       var otempPSSIDs=[];
       if(_oPSIDs.length>0)
       {
          for(var i=0; i<_oPSIDs.length;i++)
          {
             if(_oPSIDs[i]!=nProductionScheduleID)
             {
               otempPSIDs.push(_oPSIDs[i])
             }

           }
         }

         if(_oPSSIDs.length>0)
         {
          var bflag=false;
           for(var i=0; i<_oPSSIDs.length;i++)
          {
             if(bflag==false && _oPSSIDs[i]!=nPSSID )
             {
               otempPSSIDs.push(_oPSSIDs[i]);

             }
             else if(bflag==false && _oPSSIDs[i]==nPSSID)
             {
               bflag=true;
             }
             else if(bflag==true)
             {
               otempPSSIDs.push(_oPSSIDs[i]);
             }

           }
         }

          _oPSIDs=otempPSIDs;
          _oPSSIDs=otempPSSIDs;
      }

}


function RefreshForUnloadDyemachine()
{
    ToolbarRefresh();
}
   
</script>
