@model IEnumerable<ESimSol.BusinessObjects.InventoryTraking>
    @{
        ViewBag.Title = "View InventoryTraking";
    }

    <body>
        <div id="progressbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
            <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
                <label style="font-size:18px;">Please wait</label>
                <div id="progressbar" style="width:100%;height:37px;"></div>
            </div>
        </div>
        <div class="easyui-layout menuMainCollectionTable" style="margin-left: 0px;">
            <div id="divProductView" class="easyui-panel" title="Product View" style="width:100%; height:100%">
                <table id="tblInventoryTraking" style="width:100%; height:100%" class="easyui-datagrid" fit="true" fitcolumns="false" toolbar="#toolbar2" showfooter="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" data-options="rowStyler: function(index,row){
                                        if (row.ProductName=='Total'){
                                            return 'color:#016B18; font-weight:bold;';
                                        }
                                    }
                    ">
                    <thead data-options="frozen:true">
                        <tr>
                            <th field="ProductCode" width="5%" align="left">Code</th>
                            <th field="PCategoryName" width="6%" align="left">CategoryName</th>
                            <th field="ProductName" width="20%" align="left"> Yarn Name</th>
                            <th field="MUnit" width="5%" align="left"><label id="lblUnit"></label></th>
                            <th field="OpeningQty" width="8%" align="right" formatter="formatPrice">Opening </th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>

                            <th field="InGRN" width="8%" align="right" formatter="formatPrice">GRN In <label id="lblInQty"></label></th>
                            <th field="InAdj" width="8%" align="right" formatter="formatPrice">Adj. In <label id="lblInQty"></label></th>
                            <th field="InRS" width="8%" align="right" formatter="formatPrice">Pro. In <label id="lblInQty"></label></th>
                            <th field="InTr" width="8%" align="right" formatter="formatPrice">Trans. In <label id="lblInQty"></label></th>
                            <th field="InTrSW" width="10%" align="right" formatter="formatPrice">SW Req. In <label id="lblInQty"></label></th>
                            <th field="InRet" width="8%" align="right" formatter="formatPrice"> Return In <label id="lblInQty"></label></th>
                            @*<th field="InCon" width="10%" align="right" formatter="formatPrice">Cons. In <label id="lblInQty"></label></th>*@
                            <th field="InQty" width="8%" align="right" formatter="formatPrice">Total In <label id="lblInQty"></label></th>


                            <th field="OutAdj" width="8%" align="right" formatter="formatPrice">Adj. Out <label id="lblInQty"></label></th>
                            <th field="OutRS" width="8%" align="right" formatter="formatPrice">Pro. Out <label id="lblInQty"></label></th>
                            <th field="OutTr" width="8%" align="right" formatter="formatPrice">Trans. Out <label id="lblInQty"></label></th>
                            <th field="OutTrSW" width="10%" align="right" formatter="formatPrice">SW Req. Out <label id="lblInQty"></label></th>
                            <th field="OutCon" width="8%" align="right" formatter="formatPrice">Cons. Out <label id="lblInQty"></label></th>
                            <th field="OutDC" width="10%" align="right" formatter="formatPrice">DC Out <label id="lblInQty"></label></th>

                            <th field="OutQty" width="8%" align="right" formatter="formatPrice">Total Out <label id="lblOutQty"></label></th>
                            <th field="ClosingQty" width="8%" align="right" formatter="formatPrice">Closing </th>

                        </tr>
                    </thead>
                </table>

                <div id="toolbar2">

                    <table style="width:100%; height:10%" border="0" cellpadding="2" cellspacing="2" style="font-size:11px; font-weight:bold">

                        <tr>
                            <td style="width:5%;  font-size:12px; text-align:left">
                                <a id="btnBack" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-back" plain="false">Back</a>
                            </td>
                            <td style="width:70%;  font-size:12px; text-align:left;vertical-align:top">
                                @*Date  <select id="cboDateSearch" style="width:100px" ;font-size:12px;" class="_select_changeA" />
                                <input id="txtStartDate" type="text" style="width: 110px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                To
                                <input id="txtEndDate" type="text" style="width: 110px;height:20px" class="easyui-datebox" required="required" data-options="formatter:icsdateformat,parser:icsdateparser" />
                                <a href="javascript:void(0)" id="btnSearchByDate" class="easyui-linkbutton" iconcls="icon-search" plain="true"></a>*@
                                @*<a id="btnViewLotWise" href="javascript:void(0)" class="easyui-linkbutton easyui-tooltip" iconcls="icon-details" title="View GRN" plain="true">View</a>*@
                               
                                <a id="btnPrintProduct" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview</a>
                                
                                <a id="btnPrintLot" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview(Lot)</a>
                                <a id="btnPrintIT" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview(Transaction)</a>
                                <a id="btnPrintITAllStore" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-print" plain="true">Preview(Transaction All Store)</a>
                                <a id="btnPrint_XL" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">Export XL</a>
                                @*<a id="btnPrint_XLQV" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-excel" plain="true">XL(Qty & Val)</a>*@
                            </td>
                            <td style="width:10%;  font-size:12px; text-align:left"></td>
                        </tr>
                     
                    </table>

                </div>
            </div>
            
        </div>
</body>
                      <style>
                          #progressbarParent {
                              opacity: 0.8;
                              background-color: #DCD9D4;
                              position: fixed;
                              width: 100%;
                              height: 100%;
                              top: 0px;
                              left: 0px;
                              z-index: 1000;
                          }
                      </style>

    <script type="text/javascript">

        var _oInventoryTrakings=[];
        var _sBaseAddress="";
        var _oInventoryTraking=null;
        var _sBackLink="";
        $(document).ready(function ()
        {
            debugger;
           
            _oInventoryTrakings =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
            _sBaseAddress =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));
            var nBUID = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
            sessionStorage.setItem('BUID_IT',nBUID);
            _nID =parseInt(sessionStorage.getItem("SelectedRowIndex_Product"));
           // RefreshDateSearch();
          
            var oITs =sessionStorage.getItem("InventoryTrakings_Product");
            if(oITs!=null)
            {
                oITs =  jQuery.parseJSON(oITs);   
            }
            else
            {
                oITs=_oInventoryTrakings;
            }
            LoadintoGrid(oITs);
            if(_nID!=-1)
            {
                $('#tblInventoryTraking').datagrid('selectRow', _nID);
            }

          //  RefreshDateSearch();
            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 
            var bIsWorkingUnit=sessionStorage.getItem("IsWorkingUnit");
            
            //$("#cboDateSearch").val(_oInventoryTraking.DateType);
            //$('#txtStartDate').datebox('setValue', _oInventoryTraking.StartDateSt);
            //$('#txtEndDate').datebox('setValue', _oInventoryTraking.EndDateSt);
            if(bIsWorkingUnit)
            {
                RefreshProduct(_oInventoryTraking);
            }
            cboValueChange(_oInventoryTraking.ValueType);
            var sBankHeader ="Store:"+_oInventoryTraking.WUName+" Date:"+_oInventoryTraking.StartDatetimeSt+" To "+_oInventoryTraking.EndDatetimeSt;
            $('#divProductView').panel({ title:sBankHeader});
           // document.getElementById("lblText").innerHTML = "Store:"+_oInventoryTraking.WUName+" Date:"+_oInventoryTraking.StartDateSt+" To "+_oInventoryTraking.EndDateSt;

            $("#progressbar").progressbar({ value: 0 });
            $("#progressbarParent").hide();
            _sBackLink=sessionStorage.getItem("BackLink");
        });
        function updateProgress() {   
            var value =$('#progressbar').progressbar('getValue');
            if (value < 90){
                value += Math.floor(Math.random() * 15);
                $('#progressbar').progressbar('setValue', value);
            }
        }
        function hideShow(miliseconds) {
            $("#progressbarParent").hide();
        }
        function cboValueChange(nValueType)
        {
            if(parseInt(nValueType)===2)
            {
                $('#lblUnit').html('Currency');
                $('#lblInQty,#lblOutQty').html('Value');
            }
            else if(nValueType===1)
            {
                $('#lblUnit').html('Unit&Currency');
                $('#lblInQty,#lblOutQty').html('Qty&Value');
            }
            else 
            {
                $('#lblUnit').html('Unit');
                $('#lblInQty,#lblOutQty').html('Qty');
            }
        }
      
        //function RefreshDateSearch()
        //{
        //    debugger;
        //    $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
        //    $('#txtEndDate').datebox('setValue', icsdateformat(new Date()));
        //    $('#cboDateSearch').empty();
        //    var listDates = "<option value='"+1+"'>" + "EqualTo" + "</option>";
        //    listDates+= "<option value='"+5+"'>" + "Between" + "</option>";
        //    $("#cboDateSearch").html(listDates);

        //}
        //$('._select_changeA').change(function () {
        //    var DateTypes = document.getElementById("cboDateSearch");
        //    var DateType=DateTypes.options[DateTypes.selectedIndex].text;
        //    if (DateType == "EqualTo") {
        //        $('#txtStartDate').datebox({disabled: false});
        //        $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
        //        $('#txtEndDate').datebox({disabled: true});
        //        $('#txtEndDate').datebox('setValue', icsdateformat(new Date()));
        //    }
        //    if (DateType == "None" )
        //    {
        //        $('#txtStartDate').datebox({disabled: true});
        //        $('#txtEndDate').datebox({disabled: true});
        //        $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
        //        $('#txtEndDate').datebox('setValue', icsdateformat(new Date()));
        //    }
        //    if (DateType == "Between" ||DateType == "NotBetween"  )
        //    {
        //        $('#txtStartDate').datebox({disabled: false});
        //        $('#txtEndDate').datebox({disabled: false});
        //        $('#txtStartDate').datebox('setValue', icsdateformat(new Date()));
        //        $('#txtEndDate').datebox('setValue', icsdateformat(new Date()));
        //    }
        //});
       
        function LoadintoGrid(oInventoryTraking) {
        
            data = oInventoryTraking;
            data = { "total": "" + data.length + "", "rows": data };
            $('#tblInventoryTraking').datagrid('loadData', data);
            
        }
        
 

        $("#btnSearchByDate").click(function () {

           // if(!ValidateInput())return;
          
            var Date = document.getElementById("cboDateSearch");
            var nDateType = Date.options[Date.selectedIndex].value;
            var date1=$('#txtStartDate').datebox('getValue');
            var date2= $('#txtEndDate').datebox('getValue');
            if(parseInt(nDateType) == 1)//Equ
            {  
                date2=date1;
            }
            var oInventoryTraking={BUID:sessionStorage.getItem('BUID_IT'), StartDate:date1, EndDate: date2,WorkingUnitID:_oInventoryTraking.WorkingUnitID,TriggerParentType:_oInventoryTraking.TriggerParentType};
            RefreshProduct(oInventoryTraking);        

        });
        function RefreshProduct(oInventoryTraking)
        {
            debugger;
            // if(!ValidateInput())return;
            $("#progressbar").progressbar({ value: 0 });
            $("#progressbarParent").show();
            
            oInventoryTraking.StartDate=oInventoryTraking.StartDatetimeSt;
            oInventoryTraking.EndDate=oInventoryTraking.EndDatetimeSt;
            var intervalID = setInterval(updateProgress, 250);
            $.ajax
         ({
             type: "POST",
             dataType: "json",
             url : _sBaseAddress+"/InventoryTraking/SearchByProductDyeing",
             traditional: true,
             data:  JSON.stringify(oInventoryTraking),
             contentType: "application/json; charset=utf-8",
             success: function (data) {
              
                 var oInventoryTrakings = data;
                 debugger;
                 $('#progressbar').progressbar('setValue', 100);
                 clearInterval(intervalID);
                 if (oInventoryTrakings.length>0)
                 {
                     LoadintoGrid(oInventoryTrakings);
                     $.icsMakeFooterColumn('tblInventoryTraking',['WUName','OpeningQty','InGRN','InAdj','InRS','InTr','InTrSW','InRet','InQty','OutAdj','OutRS','OutTr','OutTrSW','OutCon','OutQty','ClosingQty','OutDC']);
                     //ApendTotal();
                     //$('#txtStartDate').datebox('setValue', oInventoryTrakings[0].StartDateSt);
                     //$('#txtEndDate').datebox('setValue', oInventoryTrakings[0].EndDateSt);
                     //document.getElementById("lblText").innerHTML = "Store:"+_oInventoryTraking.WUName+" Date:"+oInventoryTrakings[0].StartDateSt+" To "+oInventoryTrakings[0].EndDateSt;
                     
                 }
                 else
                 {
                     oInventoryTrakings=[];
                     LoadintoGrid(oInventoryTrakings);
                     //alert("Data Not found");
                 }
                 setTimeout(hideShow, 1000);
             },
             error: function (xhr, status, error)
             {
                 setTimeout(hideShow, 1000);
                 alert(error);
             }
         });           
        }

        function ApendTotal()
        {
            var oRows = $('#tblInventoryTraking').datagrid('getRows');
            if(oRows.length>0)
            {
                var nOpeningQty = 0;
                var nInQty = 0;
                var nOutQty = 0;
                var nClosingQty = 0;
                for(var i=0;i<oRows.length;i++)
                {
                    nOpeningQty = parseFloat(nOpeningQty)+parseFloat(oRows[i].OpeningQty);
                    nInQty = parseFloat(nInQty)+parseFloat(oRows[i].InQty );
                    nOutQty = parseFloat(nOutQty)+parseFloat(oRows[i].OutQty);
                    nClosingQty = parseFloat(nClosingQty)+parseFloat(oRows[i].ClosingQty);
                }
                debugger
                var oRow =
                {
                    ProductName : 'Total',
                    OpeningQty : nOpeningQty,
                    InQty:nInQty,
                    OutQty : nOutQty,
                    ClosingQty : nClosingQty
                }
                $('#tblInventoryTraking').datagrid('appendRow',oRow); 
            } 

        }
      
        $("#btnViewLotWise").click(function(){
            debugger;
            var oInventoryTraking= $('#tblInventoryTraking').datagrid('getSelected');
            //oIT= JSON.stringify(oIT);
            if(oInventoryTraking==null || oInventoryTraking.WorkingUnitID<=0)
            {
                alert("Please select a item from list!");
                return;
            }
            var Date = document.getElementById("cboDateSearch");
            var nDateType = Date.options[Date.selectedIndex].value;
            oInventoryTraking.DateType=nDateType;
            oInventoryTraking.TriggerParentType=_oInventoryTraking.TriggerParentType;
            oInventoryTraking.ValueType=_oInventoryTraking.ValueType;
            oInventoryTraking.WUName= _oInventoryTraking.WUName;
            oInventoryTraking.StartDate=oInventoryTraking.StartDateSt;
            oInventoryTraking.EndDate=oInventoryTraking.EndDateSt;
            oInventoryTraking.BUID=sessionStorage.getItem('BUID_IT');
                               
            var SelectedRowIndex=$('#tblInventoryTraking').datagrid('getRowIndex',oInventoryTraking);
            var oITs= $('#tblInventoryTraking').datagrid('getRows');
            sessionStorage.setItem("InventoryTrakings_Product", JSON.stringify(oITs)); 
            sessionStorage.setItem("oInventoryTraking",JSON.stringify(oInventoryTraking)); 
            sessionStorage.setItem("SelectedRowIndex_Product", SelectedRowIndex);   
            sessionStorage.setItem("ITHeader", "Lot Wise:"+oInventoryTraking.WUName+":"+oInventoryTraking.ProductName);
            sessionStorage.setItem("IsWorkingUnit", false); 
            sessionStorage.setItem("BackLink_Product", window.location.href);
            sessionStorage.setItem("BUID_IT",oInventoryTraking.BUID);
            window.location.href = _sBaseAddress+"/InventoryTraking/ViewInventoryTraking_Lot?buid="+sessionStorage.getItem('BUID_IT');    
        });

        $("#btnBack").click(function(){
          
            sessionStorage.setItem("BUID_IT", sessionStorage.getItem('BUID_IT'));
            window.location.href = _sBackLink;
        });

        $("#btnPrintProduct").click(function () {
            debugger;
            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 

         
            //var sParams="";
            //sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDatetimeSt+"~"+_oInventoryTraking.EndDatetimeSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+oInventoryTraking.ProductID+"~"+3+"~"+_oInventoryTraking.ValueType +"~"+oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            //window.open(_sBaseAddress + '/InventoryTraking/PrintPriviewDyeing?sTempString=' + sParams, "_blank");


            var sParams="";
            sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDatetimeSt+"~"+_oInventoryTraking.EndDatetimeSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;

            window.open(_sBaseAddress + '/InventoryTraking/PrintPriviewDyeing?sTempString=' + sParams, "_blank");
           
        });

        $("#btnPrintIT").click(function () {
            debugger;
            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 

            var oInventoryTraking = $('#tblInventoryTraking').datagrid('getSelected');
            if (oInventoryTraking ==null || oInventoryTraking.WorkingUnitID <=0 ) { alert("Please select an item from list."); return ; }
            var nIndex=$('#tblInventoryTraking').datagrid('getRowIndex',oInventoryTraking);

            var sParams="";
            sParams=sessionStorage.getItem('BUID_IT')+"~"+ _oInventoryTraking.StartDatetimeSt+"~"+_oInventoryTraking.EndDatetimeSt+"~"+parseInt(_oInventoryTraking.WorkingUnitID)+"~"+oInventoryTraking.ProductID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            window.open(_sBaseAddress + '/InventoryTraking/PrintInventoryTransactionsType?sTempString=' + sParams, "_blank");
        });
        $("#btnPrintITAllStore").click(function () {
            debugger;
            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 

            var oInventoryTraking = $('#tblInventoryTraking').datagrid('getSelected');
            if (oInventoryTraking ==null || oInventoryTraking.WorkingUnitID <=0 ) { alert("Please select an item from list."); return ; }
            var nIndex=$('#tblInventoryTraking').datagrid('getRowIndex',oInventoryTraking);

            var sParams="";
            sParams=sessionStorage.getItem('BUID_IT')+"~"+ _oInventoryTraking.StartDatetimeSt+"~"+_oInventoryTraking.EndDatetimeSt+"~"+""+"~"+oInventoryTraking.ProductID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            window.open(_sBaseAddress + '/InventoryTraking/PrintInventoryTransactionsTypeAllStore?sTempString=' + sParams, "_blank");
        });

        

        $("#btnPrintLot").click(function () {
            debugger;
            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 

            var oInventoryTraking = $('#tblInventoryTraking').datagrid('getSelected');
            if (oInventoryTraking ==null || oInventoryTraking.ProductID <=0 ) { alert("Please select an item from list."); return ; }
            var nIndex=$('#tblInventoryTraking').datagrid('getRowIndex',oInventoryTraking);

            var sParams="";
            sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDatetimeSt+"~"+_oInventoryTraking.EndDatetimeSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+oInventoryTraking.ProductID+"~"+3+"~"+_oInventoryTraking.ValueType +"~"+oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            window.open(_sBaseAddress + '/InventoryTraking/PrintPriview?sTempString=' + sParams, "_blank");

            //var sParams="";
            //sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDateSt+"~"+_oInventoryTraking.EndDateSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            //window.open(_sBaseAddress + '/InventoryTraking/PrintPriview?sTempString=' + sParams, "_blank");
        });



        $("#btnPrint_XL").click(function () {

            var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
            _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 
            var sParams="";
            sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDateSt+"~"+_oInventoryTraking.EndDateSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
            window.open(_sBaseAddress + '/InventoryTraking/Print_ReportXL?sTempString=' + sParams, "_blank");
        });

        //$("#btnPrint_XLQV").click(function () {

        //    var oInventoryTraking=sessionStorage.getItem("InventoryTraking");
        //    _oInventoryTraking = jQuery.parseJSON(oInventoryTraking); 
        //    var sParams="";
        //    sParams=sessionStorage.getItem('BUID_IT')+"~"+_oInventoryTraking.DateType+"~"+ _oInventoryTraking.StartDateSt+"~"+_oInventoryTraking.EndDateSt+"~"+parseInt(_oInventoryTraking.TriggerParentType)+"~"+_oInventoryTraking.WorkingUnitID+"~"+0+"~"+2+"~"+_oInventoryTraking.ValueType+"~"+_oInventoryTraking.MUnitID+"~"+_oInventoryTraking.CurrencyID;
        //    window.open(_sBaseAddress + '/InventoryTraking/ExportToExcel_ITReport?sTempString=' + sParams, "_blank");
        //});
    </script>


