<html>
<head>
    @{ ViewBag.Title = "Integration Setup"; }
</head>
<body>
    @model ESimSol.BusinessObjects.IntegrationSetup   
    <div id="progbarParent" style="width:100%;height:100%;margin:0 auto;text-align:center; margin-left: auto;margin-right: auto;left: 0;right: 0;z-index: 1;">
        <div style="margin: 0px auto;margin-top: 251px;text-align:center;width:390px;">
            <label style="font-size:18px;">Please wait</label>
            <div id="progbar" style="width:100%;height:37px;"></div>
        </div>
    </div> 
    <div class="menuMainCollectionTable">
        <div id="divIntegrationSetup" class="easyui-panel" title="Integration Setup" style="font-family:Tahoma; text-align:center; height:89%;">
            <div style="width:100%;">
                <fieldset style="width:97.5%">
                    <legend style="font-weight:bold">Integration Setup Info: </legend>
                    <table border="0" style="font-size:12px; width:100%" cellpadding="1" cellspacing="1">
                        <tr>
                            <td style="width:10%; text-align:right">Setup No:</td>
                            <td style="width:10%; text-align:left">
                                <input type="text" style="width: 80px;font-size:100%" id="txtSetupNo" disabled="disabled" />
                            </td>
                            <td style="width:10%; text-align:right">
                                Voucher Setup :
                            </td>
                            <td style="width:40%; text-align:left">
                                <select id="cboVoucherSetup" style="width:100%"> </select>
                            </td>
                            <td style="width:10%; text-align:right">
                                Operation Type:
                            </td>
                            <td style="width:20%; text-align:right">
                                <select id="cboSetupType" style="width:100%;"></select>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <table id="tblIntegrationSetupDetail" title="Integration Setup Detail(s)" class="easyui-datagrid" style="margin-left:2px; width:100%; height:60%" fitcolumns="true" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbar">
                <thead>
                    <tr>
                        <th field="VoucherName" width="120">Voucher Type</th>
                        <th field="VoucherDateSetup" width="120" align="left">Voucher Date</th>
                        <th field="NarrationSetup" width="200" align="left">Narration Setup</th>
                        <th field="ReferenceNoteSetup" width="200" align="left">Reference Setup</th>
                        <th field="UpdateTable" width="120" align="left">Update Table</th>
                    </tr>
                </thead>
            </table>
            <div id="toolbar" style="height:30px">
                <a id="btnAddDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
                <a id="btnEditDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                <a id="btnRemoveDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
            </div>

            <table border="0" style="font-size:12px; width:99%">                
                <tr>
                    <td style="width:15%; text-align:right">Data Collection SQL:</td>
                    <td style="width:85%; text-align:left">
                        <input type="text" id="txtDataCollectionSQL" style="width:100%" />
                    </td>
                </tr>
                <tr>
                    <td style="width:15%; text-align:right">Key Column :</td>
                    <td style="width:85%; text-align:left">
                        <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                            <tr>
                                <td style="width:40%">
                                    <input type="text" id="txtKeyColumn" style="width:100%" />
                                </td>
                                <td style="width:20%; text-align:right">Business Unit :</td>
                                <td style="width:40%">
                                    <select id="cboBusinessUnit" style="width:102%"></select>
                                </td>
                            </tr>
                        </table>                        
                    </td>
                </tr>
                <tr>
                    <td style="width:15%; text-align:right;font-size:12px;">Date Compare Column:</td>
                    <td style="width:85%; text-align:left">
                        <input type="text" id="txtNote" style="width:100%" />
                    </td>
                </tr>
            </table>
        </div>
        <fieldset style="height:8%">
            <legend style="font-weight: bold">Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size: 11px; font-weight: bold; width:100%">
                <tr>
                    <td style="width:83%; text-align:right"></td>
                    <td style="width:17%; text-align:right;">                        
                        <a id="btnPaste" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Paste</a>
                        <a id="btnSave" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnClose" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>

    <div id="winIntegrationSetupDetail" class="easyui-window" title="Add Voucher Setup" style="width:900px; height:550px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="width:885px; height:440px">
            <fieldset>
                <legend style="font-weight:bold"> Voucher Setup Info : </legend>
                <table border="0" cellspacing="1" cellpadding="1" style="font-size:11px; font-weight:bold; width:100%">
                    <tr>
                        <td style="width:15%; text-align:right">Voucher  Name :</td>
                        <td style="width:85%; text-align:left">
                            <select id="cboVoucherType" style="width:99%" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">Business Unit Setup :</td>
                        <td style="width:85%; text-align:left">
                            <input type="text" style="width:88%" id="txtBusinessUnitSetup" disabled="disabled" />
                            <input type="button" id="btnBusinessUnitSetup" style=" width:10%;" value="SetUp" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">Voucher  Date Setup :</td>
                        <td style="width:85%; text-align:left">
                            <input type="text" style="width:88%" id="txtVoucherDateSetup" disabled="disabled" />
                            <input type="button" id="btnVoucherDateSetup" style=" width:10%;" value="SetUp" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">Narration Setup :</td>
                        <td style="width:85%; text-align:left">
                            <input type="text" style="width:88%" id="txtNarrationSetup" disabled="disabled" />
                            <input type="button" id="btnNarrationSetup" style=" width:10%;" value="SetUp" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">Raf. Note Setup :</td>
                        <td style="width:85%; text-align:left">
                            <input type="text" style="width:88%" id="txtReferenceNoteSetup" disabled="disabled" />
                            <input type="button" id="btnReferenceNoteSetup" style=" width:10%;" value="SetUp" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:15%; text-align:right">Update Table :</td>
                        <td style="width:85%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="text-align:left; width: 40%; font-size:12px; ">
                                        <input type="text" style="width:100%" id="txtUpdateTable" />
                                    </td>
                                    <td style="text-align:right; width: 20%; font-size:12px;">Note :</td>
                                    <td style="text-align:left; width: 40%; font-size:12px;">
                                        <input type="text" style="width:96%" id="txtNoteDetail" />
                                    </td>
                                </tr>
                            </table>

                        </td>
                    </tr>
                </table>
            </fieldset>
            <table id="tblDebitCreditSetup" title="Debit Credit Setup" class="easyui-datagrid" style="width:100%; height:245px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#debitcredittoolbar">
                <thead>
                    <tr>
                        <th field="TranjactionTypeInString" width="120">Tranjaction Type</th>
                        <th field="AccountHeadTypeInString" width="125" align="left">Account Head Type</th>
                        <th field="IsCostCenterCrateInString" width="115" align="left">Cost Create Effect</th>
                        <th field="IsVoucherBillInString" width="115" align="left">Bill Ref Effect</th>
                        <th field="IsInventoryEffectInString" width="115" align="left">Inventory Efect</th>
                        <th field="IsChequeReferenceCreateInString" width="110" align="left">Cheque Reference</th>
                        <th field="IsOrderReferenceApplyInString" width="110" align="left">Order Reference</th>
                    </tr>
                </thead>
            </table>
            <div id="debitcredittoolbar">
                <a id="btnDebit" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Debit</a>
                <a id="btnCredit" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Credit</a>
                <a id="btnDebitCreditEdit" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
                <a id="btnDebitCreditRemove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                <a id="btnDebitCreditRefresh" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Refresh</a>
            </div>
        </div>
        <fieldset style="height:50px; vertical-align:top;">
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold;">
                <tr>
                    <td style="width:7%;text-align:right;">
                        <a id="btnSaveDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCloseDetail" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>

                </tr>
            </table>
        </fieldset>
    </div>

    <div id="winDebitCredit" class="easyui-window" title="Debit Credit Setup" style="width:760px; height:600px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="width:730px; height:490px">
            <fieldset style="height:200px; width:723px; overflow:auto; margin-top:2px">
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:12px; width:100%">
                    <tr>
                        <td style="width:22%; text-align:right">Data Collection Query:</td>
                        <td style="width:78%; text-align:left">
                            <input type="text" style="width:98.5%" id="txtDrCrDataCollectionQuery" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:22%; text-align:right">Compare Column:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="font-size:12px; width:100%">
                                <tr>
                                    <td style="width:40%; text-align:left">
                                        <input type="text" style="width:100%" id="txtDrCrCompareColumn" />                                        
                                    </td>
                                    <td style="width:30%; text-align:right">
                                        Account Head Type:
                                    </td>
                                    <td style="width:30%">
                                        <select id="cboDrCrAccountHeadType" style="width:99%; font-size:12px"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="trFixedAcHead">
                        <td style="width:22%; text-align:right">Account Head:</td>
                        <td style="width:78%; text-align:left">
                            <input type="text" style="width:98.5%" id="txtDrCrFixedAccountHeadName" placeholder="Press Enter With Account Head Name" />                              
                        </td>
                    </tr>
                    <tr id="trDecidedAcHead">
                        <td style="width:22%; text-align:right">Account Head:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrDecidedAccountHeadName" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDecidedAccountHeadSetup" style=" width:99%;" value="SetUp" />                                        
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="trRefereneAcHead">
                        <td style="width:22%; text-align:right">Reference Column:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:40%; text-align:left;font-size:12px;">
                                        <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                            <tr>
                                                <td style="width:75%">
                                                    <input type="text" style="width:98%" id="txtDrCrReferencAccountHeadName" disabled="disabled" />
                                                </td>
                                                <td style="width:25%; text-align:right">
                                                    <input type="button" id="btnDrCrReferencAccountHeadSetup" style=" width:95%;" value="SetUp" />
                                                </td>
                                            </tr>
                                        </table>                                
                                    </td>
                                    <td style="width:30%; text-align:right; font-size:12px;">Reference Type:</td>
                                    <td style="width:30%; text-align:left;font-size:12px;">
                                        <select id="cboDrCrReferenceType" style="width:99%; font-size:12px" />                                        
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>   
                    <tr>
                        <td style="width:22%; text-align:right">Suggest Account Head:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrAccountNameSetup" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDrCrAccountNameSetup" style=" width:99%;" value="SetUp" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>                 
                    <tr>
                        <td style="width:22%; text-align:right">Currency Setup:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrCurrencySetup" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDrCrCurrencySetup" style=" width:99%;" value="SetUp" />
                                    </td>
                                </tr>
                            </table>                            
                        </td>
                    </tr>

                    <tr>
                        <td style="width:22%; text-align:right">Conversion Rate Setup:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrConversionRateSetup" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDrCrConversionRateSetup" style=" width:99%;" value="SetUp" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:22%; text-align:right">Amount Value:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrAmountSetup" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDrCrAmountSetup" style=" width:99%;" value="SetUp" />
                                    </td>
                                </tr>
                            </table>                            
                        </td>
                    </tr>

                    <tr>
                        <td style="width:22%; text-align:right">Narration Setup:</td>
                        <td style="width:78%; text-align:left">
                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                <tr>
                                    <td style="width:90%">
                                        <input type="text" style="width:99%" id="txtDrCrNarrationSetup" disabled="disabled" />
                                    </td>
                                    <td style="width:10%; text-align:right">
                                        <input type="button" id="btnDrCrNarrationSetup" style=" width:99%;" value="SetUp" />
                                    </td>
                                </tr>
                            </table>                            
                        </td>
                    </tr>
                    <tr>
                        <td style="width:22%; text-align:right">Remarks:</td>
                        <td style="width:78%; text-align:left">
                            <input type="text" style="width:98.5%" id="txtDrCrNote" />
                        </td>
                    </tr>
                </table>
            </fieldset>

            <div class="easyui-tabs" style="width:741px;height:270px; margin-left:2px">
                <div id="divSubledger" title="Sub Ledger" style="padding:5px;">
                    <table border="0" cellspacing="2"  cellpadding="2"  style="font-size:12px; width:100%">
                        <tr>
                            <td style="width:22%; text-align:right">Sub Ledger Effect:</td>
                            <td style="width:78%; text-align:left">
                                <label><input type="checkbox" id="chkDrCrCostcCrtYes"/> Yes</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                                <label><input type="checkbox" id="chkDrCrCostcCrtNo"/>No</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrHasBillReference" /> Has Bill Ref</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrHasChequeReference" /> Has Cheque Ref</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrHasOrderReference" /> Has Order Ref</label>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right; font-size:12px;">SQL for Cost Create Data:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrCostcenterDataSQL"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Compare Columns:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrCostCenterCompareColumns" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Cost Center:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrCostcenterSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrCostcenterSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>                                
                            </td>
                        </tr>

                        <tr>
                            <td style="width:22%; text-align:right">Amount:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrCostCenterAmountSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrCostCenterAmountSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>                                                              
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Description:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrCostCenterDescriptionSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrCostCenterDescriptionSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>                                
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Tranjaction Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrCostCenterDateSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrCostCenterDateSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>                                
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Cost Center Category:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:40%; text-align:left;font-size:12px;">
                                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                                <tr>
                                                    <td style="width:75%">
                                                        <input type="text" style="width:98%" id="txtDrCrCostCenterCategorySetup" disabled="disabled" />
                                                    </td>
                                                    <td style="width:25%; text-align:right">
                                                        <input type="button" id="btnDrCrCostCenterCategorySetup" style=" width:95%;" value="SetUp" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">CC Ref. Type:</td>
                                        <td style="width:30%; text-align:left;font-size:12px;">
                                            <select id="cboDrCrCostCenterRefObjType" style="width:99%; font-size:12px" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">CC No Column :</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="font-size:12px; width:100%">
                                    <tr>
                                        <td style="width:40%; text-align:left">
                                            <input type="text" style="width:97%" id="txtDrCrCostCenterNoColumn" />
                                        </td>
                                        <td style="width:30%; text-align:right">
                                            CCRef Obj Column:
                                        </td>
                                        <td style="width:30%">
                                            <input type="text" style="width:96%" id="txtDrCrCostCenterRefObjColumn" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divVoucherBill" title="Voucher Bill" style="padding:5px;">
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:12px; width:100%">
                        <tr>
                            <td style="width:22%; text-align:right">Voucher Bill Effect:</td>
                            <td style="width:78%; text-align:left">
                                <label><input type="checkbox" id="chkDrCrVoucherBillYes" />Yes</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrVoucherBillNo" />No</label>
                            </td>
                        </tr>

                        <tr>
                            <td style="width:22%; text-align:right;">SQL for Voucher Bill Data:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrVoucherBillDataSQL" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Compare Columns:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrVoucherBillCompareColumns" />
                            </td>
                        </tr>

                        <tr>
                            <td style="width:22%; text-align:right">Voucher Bill:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrVoucherBillSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrVoucherBillSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Amount:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrVoucherBillAmountSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrVoucherBillAmountSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Description:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrVoucherBillDescriptionSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrVoucherBillDescriptionSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Tranjaction Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrVoucherBillDateSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrVoucherBillDateSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Voucher Bill TrType:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <select id="cboDrCrVoucherBillTrType" style="width:99%; font-size:12px" />
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">VB Ref. Type:</td>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <select id="cboDrCrVoucherBillRefObjType" style="width:99%; font-size:12px" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">VB No Column:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <input type="text" style="width:96%" id="txtDrCrVoucherBillNoColumn" />
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">VBRef Obj Column:</td>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <input type="text" style="width:96%" id="txtDrCrVoucherBillRefObjColumn" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Bill Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                                <tr>
                                                    <td style="width:75%">
                                                        <input type="text" style="width:98%" id="txtDrCrBillDateSetup" disabled="disabled" />
                                                    </td>
                                                    <td style="width:25%; text-align:right">
                                                        <input type="button" id="btnDrCrBillDateSetup" style=" width:95%;" value="SetUp" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">Bill Due Date:</td>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                                <tr>
                                                    <td style="width:75%">
                                                        <input type="text" style="width:98%" id="txtDrCrBillDueDateSetup" disabled="disabled" />
                                                    </td>
                                                    <td style="width:25%; text-align:right">
                                                        <input type="button" id="btnDrCrBillDueDateSetup" style=" width:95%;" value="SetUp" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divInventory" title="Inventory" style="padding:5px;">
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:12px; width:100%">
                        <tr>
                            <td style="width:22%; text-align:right">Inventory Effect:</td>
                            <td style="width:78%; text-align:left">
                                <label><input type="checkbox" id="chkDrCrInventoryYes" />Yes</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrInventoryNo" />No</label>
                            </td>
                        </tr>

                        <tr>
                            <td style="width:22%; text-align:right;">SQL for Inventory Data:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrInventoryDataSQL" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Compare Columns:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrInventoryCompareColumns" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Working Unit:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryWorkingUnitSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryWorkingUnitSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Inventory Product:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryProductSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryProductSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Qty:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryQtySetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryQtySetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Measurement Unit:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryUnitSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryUnitSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Unit Price:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryUnitPriceSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryUnitPriceSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Description:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryDescriptionSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryDescriptionSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Tranjaction Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrInventoryDateSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrInventoryDateSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divChequeReference" title="Cheque Reference" style="padding:5px; width:700px;height:450px;">
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:12px; width:100%">
                        <tr>
                            <td style="width:22%; text-align:right">Cheque Reference:</td>
                            <td style="width:78%; text-align:left">
                                <label><input type="checkbox" id="chkDrCrChequeRefrncYes" />Yes</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrChequeRefrncNo" />No</label>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">SQL for Raference Data:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrChequeReferenceDataSQL" />
                            </td>
                        </tr>

                        <tr>
                            <td style="width:22%; text-align:right">Compare Columns:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <input type="text" style="width:96%" id="txtDrCrChequeReferenceCompareColumns" />
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">Cheque Type:</td>
                                        <td style="width:35%; text-align:left;font-size:12px;">
                                            <select id="cboDrCrChequeType" style="width:98%"></select>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Cheque Setup:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrChequeSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrChequeSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Amount:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrChequeReferenceAmountSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrChequeReferenceAmountSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Description:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrChequeReferenceDescriptionSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrChequeReferenceDescriptionSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Tranjaction Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrChequeReferenceDateSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrChequeReferenceDateSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>

                <div id="divOrderReference" title="Order Reference" style="padding:5px; width:700px;height:450px;">
                    <table border="0" cellspacing="2" cellpadding="2" style="font-size:12px; width:100%">
                        <tr>
                            <td style="width:22%; text-align:right">Order Reference:</td>
                            <td style="width:78%; text-align:left">
                                <label><input type="checkbox" id="chkDrCrOrderRefYes" /> Yes</label>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label><input type="checkbox" id="chkDrCrOrderRefNo" />No</label>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">SQL for Order Ref Data:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrOrderReferenceDataSQL" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Compare Columns:</td>
                            <td style="width:78%; text-align:left">
                                <input type="text" style="width:98.5%" id="txtDrCrOrderReferenceCompareColumns" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Order Setup:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrOrderReferenceSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrOrderReferenceSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Order No:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrOrderNoSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrOrderNoSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Amount:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrOrderAmountSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrOrderAmountSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Remarks Setup:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrOrderRemarkSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrOrderRemarkSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Tranjaction Date:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:90%">
                                            <input type="text" style="width:99%" id="txtDrCrOrderDateSetup" disabled="disabled" />
                                        </td>
                                        <td style="width:10%; text-align:right">
                                            <input type="button" id="btnDrCrOrderDateSetup" style=" width:99%;" value="SetUp" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Order Ref Column:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:40%; text-align:left;font-size:12px;">
                                            <input type="text" id="txtOrderRefColumn" style="width:99%; font-size:12px" />
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">Ref Type:</td>
                                        <td style="width:30%; text-align:left;font-size:12px;">
                                            <select id="cboDrCrRefType" style="width:99%; font-size:12px" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:22%; text-align:right">Order Date Column:</td>
                            <td style="width:78%; text-align:left">
                                <table border="0" cellpadding="0" cellspacing="0" style="width:100%">
                                    <tr>
                                        <td style="width:40%; text-align:left;font-size:12px;">
                                            <input type="text" id="txtOrderDateColumn" style="width:99%; font-size:12px" />
                                        </td>
                                        <td style="width:30%; text-align:right; font-size:12px;">Order No Column:</td>
                                        <td style="width:30%; text-align:left;font-size:12px;">
                                            <input type="text" id="txtOrderNoColumn" style="width:99%; font-size:12px" />                                            
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <fieldset style="height:50px; vertical-align:top;">
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold;">
                <tr>
                    <td style="width:7%;text-align:right;">
                        <a id="btnSaveDrCr" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCloseDrCr" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>

    <div id="winDataCollectionSetup" class="easyui-window" title="Data Collection Setup" style="width:720px; height:245px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="width:705px; height:135px">
            <fieldset>
                <legend style="font-weight:bold"> Data Collection Setup : </legend>
                <table border="0" cellspacing="1" cellpadding="1" style="font-size:11px; font-weight:bold; width:100%">
                    <tr>
                        <td style="width:17%; text-align:right"></td>
                        <td style="width:83%; text-align:right">
                            <label><input type="checkbox" id="chkDCStupManual" /> Manual Data</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <label><input type="checkbox" id="chkDCStupAutomated" /> Automated Data</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Query For Value :</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupQueryForValue"/>                            
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Ref Value Field(s):</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupReferenceValueFields" />                            
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Remarks :</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupNote" />                            
                        </td>
                    </tr>                    
                </table>
            </fieldset>
        </div>
        <fieldset style="height:50px; vertical-align:top;">
            <legend style="font-weight:bold"> Action : </legend>
            <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold;">
                <tr>
                    <td style="width:7%;text-align:right;">
                        <a id="btnSaveDCStup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                        <a id="btnCloseDCStup" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                    </td>

                </tr>
            </table>
        </fieldset>
    </div>

    <div id="winDataCollectionSetups" class="easyui-window" title="Data Collection Setups" style="width:720px; height:445px" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,closable:false">
        <div style="width:705px; height:335px">
            <fieldset>
                <legend style="font-weight:bold"> Data Collection Setups : </legend>
                <table border="0" cellspacing="1" cellpadding="1" style="font-size:11px; font-weight:bold; width:100%">
                    <tr>
                        <td style="width:17%; text-align:right"></td>
                        <td style="width:83%; text-align:right">
                            <label><input type="checkbox" id="chkDCStupsManual" /> Manual Data</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <label><input type="checkbox" id="chkDCStupsAutomated" /> Automated Data</label>&nbsp;&nbsp;&nbsp;&nbsp; <label><input type="checkbox" id="chkDCStupsFixedText" /> Fixed Text</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Query For Value :</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupsQueryForValue" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Ref Value Field(s):</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupsReferenceValueFields" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Fixed Text :</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupsFixedText" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:17%; text-align:right">Remarks :</td>
                        <td style="width:83%; text-align:left">
                            <input type="text" style="width:100%" id="txtDCStupsNote" />
                        </td>
                    </tr>
                </table>
            </fieldset>
            <table id="tblDataCollectionSetup" title="Narration Setup" class="easyui-datagrid" style="width:100%;height:180px" fitcolumns="false" rownumbers="true" pagination="false" singleselect="true" autorowheight="false" toolbar="#toolbarDCStups">
                <thead>
                    <tr>
                        <th field="DataGenerateTypeInString" width="100">Data Type</th>
                        <th field="QueryForValue" width="170" align="left">Query For Value</th>
                        <th field="ReferenceValueFields" width="110" align="left">Ref Value Field(s)</th>
                        <th field="FixedText" width="100" align="left">Fixed Text</th>
                        <th field="Note" width="70" align="left">Note</th>
                    </tr>
                </thead>
            </table>
            <div id="toolbarDCStups" style="height:30px">
                <a id="btnAddDCStups" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add</a>
                <a id="btnRemoveDCStups" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Delete</a>
                <a id="btnRefreshDCStups" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-reload" plain="true">Refresh</a>
            </div>
            </div>
            <fieldset style="height:50px; vertical-align:top;">
                <legend style="font-weight:bold"> Action : </legend>
                <table border="0" cellspacing="2" cellpadding="2" style="font-size:11px; font-weight:bold;">
                    <tr>
                        <td style="width:7%;text-align:right;">
                            <a id="btnSaveDCStups" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-save" plain="true">Save</a>
                            <a id="btnCloseDCStups" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" plain="true">Close</a>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </div>
</body>
</html>
<script type="text/javascript">
    $(document).ready(function () {
        var oIntegrationSetup =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));
        var oSetupTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.SetupTypes));
        var oVoucherSetups = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VoucherSetups));
        var oBusinessUnits = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
        var oVoucherTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VoucherTypes));
        var oAccountHeadTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.AccountHeadTypes));
        var oCostCenterCategorys = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CostCenterCategorys));
        var oCostCenterReferenceTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.CostCenterReferenceTypes));
        var oVoucherBillReferenceTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VoucherBillReferenceTypes));
        var oVoucherBillTrTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VoucherBillTrTypes));
        var oVoucherReferenceTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VoucherReferenceTypes));
        var oChequeTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.ChequeTypes));
        var oVOrderRefTypes = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.VOrderRefTypes));



        $('#cboSetupType').data('oSetupTypes', oSetupTypes);
        $('#cboVoucherSetup').data('VoucherSetups', oVoucherSetups);
        $('#cboBusinessUnit').data('BusinessUnits', oBusinessUnits);
        $('#cboVoucherType').data('VoucherTypes', oVoucherTypes);
        $('#cboDrCrAccountHeadType').data('AccountHeadTypes', oAccountHeadTypes);
        $('#divIntegrationSetup').data('CostCenterCategorys', oCostCenterCategorys);
        $('#cboDrCrCostCenterRefObjType').data('CostCenterReferenceTypes', oCostCenterReferenceTypes);
        $('#cboDrCrRefType').data('VOrderRefTypes', oVOrderRefTypes);
        $('#cboDrCrVoucherBillRefObjType').data('VoucherBillReferenceTypes', oVoucherBillReferenceTypes);
        $('#cboDrCrVoucherBillTrType').data('VoucherBillTrTypes', oVoucherBillTrTypes);
        $('#cboDrCrReferenceType').data('VoucherReferenceTypes', oVoucherReferenceTypes);
        $('#cboDrCrChequeType').data('ChequeTypes', oChequeTypes);
        $('#divIntegrationSetup').data('IntegrationSetup', oIntegrationSetup);

        RefreshCombobox();
        if(parseInt(oIntegrationSetup.IntegrationSetupID)>0)
        {
            RefreshControl(oIntegrationSetup);
        }
        else
        {
            $('#btnPaste').hide();
        }
        $("#progbar").progressbar({ value: 0 });
        $("#progbarParent").hide();
    });

    function NewIntegrationDetailObj()
    {
        var oIntegrationSetupDetail = {
            IntegrationSetupDetailID : 0,
            IntegrationSetupID : 0,
            VoucherTypeID : 0,
            VoucherDateSetup : "",
            NarrationSetup : "",
            ReferenceNoteSetup : "",
            UpdateTable : "",
            KeyColumn : "",
            Note : "",
            VoucherName : "",
            DebitCreditSetups : [],
            DataCollectionSetups : []
        };
        return oIntegrationSetupDetail;
    }

    function ValidateInputDetail()
    {
        if($("#cboVoucherType").val() === null || parseInt($("#cboVoucherType").val()) <= 0)
        {
            alert("Please Select Voucher Type!");
            $('#cboVoucherType').focus();
            return false;
        }
        if($("#txtBusinessUnitSetup").val() === null || $("#txtBusinessUnitSetup").val() === "" || $('#txtBusinessUnitSetup').data('DataCollectionSetup') === null)
        {
            alert("Sorry,Business Unit Setup is empty!");
            $('#txtBusinessUnitSetup').focus();
            return false;
        }
        if($("#txtVoucherDateSetup").val() === null || $("#txtVoucherDateSetup").val() === "" || $('#txtVoucherDateSetup').data('DataCollectionSetup') === null)
        {
            alert("Sorry,Voucher Date Setup is empty!");
            $('#btnVoucherDateSetup').focus();
            return false;
        }
        if($("#txtNarrationSetup").val() === null || $("#txtNarrationSetup").val() === "" || $('#txtNarrationSetup').data('DataCollectionSetups').length <= 0)
        {
            alert("Sorry,Voucher Narration Setup is empty!");
            $('#btnNarrationSetup').focus();
            return false;
        }
        if($("#txtReferenceNoteSetup").val() === null || $("#txtReferenceNoteSetup").val() === "" || $('#txtReferenceNoteSetup').data('DataCollectionSetups').length <= 0)
        {
            alert("Sorry,Voucher Reference Note Setup is empty!");
            $('#btnReferenceNoteSetup').focus();
            return false;
        }
        if($("#txtUpdateTable").val() === null || $("#txtUpdateTable").val() === "")
        {
            alert("Please enter Update Table Name!");
            $('#txtUpdateTable').focus();
            return false;
        }

        var oDebitCreditSetups = $('#tblDebitCreditSetup').datagrid('getRows');
        if(oDebitCreditSetups.length<=0)
        {
            alert("Please add Debit Credit Item in List");
            return false;
        }

        var bHasDebit=false; var bHasCredit=false;
        for(var i=0; i<oDebitCreditSetups.length; i++)
        {
            if(oDebitCreditSetups[i].IsDebit)
            {
                bHasDebit=true;
            }
            else
            {
                bHasCredit=true;
            }
        }
        if(bHasDebit==false)
        {
            alert("Please enter debit setup!");
            return false;
        }
        if(bHasCredit==false)
        {
            alert("Please enter credit setup!");
            return false;
        }
        return true;
    }

    function RefreshObjectDetail()
    {
        var oTempIntegrationSetupDetail = $("#winIntegrationSetupDetail").data('IntegrationSetupDetail');
        var oIntegrationSetupDetail= {
            IntegrationSetupDetailID : parseInt(oTempIntegrationSetupDetail.IntegrationSetupDetailID),
            IntegrationSetupID : parseInt(oTempIntegrationSetupDetail.IntegrationSetupID),
            VoucherTypeID : parseInt($('#cboVoucherType').val()),
            BusinessUnitSetup : $.trim($('#txtBusinessUnitSetup').val()),
            VoucherDateSetup : $.trim($('#txtVoucherDateSetup').val()),
            NarrationSetup : $.trim($('#txtNarrationSetup').val()),
            ReferenceNoteSetup : $.trim($('#txtReferenceNoteSetup').val()),
            UpdateTable : $.trim($('#txtUpdateTable').val()),
            Note : $.trim($('#txtNoteDetail').val()),
            VoucherName : $("#cboVoucherType option:selected").text(),
            DebitCreditSetups : $('#tblDebitCreditSetup').datagrid('getRows'),
            DataCollectionSetups : GetDataCollectionSetupsForDetail()
        };
        return oIntegrationSetupDetail;
    }

    function NewDebitCreditSetupObj(bIsDebit)
    {
        var sTranjactionTypeInString = "Credit";
        if(bIsDebit===true)
        {
            sTranjactionTypeInString = "Debit";
        }

        var oDebitCreditSetup  = {
            DebitCreditSetupID : 0,
            IntegrationSetupDetailID : 0,
            DataCollectionQuery : "",
            CompareColumn : "",
            AccountHeadType : 0,
            AccountHeadTypeInInt : 0,
            FixedAccountHeadID : 0,
            AccountHeadSetup : "",
            ReferenceType : 0,
            ReferenceTypeInInt : 0,
            CurrencySetup : "",
            ConversionRateSetup : "",
            AmountSetup : "",
            NarrationSetup : "",
            IsChequeReferenceCreate : false,
            IsDebit : bIsDebit,
            ChequeReferenceDataSQL : "",
            ChequeReferenceCompareColumns : "",
            ChequeType : 0,
            ChequeTypeInt : 0,
            ChequeSetup : "",
            ChequeReferenceAmountSetup : "",
            ChequeReferenceDescriptionSetup : "",
            ChequeReferenceDateSetup : "",
            IsCostCenterCreate : false,
            HasBillReference : false,
            HasChequeReference : false,
            HasOrderReference : false,
            CostcenterDataSQL : "",
            CostCenterCompareColumns : "",
            CostcenterSetup : "",
            CostCenterAmountSetup : "",
            CostCenterDescriptionSetup : "",
            CostCenterDateSetup : "",
            IsVoucherBill : false,
            VoucherBillDataSQL : "",
            VoucherBillCompareColumns : "",
            VoucherBillTrType : 0,
            VoucherBillTrTypeInInt : 0,
            VoucherBillSetup : "",
            VoucherBillAmountSetup : "",
            VoucherBillDescriptionSetup : "",
            VoucherBillDateSetup : "",
            IsOrderReferenceApply : false,
            OrderReferenceDataSQL : "",
            OrderReferenceCompareColumns : "",
            OrderReferenceSetup : "",
            OrderAmountSetup : "",
            OrderRemarkSetup : "",
            OrderDateSetup : "",
            OrderRefType : 0,
            OrderRefTypeInt : 0,
            OrderNoSetup : "",

            IsInventoryEffect : false,
            InventoryDataSQL : "",
            InventoryCompareColumns : "",
            InventoryWorkingUnitSetup : "",
            InventoryProductSetup : "",
            InventoryQtySetup : "",
            InventoryUnitSetup : "",
            InventoryUnitPriceSetup : "",
            InventoryDescriptionSetup : "",
            InventoryDateSetup : "",
            Note : "",
            CostCenterCategorySetup : "",
            CostCenterNoColumn : "",
            CostCenterRefObjType : 0,
            CostCenterRefObjTypeInInt : 0,
            CostCenterRefObjColumn : "",
            VoucherBillNoColumn : "",
            VoucherBillRefObjType : 0,
            VoucherBillRefObjTypeInInt : 0,
            VoucherBillRefObjColumn : "",
            BillDateSetup : "",
            BillDueDateSetup : "",
            AccountCode : "",
            AccountHeadName : "",
            TranjactionTypeInString : sTranjactionTypeInString,
            AccountHeadTypeInString : "None",
            IsChequeReferenceCreateInString : "No",
            IsCostCenterCrateInString : "No",
            IsVoucherBillInString : "No",
            IsOrderReferenceApplyInString : "No",
            IsInventoryEffectInString : "No",
            DataCollectionSetups : []
        };
        return oDebitCreditSetup;
    }

    function DrCrRefreshControl()
    {
        var oDebitCreditSetup = $("#winDebitCredit").data('DebitCreditSetup');
        if(oDebitCreditSetup!=null)
        {
            $('#txtDrCrDataCollectionQuery').val(oDebitCreditSetup.DataCollectionQuery);
            $('#txtDrCrCompareColumn').val(oDebitCreditSetup.CompareColumn);
            if(parseInt(oDebitCreditSetup.AccountHeadTypeInInt)===1)
            {
                $("#txtDrCrFixedAccountHeadName").val(oDebitCreditSetup.AccountHeadSetup);
            }
            else if(parseInt(oDebitCreditSetup.AccountHeadTypeInInt)===2)
            {
                oDebitCreditSetup.FixedAccountHeadID = 0;
                $("#txtDrCrDecidedAccountHeadName").val(oDebitCreditSetup.AccountHeadSetup);
            }
            else if(parseInt(oDebitCreditSetup.AccountHeadTypeInInt)===3)
            {
                oDebitCreditSetup.FixedAccountHeadID = 0;
                $("#txtDrCrReferencAccountHeadName").val(oDebitCreditSetup.AccountHeadSetup);
            }

            $('#cboDrCrAccountHeadType').val(parseInt(oDebitCreditSetup.AccountHeadTypeInInt));
            $("#txtDrCrAccountNameSetup").val(oDebitCreditSetup.AccountNameSetup);
            $("#txtDrCrCurrencySetup").val(oDebitCreditSetup.CurrencySetup);
            $("#txtDrCrConversionRateSetup").val(oDebitCreditSetup.ConversionRateSetup);
            $("#txtDrCrAmountSetup").val(oDebitCreditSetup.AmountSetup);
            $("#txtDrCrNarrationSetup").val(oDebitCreditSetup.NarrationSetup);
            $("#txtDrCrNote").val(oDebitCreditSetup.Note);
            debugger;
            //Subledger Reference
            if(oDebitCreditSetup.IsCostCenterCreate)
            {
                $('#chkDrCrCostcCrtYes').attr("checked", true);
                $('#chkDrCrCostcCrtNo').attr("checked", false);
            }
            else
            {
                $('#chkDrCrCostcCrtYes').attr("checked", false);
                $('#chkDrCrCostcCrtNo').attr("checked", true);
            }

            //Is Voucher bill Create
            if(oDebitCreditSetup.IsVoucherBill)
            {
                $('#chkDrCrVoucherBillYes').attr("checked", true);
                $('#chkDrCrVoucherBillNo').attr("checked", false);
            }
            else
            {
                $('#chkDrCrVoucherBillYes').attr("checked", false);
                $('#chkDrCrVoucherBillNo').attr("checked", true);
            }
            // Is Inventory Create
            if(oDebitCreditSetup.IsInventoryEffect)
            {
                $('#chkDrCrInventoryYes').attr("checked", true);
                $('#chkDrCrInventoryNo').attr("checked", false);
            }
            else
            {
                $('#chkDrCrInventoryYes').attr("checked", false);
                $('#chkDrCrInventoryNo').attr("checked", true);
            }

            //Cheque Reference
            if(oDebitCreditSetup.IsChequeReferenceCreate)
            {
                $('#chkDrCrChequeRefrncYes').attr("checked", true);
                $('#chkDrCrChequeRefrncNo').attr("checked", false);
            }
            else
            {
                $('#chkDrCrChequeRefrncYes').attr("checked", false);
                $('#chkDrCrChequeRefrncNo').attr("checked", true);
            }

            //Order Reference
            if(oDebitCreditSetup.IsOrderReferenceApply)
            {
                $('#chkDrCrOrderRefYes').attr("checked", true);
                $('#chkDrCrOrderRefNo').attr("checked", false);
            }
            else
            {
                $('#chkDrCrOrderRefYes').attr("checked", false);
                $('#chkDrCrOrderRefNo').attr("checked", true);
            }

            //Cost Center Part
            $('#chkDrCrHasBillReference').attr("checked", oDebitCreditSetup.HasBillReference);
            $('#chkDrCrHasChequeReference').attr("checked", oDebitCreditSetup.HasChequeReference);
            $('#chkDrCrHasOrderReference').attr("checked", oDebitCreditSetup.HasOrderReference);
            $("#txtDrCrCostcenterDataSQL").val(oDebitCreditSetup.CostcenterDataSQL);
            $("#txtDrCrCostCenterCompareColumns").val(oDebitCreditSetup.CostCenterCompareColumns);
            $("#txtDrCrCostcenterSetup").val(oDebitCreditSetup.CostcenterSetup);
            $("#txtDrCrCostCenterAmountSetup").val(oDebitCreditSetup.CostCenterAmountSetup);
            $("#txtDrCrCostCenterDescriptionSetup").val(oDebitCreditSetup.CostCenterDescriptionSetup );
            $("#txtDrCrCostCenterDateSetup").val(oDebitCreditSetup.CostCenterDateSetup);
            $("#txtDrCrCostCenterCategorySetup").val(oDebitCreditSetup.CostCenterCategorySetup);
            $("#cboDrCrCostCenterRefObjType").val(oDebitCreditSetup.CostCenterRefObjTypeInInt);
            $("#txtDrCrCostCenterNoColumn").val(oDebitCreditSetup.CostCenterNoColumn);
            $("#txtDrCrCostCenterRefObjColumn").val(oDebitCreditSetup.CostCenterRefObjColumn);

            //Voucher Bill Part
            $("#txtDrCrVoucherBillDataSQL").val(oDebitCreditSetup.VoucherBillDataSQL);
            $("#txtDrCrVoucherBillCompareColumns").val(oDebitCreditSetup.VoucherBillCompareColumns);
            $("#txtDrCrVoucherBillSetup").val(oDebitCreditSetup.VoucherBillSetup);
            $("#txtDrCrVoucherBillAmountSetup").val(oDebitCreditSetup.VoucherBillAmountSetup);
            $("#txtDrCrVoucherBillDescriptionSetup").val(oDebitCreditSetup.VoucherBillDescriptionSetup);
            $("#txtDrCrVoucherBillDateSetup").val(oDebitCreditSetup.VoucherBillDateSetup);
            $("#txtDrCrBillDateSetup").val(oDebitCreditSetup.BillDateSetup);
            $("#txtDrCrBillDueDateSetup").val(oDebitCreditSetup.BillDueDateSetup);
            $("#cboDrCrVoucherBillTrType").val(oDebitCreditSetup.VoucherBillTrTypeInInt);
            $("#cboDrCrVoucherBillRefObjType").val(oDebitCreditSetup.VoucherBillRefObjTypeInInt);
            $("#txtDrCrVoucherBillNoColumn").val(oDebitCreditSetup.VoucherBillNoColumn);
            $("#txtDrCrVoucherBillRefObjColumn").val(oDebitCreditSetup.VoucherBillRefObjColumn);

            //Inventory Part
            $("#txtDrCrInventoryDataSQL").val(oDebitCreditSetup.InventoryDataSQL);
            $("#txtDrCrInventoryCompareColumns").val(oDebitCreditSetup.InventoryCompareColumns);
            $("#txtDrCrInventoryWorkingUnitSetup").val(oDebitCreditSetup.InventoryWorkingUnitSetup);
            $("#txtDrCrInventoryProductSetup").val(oDebitCreditSetup.InventoryProductSetup);
            $("#txtDrCrInventoryQtySetup").val(oDebitCreditSetup.InventoryQtySetup);
            $("#txtDrCrInventoryUnitSetup").val(oDebitCreditSetup.InventoryUnitSetup);
            $("#txtDrCrInventoryUnitPriceSetup").val(oDebitCreditSetup.InventoryUnitPriceSetup);
            $("#txtDrCrInventoryDescriptionSetup").val(oDebitCreditSetup.InventoryDescriptionSetup);
            $("#txtDrCrInventoryDateSetup").val(oDebitCreditSetup.InventoryDateSetup);

            //ChequeReference Part
            $("#txtDrCrChequeReferenceDataSQL").val(oDebitCreditSetup.ChequeReferenceDataSQL);
            $("#txtDrCrChequeReferenceCompareColumns").val(oDebitCreditSetup.ChequeReferenceCompareColumns);
            $("#cboDrCrChequeType").val(oDebitCreditSetup.ChequeTypeInt);
            $("#txtDrCrChequeSetup").val(oDebitCreditSetup.ChequeSetup);
            $("#txtDrCrChequeReferenceAmountSetup").val(oDebitCreditSetup.ChequeReferenceAmountSetup);
            $("#txtDrCrChequeReferenceDescriptionSetup").val(oDebitCreditSetup.ChequeReferenceDescriptionSetup);
            $("#txtDrCrChequeReferenceDateSetup").val(oDebitCreditSetup.ChequeReferenceDateSetup);

            //OrderReference Part
            $("#txtDrCrOrderReferenceDataSQL").val(oDebitCreditSetup.OrderReferenceDataSQL);
            $("#txtDrCrOrderReferenceCompareColumns").val(oDebitCreditSetup.OrderReferenceCompareColumns);
            $("#txtDrCrOrderReferenceSetup").val(oDebitCreditSetup.OrderReferenceSetup);
            $("#txtDrCrOrderAmountSetup").val(oDebitCreditSetup.OrderAmountSetup);
            $("#txtDrCrOrderRemarkSetup").val(oDebitCreditSetup.OrderRemarkSetup);
            $("#txtDrCrOrderDateSetup").val(oDebitCreditSetup.OrderDateSetup);
            $("#cboDrCrRefType").val(oDebitCreditSetup.OrderRefTypeInt);
            $("#txtDrCrOrderNoSetup").val(oDebitCreditSetup.OrderNoSetup);
            $("#txtOrderRefColumn").val(oDebitCreditSetup.OrderRefColumn);
            $("#txtOrderDateColumn").val(oDebitCreditSetup.OrderDateColumn);
            $("#txtOrderNoColumn").val(oDebitCreditSetup.OrderNoColumn);
        }
    }

    function ValidateDebitCreditSetup()
    {
        if($.trim($("#txtDrCrDataCollectionQuery").val()) === null || $.trim($("#txtDrCrDataCollectionQuery").val()) === "")
        {
            alert("Please Enter Data Collection Query!");
            $('#txtDrCrDataCollectionQuery').focus();
            return false;
        }
        if($.trim($("#txtDrCrCompareColumn").val()) === null || $.trim($("#txtDrCrCompareColumn").val()) === "")
        {
            alert("Please Enter Compare Column!");
            $('#txtDrCrCompareColumn').focus();
            return false;
        }

        var nAccountHeadType  = parseInt($('#cboDrCrAccountHeadType').val());
        if(parseInt(nAccountHeadType)<=0)
        {
            alert("Please Select Account Head Type");
            $('#cboDrCrAccountHeadType').focus();
            return false;
        }
        if(parseInt(nAccountHeadType)=== 1)
        {
            if($.trim($("#txtDrCrFixedAccountHeadName").val()) === null || $.trim($("#txtDrCrFixedAccountHeadName").val()) === "" || parseInt($("#winDebitCredit").data('DebitCreditSetup').FixedAccountHeadID)<=0)
            {
                alert("Please Type Account Head!");
                $('#txtDrCrFixedAccountHeadName').focus();
                return false;
            }
        }
        else if(parseInt(nAccountHeadType)=== 2)
        {
            if($.trim($("#txtDrCrDecidedAccountHeadName").val()) === null || $.trim($("#txtDrCrDecidedAccountHeadName").val()) === "" || $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup') === null)
            {
                alert("Please pick Account Head!");
                $('#txtDrCrDecidedAccountHeadName').focus();
                return false;
            }
        }
        else if(parseInt(nAccountHeadType)=== 3)
        {
            var nReferenceType  =  parseInt($('#cboDrCrReferenceType').val());
            if(nReferenceType<=0)
            {
                alert("Please add Reference Type");
                $('#cboDrCrReferenceType').focus();
                return false;
            }
            if($.trim($("#txtDrCrReferencAccountHeadName").val()) === null || $.trim($("#txtDrCrReferencAccountHeadName").val()) === "" || $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup') === null)
            {
                alert("Please Pick Reference Account Head Column Name!");
                $('#txtDrCrReferencAccountHeadName').focus();
                return false;
            }
        }
        if($.trim($("#txtDrCrCurrencySetup").val()) === null || $.trim($("#txtDrCrCurrencySetup").val()) === "" || $('#txtDrCrCurrencySetup').data('DataCollectionSetup') === null)
        {
            alert("Sorry, Currency Setup is empty!");
            $('#txtDrCrCurrencySetup').focus();
            return false;
        }
        if($.trim($("#txtDrCrConversionRateSetup").val()) === null || $.trim($("#txtDrCrConversionRateSetup").val()) === "" || $('#txtDrCrConversionRateSetup').data('DataCollectionSetup') === null)
        {
            alert("Sorry, Conversion Rate Setup is empty!");
            $('#txtDrCrConversionRateSetup').focus();
            return false;
        }
        if($.trim($("#txtDrCrAmountSetup").val()) === null || $.trim($("#txtDrCrAmountSetup").val()) === "" || $('#txtDrCrAmountSetup').data('DataCollectionSetup') === null)
        {
            alert("Please Set Voucher Detail Amount Setup!");
            $('#txtDrCrAmountSetup').focus();
            return false;
        }
        if($.trim($("#txtDrCrNarrationSetup").val()) === null || $.trim($("#txtDrCrNarrationSetup").val()) === "" || $('#txtDrCrNarrationSetup').data('DataCollectionSetups').length <=0)
        {
            alert("Please Set Voucher Detail Narration Setup!");
            $('#txtDrCrNarrationSetup').focus();
            return false;
        }

        //Subledger Ref
        if($('#chkDrCrCostcCrtYes').is(":checked"))
        {
            if($.trim($("#txtDrCrCostcenterDataSQL").val()) === null || $.trim($("#txtDrCrCostcenterDataSQL").val()) === "")
            {
                alert("Please Type Cost Center data SQL!");
                $('#txtDrCrCostcenterDataSQL').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterCompareColumns").val()) === null || $.trim($("#txtDrCrCostCenterCompareColumns").val()) === "")
            {
                alert("Please Type Cost Center Column Name!");
                $('#txtDrCrCostCenterCompareColumns').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostcenterSetup").val()) === null || $.trim($("#txtDrCrCostcenterSetup").val()) === "" || $('#txtDrCrCostcenterSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Cost Center Setup!");
                $('#txtDrCrCostcenterSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterAmountSetup").val()) === null || $.trim($("#txtDrCrCostCenterAmountSetup").val()) === "" || $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Cost Center Amount Setup!");
                $('#txtDrCrCostCenterAmountSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterDescriptionSetup").val()) === null || $.trim($("#txtDrCrCostCenterDescriptionSetup").val()) === "" || $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups').length <=0)
            {
                alert("Please Set Cost Center Description Setup!");
                $('#txtDrCrCostCenterDescriptionSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterDateSetup").val()) === null || $.trim($("#txtDrCrCostCenterDateSetup").val()) === "" || $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Cost Center Date Setup!");
                $('#txtDrCrCostCenterDateSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterCategorySetup").val()) === null || $.trim($("#txtDrCrCostCenterCategorySetup").val()) === "" || $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Cost Center Category Setup!");
                $('#txtDrCrCostCenterCategorySetup').focus();
                return false;
            }

            var nCostCenterRefObjType  = parseInt($('#cboDrCrCostCenterRefObjType').val());
            if(parseInt(nCostCenterRefObjType)<=0)
            {
                alert("Please Select Cost Center Ref Obj Type!");
                $('#cboDrCrCostCenterRefObjType').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterNoColumn").val()) === null || $.trim($("#txtDrCrCostCenterNoColumn").val()) === "")
            {
                alert("Please Enter Cost Center No Column!");
                $('#txtDrCrCostCenterNoColumn').focus();
                return false;
            }

            if($.trim($("#txtDrCrCostCenterRefObjColumn").val()) === null || $.trim($("#txtDrCrCostCenterRefObjColumn").val()) === "")
            {
                alert("Please Enter Cost Center Ref Obj Column!");
                $('#txtDrCrCostCenterRefObjColumn').focus();
                return false;
            }

            if($('#chkDrCrHasBillReference').is(":checked"))
            {
                if($('#chkDrCrVoucherBillYes').is(":checked")===false)
                {
                    alert("Please Configure Subledger Bill Configure!");
                    $('#chkDrCrVoucherBillYes').focus();
                    return false;
                }
            }
            if($('#chkDrCrHasChequeReference').is(":checked"))
            {
                if($('#chkDrCrChequeRefrncYes').is(":checked")===false)
                {
                    alert("Please Configure Subledger Cheque Configure!");
                    $('#chkDrCrChequeRefrncYes').focus();
                    return false;
                }
            }
            if($('#chkDrCrHasOrderReference').is(":checked"))
            {
                if($('#chkDrCrOrderRefYes').is(":checked")===false)
                {
                    alert("Please Configure Subledger Order Ref Configure!");
                    $('#chkDrCrOrderRefYes').focus();
                    return false;
                }
            }
        }

        //Voucher Bill Ref
        if($('#chkDrCrVoucherBillYes').is(":checked"))
        {
            if($.trim($("#txtDrCrVoucherBillDataSQL").val()) === null || $.trim($("#txtDrCrVoucherBillDataSQL").val()) === "")
            {
                alert("Please Type Voucher Bill Reference data SQL!");
                $('#txtDrCrVoucherBillDataSQL').focus();
                return false;
            }
            if($.trim($("#txtDrCrVoucherBillCompareColumns").val()) === null || $.trim($("#txtDrCrVoucherBillCompareColumns").val()) === "")
            {
                alert("Please Type Voucher Bill Reference Column Name!");
                $('#txtDrCrVoucherBillCompareColumns').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillSetup").val()) === null || $.trim($("#txtDrCrVoucherBillSetup").val()) === "" || $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Voucher Bill Reference Setup!");
                $('#txtDrCrVoucherBillSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillAmountSetup").val()) === null || $.trim($("#txtDrCrVoucherBillAmountSetup").val()) === "" || $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Voucher Bill Reference Amount Setup!");
                $('#txtDrCrVoucherBillAmountSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillDescriptionSetup").val()) === null || $.trim($("#txtDrCrVoucherBillDescriptionSetup").val()) === "" || $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups').length<=0)
            {
                alert("Please Set Voucher Bill Reference Description Setup!");
                $('#txtDrCrVoucherBillDescriptionSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillDateSetup").val()) === null || $.trim($("#txtDrCrVoucherBillDateSetup").val()) === "" || $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Voucher Bill Transaction Date Setup!");
                $('#txtDrCrVoucherBillDateSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrBillDateSetup").val()) === null || $.trim($("#txtDrCrBillDateSetup").val()) === "" || $('#txtDrCrBillDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Voucher Bill Date Setup!");
                $('#txtDrCrBillDateSetup').focus();
                return false;
            }

            if($.trim($("#txtDrCrBillDueDateSetup").val()) === null || $.trim($("#txtDrCrBillDueDateSetup").val()) === "" || $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Voucher Bill Due Date Setup!");
                $('#txtDrCrBillDueDateSetup').focus();
                return false;
            }

            var nVoucherBillTrType  = parseInt($('#cboDrCrVoucherBillTrType').val());
            if(parseInt(nVoucherBillTrType)<=0)
            {
                alert("Please Select Voucher Bill TrType!");
                $('#cboDrCrVoucherBillTrType').focus();
                return false;
            }

            var nVoucherBillRefObjType  = parseInt($('#cboDrCrVoucherBillRefObjType').val());
            if(parseInt(nVoucherBillRefObjType)<=0)
            {
                alert("Please Select Voucher Bill Ref Obj Type!");
                $('#cboDrCrVoucherBillRefObjType').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillNoColumn").val()) === null || $.trim($("#txtDrCrVoucherBillNoColumn").val()) === "")
            {
                alert("Please Enter Voucher Bill No Column!");
                $('#txtDrCrVoucherBillNoColumn').focus();
                return false;
            }

            if($.trim($("#txtDrCrVoucherBillRefObjColumn").val()) === null || $.trim($("#txtDrCrVoucherBillRefObjColumn").val()) === "")
            {
                alert("Please Enter Voucher Bill Ref Obj Column!");
                $('#txtDrCrVoucherBillRefObjColumn').focus();
                return false;
            }
        }

        //Inventory Ref
        if($('#chkDrCrInventoryYes').is(":checked"))
        {
            if($.trim($("#txtDrCrInventoryDataSQL").val()) === null || $.trim($("#txtDrCrInventoryDataSQL").val()) === "")
            {
                alert("Please Type Inventory Effect data SQL!");
                $('#txtDrCrInventoryDataSQL').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryCompareColumns").val()) === null || $.trim($("#txtDrCrInventoryCompareColumns").val()) === "")
            {
                alert("Please Type Inventory Effect Column Name!");
                $('#txtDrCrInventoryCompareColumns').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryWorkingUnitSetup").val()) === null || $.trim($("#txtDrCrInventoryWorkingUnitSetup").val()) === "" || $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Working Unit Setup!");
                $('#txtDrCrInventoryWorkingUnitSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryProductSetup").val()) === null || $.trim($("#txtDrCrInventoryProductSetup").val()) === "" || $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Product Setup!");
                $('#txtDrCrInventoryProductSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryQtySetup").val()) === null || $.trim($("#txtDrCrInventoryQtySetup").val()) === "" || $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Effect Qty Setup!");
                $('#txtDrCrInventoryQtySetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryUnitSetup").val()) === null || $.trim($("#txtDrCrInventoryUnitSetup").val()) === "" || $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Effect Unit Setup!");
                $('#txtDrCrInventoryUnitSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryUnitPriceSetup").val()) === null || $.trim($("#txtDrCrInventoryUnitPriceSetup").val()) === "" || $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Effect Unit Price Setup!");
                $('#txtDrCrInventoryUnitPriceSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryDescriptionSetup").val()) === null || $.trim($("#txtDrCrInventoryDescriptionSetup").val()) === "" || $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups').length<=0)
            {
                alert("Please Set Inventory Effect Description Setup!");
                $('#txtDrCrInventoryDescriptionSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrInventoryDateSetup").val()) === null || $.trim($("#txtDrCrInventoryDateSetup").val()) === "" || $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Inventory Effect Date Setup!");
                $('#txtDrCrInventoryDateSetup').focus();
                return false;
            }
        }

        //Cheque Ref
        if($('#chkDrCrChequeRefrncYes').is(":checked"))
        {
            if($.trim($("#txtDrCrChequeReferenceDataSQL").val()) === null || $.trim($("#txtDrCrChequeReferenceDataSQL").val()) === "")
            {
                alert("Please Type ChequeReference data SQL!");
                $('#txtDrCrChequeReferenceDataSQL').focus();
                return false;
            }
            if($.trim($("#txtDrCrChequeReferenceCompareColumns").val()) === null || $.trim($("#txtDrCrChequeReferenceCompareColumns").val()) === "")
            {
                alert("Please Type ChequeReference Column Name!");
                $('#txtDrCrChequeReferenceCompareColumns').focus();
                return false;
            }
            if($('#cboDrCrChequeType').val() === null || parseInt($('#cboDrCrChequeType').val())<=0)
            {
                alert("Please Select Cheque Type!");
                $('#cboDrCrChequeType').focus();
                return false;
            }
            if($.trim($("#txtDrCrChequeSetup").val()) === null || $.trim($("#txtDrCrChequeSetup").val()) === "" || $('#txtDrCrChequeSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Cheque Setup!");
                $('#txtDrCrChequeSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrChequeReferenceAmountSetup").val()) === null || $.trim($("#txtDrCrChequeReferenceAmountSetup").val()) === "" || $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set ChequeReference Amount Setup!");
                $('#txtDrCrChequeReferenceAmountSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrChequeReferenceDescriptionSetup").val()) === null || $.trim($("#txtDrCrChequeReferenceDescriptionSetup").val()) === "" || $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups').length<=0)
            {
                alert("Please Set ChequeReference Description Setup!");
                $('#txtDrCrChequeReferenceDescriptionSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrChequeReferenceDateSetup").val()) === null || $.trim($("#txtDrCrChequeReferenceDateSetup").val()) === "" || $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set ChequeReference Date Setup!");
                $('#txtDrCrChequeReferenceDateSetup').focus();
                return false;
            }
        }

        //Order Ref
        if($('#chkDrCrOrderRefYes').is(":checked"))
        {
            if($.trim($("#txtDrCrOrderReferenceDataSQL").val()) === null || $.trim($("#txtDrCrOrderReferenceDataSQL").val()) === "")
            {
                alert("Please Type Order data SQL!");
                $('#txtDrCrOrderReferenceDataSQL').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderReferenceCompareColumns").val()) === null || $.trim($("#txtDrCrOrderReferenceCompareColumns").val()) === "")
            {
                alert("Please Type Order Column Name!");
                $('#txtDrCrOrderReferenceCompareColumns').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderReferenceSetup").val()) === null || $.trim($("#txtDrCrOrderReferenceSetup").val()) === "" || $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Order Setup!");
                $('#txtDrCrOrderReferenceSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderAmountSetup").val()) === null || $.trim($("#txtDrCrOrderAmountSetup").val()) === "" || $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Order Amount Setup!");
                $('#txtDrCrOrderAmountSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderRemarkSetup").val()) === null || $.trim($("#txtDrCrOrderRemarkSetup").val()) === "" || $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups').length<=0)
            {
                alert("Please Set Order Remarks Setup!");
                $('#txtDrCrOrderRemarkSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderDateSetup").val()) === null || $.trim($("#txtDrCrOrderDateSetup").val()) === "" || $('#txtDrCrOrderDateSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Order Date Setup!");
                $('#txtDrCrOrderDateSetup').focus();
                return false;
            }
            if($.trim($("#txtDrCrOrderNoSetup").val()) === null || $.trim($("#txtDrCrOrderNoSetup").val()) === "" || $('#txtDrCrOrderNoSetup').data('DataCollectionSetup') === null)
            {
                alert("Please Set Order No Setup!");
                $('#txtDrCrOrderNoSetup').focus();
                return false;
            }
            if($.trim($("#txtOrderRefColumn").val()) === null || $.trim($("#txtOrderRefColumn").val()) === "")
            {
                alert("Please Type Order ref Column!");
                $('#txtOrderRefColumn').focus();
                return false;
            }
            var nOrderRefType  = parseInt($('#cboDrCrRefType').val());
            if(parseInt(nOrderRefType)<=0)
            {
                alert("Please Select Order Ref Type!");
                $('#cboDrCrRefType').focus();
                return false;
            }
            if($.trim($("#txtOrderDateColumn").val()) === null || $.trim($("#txtOrderDateColumn").val()) === "")
            {
                alert("Please Type Order date Column!");
                $('#txtOrderDateColumn').focus();
                return false;
            }
            if($.trim($("#txtOrderNoColumn").val()) === null || $.trim($("#txtOrderNoColumn").val()) === "")
            {
                alert("Please Type Order No Column!");
                $('#txtOrderNoColumn').focus();
                return false;
            }
        }
        return true;
    }

    function RefreshObjectDebitCreditSetup()
    {
        var sAccountHeadSetup = "";
        var nAccountHeadType  = parseInt($('#cboDrCrAccountHeadType').val());
        if(parseInt(nAccountHeadType)===1)
        {
            sAccountHeadSetup = $('#txtDrCrFixedAccountHeadName').val();
        }
        else if(parseInt(nAccountHeadType)===2)
        {
            sAccountHeadSetup = $('#txtDrCrDecidedAccountHeadName').val();
        }
        else if(parseInt(nAccountHeadType)===3)
        {
            sAccountHeadSetup = $('#txtDrCrReferencAccountHeadName').val();
        }

        //Cost Center Part
        var sCostCenterCreate = "No";
        var bCostCenterCreate  = false;
        if($('#chkDrCrCostcCrtYes').is(":checked"))
        {
            sCostCenterCreate = "Yes";
            bCostCenterCreate = true;
        }

        // Voucher Bill Part
        var sVoucherBill = "No";
        var bVoucherBillCreate  = false;
        if($('#chkDrCrVoucherBillYes').is(":checked"))
        {
            sVoucherBill = "Yes";
            bVoucherBillCreate = true;
        }

        //Inventory Part
        var sInventoryEffect = "No";
        var bInventoryEffect  = false;
        if($('#chkDrCrInventoryYes').is(":checked"))
        {
            sInventoryEffect = "Yes";
            bInventoryEffect = true;
        }

        //Cheque Reference
        var sIsChequeRefCreate = "No";
        var bIsChequeRefCreate =  false;
        if($('#chkDrCrChequeRefrncYes').is(":checked"))
        {
            sIsChequeRefCreate ="Yes";
            bIsChequeRefCreate = true;
        }

        //Order Reference
        var sIsOrderReferenceApply = "No";
        var bIsOrderReferenceApply =  false;
        if($('#chkDrCrOrderRefYes').is(":checked"))
        {
            sIsOrderReferenceApply ="Yes";
            bIsOrderReferenceApply = true;
        }

        var oTempDebitCreditSetup = $("#winDebitCredit").data('DebitCreditSetup');
        var oDebitCreditSetup= {
            DebitCreditSetupID : parseInt(oTempDebitCreditSetup.DebitCreditSetupID),
            IntegrationSetupDetailID : parseInt(oTempDebitCreditSetup.IntegrationSetupDetailID),
            DataCollectionQuery : $.trim($('#txtDrCrDataCollectionQuery').val()),
            CompareColumn : $.trim($('#txtDrCrCompareColumn').val()),
            AccountHeadTypeInInt: parseInt($('#cboDrCrAccountHeadType').val()),
            AccountHeadTypeInString : $("#cboDrCrAccountHeadType option:selected").text(),
            FixedAccountHeadID : parseInt(oTempDebitCreditSetup.FixedAccountHeadID),
            AccountCode : oTempDebitCreditSetup.AccountCode,
            AccountHeadName : oTempDebitCreditSetup.AccountHeadName,
            AccountHeadSetup : sAccountHeadSetup,
            AccountNameSetup : $.trim($("#txtDrCrAccountNameSetup").val()),
            ReferenceTypeInInt : parseInt($('#cboDrCrReferenceType').val()),
            CurrencySetup : $.trim($('#txtDrCrCurrencySetup').val()),
            ConversionRateSetup : $.trim($('#txtDrCrConversionRateSetup').val()),
            AmountSetup : $.trim($('#txtDrCrAmountSetup').val()),
            NarrationSetup : $.trim($('#txtDrCrNarrationSetup').val()),
            IsDebit : oTempDebitCreditSetup.IsDebit,
            TranjactionTypeInString : oTempDebitCreditSetup.TranjactionTypeInString,

            IsCostCenterCreate : bCostCenterCreate,
            IsCostCenterCrateInString : sCostCenterCreate,
            HasBillReference : $('#chkDrCrHasBillReference').is(":checked"),
            HasChequeReference : $('#chkDrCrHasChequeReference').is(":checked"),
            HasOrderReference : $('#chkDrCrHasOrderReference').is(":checked"),
            CostcenterDataSQL : $.trim($('#txtDrCrCostcenterDataSQL').val()),
            CostCenterCompareColumns : $.trim($('#txtDrCrCostCenterCompareColumns').val()),
            CostcenterSetup : $.trim($('#txtDrCrCostcenterSetup').val()),
            CostCenterAmountSetup : $.trim($('#txtDrCrCostCenterAmountSetup').val()),
            CostCenterDescriptionSetup : $.trim($('#txtDrCrCostCenterDescriptionSetup').val()),
            CostCenterDateSetup : $.trim($('#txtDrCrCostCenterDateSetup').val()),
            CostCenterCategorySetup : $.trim($('#txtDrCrCostCenterCategorySetup').val()),
            CostCenterNoColumn : $.trim($('#txtDrCrCostCenterNoColumn').val()),
            CostCenterRefObjTypeInInt : parseInt($('#cboDrCrCostCenterRefObjType').val()),
            CostCenterRefObjColumn : $.trim($('#txtDrCrCostCenterRefObjColumn').val()),

            IsVoucherBill : bVoucherBillCreate,
            IsVoucherBillInString : sVoucherBill,
            VoucherBillDataSQL : $.trim($('#txtDrCrVoucherBillDataSQL').val()),
            VoucherBillCompareColumns : $.trim($('#txtDrCrVoucherBillCompareColumns').val()),
            VoucherBillSetup : $.trim($('#txtDrCrVoucherBillSetup').val()),
            VoucherBillTrTypeInInt : parseInt($('#cboDrCrVoucherBillTrType').val()),
            VoucherBillAmountSetup : $.trim($('#txtDrCrVoucherBillAmountSetup').val()),
            VoucherBillDescriptionSetup : $.trim($('#txtDrCrVoucherBillDescriptionSetup').val()),
            VoucherBillDateSetup : $.trim($('#txtDrCrVoucherBillDateSetup').val()),
            BillDateSetup : $.trim($('#txtDrCrBillDateSetup').val()),
            BillDueDateSetup : $.trim($('#txtDrCrBillDueDateSetup').val()),
            VoucherBillNoColumn : $.trim($('#txtDrCrVoucherBillNoColumn').val()),
            VoucherBillRefObjTypeInInt : parseInt($('#cboDrCrVoucherBillRefObjType').val()),
            VoucherBillRefObjColumn : $.trim($('#txtDrCrVoucherBillRefObjColumn').val()),

            IsInventoryEffect : bInventoryEffect,
            IsInventoryEffectInString : sInventoryEffect,
            InventoryDataSQL : $.trim($('#txtDrCrInventoryDataSQL').val()),
            InventoryCompareColumns : $.trim($('#txtDrCrInventoryCompareColumns').val()),
            InventoryWorkingUnitSetup : $.trim($('#txtDrCrInventoryWorkingUnitSetup').val()),
            InventoryProductSetup : $.trim($('#txtDrCrInventoryProductSetup').val()),
            InventoryQtySetup : $.trim($('#txtDrCrInventoryQtySetup').val()),
            InventoryUnitSetup : $.trim($('#txtDrCrInventoryUnitSetup').val()),
            InventoryUnitPriceSetup : $.trim($('#txtDrCrInventoryUnitPriceSetup').val()),
            InventoryDescriptionSetup : $.trim($('#txtDrCrInventoryDescriptionSetup').val()),
            InventoryDateSetup : $.trim($('#txtDrCrInventoryDateSetup').val()),

            IsChequeReferenceCreate : bIsChequeRefCreate,
            IsChequeReferenceCreateInString : sIsChequeRefCreate,
            ChequeReferenceDataSQL : $.trim($('#txtDrCrChequeReferenceDataSQL').val()),
            ChequeReferenceCompareColumns : $.trim($('#txtDrCrChequeReferenceCompareColumns').val()),
            ChequeTypeInt : parseInt($('#cboDrCrChequeType').val()),
            ChequeSetup : $.trim($('#txtDrCrChequeSetup').val()),
            ChequeReferenceAmountSetup : $.trim($('#txtDrCrChequeReferenceAmountSetup').val()),
            ChequeReferenceDescriptionSetup : $.trim($('#txtDrCrChequeReferenceDescriptionSetup').val()),
            ChequeReferenceDateSetup : $.trim($('#txtDrCrChequeReferenceDateSetup').val()),

            IsOrderReferenceApply : bIsOrderReferenceApply,
            IsOrderReferenceApplyInString : sIsOrderReferenceApply,
            OrderReferenceDataSQL : $.trim($('#txtDrCrOrderReferenceDataSQL').val()),
            OrderReferenceCompareColumns : $.trim($('#txtDrCrOrderReferenceCompareColumns').val()),
            OrderReferenceSetup : $.trim($('#txtDrCrOrderReferenceSetup').val()),
            OrderAmountSetup : $.trim($('#txtDrCrOrderAmountSetup').val()),
            OrderRemarkSetup : $.trim($('#txtDrCrOrderRemarkSetup').val()),
            OrderDateSetup : $.trim($('#txtDrCrOrderDateSetup').val()),
            OrderNoSetup : $.trim($('#txtDrCrOrderNoSetup').val()),
            OrderRefTypeInt : parseInt($('#cboDrCrRefType').val()),
            OrderRefColumn : $.trim($('#txtOrderRefColumn').val()),
            OrderDateColumn : $.trim($('#txtOrderDateColumn').val()),
            OrderNoColumn : $.trim($('#txtOrderNoColumn').val()),

            Note : $.trim($('#txtDrCrNote').val()),
            DataCollectionSetups : GetDataCollectionSetupsForDebitCreditSetup(nAccountHeadType, bCostCenterCreate, bVoucherBillCreate, bInventoryEffect, bIsChequeRefCreate, bIsOrderReferenceApply)
        };
        return oDebitCreditSetup;
    }

    function GetDataCollectionSetupsForDebitCreditSetup(nAccountHeadType, bCostCenterCreate, bVoucherBillCreate, bInventoryEffect, bIsChequeRefCreate, bIsOrderReferenceApply)
    {
        //Debit Credit
        var oDecidedAccountHeadName = $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup');
        var oReferencAccountHeadName = $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup');
        var oAccountNameSetup = $("#txtDrCrAccountNameSetup").data('DataCollectionSetup');
        var oCurrencySetup = $('#txtDrCrCurrencySetup').data('DataCollectionSetup');
        var oConversionRateSetup = $('#txtDrCrConversionRateSetup').data('DataCollectionSetup');
        var oAmountSetup = $('#txtDrCrAmountSetup').data('DataCollectionSetup');
        var oNarrationSetup = $('#txtDrCrNarrationSetup').data('DataCollectionSetups');

        //Subledger
        var oCostcenterSetup = $('#txtDrCrCostcenterSetup').data('DataCollectionSetup');
        var oCostCenterAmountSetup = $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup');
        var oCostCenterDescriptionSetup = $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups');
        var oCostCenterDateSetup = $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup');
        var oCostCenterCategorySetup = $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup');

        //Voucher Bill
        var oVoucherBillSetup = $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup');
        var oVoucherBillAmountSetup = $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup');
        var oVoucherBillDescriptionSetup = $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups');
        var oVoucherBillDateSetup = $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup');
        var oBillDateSetup = $('#txtDrCrBillDateSetup').data('DataCollectionSetup');
        var oBillDueDateSetup = $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup');

        //Inventory
        var oInventoryWorkingUnitSetup = $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup');
        var oInventoryProductSetup = $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup');
        var oInventoryQtySetup = $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup');
        var oInventoryUnitSetup = $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup');
        var oInventoryUnitPriceSetup = $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup');
        var oInventoryDescriptionSetup = $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups');
        var oInventoryDateSetup = $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup');

        //Cheque Reference
        var oChequeSetup = $('#txtDrCrChequeSetup').data('DataCollectionSetup');
        var oChequeReferenceAmountSetup = $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup');
        var oChequeReferenceDescriptionSetup = $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups');
        var oChequeReferenceDateSetup = $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup');

        //Order Ref
        var oOrderReferenceSetup = $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup');
        var oOrderAmountSetup = $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup');
        var oOrderRemarkSetup = $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups');
        var oOrderDateSetup = $('#txtDrCrOrderDateSetup').data('DataCollectionSetup');
        var oOrderNoSetup = $('#txtDrCrOrderNoSetup').data('DataCollectionSetup');

        var oDataCollectionSetups=[];
        var oAccountHeadSetup = null;
        if(parseInt(nAccountHeadType)===1)
        {
            oAccountHeadSetup = null;
        }
        else if(parseInt(nAccountHeadType)===2)
        {
            oAccountHeadSetup = oDecidedAccountHeadName;
        }
        else if(parseInt(nAccountHeadType)===3)
        {
            oAccountHeadSetup = oReferencAccountHeadName;
        }
        if(oAccountHeadSetup!=null)
        {
            oDataCollectionSetups.push(oAccountHeadSetup);
        }
        if(oAccountNameSetup!=null)
        {
            oDataCollectionSetups.push(oAccountNameSetup);
        }
        oDataCollectionSetups.push(oCurrencySetup);
        oDataCollectionSetups.push(oConversionRateSetup);
        oDataCollectionSetups.push(oAmountSetup);
        for(var i=0; i< oNarrationSetup.length; i++)
        {
            oDataCollectionSetups.push(oNarrationSetup[i]);
        }

        //Subledger
        if(bCostCenterCreate)
        {
            oDataCollectionSetups.push(oCostcenterSetup);
            oDataCollectionSetups.push(oCostCenterAmountSetup);
            for(var i=0; i< oCostCenterDescriptionSetup.length; i++)
            {
                oDataCollectionSetups.push(oCostCenterDescriptionSetup[i]);
            }
            oDataCollectionSetups.push(oCostCenterDateSetup);
            oDataCollectionSetups.push(oCostCenterCategorySetup);
        }

        //Voucher Bill
        if(bVoucherBillCreate)
        {
            oDataCollectionSetups.push(oVoucherBillSetup);
            oDataCollectionSetups.push(oVoucherBillAmountSetup);
            for(var i=0; i< oVoucherBillDescriptionSetup.length; i++)
            {
                oDataCollectionSetups.push(oVoucherBillDescriptionSetup[i]);
            }
            oDataCollectionSetups.push(oVoucherBillDateSetup);
            oDataCollectionSetups.push(oBillDateSetup);
            oDataCollectionSetups.push(oBillDueDateSetup);
        }

        //Inventory
        if(bInventoryEffect)
        {
            oDataCollectionSetups.push(oInventoryWorkingUnitSetup);
            oDataCollectionSetups.push(oInventoryProductSetup);
            oDataCollectionSetups.push(oInventoryQtySetup);
            oDataCollectionSetups.push(oInventoryUnitSetup);
            oDataCollectionSetups.push(oInventoryUnitPriceSetup);
            for(var i=0; i< oInventoryDescriptionSetup.length; i++)
            {
                oDataCollectionSetups.push(oInventoryDescriptionSetup[i]);
            }
            oDataCollectionSetups.push(oInventoryDateSetup);
        }

        //Cheque Ref
        if(bIsChequeRefCreate)
        {
            oDataCollectionSetups.push(oChequeSetup);
            oDataCollectionSetups.push(oChequeReferenceAmountSetup);
            for(var i=0; i< oChequeReferenceDescriptionSetup.length; i++)
            {
                oDataCollectionSetups.push(oChequeReferenceDescriptionSetup[i]);
            }
            oDataCollectionSetups.push(oChequeReferenceDateSetup);
        }

        //Order Ref
        if(bIsOrderReferenceApply)
        {
            oDataCollectionSetups.push(oOrderReferenceSetup);
            oDataCollectionSetups.push(oOrderNoSetup);
            oDataCollectionSetups.push(oOrderAmountSetup);
            for(var i=0; i< oOrderRemarkSetup.length; i++)
            {
                oDataCollectionSetups.push(oOrderRemarkSetup[i]);
            }
            oDataCollectionSetups.push(oOrderDateSetup);
        }
        return oDataCollectionSetups;
    }

    function RefreshDebitCreditSetupList(oDebitCreditSetups)
    {
        var data=oDebitCreditSetups;
        data={"total":""+data.length+"","rows":data};
        $('#tblDebitCreditSetup').datagrid('loadData',data);
    }

    function GetDataCollectionSetupsForDetail()
    {
        var oDataCollectionSetups=[];
        var oBusinessUnitSetup = $('#txtBusinessUnitSetup').data('DataCollectionSetup');
        var oVoucherDateSetup = $('#txtVoucherDateSetup').data('DataCollectionSetup');
        var oNarrationSetups = $('#txtNarrationSetup').data('DataCollectionSetups');
        var oReferenceNoteSetups = $('#txtReferenceNoteSetup').data('DataCollectionSetups');

        oDataCollectionSetups.push(oBusinessUnitSetup);
        oDataCollectionSetups.push(oVoucherDateSetup);
        for(var i=0; i< oNarrationSetups.length; i++)
        {
            oDataCollectionSetups.push(oNarrationSetups[i]);
        }
        for(var i=0; i< oReferenceNoteSetups.length; i++)
        {
            oDataCollectionSetups.push(oReferenceNoteSetups[i]);
        }
        return oDataCollectionSetups;
    }

    function NewDataCollectionSetupObj(nDataReferenceTypeInt, nDataSetupTypeInt){
        var oDataCollectionSetup = {
            DataCollectionSetupID : 0,
            DataReferenceType : parseInt(nDataReferenceTypeInt),
            DataReferenceTypeInInt : parseInt(nDataReferenceTypeInt),
            DataReferenceID : 0,
            DataSetupType : parseInt(nDataSetupTypeInt),
            DataSetupTypeInInt : parseInt(nDataSetupTypeInt),
            DataGenerateType : 0,
            DataGenerateTypeInInt : 0,
            DataGenerateTypeInString : 'None',
            QueryForValue : "",
            ReferenceValueFields : "",
            FixedText : "",
            Note : ""
        };
        return oDataCollectionSetup;
    }

    function GetExistDCStup(oDataCollectionSetups, nDataSetupTypeInt)
    {
        for(var i=0; i<oDataCollectionSetups.length; i++)
        {
            if(parseInt(oDataCollectionSetups[i].DataSetupTypeInInt) === parseInt(nDataSetupTypeInt))
            {
                return oDataCollectionSetups[i];
            }
        }
        return null;
    }

    function GetExistDCStups(oDataCollectionSetups, nDataSetupTypeInt)
    {
        var oTempDataCollectionSetups = [];
        for(var i=0; i<oDataCollectionSetups.length; i++)
        {
            if(parseInt(oDataCollectionSetups[i].DataSetupTypeInInt) === parseInt(nDataSetupTypeInt))
            {
                oTempDataCollectionSetups.push(oDataCollectionSetups[i]);
            }
        }
        return oTempDataCollectionSetups;
    }

    function RefCtrlDCStup(oDataCollectionSetup)
    {
        //EnumDataGenerateType : ManualData = 1 & AutomatedData = 2
        $('#txtDCStupQueryForValue').val(oDataCollectionSetup.QueryForValue);
        $('#txtDCStupReferenceValueFields').val(oDataCollectionSetup.ReferenceValueFields);
        $('#txtDCStupNote').val(oDataCollectionSetup.Note);
        if(parseInt(oDataCollectionSetup.DataGenerateTypeInInt)===1)
        {
            $('#chkDCStupManual').attr("checked", true);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').prop('disabled', true);
        }
        else if(parseInt(oDataCollectionSetup.DataGenerateTypeInInt)===2)
        {
            $('#chkDCStupAutomated').attr("checked", true);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').prop('disabled', false);
        }
    }

    function ValidateInputDCStup()
    {
        if($('#chkDCStupManual').is(":checked") === false && $('#chkDCStupAutomated').is(":checked") === false)
        {
            alert("Please select any one between Automated & Manual Data!");
            $('#chkDCStupAutomated').focus();
            return false;
        }

        if($('#chkDCStupAutomated').is(":checked"))
        {
            if($.trim($('#txtDCStupQueryForValue').val()) === null || $.trim($('#txtDCStupQueryForValue').val()) === "")
            {
                alert("Please enter Query!");
                $('#txtDCStupQueryForValue').focus();
                return false;
            }
            if($.trim($('#txtDCStupReferenceValueFields').val()) === null || $.trim($('#txtDCStupReferenceValueFields').val()) === "")
            {
                alert("Please enter Reference Value Fields!");
                $('#txtDCStupReferenceValueFields').focus();
                return false;
            }
            var sQueryForValue = $.trim($('#txtDCStupQueryForValue').val());
            var aQueryForValue= sQueryForValue.split(" ");
            if(aQueryForValue.length<4)
            {
                alert("Incomplete Query! Please check your Query.");
                $('#txtDCStupQueryForValue').focus();
                return false;
            }
        }
        return true;
    }

    function RefreshObjectDCStup()
    {
        var nDataGenerateType = 0;
        var sDataGenerateTypeInString = "None";
        if($('#chkDCStupManual').is(":checked"))
        {
            nDataGenerateType = 1;
            sDataGenerateTypeInString ="ManualData";
        }
        else if($('#chkDCStupAutomated').is(":checked"))
        {
            nDataGenerateType = 2;
            sDataGenerateTypeInString ="AutomatedData";
        }

        var htmControlId = $('#winDataCollectionSetup').data('htmlControlId');
        var oTempDataCollectionSetup = $(htmControlId).data('DataCollectionSetup');

        var oDataCollectionSetup= {
            DataCollectionSetupID : parseInt(oTempDataCollectionSetup.DataCollectionSetupID),
            DataReferenceTypeInInt : parseInt(oTempDataCollectionSetup.DataReferenceTypeInInt),
            DataReferenceID : parseInt(oTempDataCollectionSetup.DataReferenceID),
            DataSetupTypeInInt : parseInt(oTempDataCollectionSetup.DataSetupTypeInInt),
            DataGenerateTypeInInt : parseInt(nDataGenerateType),
            QueryForValue : $.trim($("#txtDCStupQueryForValue").val()),
            ReferenceValueFields : $.trim($("#txtDCStupReferenceValueFields").val()),
            Note : $.trim($("#txtDCStupNote").val()),
            DataGenerateTypeInString : sDataGenerateTypeInString,
            SetupText : GetSetupTextDCStup()
        };
        return oDataCollectionSetup;
    }

    function GetSetupTextDCStup()
    {
        var sSetupText="";
        if($('#chkDCStupManual').is(":checked"))
        {
            sSetupText= "Manual Data";
        }
        else if($('#chkDCStupAutomated').is(":checked"))
        {
            var sQueryForValue = $.trim($("#txtDCStupQueryForValue").val());
            var aQueryForValue= sQueryForValue.split(" ");
            sSetupText = aQueryForValue[1] + " of "+ aQueryForValue[3];
        }
        return sSetupText;
    }

    function GetSetupText(oDataCollectionSetup)
    {
        var sSetupText="";
        if(parseInt(oDataCollectionSetup.DataGenerateTypeInInt)== 1)
        {
            sSetupText= "(Manual Data)";
        }
        else if(parseInt(oDataCollectionSetup.DataGenerateTypeInInt)== 2)
        {
            var aQueryForValue= oDataCollectionSetup.QueryForValue.split(" ");
            sSetupText = aQueryForValue[1] + " of "+ aQueryForValue[3];
        }
        else if(parseInt(oDataCollectionSetup.DataGenerateTypeInInt)== 3)
        {
            sSetupText = oDataCollectionSetup.FixedText + "(Fixed Text)"
        }
        return sSetupText;
    }

    function GetSetupTextDCStups()
    {
        //debugger;
        var sSetupText="";
        var oDataCollectionSetups = $('#tblDataCollectionSetup').datagrid('getRows');
        for(var i=0; i< oDataCollectionSetups.length; i++)
        {
            if(i==(oDataCollectionSetups.length-1))
            {
                sSetupText = sSetupText + GetSetupText(oDataCollectionSetups[i]);
            }
            else
            {
                sSetupText = sSetupText + GetSetupText(oDataCollectionSetups[i]) + "+";
            }
        }
        return sSetupText;
    }

    function RefreshDCStupLists(oDataCollectionSetups)
    {
        var data=oDataCollectionSetups;
        data={"total":""+data.length+"","rows":data};
        $('#tblDataCollectionSetup').datagrid('loadData',data);
    }

    function ValidateInputDCStups()
    {
        if($('#chkDCStupsManual').is(":checked") === false && $('#chkDCStupsAutomated').is(":checked") === false && $('#chkDCStupsFixedText').is(":checked") === false)
        {
            alert("Please select any one between Automated, Manual & Fixed Text Data!");
            $('#chkDCStupsAutomated').focus();
            return false;
        }
        if($('#chkDCStupsAutomated').is(":checked"))
        {
            if($.trim($('#txtDCStupsQueryForValue').val()) === null || $.trim($('#txtDCStupsQueryForValue').val()) === "")
            {
                alert("Please enter Query!");
                $('#txtDCStupsQueryForValue').focus();
                return false;
            }
            if($.trim($('#txtDCStupsReferenceValueFields').val()) === null || $.trim($('#txtDCStupsReferenceValueFields').val()) === "")
            {
                alert("Please enter Reference Value Fields!");
                $('#txtDCStupsReferenceValueFields').focus();
                return false;
            }
            var sQueryForValue = $.trim($('#txtDCStupsQueryForValue').val());
            var aQueryForValue= sQueryForValue.split(" ");
            if(aQueryForValue.length<4)
            {
                alert("Incomplete Query! Please check your Query.");
                $('#txtDCStupsQueryForValue').focus();
                return false;
            }
        }
        if($('#chkDCStupsFixedText').is(":checked"))
        {
            if($.trim($('#txtDCStupsFixedText').val()) === null || $.trim($('#txtDCStupsFixedText').val()) === "")
            {
                alert("Please enter Fixed Text!");
                $('#txtDCStupsFixedText').focus();
                return false;
            }
        }
        return true;
    }

    function RefreshObjectDCStups()
    {
        var nDataGenerateType = 0;
        var sDataGenerateTypeInString = "None";
        if($('#chkDCStupsManual').is(":checked"))
        {
            nDataGenerateType = 1;
            sDataGenerateTypeInString ="ManualData";
        }
        else if($('#chkDCStupsAutomated').is(":checked"))
        {
            nDataGenerateType = 2;
            sDataGenerateTypeInString ="AutomatedData";
        }
        else if($('#chkDCStupsFixedText').is(":checked"))
        {
            nDataGenerateType = 3;
            sDataGenerateTypeInString ="FixedData";
        }

        var htmControlId = $('#winDataCollectionSetups').data('htmlControlId');
        var oTempDataCollectionSetup = $(htmControlId).data('DataCollectionSetup');

        var oDataCollectionSetup= {
            DataCollectionSetupID : parseInt(oTempDataCollectionSetup.DataCollectionSetupID),
            DataReferenceTypeInInt : parseInt(oTempDataCollectionSetup.DataReferenceTypeInInt),
            DataReferenceID : parseInt(oTempDataCollectionSetup.DataReferenceID),
            DataSetupTypeInInt : parseInt(oTempDataCollectionSetup.DataSetupTypeInInt),
            DataGenerateTypeInInt : parseInt(nDataGenerateType),
            QueryForValue : $.trim($("#txtDCStupsQueryForValue").val()),
            ReferenceValueFields : $.trim($("#txtDCStupsReferenceValueFields").val()),
            FixedText : $.trim($("#txtDCStupsFixedText").val()),
            Note : $.trim($("#txtDCStupsNote").val()),
            DataGenerateTypeInString : sDataGenerateTypeInString
        };
        return oDataCollectionSetup;
    }

    function RefreshDrCrComboBox()
    {
        var oAccountHeadTypes = $('#cboDrCrAccountHeadType').data('AccountHeadTypes');
        var oVoucherReferenceTypes = $('#cboDrCrReferenceType').data('VoucherReferenceTypes');
        var oCostCenterReferenceTypes = $('#cboDrCrCostCenterRefObjType').data('CostCenterReferenceTypes');
        var oVoucherBillReferenceTypes = $('#cboDrCrVoucherBillRefObjType').data('VoucherBillReferenceTypes');
        var oVoucherBillTrTypes = $('#cboDrCrVoucherBillTrType').data('VoucherBillTrTypes');
        var oChequeTypes = $('#cboDrCrChequeType').data('ChequeTypes');
        var oVOrderRefTypes = $('#cboDrCrRefType').data('VOrderRefTypes');

        $("#cboDrCrAccountHeadType").icsLoadCombo({List: oAccountHeadTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrReferenceType").icsLoadCombo({List: oVoucherReferenceTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrCostCenterRefObjType").icsLoadCombo({List: oCostCenterReferenceTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrVoucherBillRefObjType").icsLoadCombo({List: oVoucherBillReferenceTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrVoucherBillTrType").icsLoadCombo({List: oVoucherBillTrTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrChequeType").icsLoadCombo({List: oChequeTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboDrCrRefType").icsLoadCombo({List: oVOrderRefTypes, OptionValue: "id", DisplayText: "Value" });
    }

    function ChnageAccountHeadType()
    {
        var oDebitCreditSetup = $("#winDebitCredit").data('DebitCreditSetup');
        var nAccountHeadType  = parseInt($('#cboDrCrAccountHeadType').val());
        if(parseInt(nAccountHeadType)<=1 )
        {
            $('#trDecidedAcHead,#trRefereneAcHead').hide();
            $('#trFixedAcHead').show();
            $('#txtDrCrDecidedAccountHeadName').val('');
            $('#txtDrCrReferencAccountHeadName').val('');
            $("#winDebitCredit").data('DebitCreditSetup').ReferenceTypeInInt = 0;
            $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup', null);
            $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', null);
        }
        else if(parseInt(nAccountHeadType)===2)
        {
            $('#trFixedAcHead,#trRefereneAcHead').hide();
            $('#trDecidedAcHead').show();
            $('#txtFixedAccountHeadName').val('');
            $('#txtReferencAccountHeadName').val('');
            $("#winDebitCredit").data('DebitCreditSetup').FixedAccountHeadID = 0;
            $("#winDebitCredit").data('DebitCreditSetup').ReferenceTypeInInt = 0;
            $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', null);
        }
        else if(parseInt(nAccountHeadType)===3)
        {
            $('#trFixedAcHead,#trDecidedAcHead').hide();
            $('#trRefereneAcHead').show();
            $('#txtFixedAccountHeadName').val('');
            $('#txtDecidedAccountHeadName').val('');
            $("#winDebitCredit").data('DebitCreditSetup').FixedAccountHeadID = 0;
            $('#txtDecidedAccountHeadName').data('DataCollectionSetup', null);
        }
    }

    function InitialCheckBoxChnage()
    {
        if($('#chkDrCrCostcCrtYes').is(":checked")) {
            $("#divSubledger :checkbox").prop('disabled', false);
            $("#divSubledger :button").prop('disabled', false);
            $("#txtDrCrCostcenterDataSQL,#txtDrCrCostCenterCompareColumns,#cboDrCrCostCenterRefObjType,#txtDrCrCostCenterNoColumn,#txtDrCrCostCenterRefObjColumn").prop('disabled', false);
            $("#chkDrCrCostcCrtNo").attr("checked", false);
        }

        if($('#chkDrCrCostcCrtNo').is(":checked")) {
            $("#divSubledger :input").prop('disabled', true);
            $("#chkDrCrCostcCrtYes,#chkDrCrCostcCrtNo").prop('disabled', false);
            $("#divSubledger :input").not("input[type='button']").val("");
            $("#cboDrCrCostCenterRefObjType").val(0);
            $("#chkDrCrCostcCrtYes,#chkDrCrHasBillReference,#chkDrCrHasChequeReference,#chkDrCrHasOrderReference").attr("checked", false);

            $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', null);
        }

        if($('#chkDrCrVoucherBillYes').is(":checked")) {
            $("#divVoucherBill :button").prop('disabled', false);
            $("#txtDrCrVoucherBillDataSQL,#txtDrCrVoucherBillCompareColumns,#cboDrCrVoucherBillTrType").prop('disabled', false);
            $("#cboDrCrVoucherBillRefObjType,#txtDrCrVoucherBillNoColumn,#txtDrCrVoucherBillRefObjColumn").prop('disabled', false);
            $("#chkDrCrVoucherBillNo").attr("checked", false);
        }

        if($('#chkDrCrVoucherBillNo').is(":checked")) {
            $("#divVoucherBill :input").prop('disabled', true);
            $("#chkDrCrVoucherBillYes,#chkDrCrVoucherBillNo").prop('disabled', false);
            $("#divVoucherBill :input").not("input[type='button']").val("");
            $("#cboDrCrVoucherBillTrType,#cboDrCrVoucherBillRefObjType").val(0);
            $("#chkDrCrVoucherBillYes").attr("checked", false);

            $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', null);
            $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrBillDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', null);
        }

        if($('#chkDrCrInventoryYes').is(":checked")) {
            $("#divInventory :button").prop('disabled', false);
            $("#txtDrCrInventoryDataSQL,#txtDrCrInventoryCompareColumns").prop('disabled', false);
            $("#chkDrCrInventoryNo").attr("checked", false);
        }

        if($('#chkDrCrInventoryNo').is(":checked")) {
            $("#divInventory :input").prop('disabled', true);
            $("#chkDrCrInventoryYes,#chkDrCrInventoryNo").prop('disabled', false);
            $("#divInventory :input").not("input[type='button']").val("");
            $("#chkDrCrInventoryYes").attr("checked", false);

            $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', null);
        }

        if($('#chkDrCrChequeRefrncYes').is(":checked")) {
            $("#divChequeReference :button").prop('disabled', false);
            $("#txtDrCrChequeReferenceDataSQL,#txtDrCrChequeReferenceCompareColumns,#cboDrCrChequeType").prop('disabled', false);
            $("#chkDrCrChequeRefrncNo").attr("checked", false);
        }

        if($('#chkDrCrChequeRefrncNo').is(":checked")) {
            $("#divChequeReference :input").prop('disabled', true);
            $("#chkDrCrChequeRefrncYes,#chkDrCrChequeRefrncNo").prop('disabled', false);
            $("#divChequeReference :input").not("input[type='button']").val("");
            $("#cboDrCrChequeType").val(0);
            $("#chkDrCrChequeRefrncYes").attr("checked", false);

            $('#txtDrCrChequeSetup').data('DataCollectionSetup', null);
            $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', null);
        }

        if($('#chkDrCrOrderRefYes').is(":checked")) {
            $("#divOrderReference :button").prop('disabled', false);
            $("#txtDrCrOrderReferenceDataSQL,#txtDrCrOrderReferenceCompareColumns,#txtOrderRefColumn,#txtOrderDateColumn,#txtOrderNoColumn,#cboDrCrRefType").prop('disabled', false);
            $("#chkDrCrOrderRefNo").attr("checked", false);
        }

        if($('#chkDrCrOrderRefNo').is(":checked")) {
            $("#divOrderReference :input").prop('disabled', true);
            $("#chkDrCrOrderRefYes,#chkDrCrOrderRefNo").prop('disabled', false);
            $("#divOrderReference :input").not("input[type='button']").val("");
            $("#chkDrCrOrderRefYes").attr("checked", false);
            $("#cboDrCrRefType").val(0);

            $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups', []);
            $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', null);
        }
    }

    //Start Integration Setup Detail
    $('#btnAddDetail').click(function(){
        $("#winIntegrationSetupDetail").data('selectedIndex', -1);
        $("#winIntegrationSetupDetail").icsWindow('open', "Add Voucher Setup");
        $("#winIntegrationSetupDetail :input").not("input[type='button']").val("");
        var oVoucherTypes = $('#cboVoucherType').data('VoucherTypes');
        $("#cboVoucherType").icsLoadCombo({List: oVoucherTypes, OptionValue: "VoucherTypeID", DisplayText: "VoucherName" });
        var oIntegrationSetupDetail = NewIntegrationDetailObj();
        $("#winIntegrationSetupDetail").data('IntegrationSetupDetail', oIntegrationSetupDetail);
        $('#txtBusinessUnitSetup').data('DataCollectionSetup', null);
        $('#txtVoucherDateSetup').data('DataCollectionSetup', null);
        $('#txtNarrationSetup').data('DataCollectionSetups', []);
        $('#txtReferenceNoteSetup').data('DataCollectionSetups', []);
        RefreshDebitCreditSetupList([]);
    });

    $('#btnEditDetail').click(function(){
        var oIntegrationSetupDetail = $('#tblIntegrationSetupDetail').datagrid('getSelected');
        if(oIntegrationSetupDetail === null || parseInt(oIntegrationSetupDetail.VoucherTypeID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var selectedIndex = $('#tblIntegrationSetupDetail').datagrid('getRowIndex', oIntegrationSetupDetail);
        $("#winIntegrationSetupDetail").data('selectedIndex', selectedIndex);
        $("#winIntegrationSetupDetail").icsWindow('open', "Edit Voucher Setup");
        $("#winIntegrationSetupDetail :input").not("input[type='button']").val("");
        var oVoucherTypes = $('#cboVoucherType').data('VoucherTypes');
        $("#cboVoucherType").icsLoadCombo({List: oVoucherTypes, OptionValue: "VoucherTypeID", DisplayText: "VoucherName" });

        $("#cboVoucherType").val(parseInt(oIntegrationSetupDetail.VoucherTypeID));
        $("#txtBusinessUnitSetup").val(oIntegrationSetupDetail.BusinessUnitSetup);
        $("#txtVoucherDateSetup").val(oIntegrationSetupDetail.VoucherDateSetup);
        $("#txtNarrationSetup").val(oIntegrationSetupDetail.NarrationSetup);
        $("#txtReferenceNoteSetup").val(oIntegrationSetupDetail.ReferenceNoteSetup);
        $("#txtUpdateTable").val(oIntegrationSetupDetail.UpdateTable);
        $("#txtNoteDetail").val(oIntegrationSetupDetail.Note);

        $("#winIntegrationSetupDetail").data('IntegrationSetupDetail', oIntegrationSetupDetail);
        var oBusinessUnitSetup = GetExistDCStup(oIntegrationSetupDetail.DataCollectionSetups, 36);//EnumDataSetupType : BusinessUnitSetup = 36
        $('#txtBusinessUnitSetup').data('DataCollectionSetup', oBusinessUnitSetup);

        var oVoucherDateSetup = GetExistDCStup(oIntegrationSetupDetail.DataCollectionSetups, 1);//EnumDataSetupType : VoucherDateSetup = 1
        $('#txtVoucherDateSetup').data('DataCollectionSetup', oVoucherDateSetup);

        var oNarrationSetups = GetExistDCStups(oIntegrationSetupDetail.DataCollectionSetups, 4);//EnumDataSetupType : NarrationSetup = 4
        $('#txtNarrationSetup').data('DataCollectionSetups', oNarrationSetups);

        var oReferenceNoteSetups = GetExistDCStups(oIntegrationSetupDetail.DataCollectionSetups, 5);//EnumDataSetupType : ReferenceNoteSetup = 5
        $('#txtReferenceNoteSetup').data('DataCollectionSetups', oReferenceNoteSetups);
        RefreshDebitCreditSetupList(oIntegrationSetupDetail.DebitCreditSetups);

        var sIntegrationSetupHeader = sessionStorage.getItem("IntegrationSetupHeader");
        if(sIntegrationSetupHeader=="View Integration Setup")
        {
            $('#btnDebit,#btnCredit,#btnDebitCreditRemove,#btnSaveDetail').hide();
        }
    });

    $('#btnRemoveDetail').click(function(){
        var oIntegrationSetupDetail = $('#tblIntegrationSetupDetail').datagrid('getSelected');
        if(oIntegrationSetupDetail === null || parseInt(oIntegrationSetupDetail.VoucherTypeID)<=0)
        {
            alert("Please select a item from list!");
            return;
        }
        var selectedIndex = $('#tblIntegrationSetupDetail').datagrid('getRowIndex', oIntegrationSetupDetail);
        if (!confirm("Confirm to Delete?")) return ;
        $('#tblIntegrationSetupDetail').datagrid('deleteRow',selectedIndex);
    });

    $('#btnSaveDetail').click(function(){
        if(!ValidateInputDetail()) return;
        var oIntegrationSetupDetail = RefreshObjectDetail();
        var selectedIndex = parseInt($("#winIntegrationSetupDetail").data('selectedIndex'));
        if(selectedIndex<0)
        {
            $('#tblIntegrationSetupDetail').datagrid('appendRow', oIntegrationSetupDetail);
        }
        else
        {
            $('#tblIntegrationSetupDetail').datagrid('updateRow',{ index: selectedIndex, row: oIntegrationSetupDetail });
        }
        $("#winIntegrationSetupDetail").icsWindow('close');
        $("#winIntegrationSetupDetail :input").not("input[type='button']").val("");
    });

    $('#btnCloseDetail').click(function(){
        $("#winIntegrationSetupDetail").icsWindow('close');
        $("#winIntegrationSetupDetail :input").not("input[type='button']").val("");
    });
    //End Integration Setup Detail

    //Start Debit Credit Setup
    $('#btnDebit').click(function(){
        $("#winDebitCredit").data('selectedDrCrIndex', -1);
        $("#winDebitCredit").icsWindow('open', "Add Debit Configure");
        $("#winDebitCredit :input").not("input[type='button']").val("");
        $("#winDebitCredit :checkbox").attr("checked", false);
        $("#chkDrCrCostcCrtYes,#chkDrCrVoucherBillYes,#chkDrCrInventoryYes,#chkDrCrChequeRefrncYes,#chkDrCrOrderRefYes").attr("checked", true);
        InitialCheckBoxChnage();
        RefreshDrCrComboBox();
        var oDebitCreditSetup = NewDebitCreditSetupObj(true);
        $("#winDebitCredit").data('DebitCreditSetup', oDebitCreditSetup);

        //Debit Credit
        $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup', null);
        $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', null);
        $("#txtDrCrAccountNameSetup").data('DataCollectionSetup', null);
        $('#txtDrCrCurrencySetup').data('DataCollectionSetup', null);
        $('#txtDrCrConversionRateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrNarrationSetup').data('DataCollectionSetups', []);

        //Subledger
        $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', null);

        //Voucher Bill
        $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', null);
        $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrBillDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', null);

        //Inventory
        $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', null);

        //Cheque Reference
        $('#txtDrCrChequeSetup').data('DataCollectionSetup', null);
        $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', null);

        //Order Ref
        $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups', []);
        $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', null);
        ChnageAccountHeadType();
    });

    $('#btnCredit').click(function(){
        $("#winDebitCredit").data('selectedDrCrIndex', -1);
        $("#winDebitCredit").icsWindow('open', "Add Credit Configure");
        $("#winDebitCredit :input").not("input[type='button']").val("");
        $("#winDebitCredit :checkbox").attr("checked", false);
        $("#chkDrCrCostcCrtYes,#chkDrCrVoucherBillYes,#chkDrCrInventoryYes,#chkDrCrChequeRefrncYes,#chkDrCrOrderRefYes").attr("checked", true);
        InitialCheckBoxChnage();
        RefreshDrCrComboBox();
        var oDebitCreditSetup = NewDebitCreditSetupObj(false);
        $("#winDebitCredit").data('DebitCreditSetup', oDebitCreditSetup);

        //Debit Credit
        $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup', null);
        $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', null);
        $("#txtDrCrAccountNameSetup").data('DataCollectionSetup', null);
        $('#txtDrCrCurrencySetup').data('DataCollectionSetup', null);
        $('#txtDrCrConversionRateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrNarrationSetup').data('DataCollectionSetups', []);

        //Subledger
        $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', null);

        //Voucher Bill
        $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', null);
        $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrBillDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', null);

        //Inventory
        $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', null);
        $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', null);

        //Cheque Reference
        $('#txtDrCrChequeSetup').data('DataCollectionSetup', null);
        $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups', []);
        $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', null);

        //Order Ref
        $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups', []);
        $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', null);
        $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', null);
        ChnageAccountHeadType();
    });

    $('#btnDebitCreditEdit').click(function(){
        var oDebitCreditSetup = $('#tblDebitCreditSetup').datagrid('getSelected');
        if(oDebitCreditSetup === null)
        {
            alert("Please select a item from list!");
            return;
        }
        var selectedIndex = $('#tblDebitCreditSetup').datagrid('getRowIndex', oDebitCreditSetup);
        $("#winDebitCredit").data('selectedDrCrIndex', selectedIndex);
        var sWindowHeader = "Edit Credit Configure";
        if(oDebitCreditSetup.IsDebit === true){ sWindowHeader = "Edit Debit Configure"; }
        $("#winDebitCredit").icsWindow('open', sWindowHeader);
        $("#winDebitCredit :input").not("input[type='button']").val("");
        $("#winDebitCredit :checkbox").attr("checked", false);
        $("#winDebitCredit").data('DebitCreditSetup', oDebitCreditSetup);
        RefreshDrCrComboBox();
        DrCrRefreshControl();
        InitialCheckBoxChnage();

        //Debit Credit
        var oDecidedAccountHeadName = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 6);//EnumDataSetupType : AccountHeadSetup = 6
        $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup', oDecidedAccountHeadName);

        var oReferencAccountHeadName = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 6);//EnumDataSetupType : AccountHeadSetup = 6
        $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', oReferencAccountHeadName);

        var oAccountNameSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 30);//EnumDataSetupType : AccountNameSetup = 30
        $('#txtDrCrAccountNameSetup').data('DataCollectionSetup', oAccountNameSetup);

        var oCurrencySetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 2);//EnumDataSetupType : CurrencySetup = 2
        $('#txtDrCrCurrencySetup').data('DataCollectionSetup', oCurrencySetup);

        var oConversionRateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 3);//EnumDataSetupType : ConversionRateSetup = 3
        $('#txtDrCrConversionRateSetup').data('DataCollectionSetup', oConversionRateSetup);

        var oAmountSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 7);//EnumDataSetupType : VoucherDetailAmountSetup = 7
        $('#txtDrCrAmountSetup').data('DataCollectionSetup', oAmountSetup);

        var oNarrationSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 8);//EnumDataSetupType : VoucherDetailNarrationSetup = 8
        $('#txtDrCrNarrationSetup').data('DataCollectionSetups', oNarrationSetup);

        //Subledger
        var oCostcenterSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 12);//EnumDataSetupType : CostCenterSetup = 12
        $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', oCostcenterSetup);

        var oCostCenterAmountSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 13);//EnumDataSetupType : CostCenterAmountSetup = 13
        $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', oCostCenterAmountSetup);

        var oCostCenterDescriptionSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 14);//EnumDataSetupType : CostCenterDescriptionSetup = 14
        $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups', oCostCenterDescriptionSetup);

        var oCostCenterDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 15);//EnumDataSetupType : CostCenterDateSetup = 15
        $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', oCostCenterDateSetup);

        var oCostCenterCategorySetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 27);//EnumDataSetupType : CostCenterCategorySetup = 27
        $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', oCostCenterCategorySetup);

        //Voucher Bill
        var oVoucherBillSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 16);//EnumDataSetupType : VoucherBillSetup = 16
        $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', oVoucherBillSetup);

        var oVoucherBillAmountSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 17);//EnumDataSetupType : VoucherBillAmountSetup = 17
        $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', oVoucherBillAmountSetup);

        var oVoucherBillDescriptionSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 18);//EnumDataSetupType : VoucherBillDescriptionSetup = 18
        $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups', oVoucherBillDescriptionSetup);

        var oVoucherBillDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 19);//EnumDataSetupType : VoucherBillDateSetup = 19
        $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', oVoucherBillDateSetup);

        var oBillDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 28);//EnumDataSetupType : BillDateSetup = 28
        $('#txtDrCrBillDateSetup').data('DataCollectionSetup', oBillDateSetup);

        var oBillDueDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 29);//EnumDataSetupType : BillDueDateSetup = 29
        $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', oBillDueDateSetup);

        //Inventory
        var oInventoryWorkingUnitSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 20);//EnumDataSetupType : InventoryWorkingUnitSetup = 20
        $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', oInventoryWorkingUnitSetup);

        var oInventoryProductSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 21);//EnumDataSetupType : InventoryProductSetup = 21
        $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', oInventoryProductSetup);

        var oInventoryQtySetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 22);//EnumDataSetupType : InventoryQtySetup = 22
        $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', oInventoryQtySetup);

        var oInventoryUnitSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 23);//EnumDataSetupType : InventoryUnitSetup = 23
        $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', oInventoryUnitSetup);

        var oInventoryUnitPriceSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 24);//EnumDataSetupType : InventoryUnitPriceSetup = 24
        $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', oInventoryUnitPriceSetup);

        var oInventoryDescriptionSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 25);//EnumDataSetupType : InventoryDescriptionSetup = 25
        $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups', oInventoryDescriptionSetup);

        var oInventoryDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 26);//EnumDataSetupType : InventoryDateSetup = 26
        $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', oInventoryDateSetup);

        //Cheque Reference
        var oChequeSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 31);//EnumDataSetupType : ChequeSetup = 31
        $('#txtDrCrChequeSetup').data('DataCollectionSetup', oChequeSetup);

        var oChequeReferenceAmountSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 9);//EnumDataSetupType : ChequeReferenceAmountSetup = 9
        $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', oChequeReferenceAmountSetup);

        var oChequeReferenceDescriptionSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 10);//EnumDataSetupType : ChequeReferenceDescriptinSetup = 10
        $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups', oChequeReferenceDescriptionSetup);

        var oChequeReferenceDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 11);//EnumDataSetupType : ChequeReferenceDateSetup = 11
        $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', oChequeReferenceDateSetup);

        //Order Ref
        var oOrderReferenceSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 32);//EnumDataSetupType : OrderSetup = 32
        $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', oOrderReferenceSetup);

        var oOrderNoSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 37);//EnumDataSetupType : OrderNoSetup = 37
        $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', oOrderNoSetup);

        var oOrderAmountSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 33);//EnumDataSetupType : OrderAmountSetup = 33
        $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', oOrderAmountSetup);

        var oOrderRemarkSetup = GetExistDCStups(oDebitCreditSetup.DataCollectionSetups, 34);//EnumDataSetupType : OrderRemarkSetup = 34
        $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups', oOrderRemarkSetup);

        var oOrderDateSetup = GetExistDCStup(oDebitCreditSetup.DataCollectionSetups, 35);//EnumDataSetupType : OrderDateSetup = 35
        $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', oOrderDateSetup);
        ChnageAccountHeadType();
        var sIntegrationSetupHeader = sessionStorage.getItem("IntegrationSetupHeader");
        if(sIntegrationSetupHeader=="View Integration Setup")
        {
            $('#btnSaveDrCr').hide();
        }
    });

    $('#btnDebitCreditRemove').click(function(){
        var oDebitCreditSetup = $('#tblDebitCreditSetup').datagrid('getSelected');
        if(oDebitCreditSetup === null)
        {
            alert("Please select a item from list!");
            return;
        }
        var selectedIndex = $('#tblDebitCreditSetup').datagrid('getRowIndex', oDebitCreditSetup);
        if (!confirm("Confirm to Delete?")) return ;
        $('#tblDebitCreditSetup').datagrid('deleteRow',selectedIndex);
    });

    $('#btnDebitCreditRefresh').click(function(){
        var oDebitCreditSetups = $('#tblDebitCreditSetup').datagrid('getRows');
        RefreshDebitCreditSetupList(oDebitCreditSetups);
    });

    $('#btnSaveDrCr').click(function(){
        if(!ValidateDebitCreditSetup()) return;
        var oDebitCreditSetup = RefreshObjectDebitCreditSetup();
        var selectedIndex = parseInt($("#winDebitCredit").data('selectedDrCrIndex'));
        if(selectedIndex<0)
        {
            $('#tblDebitCreditSetup').datagrid('appendRow', oDebitCreditSetup);
        }
        else
        {
            $('#tblDebitCreditSetup').datagrid('updateRow',{ index: selectedIndex, row: oDebitCreditSetup});
        }
        $("#winDebitCredit").icsWindow('close');
        $("#winDebitCredit :input").not("input[type='button']").val("");
    });

    $('#btnCloseDrCr').click(function(){
        $("#winDebitCredit").icsWindow('close');
        $("#winDebitCredit :input").not("input[type='button']").val("");
    });

    $('#cboDrCrAccountHeadType').change(function(){
        ChnageAccountHeadType();
    });

    $('#chkDrCrCostcCrtYes').click(function() {
        if($('#chkDrCrCostcCrtYes').is(":checked")) {
            $("#divSubledger :checkbox").prop('disabled', false);
            $("#divSubledger :button").prop('disabled', false);
            $("#txtDrCrCostcenterDataSQL,#txtDrCrCostCenterCompareColumns,#cboDrCrCostCenterRefObjType,#txtDrCrCostCenterNoColumn,#txtDrCrCostCenterRefObjColumn").prop('disabled', false);
            $("#chkDrCrCostcCrtNo").attr("checked", false);
        }
    });

    $('#chkDrCrCostcCrtNo').click(function() {
        if($('#chkDrCrCostcCrtNo').is(":checked")) {
            $("#divSubledger :input").prop('disabled', true);
            $("#chkDrCrCostcCrtYes,#chkDrCrCostcCrtNo").prop('disabled', false);
            $("#divSubledger :input").not("input[type='button']").val("");
            $("#cboDrCrCostCenterRefObjType").val(0);
            $("#chkDrCrCostcCrtYes,#chkDrCrHasBillReference,#chkDrCrHasChequeReference,#chkDrCrHasOrderReference").attr("checked", false);

            $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', null);
        }
    });

    $('#chkDrCrVoucherBillYes').click(function() {
        if($('#chkDrCrVoucherBillYes').is(":checked")) {
            $("#divVoucherBill :button").prop('disabled', false);
            $("#txtDrCrVoucherBillDataSQL,#txtDrCrVoucherBillCompareColumns,#cboDrCrVoucherBillTrType").prop('disabled', false);
            $("#cboDrCrVoucherBillRefObjType,#txtDrCrVoucherBillNoColumn,#txtDrCrVoucherBillRefObjColumn").prop('disabled', false);
            $("#chkDrCrVoucherBillNo").attr("checked", false);
        }
    });

    $('#chkDrCrVoucherBillNo').click(function() {
        if($('#chkDrCrVoucherBillNo').is(":checked")) {
            $("#divVoucherBill :input").prop('disabled', true);
            $("#chkDrCrVoucherBillYes,#chkDrCrVoucherBillNo").prop('disabled', false);
            $("#divVoucherBill :input").not("input[type='button']").val("");
            $("#cboDrCrVoucherBillTrType,#cboDrCrVoucherBillRefObjType").val(0);
            $("#chkDrCrVoucherBillYes").attr("checked", false);

            $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', null);
            $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrBillDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', null);
        }
    });

    $('#chkDrCrInventoryYes').click(function() {
        if($('#chkDrCrInventoryYes').is(":checked")) {
            $("#divInventory :button").prop('disabled', false);
            $("#txtDrCrInventoryDataSQL,#txtDrCrInventoryCompareColumns").prop('disabled', false);
            $("#chkDrCrInventoryNo").attr("checked", false);
        }
    });

    $('#chkDrCrInventoryNo').click(function() {
        if($('#chkDrCrInventoryNo').is(":checked")) {
            $("#divInventory :input").prop('disabled', true);
            $("#chkDrCrInventoryYes,#chkDrCrInventoryNo").prop('disabled', false);
            $("#divInventory :input").not("input[type='button']").val("");
            $("#chkDrCrInventoryYes").attr("checked", false);

            $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', null);
            $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', null);
        }
    });

    $('#chkDrCrChequeRefrncYes').click(function() {
        if($('#chkDrCrChequeRefrncYes').is(":checked")) {
            $("#divChequeReference :button").prop('disabled', false);
            $("#txtDrCrChequeReferenceDataSQL,#txtDrCrChequeReferenceCompareColumns,#cboDrCrChequeType").prop('disabled', false);
            $("#chkDrCrChequeRefrncNo").attr("checked", false);
        }
    });

    $('#chkDrCrChequeRefrncNo').click(function() {
        if($('#chkDrCrChequeRefrncNo').is(":checked")) {
            $("#divChequeReference :input").prop('disabled', true);
            $("#chkDrCrChequeRefrncYes,#chkDrCrChequeRefrncNo").prop('disabled', false);
            $("#divChequeReference :input").not("input[type='button']").val("");
            $("#cboDrCrChequeType").val(0);
            $("#chkDrCrChequeRefrncYes").attr("checked", false);

            $('#txtDrCrChequeSetup').data('DataCollectionSetup', null);
            $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups', []);
            $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', null);
        }
    });

    $('#chkDrCrOrderRefYes').click(function() {
        if($('#chkDrCrOrderRefYes').is(":checked")) {
            $("#divOrderReference :button").prop('disabled', false);
            $("#txtDrCrOrderReferenceDataSQL,#txtDrCrOrderReferenceCompareColumns,#cboDrCrRefType,#txtOrderRefColumn,#txtOrderDateColumn,#txtOrderNoColumn").prop('disabled', false);
            $("#chkDrCrOrderRefNo").attr("checked", false);
        }
    });

    $('#chkDrCrOrderRefNo').click(function() {
        if($('#chkDrCrOrderRefNo').is(":checked")) {
            $("#divOrderReference :input").prop('disabled', true);
            $("#chkDrCrOrderRefYes,#chkDrCrOrderRefNo").prop('disabled', false);
            $("#divOrderReference :input").not("input[type='button']").val("");
            $("#chkDrCrOrderRefYes").attr("checked", false);
            $("#cboDrCrRefType").val(0);

            $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups', []);
            $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', null);
            $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', null);
        }
    });
    //End Debit Credit Setup


    //Start Data Collection Setup
    $('#btnBusinessUnitSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Business Unit Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtBusinessUnitSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : IntegrationDetail = 1 & EnumDataSetupType : BusinessUnitSetup = 36
            oDataCollectionSetup = NewDataCollectionSetupObj(1, 36);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtBusinessUnitSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtBusinessUnitSetup');
    });

    $('#btnVoucherDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Voucher Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtVoucherDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : IntegrationDetail = 1 & EnumDataSetupType : VoucherDateSetup = 1
            oDataCollectionSetup = NewDataCollectionSetupObj(1, 1);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtVoucherDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtVoucherDateSetup');
    });

    $('#btnDecidedAccountHeadSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Decided Account Head Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : AccountHeadSetup = 6
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 6);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrDecidedAccountHeadName').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrDecidedAccountHeadName');
    });

    $('#btnDrCrReferencAccountHeadSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Referenc Account Head Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : AccountHeadSetup = 6
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 6);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrReferencAccountHeadName').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrReferencAccountHeadName');
    });

    $('#btnDrCrAccountNameSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Account Name Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrAccountNameSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : AccountNameSetup = 30
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 30);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrAccountNameSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrAccountNameSetup');
    });

    $('#btnDrCrCurrencySetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Currency Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrCurrencySetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CurrencySetup = 2
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 2);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrCurrencySetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrCurrencySetup');
    });

    $('#btnDrCrConversionRateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Conversion Rate Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrConversionRateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : ConversionRateSetup = 3
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 3);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrConversionRateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrConversionRateSetup');
    });

    $('#btnDrCrAmountSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Voucher Amount Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrAmountSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherDetailAmountSetup = 7
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 7);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrAmountSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrAmountSetup');
    });

    $('#btnDrCrCostcenterSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Costcenter Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrCostcenterSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CostCenterSetup = 12
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 12);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrCostcenterSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrCostcenterSetup');
    });

    $('#btnDrCrCostCenterAmountSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Costcenter Amount Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CostCenterAmountSetup = 13
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 13);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrCostCenterAmountSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrCostCenterAmountSetup');
    });

    $('#btnDrCrCostCenterDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Costcenter Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CostCenterDateSetup = 15
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 15);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrCostCenterDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrCostCenterDateSetup');
    });

    $('#btnDrCrCostCenterCategorySetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Costcenter Category Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CostCenterCategorySetup = 27
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 27);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrCostCenterCategorySetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrCostCenterCategorySetup');
    });

    $('#btnDrCrVoucherBillSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Voucher Bill Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherBillSetup = 16
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 16);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrVoucherBillSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrVoucherBillSetup');
    });

    $('#btnDrCrVoucherBillAmountSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Voucher Bill Amount Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherBillAmountSetup = 17
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 17);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrVoucherBillAmountSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrVoucherBillAmountSetup');
    });

    $('#btnDrCrVoucherBillDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Voucher Bill Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherBillDateSetup = 19
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 19);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrVoucherBillDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrVoucherBillDateSetup');
    });

    $('#btnDrCrBillDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Bill Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrBillDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : BillDateSetup = 28
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 28);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrBillDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrBillDateSetup');
    });

    $('#btnDrCrBillDueDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Bill Due Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : BillDueDateSetup = 29
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 29);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrBillDueDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrBillDueDateSetup');
    });

    $('#btnDrCrInventoryWorkingUnitSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Working Unit Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryWorkingUnitSetup = 20
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 20);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryWorkingUnitSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryWorkingUnitSetup');
    });

    $('#btnDrCrInventoryProductSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Product Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryProductSetup = 21
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 21);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryProductSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryProductSetup');
    });

    $('#btnDrCrInventoryQtySetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Qty Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryQtySetup = 22
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 22);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryQtySetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryQtySetup');
    });

    $('#btnDrCrInventoryUnitSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Unit Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryUnitSetup = 23
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 23);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryUnitSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryUnitSetup');
    });

    $('#btnDrCrInventoryUnitPriceSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Unit Price Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryUnitPriceSetup = 24
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 24);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryUnitPriceSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryUnitPriceSetup');
    });

    $('#btnDrCrInventoryDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Inventory Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryDateSetup = 26
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 26);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrInventoryDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrInventoryDateSetup');
    });

    $('#btnDrCrChequeSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Cheque Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrChequeSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : ChequeSetup = 31
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 31);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrChequeSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrChequeSetup');
    });

    $('#btnDrCrChequeReferenceAmountSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Cheque Amount Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : ChequeReferenceAmountSetup = 9
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 9);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrChequeReferenceAmountSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrChequeReferenceAmountSetup');
    });

    $('#btnDrCrChequeReferenceDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Cheque Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : ChequeReferenceDateSetup = 11
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 11);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrChequeReferenceDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrChequeReferenceDateSetup');
    });

    $('#btnDrCrOrderReferenceSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Order Reference Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : OrderSetup = 32
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 32);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrOrderReferenceSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrOrderReferenceSetup');
    });

    $('#btnDrCrOrderNoSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Order No Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrOrderNoSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : OrderNoSetup = 37
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 37);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrOrderNoSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrOrderNoSetup');
    });

    $('#btnDrCrOrderAmountSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Order Amount Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : OrderAmountSetup = 33
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 33);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrOrderAmountSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrOrderAmountSetup');
    });

    $('#btnDrCrOrderDateSetup').click(function(){
        $("#winDataCollectionSetup").icsWindow('open', "Configure Order Date Setup");
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
        $("#winDataCollectionSetup :checkbox").attr("checked", false);
        var oDataCollectionSetup = $('#txtDrCrOrderDateSetup').data('DataCollectionSetup');
        if(oDataCollectionSetup===null)
        {
            //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : OrderDateSetup = 35
            oDataCollectionSetup = NewDataCollectionSetupObj(2, 35);
        }
        RefCtrlDCStup(oDataCollectionSetup);
        $('#txtDrCrOrderDateSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetup').data('htmlControlId', '#txtDrCrOrderDateSetup');
    });

    $('#btnSaveDCStup').click(function(){
        if(!ValidateInputDCStup()) return;
        var oDataCollectionSetup = RefreshObjectDCStup();
        var htmControlId = $('#winDataCollectionSetup').data('htmlControlId');
        $(htmControlId).data('DataCollectionSetup', oDataCollectionSetup);
        $(htmControlId).val(oDataCollectionSetup.SetupText);

        $("#winDataCollectionSetup").icsWindow('close');
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
    });

    $('#btnCloseDCStup').click(function(){
        $("#winDataCollectionSetup").icsWindow('close');
        $("#winDataCollectionSetup :input").not("input[type='button']").val("");
    });

    $('#chkDCStupManual').change(function(){
        if($(this).is(":checked"))
        {
            $('#chkDCStupAutomated').attr("checked", false);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').prop('disabled', true);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').val('');
        }
    });

    $('#chkDCStupAutomated').change(function(){
        if($(this).is(":checked"))
        {
            $('#chkDCStupManual').attr("checked", false);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').prop('disabled', false);
            $('#txtDCStupQueryForValue,#txtDCStupReferenceValueFields').val('');
        }
    });
    //End Data Collection Setup


    //Start Data Collection Setups
    $('#btnNarrationSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Voucher Narration Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtNarrationSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : IntegrationDetail = 1 & EnumDataSetupType : NarrationSetup = 4
        var oDataCollectionSetup = NewDataCollectionSetupObj(1, 4);
        $('#txtNarrationSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtNarrationSetup');
    });

    $('#btnReferenceNoteSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Reference Note Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtReferenceNoteSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : IntegrationDetail = 1 & EnumDataSetupType : ReferenceNoteSetup = 5
        var oDataCollectionSetup = NewDataCollectionSetupObj(1, 5);
        $('#txtReferenceNoteSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtReferenceNoteSetup');
    });

    $('#btnDrCrNarrationSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Voucher Detail Narration Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrNarrationSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherDetailNarrationSetup = 8
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 8);
        $('#txtDrCrNarrationSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrNarrationSetup');
    });

    $('#btnDrCrCostCenterDescriptionSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Costcenter Description Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : CostCenterDescriptionSetup = 14
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 14);
        $('#txtDrCrCostCenterDescriptionSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrCostCenterDescriptionSetup');
    });

    $('#btnDrCrVoucherBillDescriptionSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Voucher Bill Description Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : VoucherBillDescriptionSetup = 18
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 18);
        $('#txtDrCrVoucherBillDescriptionSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrVoucherBillDescriptionSetup');
    });

    $('#btnDrCrInventoryDescriptionSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Inventory Description Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : InventoryDescriptionSetup = 25
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 25);
        $('#txtDrCrInventoryDescriptionSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrInventoryDescriptionSetup');
    });

    $('#btnDrCrChequeReferenceDescriptionSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Cheque Description Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : ChequeReferenceDescriptinSetup = 10
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 10);
        $('#txtDrCrChequeReferenceDescriptionSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrChequeReferenceDescriptionSetup');
    });

    $('#btnDrCrOrderRemarkSetup').click(function(){
        $("#winDataCollectionSetups").icsWindow('open', "Configure Voucher Narration Setup");
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
        var oDataCollectionSetups  = $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetups');
        if(oDataCollectionSetups===null) { oDataCollectionSetups = []; }
        RefreshDCStupLists(oDataCollectionSetups);

        //EnumDataReferenceType : DebitCreditSetup = 2 & EnumDataSetupType : OrderRemarkSetup = 34
        var oDataCollectionSetup = NewDataCollectionSetupObj(2, 34);
        $('#txtDrCrOrderRemarkSetup').data('DataCollectionSetup', oDataCollectionSetup);
        $('#winDataCollectionSetups').data('htmlControlId', '#txtDrCrOrderRemarkSetup');
    });

    $('#btnAddDCStups').click(function(){
        if(!ValidateInputDCStups()) return;
        var oDataCollectionSetup = RefreshObjectDCStups()
        $('#tblDataCollectionSetup').datagrid('appendRow',oDataCollectionSetup);
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
        $("#winDataCollectionSetups :checkbox").attr("checked", false);
    });

    $('#btnRemoveDCStups').click(function(){
        var oDataCollectionSetup= $('#tblDataCollectionSetup').datagrid('getSelected');
        if(oDataCollectionSetup==null)
        {
            alert("Please select a item from list!");
            return;
        }
        if (!confirm("Confirm to Delete?")) return ;
        var SelectedRowIndex=$('#tblDataCollectionSetup').datagrid('getRowIndex',oDataCollectionSetup);
        $('#tblDataCollectionSetup').datagrid('deleteRow', SelectedRowIndex);
    });

    $('#btnRefreshDCStups').click(function(){
        var oDataCollectionSetups = $('#tblDataCollectionSetup').datagrid('getRows');
        RefreshDCStupLists(oDataCollectionSetups);
    });

    $('#btnSaveDCStups').click(function(){
        var oDataCollectionSetups = $('#tblDataCollectionSetup').datagrid('getRows');
        if(oDataCollectionSetups.length<=0)
        {
            alert("Please Add at least One Narration");
            return;
        }
        var sSetupText = GetSetupTextDCStups();
        var htmControlId = $('#winDataCollectionSetups').data('htmlControlId');
        $(htmControlId).data('DataCollectionSetups', oDataCollectionSetups);
        $(htmControlId).val(sSetupText);
        $("#winDataCollectionSetups").icsWindow('close');
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
    });

    $('#btnCloseDCStups').click(function(){
        $("#winDataCollectionSetups").icsWindow('close');
        $("#winDataCollectionSetups :input").not("input[type='button']").val("");
    });

    $('#chkDCStupsManual').change(function(){
        if($(this).is(":checked"))
        {
            $('#chkDCStupsAutomated').attr("checked", false);
            $('#chkDCStupsFixedText').attr("checked", false);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields,#txtDCStupsFixedText').prop('disabled', true);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields,#txtDCStupsFixedText').val('');
        }
    });

    $('#chkDCStupsAutomated').change(function(){
        if($(this).is(":checked"))
        {
            $('#chkDCStupsManual').attr("checked", false);
            $('#chkDCStupsFixedText').attr("checked", false);
            $('#txtDCStupsFixedText').prop('disabled', true);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields').prop('disabled', false);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields,#txtDCStupsFixedText').val('');
        }
    });

    $('#chkDCStupsFixedText').change(function(){
        if($(this).is(":checked"))
        {
            $('#chkDCStupsManual').attr("checked", false);
            $('#chkDCStupsAutomated').attr("checked", false);
            $('#txtDCStupsFixedText').prop('disabled', false);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields').prop('disabled', true);
            $('#txtDCStupsQueryForValue,#txtDCStupsReferenceValueFields,#txtDCStupsFixedText').val('');
        }
    });
    //End Data Collection Setups


    //Start Integration Setup
    function RefreshCombobox()
    {
        var oSetupTypes = $('#cboSetupType').data('oSetupTypes');
        var oVoucherSetups = $('#cboVoucherSetup').data('VoucherSetups');
        var oBusinessUnits = $('#cboBusinessUnit').data('BusinessUnits');

        $("#cboSetupType").icsLoadCombo({List: oSetupTypes, OptionValue: "id", DisplayText: "Value" });
        $("#cboVoucherSetup").icsLoadCombo({List: oVoucherSetups, OptionValue: "id", DisplayText: "Value" });
        $("#cboBusinessUnit").icsLoadCombo({List: oBusinessUnits, OptionValue: "BusinessUnitID", DisplayText: "ShortName" });
    }

    function RefreshControl(oIntegrationSetup)
    {
        $('#txtSetupNo').val(oIntegrationSetup.SetupNo);
        $('#cboVoucherSetup').val(parseInt(oIntegrationSetup.VoucherSetupInt));
        $('#cboSetupType').val(parseInt(oIntegrationSetup.SetupTypeInInt));
        $('#txtDataCollectionSQL').val(oIntegrationSetup.DataCollectionSQL);
        $('#txtKeyColumn').val(oIntegrationSetup.KeyColumn);
        $('#cboBusinessUnit').val(parseInt(oIntegrationSetup.BUID));
        $('#txtNote').val(oIntegrationSetup.Note);
        RefreshDetailList(oIntegrationSetup.IntegrationSetupDetails);
        var sIntegrationSetupHeader = sessionStorage.getItem("IntegrationSetupHeader");
        $('#divIntegrationSetup').panel('setTitle',{ title : sIntegrationSetupHeader });
        if(sIntegrationSetupHeader=="View Integration Setup")
        {
            $('#btnSave,#btnAddDetail,#btnRemoveDetail,#btnPaste').hide();
            $("#divIntegrationSetup :input").prop('disabled', true);
        }
        else if(sIntegrationSetupHeader=="Copy Integration Setup")
        {
            $('#btnSave').hide();
        }
        else
        {
            $('#btnPaste').hide();
        }
    }

    function RefreshDetailList(oIntegrationSetupDetails)
    {
        var data=oIntegrationSetupDetails;
        data={"total":""+data.length+"","rows":data};
        $('#tblIntegrationSetupDetail').datagrid('loadData',data);
    }

    function Validation()
    {
        if($('#cboVoucherSetup').val()<=0){
            $('#cboVoucherSetup').focus();
            $('#cboVoucherSetup').addClass("errorFieldBorder");
            alert('Please Select Voucher Setup');
            return false;
        }
        else{
            $('#cboVoucherSetup').removeClass("errorFieldBorder");
        }

        if($('#cboSetupType').val()<=0){
            $('#cboSetupType').focus();
            $('#cboSetupType').addClass("errorFieldBorder");
            alert('Please Select Voucher Setup');
            return false;
        }
        else{
            $('#cboSetupType').removeClass("errorFieldBorder");
        }

        if( $.trim($('#txtDataCollectionSQL').val()) === null ||  $.trim($('#txtDataCollectionSQL').val()) === ""){
            $('#txtDataCollectionSQL').focus();
            $('#txtDataCollectionSQL').addClass("errorFieldBorder");
            alert('Please Enter Data Collection SQL');
            return false;
        }
        else{
            $('#txtDataCollectionSQL').removeClass("errorFieldBorder");
        }

        if( $.trim($('#txtKeyColumn').val()) === null ||  $.trim($('#txtKeyColumn').val()) === ""){
            $('#txtKeyColumn').focus();
            $('#txtKeyColumn').addClass("errorFieldBorder");
            alert('Please Enter Key Column Name');
            return false;
        }
        else{
            $('#txtKeyColumn').removeClass("errorFieldBorder");
        }

        if(parseInt($('#cboBusinessUnit').val())<=0){
            $('#cboBusinessUnit').focus();
            $('#cboBusinessUnit').addClass("errorFieldBorder");
            alert('Please Select Business Unit');
            return false;
        }
        else{
            $('#cboBusinessUnit').removeClass("errorFieldBorder");
        }

        var oIntegrationSetupDetails = $('#tblIntegrationSetupDetail').datagrid('getRows');
        if(oIntegrationSetupDetails.length<=0)
        {
            alert("Please enter at least one Item!");
            return false;
        }
        return true;
    }

    function RefreshObject()
    {
        var oTempIntegrationSetup = $('#divIntegrationSetup').data('IntegrationSetup');
        var oIntegrationSetup= {
            IntegrationSetupID : parseInt(oTempIntegrationSetup.IntegrationSetupID),
            SetupNo : oTempIntegrationSetup.SetupNo,
            VoucherSetupInt : parseInt($("#cboVoucherSetup").val()),
            DataCollectionSQL : $.trim($("#txtDataCollectionSQL").val()),
            KeyColumn : $.trim($("#txtKeyColumn").val()),
            BUID : parseInt($("#cboBusinessUnit").val()),
            Note : $.trim($("#txtNote").val()),
            SetupTypeInInt : parseInt($("#cboSetupType").val()),
            IntegrationSetupDetails : $('#tblIntegrationSetupDetail').datagrid('getRows')
        };
        return oIntegrationSetup;
    }

    $("#btnSave").click(function (){
        if(!Validation()) return false;
        var oIntegrationSetup=RefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url : sessionStorage.getItem('BaseAddress')+"/IntegrationSetup/Save",
            traditional: true,
            data:  JSON.stringify(oIntegrationSetup),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                oIntegrationSetup = jQuery.parseJSON(data);
                if (oIntegrationSetup.ErrorMessage==null || oIntegrationSetup.ErrorMessage=="") {
                    alert("Data Saved successfully");
                    var oIntegrationSetups = sessionStorage.getItem("IntegrationSetups");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedIntegrationSetupRowIndex"));
                    if (oIntegrationSetups != null) {
                        oIntegrationSetups = jQuery.parseJSON(oIntegrationSetups);
                    }
                    else {
                        oIntegrationSetups = [];
                    }
                    if (nIndex != -1) {
                        oIntegrationSetups[nIndex] = oIntegrationSetup;
                    }
                    else {
                        sessionStorage.setItem("SelectedRowIndex", oIntegrationSetups.length);
                        oIntegrationSetups.push(oIntegrationSetup);
                    }
                    sessionStorage.setItem("IntegrationSetups", JSON.stringify(oIntegrationSetups));
                    window.location.href = sessionStorage.getItem("BackLink");
                }
                else {
                    alert(oIntegrationSetup.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }

        });
    });

    $("#btnPaste").click(function (){
        if(!Validation()) return false;
        var oIntegrationSetup=RefreshObject();
        $.ajax({
            type: "POST",
            dataType: "json",
            url : sessionStorage.getItem('BaseAddress')+"/IntegrationSetup/Copy",
            traditional: true,
            data:  JSON.stringify(oIntegrationSetup),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                oIntegrationSetup = jQuery.parseJSON(data);
                if (oIntegrationSetup.ErrorMessage==null || oIntegrationSetup.ErrorMessage=="") {
                    alert("Data Saved successfully");
                    var oIntegrationSetups = sessionStorage.getItem("IntegrationSetups");
                    var nIndex = parseInt(sessionStorage.getItem("SelectedIntegrationSetupRowIndex"));
                    if (oIntegrationSetups != null) {
                        oIntegrationSetups = jQuery.parseJSON(oIntegrationSetups);
                    }
                    else {
                        oIntegrationSetups = [];
                    }

                    sessionStorage.setItem("SelectedRowIndex", oIntegrationSetups.length);
                    oIntegrationSetups.push(oIntegrationSetup);

                    sessionStorage.setItem("IntegrationSetups", JSON.stringify(oIntegrationSetups));
                    window.location.href = sessionStorage.getItem("BackLink");
                }
                else {
                    alert(oIntegrationSetup.ErrorMessage);
                }
            },
            error: function (xhr, status, error) {
                alert(error);
            }

        });
    });

    $('#btnClose').click(function(e){
        window.location.href = sessionStorage.getItem("BackLink");
    });
    //End Integration Setup


    ///AccountHead Pick
    $("#txtDrCrFixedAccountHeadName").keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 13) // Enter Press
        {
            var sAccountHeadName = $.trim($('#txtDrCrFixedAccountHeadName').val())
            if(sAccountHeadName === null || sAccountHeadName === "")
            {
                alert("Please enter account head Name!");
                $('#txtDrCrFixedAccountHeadName').focus();
                return;
            }

            var oChatOfAccount = {
                AccountHeadName : sAccountHeadName,
                AccountTypeInInt : 5
            }
            PickAccountHeads(oChatOfAccount);
        }
    });

    $('#txtDrCrFixedAccountHeadName').keydown(function (e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if (code == 8) //backspace=8
        {
            $("#txtDrCrFixedAccountHeadName").removeClass("fontColorOfPickItem");
            $("#winDebitCredit").data('DebitCreditSetup').FixedAccountHeadID = 0;
            $("#winDebitCredit").data('DebitCreditSetup').AccountCode ="";
            $("#winDebitCredit").data('DebitCreditSetup').AccountHeadName = "";
        }
    });

    function PickAccountHeads(oChatOfAccount)
    {
        var obj = {
            BaseAddress: sessionStorage.getItem("BaseAddress"),
            Object: oChatOfAccount,
            ControllerName: "ChartsOfAccount",
            ActionName: "GetsbyAccountTypeOrName",
            IsWinClose: false
        };
        $("#progbar").progressbar({ value: 0 });
        $("#progbarParent").show();
        var intervalID = setInterval(updateProgress, 250);
        $.icsDataGets(obj, function (response) {
            clearInterval(intervalID);
            $("#progbarParent").hide();
            if (response.status && response.objs.length > 0) {
                if (response.objs[0].AccountHeadID > 0) {
                    var tblColums = [];
                    var oColumn = { field: "AccountCode", title: "Account Code", width: 120, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "AccountHeadName", title: "Account Name", width: 220, align: "left" }; tblColums.push(oColumn);
                    oColumn = { field: "ParentHeadName", title: "Category Name", width: 200, align: "left" }; tblColums.push(oColumn);
                    var oPickerParam = {
                        winid: 'winAccountHead',
                        winclass: 'clsAccountHead',
                        winwidth: 600,
                        winheight: 460,
                        tableid: 'tblAccountHeads',
                        tablecolumns: tblColums,
                        datalist: response.objs,
                        multiplereturn: false,
                        searchingbyfieldName: 'AccountHeadName',
                        windowTittle: 'Account Head List'
                    };
                    $.icsPicker(oPickerParam);
                    IntializePickerbutton(oPickerParam);
                }
                else { alert(response.objs[0].ErrorMessage); }
            }else{
                alert("Data Not Found.");
                return;
            }
        });
    }
    //End AccountHead Picker

    function IntializePickerbutton(oPickerobj) {
        $("#" + oPickerobj.winid).find("#btnOk").click(function () {
            //for Single Select
            SetPickerValueAssign(oPickerobj);
        });
        $(document).find('.' + oPickerobj.winclass).keydown(function (e) {
            if (e.which == 13)//enter=13
            {
                SetPickerValueAssign(oPickerobj);
            }
        });
    }

    function SetPickerValueAssign(oPickerobj) {
        var oreturnObj = null, oreturnobjs = [];
        if (oPickerobj.multiplereturn) {
            oreturnobjs = $('#' + oPickerobj.tableid).datagrid('getChecked');
        } else {
            oreturnObj = $('#' + oPickerobj.tableid).datagrid('getSelected');
        }
        $("#" + oPickerobj.winid).icsWindow("close");
        $("#" + oPickerobj.winid).remove();

        if (oPickerobj.winid === 'winAccountHead')
        {
            if (oreturnObj != null && parseInt(oreturnObj.AccountHeadID) > 0) {
                $('#txtDrCrFixedAccountHeadName').val(oreturnObj.AccountHeadName);
                $('#txtDrCrFixedAccountHeadName').addClass('fontColorOfPickItem');
                $("#winDebitCredit").data('DebitCreditSetup').FixedAccountHeadID = parseInt(oreturnObj.AccountHeadID);
                $("#winDebitCredit").data('DebitCreditSetup').AccountCode = oreturnObj.AccountCode;
                $("#winDebitCredit").data('DebitCreditSetup').AccountHeadName = oreturnObj.AccountHeadName;
            }
        }
    }

    function updateProgress() {
        var value =$('#progbar').progressbar('getValue');
        if (value < 96){
            value += Math.floor(Math.random() * 10);
            $('#progbar').progressbar('setValue', value);
        }
    }

    function hideShow(miliseconds) {
        $("#progbarParent").hide();
    }

</script>