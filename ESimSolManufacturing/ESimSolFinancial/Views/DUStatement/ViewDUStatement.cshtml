@model IEnumerable<ESimSol.BusinessObjects.DUStatement>

    @{
        ViewBag.Title = "DU Statement";
    }

<div ng-app="DUSApp" class="form-horizontal regionDUStatement">
    <div ng-controller="DUSCntrl">

        <div class="ui-grid-top-panel" style="height:50px">
            <div class="text-left" style="padding-left:3px;padding-top:16px">
                @*<label class="control-label">DU Statement :</label>*@
                <div class="row col-md-12">
                    <div class="col-md-2 text-right">
                        <label class="control-label"> Unit :</label>
                    </div>
                    <div class="col-md-2 text-left">
                        <select id="cboUnit" ng-change="changeFDOType()" ng-model="BusinessUnitID" style="width:220px; margin:0 5px 0 0px" ng-options="obj.BusinessUnitID as obj.ShortName for obj in BusinessUnits" ng-disabled="DUBusinessUnitID > 0" class="form-control">
                            <option value="">--Select One--</option>
                        </select>
                    </div>
                    <div class="col-md-2 text-right">
                        <label class="control-label">Buyer:</label>
                    </div>
                    <div class="col-md-6 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlBuyer" ng-model="txtBuyer" placeholder="Type Name & Press Enter" ng-disabled="disabled" ng-keydown="SearchKeyDownBuyer($event)" style="width:40%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickBuyer()" ng-disabled="disabled"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveBuyer()" ng-disabled="disabled"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      
        <div style="height:70%">
            <fieldset style="height:100%">
                <div class="row col-md-12" style="padding-top:50px;">
                    <div class="col-md-2 text-right">
                        <label class="control-label">Order No :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlOrderNo" ng-model="txtOrderNo" placeholder="Type Order & Press Enter" ng-disabled="ORdisabled" ng-keydown="SearchKeyDownOrder($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickOrder()" ng-disabled="ORdisabled"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveOrder()" ng-disabled="ORdisabled"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right">
                        <label class="control-label">Bill/InvoiceNo :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlInvoiceNo" ng-model="txtInvoiceNo" placeholder="Type Invoice No & Press Enter" ng-disabled="Billdisabled" ng-keydown="SearchKeyDownInvoice($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickInvoice()" ng-disabled="Billdisabled"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveInvoice()" ng-disabled="Billdisabled"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right">
                        <label class="control-label">PI No :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlPINo" ng-model="txtPINo" placeholder="Type PI No & Press Enter" ng-disabled="disabled" ng-keydown="SearchKeyDownPI($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickPI()" ng-disabled="disabled"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemovePI()" ng-disabled="disabled"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-2 text-right">
                        <label class="control-label">LC No :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlLCNo" ng-model="txtLCNo" placeholder="Type LC No & Press Enter" ng-disabled="disabled" ng-keydown="SearchKeyDownLC($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickLC()" ng-disabled="disabled"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveLC()" ng-disabled="disabled"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
                <div ng-hide="DOHideDyeing" class="row col-md-12" >
                    <div class="col-md-2 text-right">
                        <label class="control-label">DO No :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlDONo" ng-model="txtDONo" placeholder="Type DO & Press Enter" ng-keydown="SearchKeyDownDO($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickDO()" ><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveDO()" ><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
                <div ng-hide="DOHideFabric" class="row col-md-12" style="padding-bottom:50px;">
                    <div class="col-md-2 text-right">
                        <label class="control-label">DO No :</label>
                    </div>
                    <div class="col-md-10 text-left">
                        <div class="form-inline">
                            <input class="form-control" ng-style="stlDONo" ng-model="txtDONoFabric" placeholder="Type Fabric DO No & Press Enter" ng-keydown="SearchKeyDownDOFabric($event)" style="width:50%" required />
                            <button type="button" class="btn btn-primary btn-sm" aria-label="right Align" ng-click="PickDOFabric()"><span aria-hidden="true"> Pick </span></button>
                            <button type="button" class="btn btn-danger btn-sm" aria-label="right Align" ng-click="RemoveDOFabric()"><span aria-hidden="true"> Remove </span></button>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div style="height:25%">
            <fieldset style="height:100%">
                <div class="row col-md-12" >
                    <div class="navbar-form">
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn btn-warning btn-group-sm" aria-label="right Align" ng-click="Reset()" ng-disabled="disabled"><span aria-hidden="true"> Reset </span></button>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn btn-primary btn-sm" aria-label="left Align" ng-click="printBillStatement()" ng-disabled="disabled"><span aria-hidden="true"> Preview (Bill Statement)</span></button>
                        <button type="button" class="btn btn-primary btn-sm" aria-label="left Align" ng-click="PrintStatement_DO(1)" ng-disabled="disabled"><span aria-hidden="true"> Preview (Delivery Statement)</span></button>
                        <button type="button" class="btn btn-primary btn-sm" aria-label="left Align" ng-click="PrintStatement_DO(2)" ng-disabled="disabled"><span aria-hidden="true"> Preview (Delivery & Dyeing Statement)</span></button>
                        <button type="button" class="btn btn-primary btn-sm" aria-label="left Align" ng-click="PrintStatement_All()" ng-disabled="disabled"><span aria-hidden="true"> Preview (All)</span></button>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</div>

<style type="text/css">
    .grid {
        width: 100%;
        height: 290px;
    }

    .regionDUStatement .form-horizontal .control-label {
        padding-top: 3px;
    }

    .regionDUStatement .form-control {
        height: 26px;
        padding: 0px 6px;
        font-size: 12px;
    }

    .regionDUStatement .col-md-12 {
        width: 100%;
        padding-right: 5px;
        padding-left: 5px;
        margin-bottom: 5px;
    }

    .regionDUStatement .col-md-2 {
        width: 16.6%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .col-md-3 {
        width: 20%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .col-md-4 {
        width: 28%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .col-md-5 {
        width: 40%;
        padding-right: 5px;
        padding-left: 0px;
    }

    .regionDUStatement .col-md-6 {
        width: 50%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .col-md-10 {
        width: 83%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .col-md-8 {
        width: 69%;
        padding-right: 5px;
        padding-left: 5px;
    }

    .regionDUStatement .btn-sm {
        padding: 3px 10px;
    }

    .regionDUStatement .input-group-addon {
        padding: 4px 8px;
    }
</style>

<script type="text/javascript">

    _sBaseAddress =@Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(HttpContext.Current.Session[SessionInfo.BaseAddress]));

    var oImos =@Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model));

    var nBUID = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BUID));
    var nBusinessUnitTypeInInt = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnitTypeInInt));
    var oBusinessUnits = @Html.Raw(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(ViewBag.BusinessUnits));
    sessionStorage.setItem('BUID',nBUID);

    var  DUSApp = angular.module('DUSApp',['ngAnimate','ui.bootstrap','ui.grid','ui.grid.selection','ui.grid.resizeColumns','ms.service']);
    DUSApp.controller('DUSCntrl', function ($scope,$http,$uibModal,$log,uiGridConstants,msModal,userSession,icsMethod)
    {
        $scope.BusinessUnits=oBusinessUnits;
        $scope.BusinessUnitID=nBUID;
        $scope.DUBusinessUnitID=nBUID;
        $scope.BusinessUnitTypeInInt=nBUID;
        $scope.BusinessUnitTypeInInt=nBusinessUnitTypeInInt;
        $scope.DOHideDyeing =false;
        $scope.DOHideFabric =false;
        $scope.Reset= function ()
        {
            if($scope.DUBusinessUnitID==0)
                $scope.BusinessUnitID=0;

            $scope.DyeingOrderID=0;
            $scope.BuyerID=0;
            $scope.SampleInvoiceID=0;
            $scope.DUDeliveryOrderID=0;
            $scope.ExportPIID=0;
            $scope.ExportLCID=0;

            $scope.txtBuyer='';
            $scope.txtOrderNo="";
            $scope.txtInvoiceNo="";
            $scope.txtLCNo="";
            $scope.txtPINo="";
            $scope.txtDONo="";
            $scope.txtDONoFabric="";
            $scope.FDOID=0;

            $scope.stlBuyer= $scope.stlOrderNo= $scope.stlInvoiceNo= $scope.stlPINo= $scope.stlLCNo=$scope.stlDONo= {
                "color" : "black",
                "font-size" : "12px",
            }
        }

        $scope.Reset();

        //------------PICKERS-------------

        //------------Buyer-------------
        $scope.PickBuyer= function ()
        {
            var oContractor = {
                Params: '2' + '~' + $.trim($scope.txtBuyer)+'~'+$scope.BusinessUnitID
            };
            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(_sBaseAddress+'/Contractor/ContractorSearchByNameType',$.param(oContractor), config).then(
                                function (response)
                                {
                                    var oColumns = [];
                                    var oColumn = { field: 'ContractorID', name: 'Code',width: '20%'  };oColumns.push(oColumn);
                                    oColumn = { field: 'Name', name: 'Applicant Name',width: '50%', enableSorting: false  };oColumns.push(oColumn);
                                    oColumn = { field: 'Address', name: 'Address',width: '30%', enableSorting: false  };oColumns.push(oColumn);

                                    var results = response.data;
                                    if(results.length<=0)
                                    {
                                        alert("No Data Found!!"); return;
                                    }else if(results[0].ContractorID==0)
                                    {
                                        alert(results[0].ErrorMessage);return;
                                    }

                                    var modalObj={
                                        size:'md',
                                        modalcontroller:'ModalCommonListCtrl',
                                        appcontroller:'SalesQuotationController',
                                        objs:results,
                                        multiSelect:false,
                                        pickertitle:'Buyer List',
                                        searchingbyfieldName:'Name',
                                        columns:oColumns
                                    }
                                    var modalInstance=msModal.Instance(modalObj);
                                    modalInstance.result.then(function (result)
                                    {
                                        if(result.ContractorID>0)
                                        {
                                            $scope.stlBuyer= {
                                                "color" : "blue",
                                                "font-size" : "12px"
                                            };
                                            $scope.BuyerID=result.ContractorID;
                                            $scope.txtBuyer=result.Name;
                                        }

                                    }, function () {
                                        $log.info('Modal dismissed at: ' + new Date());
                                    });
                                },
                                    function (response) { alert(jQuery.parseJSON(response.data).Message);}
                            );
        };
        $scope.SearchKeyDownBuyer = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                if($scope.BusinessUnitID==0 || $scope.BusinessUnitID==null)
                {
                    alert("Please Select Business Unit!");
                    return;
                }
                $scope.PickBuyer();
            }else if (code == 8) //backspace=8
            {
                //debugger;
                $scope.BuyerID=0;
            }
        };
        $scope.RemoveBuyer= function ()
        {
            $scope.stlBuyer= {
                "color" : "black",
                "font-size" : "12px",
            }
            $scope.BuyerID=0;
            $scope.txtBuyer='';
        }
        //------------Order-------------
        $scope.PickOrder= function ()
        {
            var oDO= {
                OrderNo:($scope.txtOrderNo == undefined ? "" : $scope.txtOrderNo),
                //ExportPIID:0,//DyeingOrderID
                //SampleInvoiceID:0,
                ContractorID:$scope.BuyerID,
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetDyeingOrders',$.param(oDO), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'OrderNoFull', name:'Order No', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'OrderDateSt', name:'Order Date', width:'15%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'OrderTypeSt', name:'Type', width:'15%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'ContractorName', name:'Buyer', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                           

                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Order Found!!"); return;
                            }else if(results[0].DyeingOrderID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'lg',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'Order List',
                                searchingbyfieldName:'OrderNoFull',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                if(result.DyeingOrderID>0)
                                {
                                    $scope.stlOrderNo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.DyeingOrderID=result.DyeingOrderID;
                                    $scope.txtOrderNo=result.OrderNo;
                                }
                                else
                                    alert(result.ErrorMessage);

                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) { debugger; alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownOrder = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtOrder = $.trim($scope.txtOrderNo);
                if(txtOrder=="" || txtOrder==null)
                {
                    alert("Type Order No and Press Enter");
                    return;
                }
                $scope.PickOrder();
            }else if (code == 8) //backspace=8
            {
                //debugger;
                //$scope.txtOrderNo='';
                $scope.DyeingOrderID=0;
            }
        };
        $scope.RemoveOrder= function ()
        {
            $scope.stlOrderNo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.DyeingOrderID=0;
            $scope.txtOrderNo="";
        }
        //------------Invoice-------------
        $scope.PickInvoice= function ()
        {
            debugger;
            var oInvoice= {
                SampleInvoiceNo:($scope.txtInvoiceNo == undefined ? "" : $scope.txtInvoiceNo),
                ///ExportPINo:"",
                ContractorID:$scope.BuyerID,
                OrderNo:($scope.DyeingOrderID<=0? "": $scope.txtOrderNo),
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetSampleInvoices',$.param(oInvoice), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'SampleInvoiceNo', name:'Invoice No', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'ContractorName', name:'Buyer', width:'45%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'SampleInvoiceDateST', name:'Date', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);

                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Data Found!!"); return;
                            }else if(results[0].SampleInvoiceID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'md',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'Invoice List',
                                searchingbyfieldName:'SampleInvoiceNo',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                if(result.SampleInvoiceID>0)
                                {
                                    $scope.stlInvoiceNo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.SampleInvoiceID=result.SampleInvoiceID;
                                    $scope.txtInvoiceNo=result.SampleInvoiceNo;
                                }
                                else
                                    alert(result.ErrorMessage);
                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) {  debugger; alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownInvoice = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtOrder = $.trim($scope.txtInvoiceNo);
                if(txtOrder=="" || txtOrder==null)
                {
                    alert("Type Invoice No and Press Enter");
                    return;
                }
                $scope.PickInvoice();
            }else if (code == 8) //backspace=8
            {
                $scope.RemoveInvoice();
            }
        };
        $scope.RemoveInvoice= function ()
        {
            $scope.stlInvoiceNo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtInvoiceNo="";
            $scope.SampleInvoiceID=0;
        }
        //------------PI-------------
        $scope.PickPI= function ()
        {
            var oPI= {
                PINo:($scope.txtPINo == undefined ? "" : $scope.txtPINo),
                LCID:$scope.ExportLCID,
                BuyerID:$scope.BuyerID,
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetExportPIs',$.param(oPI), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'PINo', name:'PI No', width:'75%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'IssueDateInString', name:'Issue Date', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Data Found!!"); return;
                            }else if(results[0].ExportPIID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'md',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'PI List',
                                searchingbyfieldName:'SampleInvoiceNo',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                if(result.ExportPIID>0)
                                {
                                    $scope.stlPINo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.txtPINo=result.PINo;
                                    $scope.ExportPIID=result.ExportPIID;
                                }
                                else
                                    alert(result.ErrorMessage);
                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) {     debugger; alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownPI = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtPINo = $.trim($scope.txtPINo);
                if(txtPINo=="" || txtPINo==null)
                {
                    alert("Type PI No and Press Enter");
                    return;
                }

                $scope.PickPI();
            }else if (code == 8) //backspace=8
            {
                //debugger;
              
                $scope.ExportPIID=0;
            }
        };
        $scope.RemovePI= function ()
        {
            $scope.stlPINo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtPINo='';
            $scope.ExportPIID=0;
        }
        //------------LC-------------
        $scope.PickLC= function ()
        {
            var oLC= {
                ExportLCNo:($scope.txtLCNo == undefined ? "" : $scope.txtLCNo),
                //PINo:"",
                //LCID:"",
                Applicant:$scope.ContractorID,
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetExportLCs',$.param(oLC), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'ExportLCNo', name:'Invoice No', width:'25%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'FileNo', name:'File No', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'ApplicantName', name:'Applicant', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'OpeningDateST', name:'Opening Date', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);

                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Data Found!!"); return;
                            }else if(results[0].ExportLCID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'lg',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'LC List',
                                searchingbyfieldName:'ExportLCNo',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                if(result.ExportLCID>0)
                                {
                                    $scope.stlLCNo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.txtLCNo=result.ExportLCNo;
                                    $scope.ExportLCID=result.ExportLCID;
                                }

                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) { alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownLC = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtLCNo = $.trim($scope.txtLCNo);
                if(txtLCNo=="" || txtLCNo==null)
                {
                    alert("Type LC No and Press Enter");
                    return;
                }

                $scope.PickLC();
            }else if (code == 8) //backspace=8
            {
                //debugger;
                $scope.RemoveLC();
            }
        };
        $scope.RemoveLC= function ()
        {
            $scope.stlLCNo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtLCNo='';
            $scope.ExportLCID=0;
        }
        //------------DO Dyeing-------------
        $scope.PickDO= function ()
        {
            var oDO= {
                DONo:($scope.txtDONo == undefined ? "" : $scope.txtDONo),
                ExportPIID:$scope.ExportPIID,
                OrderID:$scope.DyeingOrderID,
                ContractorID:0,
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetDUDOrders',$.param(oDO), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'DONo', name:'DO No', width:'24%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            var oColumn = { field: 'OrderNo', name:'Order No', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'OrderTypeSt', name:'Type', width:'25%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            //oColumn = { field: 'ContractorName', name:'Contractor', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'DODateSt', name:'DO Date', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            //oColumn = { field: 'ExportLCNo', name:'LC No', width:'15%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);

                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Data Found!!"); return;
                            }else if(results[0].DUDeliveryOrderID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'md',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'DO List',
                                searchingbyfieldName:'DONo',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                debugger;
                                if(result.DUDeliveryOrderID>0)
                                {
                                    $scope.stlDONo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.txtDONo=result.DONo;
                                    $scope.DUDeliveryOrderID=result.DUDeliveryOrderID;
                                }

                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) { alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownDO = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtDONo = $.trim($scope.txtDONo);
                if(txtDONo=="" || txtDONo==null)
                {
                    alert("Type DO No and Press Enter");
                    return;
                }

                $scope.PickDO();
            }else if (code == 8) //backspace=8
            {
                //debugger;
         
                $scope.DUDeliveryOrderID=0;
            }
        };
        $scope.RemoveDO= function ()
        {
            $scope.stlDONo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtDONo='';
            $scope.DUDeliveryOrderID=0;
        }

        //------------DO Wiving and Finishing-------------
        $scope.PickDOFabric= function ()
        {
            var oDO= {
                DONo:($scope.txtDONoFabric == undefined ? "" : $scope.txtDONoFabric),
                ExportPIID:$scope.ExportPIID,
                FEOID:$scope.DyeingOrderID,
                ContractorID:0,
                BUID:$scope.BusinessUnitID
            };

            var config = { headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;' } };
            $http.post(sessionStorage.getItem('BaseAddress')+'/DUStatement/GetsFabricDO',$.param(oDO), config).then(
                        function (response)
                        {
                            debugger;
                            var oDetailColumns = [];
                            var oColumn = { field: 'DONo', name:'DO No', width:'24%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            var oColumn = { field: 'FDOTypeInSt', name:'DO Type', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            //oColumn = { field: 'ContractorName', name:'Contractor', width:'30%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            oColumn = { field: 'DODateSt', name:'DO Date', width:'20%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);
                            //oColumn = { field: 'ExportLCNo', name:'LC No', width:'15%',cellClass: 'text-left', enableCellEdit:false };oDetailColumns.push(oColumn);

                            var results=jQuery.parseJSON(response.data);

                            if(results.length<=0)
                            {
                                alert("No Data Found!!"); return;
                            }else if(results[0].DUDeliveryOrderID==0)
                            {
                                alert(results[0].ErrorMessage);return;
                            }

                            var modalObj={
                                size:'md',
                                modalcontroller:'',
                                appcontroller:'',
                                objs:results,
                                multiSelect:false,
                                pickertitle:'DO List',
                                searchingbyfieldName:'DONo',
                                columns:oDetailColumns
                            }
                            var modalInstance=msModal.Instance(modalObj);

                            modalInstance.result.then(function (result)
                            {
                                debugger;
                                if(result.FDOID>0)
                                {
                                    $scope.stlDONo= {
                                        "color" : "blue",
                                        "font-size" : "12px"
                                    };
                                    $scope.txtDONoFabric=result.DONo;
                                    $scope.FDOID=result.FDOID;
                                }

                            }, function () {
                                $log.info('Modal dismissed at: ' + new Date());
                            });
                        },
                            function (response) { alert(jQuery.parseJSON(response.data).Message);}
                    );
        };
        $scope.SearchKeyDownDOFabric = function (e){
            //debugger;
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13)
            {
                var txtDONo = $.trim($scope.txtDONoFabric);
                if(txtDONo=="" || txtDONo==null)
                {
                    alert("Type DO No and Press Enter");
                    return;
                }

                $scope.PickDOFabric();
            }else if (code == 8) //backspace=8
            {
                //debugger;
             
                $scope.FDOID=0;
            }
        };
        $scope.RemoveDO= function ()
        {
            $scope.stlDONo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtDONo='';
            $scope.DUDeliveryOrderID=0;
        }
        $scope.RemoveDOFabric= function ()
        {
            $scope.stlDONo= {
                "color" : "black",
                "font-size" : "12px"
            };
            $scope.txtDONoFabric='';
            $scope.FDOID=0;
        }
        

        //-----------PICKERS__END---------------

        $scope.printBillStatement = function(){

            var  sTempString ="nBUID="+$scope.BusinessUnitID
                    +"&nExportLCID="+$scope.ExportLCID
                    +"&nVersionNo=-1"
                    +"&nExportPIID="+$scope.ExportPIID
                    +"&nDyeingOrderID="+$scope.DyeingOrderID
                    +"&nDOID="+$scope.DUDeliveryOrderID
                    +"&nSampleInvoiceID="+$scope.SampleInvoiceID;

            window.open(_sBaseAddress + '/DUStatement/PrintDUStatementReport?'+sTempString, "_blank");
        };
        $scope.printBillStatement_F2 = function(){

            var  sTempString ="nBUID="+$scope.BusinessUnitID
                    +"&nExportLCID="+$scope.ExportLCID
                    +"&nVersionNo=-1"
                    +"&nExportPIID="+$scope.ExportPIID
                    +"&nDyeingOrderID="+$scope.DyeingOrderID
                    +"&nDOID="+$scope.DUDeliveryOrderID
                    +"&nSampleInvoiceID="+$scope.SampleInvoiceID;

            window.open(_sBaseAddress + '/DUStatement/PrintDUStatementReport_F2?'+sTempString, "_blank");
        };
        $scope.PrintStatement_DO = function(nDOType){

            var  sTempString ="nBUID="+$scope.BusinessUnitID
                    +"&nExportLCID="+$scope.ExportLCID
                    +"&nVersionNo=-1"
                    +"&nExportPIID="+$scope.ExportPIID
                    +"&nDyeingOrderID="+$scope.DyeingOrderID
                    +"&nDOID="+$scope.DUDeliveryOrderID
                    +"&nSampleInvoiceID="+$scope.SampleInvoiceID
                    +"&nDOType="+(nDOType==undefined?0:nDOType);

            window.open(_sBaseAddress + '/DUStatement/PrintDOStatementReport?'+sTempString, "_blank");
        };
        $scope.PrintStatement_All = function(){

            var  sTempString ="nBUID="+$scope.BusinessUnitID
                    +"&nExportLCID="+$scope.ExportLCID
                    +"&nVersionNo=-1"
                    +"&nExportPIID="+$scope.ExportPIID
                    +"&nDyeingOrderID="+$scope.DyeingOrderID
                    +"&nDOID="+$scope.DUDeliveryOrderID
                    +"&nSampleInvoiceID="+$scope.SampleInvoiceID;

            window.open(_sBaseAddress + '/DUStatement/PrintStatement_All?'+sTempString, "_blank");
        };

        ///---Fabric DO

        $scope.changeFDOType = function()
        {
            debugger;
            for(var i = 0; i<$scope.BusinessUnits.length;i++)
            {
                if($scope.BusinessUnitID==$scope.BusinessUnits[i].BusinessUnitID)
                {
                    $scope.BusinessUnitTypeInInt=$scope.BusinessUnits[i].BusinessUnitTypeInInt;
                    break;
                }
            }
            
            if(parseInt($scope.BusinessUnitTypeInInt)==1)//finishing
            {
                $scope.DOHideDyeing =false;    
                $scope.DOHideFabric =true;    
            }
            else
            {
                $scope.DOHideDyeing =true;
                $scope.DOHideFabric =false;    
            }

        };

    });

</script>
